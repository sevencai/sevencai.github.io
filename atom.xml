<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Seven&#39;s Blog</title>
  <subtitle>Share, Learn, Enjoy, Keep</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://sevencai.github.io/"/>
  <updated>2019-06-06T08:35:29.000Z</updated>
  <id>http://sevencai.github.io/</id>
  
  <author>
    <name>Seven Cai</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>webpackè¯»ä¹¦ç¬”è®°-å››</title>
    <link href="http://sevencai.github.io/2019/06/05/webpack%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E5%9B%9B/"/>
    <id>http://sevencai.github.io/2019/06/05/webpackè¯»ä¹¦ç¬”è®°-å››/</id>
    <published>2019-06-05T13:24:36.000Z</published>
    <updated>2019-06-06T08:35:29.000Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure>
<p>// TODO:: not finished yet</p>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;spa
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>5æœˆç¬”è®°</title>
    <link href="http://sevencai.github.io/2019/05/27/5%E6%9C%88%E7%AC%94%E8%AE%B0/"/>
    <id>http://sevencai.github.io/2019/05/27/5æœˆç¬”è®°/</id>
    <published>2019-05-27T11:56:22.000Z</published>
    <updated>2019-05-28T12:06:25.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½ ä»Šå¹´30å² é‚£ä¹ˆå¦‚æœä½ åˆ©ç”¨ä¸šåŠ¡æ—¶é—´å­¦è‹±è¯­ é‚£ä¹ˆ5å¹´ä¹Ÿå°±æ˜¯ä½ 35å²æ—¶ ä½ å¯èƒ½å°±å¯ä»¥æˆä¸ºä¸€ä¸ªè¯´è‹±æ–‡å¾ˆæµåˆ©çš„äººğŸŒ¹</p>
<p>æ°¸è¿œä¸è¦è¢«æ—¶é—´é™åˆ¶ä½è‡ªå·± å°½ä½ è‡ªå·±æœ€å¤§çš„åŠªåŠ› åŠªåŠ›åšæˆä½ æœ€æƒ³åšçš„é‚£ä»¶äº‹ æˆä¸ºä½ æœ€æƒ³æˆä¸ºçš„é‚£ç§äºº è¿‡ç€ä½ æœ€æƒ³è¿‡çš„é‚£ç§ç”Ÿæ´» ğŸ’³</p>
<p>ä¹Ÿè®¸æˆ‘ä»¬å§‹ç»ˆéƒ½åªæ˜¯ä¸€ä¸ªå°äººç‰© ä½†è¿™å¹¶ä¸å¦¨ç¢æˆ‘ä»¬é€‰æ‹©ç”¨ä»€ä¹ˆæ ·çš„æ–¹å¼æ´»ä¸‹å» è¿™ä¸ªä¸–ç•Œæ°¸è¿œæ¯”ä½ æƒ³çš„è¦æ›´ç²¾å½© ğŸ“šğŸŒ²</p>
</blockquote>
<p>ä¹‹æ‰€ä»¥å†™ä¸Šé¢è¿™æ®µé¸¡æ±¤ï¼Œå®Œå…¨æ˜¯ä¸ºäº†é¿å…å­—æ•°å¤ªå°‘ï¼Œå¯¼è‡´ä¸»é¡µæ‘˜è¦ä¸å‡ºç°ä»£ç è¡Œå·çš„æƒ…å†µã€‚è¯·å¿½ç•¥~</p>
<hr>
<h2 id="jså¯¹ç§°åŠ å¯†ç®—æ³•"><a href="#jså¯¹ç§°åŠ å¯†ç®—æ³•" class="headerlink" title="jså¯¹ç§°åŠ å¯†ç®—æ³•"></a>jså¯¹ç§°åŠ å¯†ç®—æ³•</h2><p>æœ€è¿‘æœ‰ç”¨åˆ° js çš„å¯¹ç§°åŠ å¯†çš„ç®—æ³•æ¥è§£å†³ä¸€äº›ç®€å•çš„æ•°æ®åº“å­—æ®µåŠ å¯†é—®é¢˜ã€‚ç®€å•çš„ demo å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Aes</span> </span>&#123;</span><br><span class="line">  <span class="comment">// æ­¤å¤„4ä¸ªå‚æ•°å¯ä»¥æ”¹æˆç”±å¤–éƒ¨ä¼ å…¥</span></span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">this</span>.key = <span class="string">'xxxxxx'</span></span><br><span class="line">    <span class="keyword">this</span>.algorithm = <span class="string">'aes256'</span></span><br><span class="line">    <span class="keyword">this</span>.inputEncoding = <span class="string">'utf8'</span></span><br><span class="line">    <span class="keyword">this</span>.outputEncoding = <span class="string">'hex'</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * encrypt åŠ å¯†</span></span><br><span class="line"><span class="comment">   * @param data</span></span><br><span class="line"><span class="comment">   * @returns &#123;string&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  encrypt(data) &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; algorithm, inputEncoding, outputEncoding, key &#125; = <span class="keyword">this</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> cipher = crypto.createCipher(algorithm, key)</span><br><span class="line">    <span class="keyword">let</span> ciphered = cipher.update(data, inputEncoding, outputEncoding)</span><br><span class="line"></span><br><span class="line">    ciphered += cipher.final(outputEncoding)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ciphered</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * descrpt è§£å¯†</span></span><br><span class="line"><span class="comment">   * @param ciphered</span></span><br><span class="line"><span class="comment">   * @returns &#123;string&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  descrpt(ciphered) &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; algorithm, inputEncoding, outputEncoding, key &#125; = <span class="keyword">this</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> decipher = crypto.createDecipher(algorithm, key)</span><br><span class="line">    <span class="keyword">let</span> deciphered = decipher.update(ciphered, outputEncoding, inputEncoding)</span><br><span class="line"></span><br><span class="line">    deciphered += decipher.final(inputEncoding)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> deciphered</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Aes</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ä½¿ç”¨-xlsx-è½¬æ¢æ–‡ä»¶"><a href="#ä½¿ç”¨-xlsx-è½¬æ¢æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨ xlsx è½¬æ¢æ–‡ä»¶"></a>ä½¿ç”¨ xlsx è½¬æ¢æ–‡ä»¶</h2><p>ä»¥ä¸‹è®°å½•ä¸‹æœ€è¿‘ä½¿ç”¨çš„xlsxåº“ï¼Œä½¿ç”¨çš„ç›®çš„æ˜¯è§£å†³ä¸‹é¢ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>å°† excel è½¬æ¢ä¸º CSVï¼ˆå¦‚ /home/seven/201212 -&gt; /home/seven/201212_txtï¼‰, å¹¶å†™å…¥åŸç›®å½•ï¼Œå› ä¸ºåå°ä¸å¥½å¤„ç† excel æ–‡ä»¶ã€‚</li>
<li>ç”¨æˆ·ç‚¹å‡»ä¸‹è½½æŒ‰é’®ï¼Œåˆ™å°†æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œè½¬æ¢ä¸º excel å¹¶ä¸‹è½½åˆ°å‰ç«¯ã€‚</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> XLSX = <span class="built_in">require</span>(<span class="string">'xlsx'</span>)</span><br><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExcelUtil</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * excel è¡¨æ ¼è½¬æ¢æˆ txt æ–‡ä»¶</span></span><br><span class="line"><span class="comment">   * æ³¨æ„è¿™é‡Œä½¿ç”¨ sheet_to_csv è€Œä¸æ˜¯ sheet_to_txt</span></span><br><span class="line"><span class="comment">   * å› ä¸º sheet_to_txt æ˜¯è½¬æˆäº† utf16, åœ¨å¤´è¡Œä¼šæœ‰ bom</span></span><br><span class="line"><span class="comment">   * @param filepath</span></span><br><span class="line"><span class="comment">   * @returns &#123;*&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  transformToCSV(filepath) &#123;</span><br><span class="line">    <span class="comment">// å…ˆåˆ¤æ–­ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">    <span class="keyword">if</span>(!fs.existsSync(filepath)) &#123;</span><br><span class="line">      <span class="comment">// å¤„ç†é”™è¯¯</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å› workbook</span></span><br><span class="line">    <span class="keyword">const</span> wb = XLSX.readFile(filepath)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å› worksheet</span></span><br><span class="line">    <span class="keyword">const</span> ws = wb.Sheets[wb.SheetNames[<span class="number">0</span>]]</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è½¬æ¢ worksheet åˆ° csv æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">let</span> data = XLSX.utils.sheet_to_csv(ws)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å¾—æ–‡ä»¶åï¼ŒåŒºåˆ«ä¸ç”¨æˆ·ä¸Šä¼ çš„ excel æ–‡ä»¶ï¼Œè¿™é‡Œå¢åŠ  _txt</span></span><br><span class="line">    <span class="keyword">let</span> filename = <span class="string">`<span class="subst">$&#123;filepath&#125;</span>_txt`</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å†™å…¥æ–‡ä»¶,è‹¥å†™å…¥å¤±è´¥ï¼Œåˆ™ä¸èƒ½å¤ŸåŒæ­¥åå°å‘å¸ƒä»»åŠ¡</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      fs.writeFileSync(filename, data)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="comment">// å¤„ç†é”™è¯¯å¦‚è¿”å›é”™è¯¯çš„é”™è¯¯ç ä¹‹ç±»çš„</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å†™å…¥æˆåŠŸï¼Œè¿”å›å‰ç«¯</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      ret: <span class="number">0</span>,</span><br><span class="line">      filename: path.basename(filename)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å°†æ•°æ®è½¬æ¢ä¸º Excel è¡¨æ ¼</span></span><br><span class="line"><span class="comment">   * @param sheetData è¡¨æ•°æ®</span></span><br><span class="line"><span class="comment">   * @param sheetHeader è¡¨å¤´</span></span><br><span class="line"><span class="comment">   * @param filename æ–‡ä»¶åç§°</span></span><br><span class="line"><span class="comment">   * @param sheetName è¡¨åç§°</span></span><br><span class="line"><span class="comment">   * @param wscols åˆ—æ ·å¼</span></span><br><span class="line"><span class="comment">   * @returns &#123;any&#125;</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  transformToExcel(sheetData, sheetHeader, filename, sheetName, wscols) &#123;</span><br><span class="line">    <span class="comment">// æ·»åŠ è¡¨å¤´</span></span><br><span class="line">    sheetData.unshift(sheetHeader)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> wb = XLSX.utils.book_new()</span><br><span class="line">    <span class="keyword">let</span> ws = XLSX.utils.json_to_sheet(sheetData, &#123;</span><br><span class="line">      header: <span class="built_in">Object</span>.keys(sheetHeader),</span><br><span class="line">      skipHeader: <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®åˆ—æ ·å¼</span></span><br><span class="line">    <span class="keyword">if</span> (wscols) &#123;</span><br><span class="line">      ws[<span class="string">'!cols'</span>] = wscols</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    XLSX.utils.book_append_sheet(wb, ws, sheetName)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> XLSX.write(wb, &#123;</span><br><span class="line">      bookType: filename.split(<span class="string">'.'</span>).pop(),</span><br><span class="line">      bookSST: <span class="literal">false</span>,</span><br><span class="line">      type: <span class="string">'buffer'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * åˆ é™¤æŸä¸€è¡Œ</span></span><br><span class="line"><span class="comment">   * @param ws</span></span><br><span class="line"><span class="comment">   * @param row_index</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  deleteRow(ws, row_index) &#123;</span><br><span class="line">    <span class="keyword">const</span> ec = <span class="function">(<span class="params">r, c</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> XLSX.utils.encode_cell(&#123;<span class="attr">r</span>: r, <span class="attr">c</span>: c&#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> range = XLSX.utils.decode_range(ws[<span class="string">"!ref"</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> R = row_index; R &lt; range.e.r; ++R) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> C = range.s.c; C &lt;= range.e.c; ++C) &#123;</span><br><span class="line">        ws[ec(R, C)] = ws[ec(R + <span class="number">1</span>, C)]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    range.e.r--</span><br><span class="line"></span><br><span class="line">    ws[<span class="string">'!ref'</span>] = XLSX.utils.encode_range(range.s, range.e)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = ExcelUtil</span><br></pre></td></tr></table></figure>
<p><code>transformToExcel</code>è°ƒç”¨æ–¹å¼ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> sheetName = <span class="string">'è¡¨å'</span></span><br><span class="line"><span class="keyword">let</span> filename = <span class="string">`<span class="subst">$&#123;+<span class="keyword">new</span> <span class="built_in">Date</span>()&#125;</span>.xlsx`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sheetHeader = &#123;</span><br><span class="line">  ID: <span class="string">'ID'</span>,</span><br><span class="line">  Name: <span class="string">'å§“å'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™é‡Œç”¨æ¥å¡«å……æ•°æ®</span></span><br><span class="line"><span class="keyword">let</span> sheetData = <span class="keyword">await</span> ctx.models.DBUser.findAll(&#123;</span><br><span class="line">  where : &#123;</span><br><span class="line">   xxx : xxx</span><br><span class="line">  &#125;,</span><br><span class="line">  raw: <span class="literal">true</span>,</span><br><span class="line">  attributes: [<span class="string">'ID'</span>, <span class="string">'Name'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> excelUtil = <span class="keyword">new</span> ExcelUtil()</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®è¡¨å®½åº¦</span></span><br><span class="line"><span class="keyword">let</span> wscols = [</span><br><span class="line">  &#123;<span class="attr">wch</span>: <span class="number">28</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">wch</span>: <span class="number">20</span>&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> data = excelUtil.transformToExcel(sheetData, sheetHeader, filename, sheetName, wscols)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½® header å¤´ä¿¡æ¯ ï¼ŒgetAttachHeader çœç•¥</span></span><br><span class="line">ctx.set(&#123;</span><br><span class="line">  <span class="string">'Content-disposition'</span>: getAttachHeader(ctx, filename),</span><br><span class="line">  <span class="string">'Content-type'</span>: <span class="string">'application/octet-stream'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›ç»™å‰ç«¯ç›¸åº”çš„å†…å®¹</span></span><br><span class="line">ctx.body = data</span><br></pre></td></tr></table></figure></p>
<p>æ³¨æ„è¦ç»“åˆå‰ç«¯ä»£ç æ¥ä¸€èµ·ä¸‹è½½ã€‚å¦‚ä¸‹ï¼Œè¿™æ ·ç”¨æˆ·ç‚¹å‡»ä¸‹è½½çš„æ—¶å€™ï¼Œå°±å®Œæˆäº†ä»æ•°æ®åº“åˆ° excel çš„è¿‡ç§°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> iframe = <span class="built_in">document</span>.createElement(<span class="string">'iframe'</span>)</span><br><span class="line"></span><br><span class="line">iframe.style.display = <span class="string">'none'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼ å…¥Nodejså±‚çš„æ¥å£</span></span><br><span class="line">iframe.src = url</span><br><span class="line"></span><br><span class="line">iframe.onload = iframe.onerror = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line"><span class="built_in">document</span>.body.removeChild(iframe)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body.appendChild(iframe)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="è·å¾—æ–‡ä»¶-MD5"><a href="#è·å¾—æ–‡ä»¶-MD5" class="headerlink" title="è·å¾—æ–‡ä»¶ MD5"></a>è·å¾—æ–‡ä»¶ MD5</h2><p>ç›®çš„æ˜¯é˜²æ­¢æ–‡ä»¶è¢«ç¯¡æ”¹ï¼Œä¸»è¦æ˜¯ä½¿ç”¨ crypto åº“ã€‚ä¼ å…¥æ–‡ä»¶çš„ bufferã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* è·å¾—æ–‡ä»¶çš„ MD5, é˜²æ­¢æ–‡ä»¶è¢«ç¯¡æ”¹</span></span><br><span class="line"><span class="comment">* @param filename</span></span><br><span class="line"><span class="comment">* @returns &#123;string&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> genMd5 = <span class="function"><span class="params">filename</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> buffer</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      buffer = fs.readFileSync(filename)</span><br><span class="line">    &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">''</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> fsHash = crypto.createHash(<span class="string">'md5'</span>)</span><br><span class="line">    </span><br><span class="line">    fsHash.update(buffer)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> fsHash.digest(<span class="string">'hex'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="sequelize-çš„-transaction"><a href="#sequelize-çš„-transaction" class="headerlink" title="sequelize çš„ transaction"></a>sequelize çš„ transaction</h2><p><img src="transaction.png" alt="transaction"></p>
<p>sequelize çš„äº‹åŠ¡ä¸»è¦æœ‰ä¸Šé¢ä¸¤ç§æ–¹å¼ï¼Œä¸€ä¸ªæ˜¯è‡ªè¡Œå›æ»šçš„å†™æ³•ï¼Œå¦ä¸€ä¸ªæ˜¯æ‰‹åŠ¨å£°æ˜å›æ»šçš„å†™æ³•ã€‚æˆ‘ç”¨çš„æ˜¯è‡ªè¡Œå›æ»šçš„æ–¹æ³•ã€‚<a href="http://docs.sequelizejs.com/manual/transactions.html" target="_blank" rel="noopener">æ–‡æ¡£</a></p>
<p>è‡ªè¡Œå›æ»šçš„æ–¹æ³•ï¼Œéœ€è¦åœ¨å¼€å§‹å‘<code>sequelize.transaction</code>ä¼ å…¥ä¸€ä¸ª callbackã€‚è¿™ç§æ—¶å€™ï¼Œä¸éœ€è¦å†å»è¿›è¡Œ<code>t.commit()</code> or <code>t.rollback()</code>äº†ã€‚å½“åˆ° catch å†…æ—¶ï¼Œä¼šè‡ªè¡Œå›æ»šã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> sequelize.transaction(<span class="function"><span class="params">t</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// chain all your queries here. make sure you return them.</span></span><br><span class="line">  <span class="keyword">return</span> User.create(&#123;</span><br><span class="line">    firstName: <span class="string">'Abraham'</span>,</span><br><span class="line">    lastName: <span class="string">'Lincoln'</span></span><br><span class="line">  &#125;, &#123;<span class="attr">transaction</span>: t&#125;).then(<span class="function"><span class="params">user</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> user.setShooter(&#123;</span><br><span class="line">      firstName: <span class="string">'John'</span>,</span><br><span class="line">      lastName: <span class="string">'Boothe'</span></span><br><span class="line">    &#125;, &#123;<span class="attr">transaction</span>: t&#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;).then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Transaction has been committed</span></span><br><span class="line">  <span class="comment">// result is whatever the result of the promise chain returned to the transaction callback</span></span><br><span class="line">&#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Transaction has been rolled back</span></span><br><span class="line">  <span class="comment">// err is whatever rejected the promise chain returned to the transaction callback</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ æ˜¯ç”¨çš„ <code>async await</code> ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">await</span> sequelize.transaction(<span class="keyword">async</span> transaction =&gt; &#123;</span><br><span class="line">    <span class="comment">// step 1</span></span><br><span class="line">    <span class="keyword">await</span> Model.destroy(&#123;<span class="attr">where</span>: &#123;id&#125;, transaction&#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// step 2</span></span><br><span class="line">    <span class="keyword">await</span> Model.create(&#123;&#125;, &#123;transaction&#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">  <span class="comment">// è‹¥ä¸Šé¢æ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œåˆ™ä¼šåˆ° catch ä¸­ï¼Œå¹¶ä¸”ä¼šè‡ªåŠ¨å›æ»š</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœä¸æƒ³ä½¿ç”¨è‡ªåŠ¨å›æ»šçš„è¿™ç§æ–¹æ³•ï¼Œåˆ™ä¸å‘<code>sequelize.transaction()</code>ä¸ä¼ å…¥ä¸€ä¸ª callbackã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> sequelize.transaction().then(<span class="function"><span class="params">t</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> User.create(&#123;</span><br><span class="line">    firstName: <span class="string">'Bart'</span>,</span><br><span class="line">    lastName: <span class="string">'Simpson'</span></span><br><span class="line">  &#125;, &#123;<span class="attr">transaction</span>: t&#125;).then(<span class="function"><span class="params">user</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> user.addSibling(&#123;</span><br><span class="line">      firstName: <span class="string">'Lisa'</span>,</span><br><span class="line">      lastName: <span class="string">'Simpson'</span></span><br><span class="line">    &#125;, &#123;<span class="attr">transaction</span>: t&#125;);</span><br><span class="line">  &#125;).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> t.commit();</span><br><span class="line">  &#125;).catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> t.rollback();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœä½¿ç”¨ <code>async await</code> åˆ™ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> transaction;    </span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// get transaction</span></span><br><span class="line">  transaction = <span class="keyword">await</span> sequelize.transaction();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// step 1</span></span><br><span class="line">  <span class="keyword">await</span> Model.destroy(&#123;<span class="attr">where</span>: &#123;id&#125;, transaction&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// step 2</span></span><br><span class="line">  <span class="keyword">await</span> Model.create(&#123;&#125;, &#123;transaction&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// commit</span></span><br><span class="line">  <span class="keyword">await</span> transaction.commit();</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">  <span class="comment">// Rollback transaction if any errors were encountered</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">await</span> transaction.rollback();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¾ˆå¥½ç”¨~</p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>5æœˆå°±åšäº†ä¸€ä¸ªé¡¹ç›®ï¼Œä¸»è¦æ˜¯ä¸šåŠ¡é€»è¾‘å¤ªå¤æ‚äº†ï¼Œå¯¹æ•°æ®åº“é‡Œçš„ä¸€ä¸ªå­—æ®µéƒ½è¦æ ¡éªŒå‡ ç™¾è¡Œä»£ç ã€‚</p>
<p>5æœˆå»å°æ¹¾å›¢å»ºï¼Œä½“éªŒä¸€èˆ¬èˆ¬ï¼Œä½†ä¹Ÿç®—æ˜¯èµ°å‡ºå»çœ‹çœ‹äº†ã€‚</p>
<p>è½¬çœ¼é—´19å¹´éƒ½å¿«è¿‡å»ä¸€åŠäº†ã€‚åŠ æ²¹â›½ï¸!</p>
<p>å‰©ä¸‹çš„å‡ å¤©æŠŠé¡¹ç›®åˆ†æ”¯å†éƒ½éªŒè¯ä¸‹ï¼Œå†™æµ‹è¯•ç”¨ä¾‹ï¼Œä¼˜åŒ–ä¸‹ä»£ç ï¼Œç„¶åå†æ€»ç»“ä¸‹å‡ ä¸ªé—®é¢˜ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½ ä»Šå¹´30å² é‚£ä¹ˆå¦‚æœä½ åˆ©ç”¨ä¸šåŠ¡æ—¶é—´å­¦è‹±è¯­ é‚£ä¹ˆ5å¹´ä¹Ÿå°±æ˜¯ä½ 35å²æ—¶ ä½ å¯èƒ½å°±å¯ä»¥æˆä¸ºä¸€ä¸ªè¯´è‹±æ–‡å¾ˆæµåˆ©çš„äººğŸŒ¹&lt;/p&gt;
&lt;p&gt;æ°¸è¿œä¸è¦è¢«æ—¶é—´é™åˆ¶ä½è‡ªå·± å°½ä½ è‡ªå·±æœ€å¤§çš„åŠªåŠ› åŠªåŠ›åšæˆä½ æœ€æƒ³åšçš„é‚£ä»¶äº‹ æˆä¸ºä½ æœ€æƒ³æˆä¸ºçš„é‚£ç§äºº è¿‡ç€ä½ æœ€æƒ³è¿‡çš„é‚£ç§ç”Ÿæ´» ï¿½
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>webpack4è¯»ä¹¦ç¬”è®°(ä¸‰)</title>
    <link href="http://sevencai.github.io/2019/05/26/webpack4%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E4%B8%89/"/>
    <id>http://sevencai.github.io/2019/05/26/webpack4è¯»ä¹¦ç¬”è®°-ä¸‰/</id>
    <published>2019-05-26T04:57:36.000Z</published>
    <updated>2019-05-29T11:10:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡æ–‡ç« ä¸»è¦è®°å½• webpack çš„ä»£ç åˆ†ç¦»çš„å‡ ç§æ–¹å¼ï¼Œç”±æ­¤å†å»ç†è§£é€šè¿‡<strong>ä»£ç åˆ†ç¦»</strong>å¯ä»¥åšå“ªäº›å‰ç«¯ä¼˜åŒ–ï¼šå¦‚æ‡’åŠ è½½å’Œé¢„å…ˆåŠ è½½ã€‚ä¹‹åå†ä»‹ç»äº†å‡ ä¸ªæ˜“æ··æ·†çš„æ¦‚å¿µã€‚ğŸ“š</p>
<hr>
<h1 id="webpack-ä»£ç åˆ†ç¦»ğŸŒ²"><a href="#webpack-ä»£ç åˆ†ç¦»ğŸŒ²" class="headerlink" title="webpack ä»£ç åˆ†ç¦»ğŸŒ²"></a>webpack ä»£ç åˆ†ç¦»ğŸŒ²</h1><p>webpack ä»£ç åˆ†ç¦»å¯ä»¥æœ‰ä»¥ä¸‹è¿™å‡ ç§æ–¹å¼ï¼š</p>
<h2 id="1-å…¥å£èµ·ç‚¹-entry-points"><a href="#1-å…¥å£èµ·ç‚¹-entry-points" class="headerlink" title="1. å…¥å£èµ·ç‚¹(entry points)"></a>1. å…¥å£èµ·ç‚¹(entry points)</h2><p>è¿™ç§æ˜¯åœ¨å…¥å£æ–‡ä»¶å†…é…ç½®å¤šä¸ª entry,è‡ªç„¶å¯ä»¥ç”Ÿæˆå¤šä¸ªæ–‡ä»¶ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    index: <span class="string">'./src/index.js'</span>,</span><br><span class="line">    <span class="comment">// è®¾ç½®çš„å…¶ä»–å…¥å£</span></span><br><span class="line">    another: <span class="string">'./src/another-module.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'[name].bundle.js'</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="2-ä½¿ç”¨-SplitChunksPlugin-æ’ä»¶"><a href="#2-ä½¿ç”¨-SplitChunksPlugin-æ’ä»¶" class="headerlink" title="2. ä½¿ç”¨ SplitChunksPlugin æ’ä»¶"></a>2. ä½¿ç”¨ <code>SplitChunksPlugin æ’ä»¶</code></h2><p>å®ƒå¯ä»¥å°†å…¬å…±çš„ä¾èµ–æ¨¡å—æå–åˆ°å·²æœ‰çš„ entry chunk ä¸­ï¼Œæˆ–è€…æå–åˆ°ä¸€ä¸ªæ–°ç”Ÿæˆçš„ chunk<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  optimization: &#123;</span><br><span class="line">    <span class="comment">// splitChunks: &#123;</span></span><br><span class="line">       <span class="comment">// è¡¨æ˜å¯¹åŒæ­¥ä»£ç å’Œå¼‚æ­¥ä»£ç éƒ½åšä»£ç åˆ†å‰²</span></span><br><span class="line">       <span class="comment">//chunks: 'all'</span></span><br><span class="line">    <span class="comment">// &#125;,</span></span><br><span class="line">    splitChunks: &#123;</span><br><span class="line">      chunks: <span class="string">'async'</span>,</span><br><span class="line">      minSize: <span class="number">30000</span>,</span><br><span class="line">      maxSize: <span class="number">0</span>,</span><br><span class="line">      minChunks: <span class="number">1</span>,</span><br><span class="line">      maxAsyncRequests: <span class="number">5</span>,</span><br><span class="line">      maxInitialRequests: <span class="number">3</span>,</span><br><span class="line">      automaticNameDelimiter: <span class="string">'~'</span>,</span><br><span class="line">      name: <span class="literal">true</span>,</span><br><span class="line">      cacheGroups: &#123;</span><br><span class="line">        vendors: &#123;</span><br><span class="line">          test: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">          priority: <span class="number">-10</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="keyword">default</span>: &#123;</span><br><span class="line">          minChunks: <span class="number">2</span>,</span><br><span class="line">          priority: <span class="number">-20</span>,</span><br><span class="line">          reuseExistingChunk: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="3-ä½¿ç”¨åŠ¨æ€å¯¼å…¥æ–¹æ³•"><a href="#3-ä½¿ç”¨åŠ¨æ€å¯¼å…¥æ–¹æ³•" class="headerlink" title="3. ä½¿ç”¨åŠ¨æ€å¯¼å…¥æ–¹æ³•"></a>3. ä½¿ç”¨åŠ¨æ€å¯¼å…¥æ–¹æ³•</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: 'loadash'*/</span> <span class="string">'lodash'</span>)</span><br><span class="line">  .then(<span class="function">(<span class="params">&#123;defalut: _&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> dom = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>)</span><br><span class="line">    </span><br><span class="line">    dom.innerText = _.join([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="string">'+'</span>)</span><br><span class="line">    <span class="keyword">return</span> dom</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…ç”¨ async await</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; <span class="attr">default</span>: _ &#125; = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: 'lodash'*/</span> <span class="string">'lodash'</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> dom = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>)</span><br><span class="line">  </span><br><span class="line">  dom.innerText = _.join([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="string">'+'</span>)</span><br><span class="line">  <span class="keyword">return</span> dom</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç„¶åå†è¿›è¡Œè°ƒç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">renderComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  getComponent().then(<span class="function"><span class="params">ele</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.body.apendChild(ele)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™æ ·ï¼Œå°±åªæœ‰åœ¨è°ƒç”¨ renderComponent æ—¶ï¼Œæ‰ä¼šå»åŠ è½½lodashè¿™ä¸ªæ¨¡å—ï¼Œå¹¶ä¸”lodashæ¨¡å—ä¼šå•ç‹¬è¢«æ‹†åˆ†å‡ºæ¥</span></span><br><span class="line">renderComponent()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>import() è°ƒç”¨ä¼šåœ¨å†…éƒ¨ç”¨åˆ° promisesã€‚å¦‚æœåœ¨æ—§ç‰ˆæœ¬æµè§ˆå™¨ä¸­ä½¿ç”¨ import()ï¼Œè®°å¾—ä½¿ç”¨ä¸€ä¸ª polyfill åº“ï¼ˆä¾‹å¦‚ es6-promise æˆ– promise-polyfillï¼‰ï¼Œæ¥ shim Promiseã€‚</p>
</blockquote>
<p><strong>å…¶å®è¿™é‡Œçš„<code>åŠ¨æ€å¯¼å…¥(dynamic imports)</code>æ—¢æ˜¯ä»£ç åˆ†å‰²çš„ä¸€ç§æ–¹æ³•ï¼Œä¹Ÿæ˜¯ä¸€ç§æ‡’åŠ è½½çš„æ–¹æ³•ã€‚</strong>åœ¨ä¸‹é¢ä»”ç»†è®²ã€‚</p>
<h2 id="4-é¢„å–-é¢„åŠ è½½æ¨¡å—-prefetch-preload-module"><a href="#4-é¢„å–-é¢„åŠ è½½æ¨¡å—-prefetch-preload-module" class="headerlink" title="4. é¢„å–/é¢„åŠ è½½æ¨¡å—(prefetch/preload module)"></a>4. é¢„å–/é¢„åŠ è½½æ¨¡å—(prefetch/preload module)</h2><p>è¿™ä¸ªä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œä»£ç åˆ†ç¦»çš„ä¸€ç§æ–¹æ³•ï¼Œå®ƒå¯ä»¥ä½¿ç”¨ç±»ä¼¼ä¸‹é¢è¿™ç§è¯­æ³•ï¼Œç”Ÿæˆ link tag  å¹¶è¿½åŠ åˆ°é¡µé¢å¤´éƒ¨ï¼ŒæŒ‡ç¤ºç€æµè§ˆå™¨åœ¨é—²ç½®æ—¶é—´é¢„å– <code>login-modal-chunk.js</code> æ–‡ä»¶ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;link rel="prefetch" href="login-modal-chunk.js"&gt;</span></span><br><span class="line"><span class="keyword">import</span>(<span class="comment">/* webpackPrefetch: true */</span> <span class="string">'LoginModal'</span>);</span><br></pre></td></tr></table></figure></p>
<p>è¿™æ ·å°±ä¼šç”Ÿæˆäº†ä¸€ä¸ª<code>login-modal-chunk.js</code>çš„jsæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯åˆ†ç¦»äº†ä»£ç ã€‚è¿™ç§æ–¹æ³•æ­£å¥½å’Œæ‡’åŠ è½½ç›¸åã€‚ä¸‹é¢ä¼šå†è¿›è¡Œè§£é‡Šã€‚</p>
<hr>
<h1 id="lazy-loadingğŸŒ¶"><a href="#lazy-loadingğŸŒ¶" class="headerlink" title="lazy loadingğŸŒ¶"></a>lazy loadingğŸŒ¶</h1><p>ä¸Šé¢æåˆ°äº†åŠ¨æ€åŠ è½½æ˜¯ä»£ç åˆ†å‰²çš„æ–¹æ³•ï¼Œè¿™ä¹Ÿé¡ºä¾¿å®ç°äº†æ‡’åŠ è½½çš„æ–¹æ³•ã€‚ä¸‹é¢æ€»ç»“ä¸‹å®é™…å·¥ç¨‹ä¸­ï¼Œä¸€èˆ¬æˆ‘ä»¬æ€ä¹ˆä½¿ç”¨å®ƒè¿›è¡Œä»£ç ä¼˜åŒ–ã€‚</p>
<blockquote>
<p>æ‡’åŠ è½½æˆ–è€…æŒ‰éœ€åŠ è½½ï¼Œæ˜¯ä¸€ç§å¾ˆå¥½çš„ä¼˜åŒ–ç½‘é¡µæˆ–åº”ç”¨çš„æ–¹å¼ã€‚è¿™ç§æ–¹å¼å®é™…ä¸Šæ˜¯å…ˆæŠŠä½ çš„ä»£ç åœ¨ä¸€äº›é€»è¾‘æ–­ç‚¹å¤„åˆ†ç¦»å¼€ï¼Œç„¶ååœ¨ä¸€äº›ä»£ç å—ä¸­å®ŒæˆæŸäº›æ“ä½œåï¼Œç«‹å³å¼•ç”¨æˆ–å³å°†å¼•ç”¨å¦å¤–ä¸€äº›æ–°çš„ä»£ç å—ã€‚è¿™æ ·åŠ å¿«äº†åº”ç”¨çš„åˆå§‹åŠ è½½é€Ÿåº¦ï¼Œå‡è½»äº†å®ƒçš„æ€»ä½“ä½“ç§¯ï¼Œå› ä¸ºæŸäº›ä»£ç å—å¯èƒ½æ°¸è¿œä¸ä¼šè¢«åŠ è½½ã€‚</p>
</blockquote>
<p>æ³¨æ„<strong>æ‡’åŠ è½½å¹¶ä¸æ˜¯ webpack çš„æ¦‚å¿µï¼Œè€Œæ˜¯ es6 çš„æ¦‚å¿µï¼Œ webpackåªæ˜¯è¯†åˆ«äº†<code>/* webpackChunkName: &#39;lodash&#39;*/</code>è¿™ç§è¯­æ³•</strong>ã€‚âŒè¿™é‡Œå¾ˆå®¹æ˜“è¯¯ä»¥ä¸ºã€‚</p>
<p>åœ¨ es6 è¯­æ³•é‡Œæœ‰ä¸€ç§<code>import()</code>çš„<a href="https://github.com/tc39/proposal-dynamic-import" target="_blank" rel="noopener">ææ¡ˆ</a>ï¼Œè¿™ä¸ªå‡½æ•°è§£å†³äº† import å‘½ä»¤æœ¬èº«ä¸èƒ½åŠ¨æ€åŠ è½½æ¨¡å—çš„åŠ£åŠ¿ï¼Œè€Œåœ¨è¿™å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨ require æ˜¯å¾ˆå¥½åšåˆ°è¿™ä¸€ç‚¹çš„ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> file = env === <span class="string">'production'</span> ? <span class="string">`prod_<span class="subst">$&#123;filename&#125;</span>`</span> : <span class="string">`sandbox_<span class="subst">$&#123;filename&#125;</span>`</span></span><br><span class="line"><span class="keyword">const</span> myModual = <span class="built_in">require</span>(file)</span><br></pre></td></tr></table></figure>
<p>import å‘½ä»¤ä¼šè¢« JavaScript å¼•æ“<strong>é™æ€åˆ†æï¼Œå…ˆäºæ¨¡å—å†…çš„å…¶ä»–è¯­å¥æ‰§è¡Œ</strong>ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Wrong: import ä¼šè¢«æåˆ°æœ€ä¸Šé¢ï¼Œfileå°†ä¸è¢«è¯†åˆ«</span></span><br><span class="line"><span class="keyword">const</span> file = env === <span class="string">'production'</span> ? <span class="string">`prod_<span class="subst">$&#123;filename&#125;</span>`</span> : <span class="string">`sandbox_<span class="subst">$&#123;filename&#125;</span>`</span></span><br><span class="line"><span class="keyword">import</span> myModule <span class="keyword">from</span> file</span><br><span class="line"></span><br><span class="line"><span class="comment">// Wrong: import æ˜¯é™æ€æ‰§è¡Œï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨è¡¨è¾¾å¼å’Œå˜é‡ï¼Œè¿™äº›åªæœ‰åœ¨è¿è¡Œæ—¶æ‰èƒ½å¾—åˆ°ç»“æœçš„è¯­æ³•ç»“æ„ã€‚</span></span><br><span class="line"><span class="keyword">if</span> (env === <span class="string">'production'</span>) &#123;</span><br><span class="line">  <span class="keyword">import</span> myModule <span class="keyword">from</span> <span class="string">'prodFile'</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">import</span> myModule <span class="keyword">from</span> <span class="string">'sandboxFile'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å› æ­¤å‡ºç°äº† <code>import()</code>å‡½æ•°, <code>import()</code>å‡½æ•°çš„ç‰¹æ€§ï¼Œå¯ä»¥å®ç°ï¼š</p>
<ol>
<li>æŒ‰éœ€åŠ è½½ã€‚ä¹Ÿå°±æ˜¯æ‡’åŠ è½½ã€‚</li>
<li>æ¡ä»¶åŠ è½½ï¼Œè§£å†³äº† import å‘½ä»¤ä¸èƒ½ä½¿ç”¨æ¡ä»¶çš„é—®é¢˜ã€‚</li>
<li>åŠ¨æ€çš„æ¨¡å—è·¯å¾„ï¼Œè·¯å¾„å¯ä»¥ä½¿ç”¨å˜é‡ã€‚è§£å†³äº† import å‘½ä»¤é™æ€ç¼–è¯‘ä¸èƒ½ä½¿ç”¨åŠ¨æ€è·¯å¾„çš„é—®é¢˜ã€‚</li>
</ol>
<p>æ³¨æ„å«æ³•çš„åŒºåˆ«:ä¸€ä¸ªæ˜¯<code>importå‘½ä»¤</code>ï¼Œä¸€ä¸ªæ˜¯<code>importå‡½æ•°</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// import()åŠ è½½æ¨¡å—æˆåŠŸä»¥åï¼Œè¿™ä¸ªæ¨¡å—ä¼šä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå½“ä½œthenæ–¹æ³•çš„å‚æ•°ã€‚</span></span><br><span class="line"><span class="keyword">import</span>(<span class="built_in">module</span>).then().catch()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ä»¥ä½¿ç”¨å¯¹è±¡è§£æ„èµ‹å€¼çš„è¯­æ³•ï¼Œè·å–è¾“å‡ºæ¥å£</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: 'loadash'*/</span> <span class="string">'lodash'</span>)</span><br><span class="line">  .then(<span class="function">(<span class="params">&#123;defalut: _&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> dom = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>)</span><br><span class="line">    </span><br><span class="line">    dom.innerText = _.join([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="string">'+'</span>)</span><br><span class="line">    <span class="keyword">return</span> dom</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç‚¹å‡»æ—¶æ‰å»å¼€å§‹æ‰§è¡ŒåŠ è½½æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> main = <span class="built_in">document</span>.querySelector(<span class="string">"main"</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> link <span class="keyword">of</span> <span class="built_in">document</span>.querySelectorAll(<span class="string">"nav &gt; a"</span>)) &#123;</span><br><span class="line">    link.addEventListener(<span class="string">"click"</span>, e =&gt; &#123;</span><br><span class="line">      e.preventDefault();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">import</span>(<span class="string">`./section-modules/<span class="subst">$&#123;link.dataset.entryModule&#125;</span>.js`</span>)</span><br><span class="line">        .then(<span class="function"><span class="params">module</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">module</span>.loadPageInto(main);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">          main.textContent = err.message;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>ä¹‹æ‰€ä»¥è¿™é‡Œè§£æ„æ—¶æ˜¯ï¼š<code>{default: _}</code>ï¼Œæ˜¯å› ä¸ºä» webpack v4 å¼€å§‹ï¼Œåœ¨ import CommonJS æ¨¡å—æ—¶ï¼Œä¸ä¼šå†å°†å¯¼å…¥æ¨¡å—è§£æä¸º module.exports çš„å€¼ï¼Œè€Œæ˜¯ä¸º CommonJS æ¨¡å—åˆ›å»ºä¸€ä¸ª artificial namespace object(äººå·¥å‘½åç©ºé—´å¯¹è±¡)ï¼Œæˆ‘è®°å¾—æˆ‘ä¹‹å‰é‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯å¿˜è®°å“ªä¸ªæ–‡ç« é‡Œä¸“é—¨å†™äº†ï¼Œè¿™é‡Œè´´ä¸€ç¯‡å¾ˆå¥½çš„æ–‡ç« ï¼š<a href="https://medium.com/webpack/webpack-4-import-and-commonjs-d619d626b655" target="_blank" rel="noopener">webpack-4-import-and-commonjs</a></p>
<p>ä½†æ˜¯æ›´ä¸ºå¸¸è§çš„ä¸€ç§æ‡’åŠ è½½çš„æ–¹æ³•ï¼Œæ˜¯åœ¨ vue ä¸­ï¼Œ<strong>ç»“åˆ vue-router å®ç°çš„è·¯ç”±æ‡’åŠ è½½ã€‚è¿™ç§æ–¹æ³•èƒ½æŠŠä¸åŒè·¯ç”±å¯¹åº”çš„ç»„ä»¶åˆ†å‰²æˆä¸åŒçš„ä»£ç å—ï¼Œç„¶åå½“è·¯ç”±è¢«è®¿é—®çš„æ—¶å€™æ‰åŠ è½½å¯¹åº”ç»„ä»¶</strong>ã€‚</p>
<p>ä½¿ç”¨æ–¹å¼ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Foo = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'./Foo.vue'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">'/foo'</span>, <span class="attr">component</span>: Foo &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿™ä¸ªæ—¶å€™ï¼Œè¿˜å¯ä»¥ç»“åˆ webpack çš„è¯­æ³•ï¼Œè¿›è¡Œä»£ç åˆ†å‰²ï¼ŒæŠŠæŠŠæŸä¸ªè·¯ç”±ä¸‹çš„æ‰€æœ‰ç»„ä»¶éƒ½æ‰“åŒ…åœ¨åŒä¸ªå¼‚æ­¥å— (chunk) ä¸­å¦‚:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Foo = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: "foo" */</span> <span class="string">'./Foo.vue'</span>)</span><br><span class="line"><span class="keyword">const</span> Foo1 = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: "foo" */</span> <span class="string">'./Foo1.vue'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Bar = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: "bar" */</span> <span class="string">'./Bar.vue'</span>)</span><br></pre></td></tr></table></figure></p>
<p>è¿™æ · Foo å’Œ Foo1 å°†ä¼šåœ¨ä¸€ä¸ª chunk å†…ï¼Œ bar åˆä¼šåœ¨ä¸€ä¸ª chunk å†…ã€‚</p>
<p>è¿™é‡Œæ³¨æ„ä¸‹ï¼š<strong>dist å†…ç”Ÿæˆçš„æ¯ä¸€ä¸ª js æ–‡ä»¶å°±æ˜¯ä¸€ä¸ª chunk,è€Œ minChunks å°±è¡¨æ˜äº†ä»€ä¹ˆæƒ…å†µä¸‹è¿›è¡Œä»£ç åˆ†å‰²ï¼Œè‹¥ minChunks = 2, åˆ™æ„å‘³ç€ç”Ÿæˆçš„ chunk js æ–‡ä»¶é‡Œï¼Œæœ‰å¤šå°‘ä¸ªç”¨åˆ°äº†è¿™ä¸ªæ¨¡å—ï¼Œå¦‚æœæœ‰çš„è¯æ‰è¿›è¡Œä»£ç åˆ†å‰²ã€‚</strong></p>
<hr>
<h1 id="é¢„å–-é¢„åŠ è½½æ¨¡å—-prefetch-preload-module-ğŸ¡"><a href="#é¢„å–-é¢„åŠ è½½æ¨¡å—-prefetch-preload-module-ğŸ¡" class="headerlink" title="é¢„å–/é¢„åŠ è½½æ¨¡å—(prefetch/preload module)ğŸ¡"></a>é¢„å–/é¢„åŠ è½½æ¨¡å—(prefetch/preload module)ğŸ¡</h1><p>ä½¿ç”¨ä¸Šé¢çš„ Lazy loading ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å®ƒåªèƒ½åœ¨æ‰§è¡ŒæŸä¸ªåŠ¨ä½œçš„æ—¶å€™ï¼Œæ‰ä¼šå»åŠ è½½ã€‚æ¯”å¦‚ç”¨æˆ·ç‚¹å‡»äº†ç™»å½•æ¡†ï¼Œè¿™ä¸ªæ—¶å€™å¼€å§‹ä¸‹è½½jså¹¶å¼€å§‹è§£ææ‰§è¡Œã€‚</p>
<p>å®é™…ä¸Šè¿™æ ·å¯¹ç”¨æˆ·æ¥è¯´è¿˜æ˜¯æœ‰ç­‰å¾…çš„ä¸€ä¸ªè¿‡ç¨‹çš„ã€‚ä½†æ˜¯åˆ©ç”¨ <code>prefetch/preload module</code> å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç©ºé—²æ—¶å»æå‰åŠ è½½äº†ä»£ç ã€‚ç”¨æˆ·ç‚¹å‡»æ—¶å·²æœ‰ç¼“å­˜ï¼Œç›´æ¥å»è§£ææ‰§è¡Œä»£ç å³å¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> ele = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>)</span><br><span class="line">  ele.innerText = <span class="string">'hello seven'</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(ele)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">'click'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">import</span>(<span class="comment">/* webpackPrefetch: true */</span> <span class="string">'./2.js'</span>)</span><br><span class="line">      .then(<span class="function">(<span class="params">&#123;<span class="keyword">default</span>: func&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">        func()</span><br><span class="line">      &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±ä¼šå‘ç°ï¼Œåœ¨é¦–é¡µçš„è¯·æ±‚å†…ï¼Œä¹Ÿä¼šæœ‰ 2.js çš„è¯·æ±‚ï¼Œå¹¶ä¸”å®ƒçš„æ—¶é—´æ˜¯åœ¨ index.js ä¹‹åã€‚<br><img src="prefetch.png" alt="prefetch"><br>ç„¶åç‚¹å¼€è¿™ç¬”è¯·æ±‚çš„è¯¦æƒ…åï¼Œä¼šçœ‹åˆ°ç›¸å…³çš„é¢„å…ˆåŠ è½½çš„ä¿¡æ¯å¤´<code>purpose: prefetch</code>ã€‚<br><img src="header.png" alt="header"><br>æœ€åæŸ¥çœ‹domç»“æ„ï¼Œä½ ä¼šå‘ç°å¤šäº†è¿™æ ·ä¸€ä¸ªlinkæ–‡ä»¶ã€‚<br><img src="prefechlink.png" alt="prefech link"><br>preloadå’Œprefetchæœ‰è®¸å¤šåŒºåˆ«ã€‚webpackPreload ä¼šåœ¨æµè§ˆå™¨é—²ç½®ä¸‹è½½æ–‡ä»¶ï¼ŒwebpackPreload ä¼šåœ¨çˆ¶ chunk åŠ è½½æ—¶å¹¶è¡Œä¸‹è½½æ–‡ä»¶ã€‚å¯¹äº preload æˆ‘è¿˜æ²¡æœ‰è¿‡å®è·µã€‚<br><img src="diff.png" alt="diff.png"></p>
<hr>
<h1 id="å‡ ä¸ªæ˜“æ··æ·†çš„æ¦‚å¿µâŒ"><a href="#å‡ ä¸ªæ˜“æ··æ·†çš„æ¦‚å¿µâŒ" class="headerlink" title="å‡ ä¸ªæ˜“æ··æ·†çš„æ¦‚å¿µâŒ"></a>å‡ ä¸ªæ˜“æ··æ·†çš„æ¦‚å¿µâŒ</h1><h2 id="filename-ä¸-chunkFilename"><a href="#filename-ä¸-chunkFilename" class="headerlink" title="filename ä¸ chunkFilename"></a>filename ä¸ chunkFilename</h2><p>filename æ˜¯æŒ‡åœ¨ entry ä¸­å£°æ˜çš„æ–‡ä»¶ï¼Œæ‰“åŒ…è¾“å‡ºåçš„æ–‡ä»¶çš„åç§°ã€‚<br>chunkFilename æ˜¯æŒ‡æœªåœ¨ entry ä¸­å£°æ˜ï¼Œä½†æ˜¯å´ç”±äºä»£ç åˆ†ç¦»çš„åŸå› è¢«æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶çš„åç§°ã€‚</p>
<p>å¯ä»¥çœ‹åˆ° filename å¯¹åº”äºä¸Šé¢ä»£ç åˆ†ç¦»ä¸­çš„ç¬¬ä¸€ç‚¹<br>è€Œ chunkFilename å¯¹åº”äºä»£ç åˆ†ç¦»ä¸­çš„2ï¼Œ3ï¼Œ4ç‚¹</p>
<p>æ¯”å¦‚åœ¨åˆšåˆšçš„æ‡’åŠ è½½æˆ–è€…é¢„å…ˆåŠ è½½ä¸­ï¼Œæˆ‘ä»¬è¿›è¡Œäº†ä»£ç åˆ†ç¦»ã€‚åˆ†ç¦»åå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š<br><img src="chunk.png" alt="chunk"></p>
<p>è€Œæˆ‘ä»¬çš„ output é…ç½®å¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">entry: <span class="string">'./src/index'</span></span><br><span class="line"></span><br><span class="line">output: &#123;</span><br><span class="line">  path: path.resolve(__dirname, <span class="string">'./dist'</span>),</span><br><span class="line">  filename: <span class="string">"[name].min.js"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å› æ­¤å¯ä»¥çœ‹åˆ° <code>main.min.js</code> å°±æ˜¯ <code>filename</code>, è€Œ<code>0.min.js</code>å°±æ˜¯ <code>chunkFilename</code></p>
<p>æˆ‘ä»¬å¯ä»¥æ˜¾è¯•çš„æŒ‡æ˜ chunkFilename ,é‚£ä¹ˆç”Ÿæˆçš„æ–‡ä»¶åç§°å°±å«<code>0.chunk.js</code>ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'./dist'</span>),</span><br><span class="line">    filename: <span class="string">"[name].min.js"</span>,</span><br><span class="line">    chunkFilename: <span class="string">"[name].chunk.js"</span></span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure></p>
<p>å½“ç„¶å¾ˆæ˜æ˜¾ <code>chunkFilename</code> æŒ‡å®šä¸º <code>[name].chunk.js</code> å¹¶ä¸å¥½ï¼Œå› ä¸ºç”Ÿæˆçš„æ˜¯<code>0.chunk.js</code>è¿™ç§æ— å«ä¹‰æ–‡ä»¶åã€‚</p>
<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ç»“åˆåˆšåˆšçš„<code>webpackChunkName</code>è¿™ç§ <code>magic comments</code> æ¥è¿›è¡Œæ‰“åŒ…ã€‚</p>
<hr>
<h2 id="webpackChunkNameï¼ŒwebpackPreloadï¼ŒwebpackPreload"><a href="#webpackChunkNameï¼ŒwebpackPreloadï¼ŒwebpackPreload" class="headerlink" title="webpackChunkNameï¼ŒwebpackPreloadï¼ŒwebpackPreload"></a>webpackChunkNameï¼ŒwebpackPreloadï¼ŒwebpackPreload</h2><p>è¿™ä¸‰ä¸ªéƒ½æ˜¯é­”æ³•æ³¨é‡Šï¼ˆmagic commentsï¼‰,ä¸Šé¢å·²ä»‹ç»æ¸…æ¥šã€‚è¿™é‡Œåªæ€»ç»“ä¸‹è¯­æ³•å’Œç”¨é€”ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸ºé¢„åŠ è½½çš„æ–‡ä»¶å–åˆ«å</span></span><br><span class="line"><span class="keyword">import</span>(<span class="comment">/* webpackChunkName: 'loadash'*/</span> <span class="string">'lodash'</span>)</span><br><span class="line"><span class="comment">// åœ¨æµè§ˆå™¨é—²ç½®ä¸‹è½½æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">import</span>(<span class="comment">/* webpackPrefetch: true */</span> <span class="string">'./2.js'</span>)</span><br><span class="line"><span class="comment">// åœ¨çˆ¶ chunk åŠ è½½æ—¶å¹¶è¡Œä¸‹è½½æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">import</span>(<span class="comment">/* webpackPreload: true */</span> <span class="string">'./2.js'</span>)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="hash-chunkhash-contenthash"><a href="#hash-chunkhash-contenthash" class="headerlink" title="hash chunkhash contenthash"></a>hash chunkhash contenthash</h2><p><strong>hashæ˜¯è·Ÿæ•´ä¸ªé¡¹ç›®çš„æ„å»ºç›¸å…³ï¼Œåªè¦é¡¹ç›®é‡Œæœ‰æ–‡ä»¶æ›´æ”¹ï¼Œæ•´ä¸ªé¡¹ç›®æ„å»ºçš„hashå€¼éƒ½ä¼šæ›´æ”¹ï¼Œå¹¶ä¸”å…¨éƒ¨æ–‡ä»¶éƒ½å…±ç”¨ç›¸åŒçš„hashå€¼</strong>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">entry:&#123;</span><br><span class="line">    main: <span class="string">'./index.js'</span>,</span><br><span class="line">    vender:[<span class="string">'jquery'</span>,<span class="string">'lodash'</span>]</span><br><span class="line">&#125;</span><br><span class="line">output:&#123;</span><br><span class="line">    path:path.join(__dirname, <span class="string">'/dist/js'</span>),</span><br><span class="line">    filename: <span class="string">'[name].[hash].js'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œè‹¥ <code>index.js</code> æ–‡ä»¶å˜åŒ–æ—¶ï¼Œ <code>vendor</code> æœ€åç”Ÿæˆ <code>output</code> çš„æ–‡ä»¶åä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼Œéƒ½ç›¸åŒã€‚è¿™æ ·æ— æ³•åˆ©ç”¨ç¼“å­˜ï¼Œå› ä¸ºhashä¸é¡¹ç›®ç›¸å…³ï¼Œåªè¦é¡¹ç›®å˜äº†ï¼Œhashå°±ä¼šå˜ã€‚</p>
<p>è¿™é‡Œæ³¨æ„ä¸‹ï¼Œå¦‚æœæ˜¯è€ç‰ˆæœ¬çš„webpack, å³ä½¿æ˜¯ä½ æ–‡ä»¶éƒ½æ²¡æœ‰æ›´æ”¹ï¼Œåªæ˜¯é‡æ–°æ„å»ºäº†ï¼Œä¹Ÿæœ‰å¯èƒ½å¯¼è‡´ hash çš„å€¼ä¸ä¸€æ ·ã€‚è¿™æ˜¯å› ä¸ºå®ƒæœ‰ä¸ª manifest æ–‡ä»¶ï¼Œé‡Œé¢è®°å½•äº† vendor å’Œ main çš„è”ç³»ï¼Œå®ƒå³å­˜åœ¨äºvendoré‡Œï¼Œåˆæœ‰å¯èƒ½å­˜åœ¨mainé‡Œï¼Œå®ƒæ¯æ¬¡æ„å»ºå¯èƒ½æœ‰ä¸åŒï¼Œå¯¼è‡´äº†æ¯æ¬¡çš„æ„å»ºéƒ½ä¸ä¸€æ ·ï¼Œhashå°±ä¹Ÿå˜åŒ–äº†ã€‚å¯ä»¥ä½¿ç”¨ runtimeChunk æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä»¥ä¿è¯è€ç‰ˆæœ¬é‡Œï¼Œä»£ç æ²¡å˜ï¼Œhashä¹Ÿæ²¡å˜çš„é—®é¢˜ã€‚</p>
<p><strong>chunkhashå’Œhashä¸ä¸€æ ·ï¼Œå®ƒæ ¹æ®ä¸åŒçš„å…¥å£æ–‡ä»¶(Entry)è¿›è¡Œä¾èµ–æ–‡ä»¶è§£æã€æ„å»ºå¯¹åº”çš„chunkï¼Œç”Ÿæˆå¯¹åº”çš„å“ˆå¸Œå€¼ã€‚</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">entry:&#123;</span><br><span class="line">    main: <span class="string">'./index.js'</span>,</span><br><span class="line">    vender:[<span class="string">'jquery'</span>,<span class="string">'lodash'</span>]</span><br><span class="line">&#125;</span><br><span class="line">output:&#123;</span><br><span class="line">    path:path.join(__dirname, <span class="string">'/dist/js'</span>),</span><br><span class="line">    filename: <span class="string">'[name].[chunkhash].js'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æˆ‘ä»¬åœ¨ç”Ÿäº§ç¯å¢ƒé‡ŒæŠŠä¸€äº›å…¬å…±åº“å’Œç¨‹åºå…¥å£æ–‡ä»¶åŒºåˆ†å¼€ï¼Œå•ç‹¬æ‰“åŒ…æ„å»ºï¼Œå†é‡‡ç”¨<code>chunkhash</code>çš„æ–¹å¼ç”Ÿæˆå“ˆå¸Œå€¼ï¼Œé‚£ä¹ˆåªè¦æˆ‘ä»¬ä¸æ”¹åŠ¨vendorçš„ä»£ç ï¼Œå°±å¯ä»¥ä¿è¯å…¶å“ˆå¸Œå€¼ä¸ä¼šå—å½±å“ã€‚è¿™æ ·å¯ä»¥æ¯”è¾ƒæœ‰æ•ˆçš„åˆ©ç”¨ç¼“å­˜ã€‚</strong></p>
<p>è€Œåªä½¿ç”¨ chunkhash ä¹Ÿä¼šæœ‰é—®é¢˜ï¼Œè‹¥ä¸€ä¸ªindex.jsæ–‡ä»¶ä¸­å¼•å…¥äº†ä¸€ä¸ªcssæ–‡ä»¶ï¼Œé‚£ä¹ˆå®ƒå°†ä¼šæ‰“åŒ…åˆ°å’Œindex.jsä¸€èµ·ï¼Œé‚£ä¹ˆå¦‚æœåªæ˜¯csså˜åŒ–äº†ï¼Œä»–ä»¬åˆå…¬ç”¨ä¸€ä¸ªchunk, é‚£ä¹ˆindex.jsè™½ç„¶æ²¡æœ‰å˜åŒ–ï¼Œä½†æ˜¯æ–‡ä»¶åä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨extract-text-webpack-pluginè¿™ä¸ªæ’ä»¶ï¼Œç„¶åç»“åˆcontenthash,å³å¯ä¿è¯csså˜åŒ–æ—¶ï¼Œjsä¸å‘ç”Ÿå˜åŒ–ã€‚</p>
<blockquote>
<p>å®ƒä¼šå°†æ‰€æœ‰çš„å…¥å£ chunk(entry chunks)ä¸­å¼•ç”¨çš„ *.cssï¼Œç§»åŠ¨åˆ°ç‹¬ç«‹åˆ†ç¦»çš„ CSS æ–‡ä»¶ã€‚å› æ­¤ï¼Œä½ çš„æ ·å¼å°†ä¸å†å†…åµŒåˆ° JS bundle ä¸­ï¼Œè€Œæ˜¯ä¼šæ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„ CSS æ–‡ä»¶ï¼ˆå³ styles.cssï¼‰å½“ä¸­ã€‚ å¦‚æœä½ çš„æ ·å¼æ–‡ä»¶å¤§å°è¾ƒå¤§ï¼Œè¿™ä¼šåšæ›´å¿«æå‰åŠ è½½ï¼Œå› ä¸º CSS bundle ä¼šè·Ÿ JS bundle å¹¶è¡ŒåŠ è½½ã€‚</p>
</blockquote>
<p><strong>contenthash å°†æ ¹æ®èµ„æºå†…å®¹åˆ›å»ºå‡ºå”¯ä¸€ hashï¼Œä¹Ÿå°±æ˜¯è¯´æ–‡ä»¶å†…å®¹ä¸å˜ï¼Œhash å°±ä¸å˜ã€‚</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">"extract-text-webpack-plugin"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">          fallback: <span class="string">"style-loader"</span>,</span><br><span class="line">          use: <span class="string">"css-loader"</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> ExtractTextPlugin(<span class="string">'[name].[contenthash].css'</span>),</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>contenthash</code>ä¸€èˆ¬æˆ‘åªåœ¨ <code>ExtractTextPlugin</code> ä½¿ç”¨ï¼Œåœ¨ <code>filename</code>å’Œ<code>chunkfilename</code>ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šè®¾ç½®ä¸ºè¿™ä¸ªå€¼ï¼Œè€Œæ˜¯ä½¿ç”¨<code>chunkhash</code>ã€‚<br>å¹¶ä¸”<code>chunkhash</code>,<code>contenthash</code>å’Œ<code>HMR</code>ä¸èƒ½åŒæ—¶ä½¿ç”¨,ä¸€èˆ¬æˆ‘ä»¬ä¸ä¼šå†devé‡Œè¿™æ ·å†™ï¼Œè€Œæ˜¯åœ¨ <code>production</code> ç¯å¢ƒä¸­è®¾ç½®ã€‚devç¯å¢ƒä¸­æˆ‘ä»¬å°±ç”¨<code>[name].js</code>å…¶å®å°±å¯ä»¥ã€‚</p>
<p>å› æ­¤å¯ä»¥ç†è§£ä¸ºï¼šhash è®¡ç®—ä¸æ•´ä¸ªé¡¹ç›®çš„æ„å»ºç›¸å…³ï¼›chunkhash è®¡ç®—ä¸åŒä¸€ chunk å†…å®¹ç›¸å…³ï¼›contenthash è®¡ç®—ä¸æ–‡ä»¶å†…å®¹æœ¬èº«ç›¸å…³ã€‚<br>è¿™ä¹ˆæƒ³æ¥ï¼Œè®¾è®¡è€…å–åä¹Ÿæ˜¯éå¸¸å‡†ç¡®å’Œç”¨å¿ƒäº†ã€‚</p>
<hr>
<h1 id="æ€»ç»“ğŸŒº"><a href="#æ€»ç»“ğŸŒº" class="headerlink" title="æ€»ç»“ğŸŒº"></a>æ€»ç»“ğŸŒº</h1><p>è¿™é‡Œä¸Šé¢æåˆ°çš„ä¸€äº›æ¦‚å¿µï¼Œæœ‰å¤§æ¦‚70%æˆ‘åœ¨å®è·µä¸­ä½¿ç”¨çš„æ¯”è¾ƒé¢‘ç¹ï¼Œå…¶ä»–çš„å¦‚ prefetch å’Œ preload,æˆ‘åŸºæœ¬æ²¡æœ‰ä½¿ç”¨åˆ°è¿‡ã€‚å¸Œæœ›åç»­è‡ªå·±æœ‰æ„è¯†å»ä½¿ç”¨ï¼Œå¹¶è§‚å¯Ÿæ˜¯å¦çœŸçš„æœ‰æ•ˆæœã€‚ğŸ“š</p>
<p>prefech çš„å…¼å®¹æ€§ä¼šæ¯” preload å¥½äº›ã€‚ä»–ä»¬ä¹‹é—´è¿˜æœ‰è®¸å¤šåŒºåˆ«ï¼Œæˆ‘å…ˆä¸å»åšäº†è§£äº†ã€‚</p>
<p>æœ€ä¸»è¦çš„ç›®çš„è¿˜æ˜¯å¸Œæœ›è‡ªå·±å¯¹æŸä¸ªçŸ¥è¯†ç‚¹æ˜¯ç³»ç»ŸåŒ–çš„ï¼Œè€Œä¸æ˜¯åªçŸ¥é“å…¶ä¸­çš„ä¸€ç‚¹ã€‚ç»†èŠ‚å¯ä»¥ä¸å»äº†è§£ï¼Œä½†æ˜¯åŸºæœ¬çš„è¿™äº›æ€æƒ³å¸Œæœ›èƒ½è®°ä½ï¼Œç„¶åå†æŸäº›éœ€è¦çš„æ—¶å€™ï¼Œå†å»ä½¿ç”¨ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬ç¯‡æ–‡ç« ä¸»è¦è®°å½• webpack çš„ä»£ç åˆ†ç¦»çš„å‡ ç§æ–¹å¼ï¼Œç”±æ­¤å†å»ç†è§£é€šè¿‡&lt;strong&gt;ä»£ç åˆ†ç¦»&lt;/strong&gt;å¯ä»¥åšå“ªäº›å‰ç«¯ä¼˜åŒ–ï¼šå¦‚æ‡’åŠ è½½å’Œé¢„å…ˆåŠ è½½ã€‚ä¹‹åå†ä»‹ç»äº†å‡ ä¸ªæ˜“æ··æ·†çš„æ¦‚å¿µã€‚ğŸ“š&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&quot;webpack-ä»£ç åˆ†ç¦»ğŸŒ²&quot;&gt;&lt;a href=&quot;
    
    </summary>
    
    
      <category term="å·¥å…·/é…ç½®" scheme="http://sevencai.github.io/tags/%E5%B7%A5%E5%85%B7-%E9%85%8D%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºå¾®ä¿¡å…å¯†æ”¯ä»˜çš„å‡ ä¸ªæ¦‚å¿µ</title>
    <link href="http://sevencai.github.io/2019/03/15/%E5%85%B3%E4%BA%8E%E5%BE%AE%E4%BF%A1%E5%85%8D%E5%AF%86%E6%94%AF%E4%BB%98%E7%9A%84%E5%87%A0%E4%B8%AA%E6%A6%82%E5%BF%B5/"/>
    <id>http://sevencai.github.io/2019/03/15/å…³äºå¾®ä¿¡å…å¯†æ”¯ä»˜çš„å‡ ä¸ªæ¦‚å¿µ/</id>
    <published>2019-03-15T11:38:31.000Z</published>
    <updated>2019-03-18T03:21:02.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>çº¯ç­¾çº¦<br>æ”¯ä»˜ä¸­ç­¾çº¦<br>æ”¯ä»˜åç­¾çº¦<br>ç­¾çº¦åæ”¯ä»˜ï¼ˆè¿ç»­åŒ…æœˆï¼‰<br>è‡ªåŠ¨ç»­è´¹</p>
</blockquote>
<p>å¾®ä¿¡ä¸€å…±<strong>åª</strong>æä¾›ä¸¤ç§ç­¾çº¦æ–¹å¼ï¼š <strong>çº¯ç­¾çº¦å’Œæ”¯ä»˜ä¸­ç­¾çº¦</strong>ï¼Œ<a href="https://pay.weixin.qq.com/wiki/doc/api/pap.php?chapter=17_2" target="_blank" rel="noopener">æ–‡æ¡£åœ¨è¿™é‡Œ</a>ã€‚ <strong>åé¢çš„å‡ ç§æ–¹å¼éƒ½ä¸æ˜¯å¾®ä¿¡çš„æ¦‚å¿µï¼Œè€Œæ˜¯å¤§å®¶åŒ…è£…å‡ºæ¥çš„æ¦‚å¿µ</strong>ã€‚</p>
<hr>
<h2 id="çº¯ç­¾çº¦"><a href="#çº¯ç­¾çº¦" class="headerlink" title="çº¯ç­¾çº¦"></a>çº¯ç­¾çº¦</h2><p>çº¯ç­¾çº¦å¯ä»¥ç†è§£ä¸ºå§”æ‰˜æ‰£æ¬¾ï¼Œç”¨æˆ·ä¸€æ—¦åŒæ„ï¼Œä»¥åå•†å®¶å°±å¯ä»¥å…ç”¨æˆ·å¯†ç è¿›è¡Œæ‰£æ¬¾ã€‚<strong>è¿™ä¸ªè¿‡ç§°ä¸­ä¸ä¼šå‘ç”Ÿæ‰£æ¬¾è¡Œä¸ºï¼Œä»…ä»…æ˜¯ç­¾çº¦ï¼Œç­¾è®¢åè®®è€Œå·²</strong>ã€‚</p>
<p><img src="chunqianyue.png" alt="çº¯ç­¾çº¦"></p>
<hr>
<h2 id="æ”¯ä»˜ä¸­ç­¾çº¦"><a href="#æ”¯ä»˜ä¸­ç­¾çº¦" class="headerlink" title="æ”¯ä»˜ä¸­ç­¾çº¦"></a>æ”¯ä»˜ä¸­ç­¾çº¦</h2><p>æ”¯ä»˜ä¸­ç­¾çº¦æ˜¯å¾®ä¿¡æä¾›çš„å¦å¤–ä¸€ç§ç­¾çº¦ï¼Œå•†å®¶åœ¨ä¸‹è®¢å•æ—¶ï¼Œå¸¦ä¸Šç­¾çº¦çš„å‚æ•°ï¼Œå°±ä¼šåœ¨ä¸‹è®¢å•çš„è®¢å•é¡µå‡ºç°ä¸€ä¸ªæŒ‰é’®ï¼Œç”¨æˆ·å‹¾é€‰æ˜¯å¦ç­¾çº¦ã€‚è¿™ç§ç”¨æˆ·éœ€è¦ä¸»åŠ¨å‹¾é€‰åŒæ„ï¼Œè½¬æ¢ç‡åº•ã€‚<strong>è¿™ç§æƒ…å†µï¼Œç”¨æˆ·ä¸€æ—¦å‹¾ä¸Šäº†åŒæ„ï¼Œå°±ä¼šå³æ‰£æ¬¾ï¼Œä¹Ÿä¼šç­¾çº¦</strong>ã€‚</p>
<p><img src="zhifuzhongqianyue.png" alt="æ”¯ä»˜ä¸­ç­¾çº¦"></p>
<hr>
<h2 id="æ”¯ä»˜åç­¾çº¦"><a href="#æ”¯ä»˜åç­¾çº¦" class="headerlink" title="æ”¯ä»˜åç­¾çº¦"></a>æ”¯ä»˜åç­¾çº¦</h2><p>æ”¯ä»˜åç­¾çº¦ï¼šæ˜¯ç”¨æˆ·å…ˆè¿›è¡Œä¸€ç¬”æ”¯ä»˜ï¼Œæ”¯ä»˜åå†æ‹‰èµ·ç­¾çº¦é¡µé¢ã€‚<strong>è¿™ç§æƒ…å†µè½¬æ¢ç‡æ›´ä½ï¼Œç”¨æˆ·éœ€è¦è¾“å…¥ä¸¤æ¬¡å¯†ç ï¼Œç¬¬ä¸€æ¬¡æ˜¯ä»˜æ¬¾çš„å¯†ç ï¼Œç¬¬äºŒæ¬¡æ˜¯ç­¾çº¦çš„å¯†ç </strong>ã€‚ä½“éªŒä¸å¥½ã€‚</p>
<hr>
<h2 id="ç­¾çº¦åæ”¯ä»˜"><a href="#ç­¾çº¦åæ”¯ä»˜" class="headerlink" title="ç­¾çº¦åæ”¯ä»˜"></a>ç­¾çº¦åæ”¯ä»˜</h2><p>ç­¾çº¦åæ”¯ä»˜ï¼šå…ˆæ‹‰èµ·ç­¾çº¦é¡µé¢ï¼Œç”¨æˆ·è¾“å…¥å¯†ç ï¼Œç„¶åç­¾çº¦åï¼Œç”±å•†å®¶è¿›è¡Œæ‰£æ¬¾ä¸€ç¬”ä»˜è´¹ã€‚<strong>è¿™ç§æƒ…å†µï¼Œç”¨æˆ·åªéœ€è¦è¾“å…¥å¯†ç ä¸€æ¬¡ï¼Œå¹¶ä¸”ä¸€å®šæ˜¯å…ˆç­¾çº¦è½¬æ¢ç‡é«˜ï¼Œå¹¶ä¸”ç”¨æˆ·ä¹Ÿä¼šæ”¯ä»˜ä¸€ç¬”ï¼Œå¤§å®¶æŠŠå®ƒåŒ…è£…æˆã€è¿ç»­åŒ…æœˆã€‘çš„æ¦‚å¿µ</strong>ã€‚</p>
<p>è¿™ç§è¿ç»­åŒ…æœˆå°±æ˜¯éœ€è¦å•†å®¶åœ¨ç”¨æˆ·ç­¾çº¦å®Œæˆåï¼Œç«‹åˆ»<strong>ä¸ºç”¨æˆ·ä¸‹ä¸€ç¬”å•</strong>ï¼Œç„¶åç”±äºç”¨æˆ·å·²ç»ç­¾çº¦ï¼Œæ‰€ä»¥ä¸éœ€è¦å†è¾“å¯†ç ã€‚è¿™æ—¶å€™ç”¨æˆ·å°±åˆç­¾çº¦åˆæ”¯ä»˜ã€‚æ¯”è¾ƒå®Œç¾ã€‚å•†å®¶éœ€è¦å¼€å‘åç»­å†ä¸‹å•çš„æµç¨‹ã€‚</p>
<hr>
<h2 id="è‡ªåŠ¨ç»­è´¹"><a href="#è‡ªåŠ¨ç»­è´¹" class="headerlink" title="è‡ªåŠ¨ç»­è´¹"></a>è‡ªåŠ¨ç»­è´¹</h2><p>è‡ªåŠ¨ç»­è´¹å°±æ˜¯ä¸€ç§å¾ˆå®½æ³›çš„è¯´æ³•äº†ï¼Œå°±æ˜¯åˆ°æœŸäº†ï¼Œå•†å®¶å¸®åŠ©ç”¨æˆ·è¿›è¡Œè‡ªåŠ¨çš„æ‰£æ¬¾å¹¶ä¸”å»¶é•¿æœåŠ¡çš„è¯´æ³•ã€‚è‡ªåŠ¨ç»­è´¹çš„æ¸ é“æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚æ”¯ä»˜å®ï¼ŒQB, å¾®ä¿¡æ”¯ä»˜ç­‰æ¸ é“ã€‚è€Œè¿ç»­åŒ…æœˆå¯ä»¥è¯´æ˜¯å…¶ä¸­çš„ä¸€ç§ï¼Œå¯ä»¥ç†è§£ä¸ºæ˜¯å¾®ä¿¡çš„è‡ªåŠ¨ç»­è´¹ã€‚è‡ªåŠ¨ç»­è´¹æ¦‚å¿µæ¯”è¾ƒå¹¿æ³›ï¼Œè¿ç»­åŒ…æœˆæ˜¯å…¶ä¸­çš„ä¸€ç§å®ç°ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;çº¯ç­¾çº¦&lt;br&gt;æ”¯ä»˜ä¸­ç­¾çº¦&lt;br&gt;æ”¯ä»˜åç­¾çº¦&lt;br&gt;ç­¾çº¦åæ”¯ä»˜ï¼ˆè¿ç»­åŒ…æœˆï¼‰&lt;br&gt;è‡ªåŠ¨ç»­è´¹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¾®ä¿¡ä¸€å…±&lt;strong&gt;åª&lt;/strong&gt;æä¾›ä¸¤ç§ç­¾çº¦æ–¹å¼ï¼š &lt;strong&gt;çº¯ç­¾çº¦å’Œæ”¯ä»˜ä¸­ç­¾çº¦&lt;/strong&gt;
    
    </summary>
    
    
      <category term="æ¦‚å¿µ" scheme="http://sevencai.github.io/tags/%E6%A6%82%E5%BF%B5/"/>
    
  </entry>
  
  <entry>
    <title>è¯ä¹¦ã€å¯¹ç§°åŠ å¯†ã€éå¯¹ç§°åŠ å¯†</title>
    <link href="http://sevencai.github.io/2019/03/14/%E8%AF%81%E4%B9%A6%E3%80%81%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E3%80%81%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/"/>
    <id>http://sevencai.github.io/2019/03/14/è¯ä¹¦ã€å¯¹ç§°åŠ å¯†ã€éå¯¹ç§°åŠ å¯†/</id>
    <published>2019-03-14T09:16:48.000Z</published>
    <updated>2019-05-28T02:39:17.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡æ–‡ç« ä¸»è¦æ˜¯é’ˆå¯¹æˆ‘å¯¹è¯ä¹¦ï¼Œå¯¹ç§°åŠ å¯†ï¼Œéå¯¹ç§°åŠ å¯†ï¼ŒCAç­‰å†…å®¹çš„ç²—æµ…ç†è§£çš„è®°å½•ã€‚ä¸‹å›¾ä¸ºæˆ‘ç†è§£çš„å¤§è‡´æµç¨‹ã€‚æ–¹ä¾¿åç»­æŸ¥é˜…ã€‚</p>
<p>å‡ ä¸ªåŸºæœ¬æ¦‚å¿µ</p>
<ol>
<li>å¯†ç : å¯¹æ–‡æœ¬è¿›è¡Œç¼–ç ï¼Œä½¿å·çª¥è€…æ— æ³•è¯†åˆ«çš„ç®—æ³•ã€‚</li>
<li>å¯†é’¥: æ”¹å˜å¯†ç è¡Œä¸ºçš„æ•°å­—åŒ–å‚æ•°ã€‚</li>
<li>å¯¹ç§°å¯†é’¥åŠ å¯†ç³»ç»Ÿ: ç¼– / è§£ç ä½¿ç”¨ç›¸åŒå¯†é’¥çš„ç®—æ³•ã€‚</li>
<li>ä¸å¯¹ç§°å¯†é’¥åŠ å¯†ç³»ç»Ÿ: ç¼– / è§£ç ä½¿ç”¨ä¸åŒå¯†é’¥çš„ç®—æ³•ã€‚</li>
<li>å…¬å¼€å¯†é’¥åŠ å¯†ç³»ç»Ÿ: ä¸€ç§èƒ½å¤Ÿä½¿æ•°ç™¾ä¸‡è®¡ç®—æœºä¾¿æ·åœ°å‘é€æœºå¯†æŠ¥æ–‡çš„ç³»ç»Ÿã€‚</li>
<li>æ•°å­—ç­¾å: ç”¨æ¥éªŒè¯æŠ¥æ–‡æœªè¢«ä¼ªé€ æˆ–ç¯¡æ”¹çš„æ ¡éªŒå’Œã€‚</li>
<li>æ•°å­—è¯ä¹¦: ç”±ä¸€ä¸ªå¯ä¿¡çš„ç»„ç»‡éªŒè¯å’Œç­¾å‘çš„è¯†åˆ«ä¿¡æ¯ã€‚</li>
</ol>
<p>ä¸€ä¸ªæ•´ä½“çš„äº¤äº’å›¾</p>
<p><img src="process.png" alt="æµç¨‹å›¾"></p>
<hr>
<h2 id="CAåŠCAè¯ä¹¦"><a href="#CAåŠCAè¯ä¹¦" class="headerlink" title="CAåŠCAè¯ä¹¦"></a>CAåŠCAè¯ä¹¦</h2><p>CA å°±æ˜¯è®¤è¯æœºæ„,<code>Certificate Authority</code>ã€‚</p>
<p>CA è¯ä¹¦ï¼š å› ç‰¹ç½‘çš„<code>IDå¡</code>, é€šå¸¸è¢«ç§°ä¸º certsã€‚</p>
<p>å…¶ä¸­åŒ…å«äº†ç”±æŸä¸ª<strong>å—ä¿¡ä»»çš„ç»„ç»‡æ‹…ä¿çš„ç”¨æˆ·æˆ–è€…å…¬å¸çš„ç›¸å…³ä¿¡æ¯</strong>ã€‚</p>
<p><strong>ä»»ä½•äººéƒ½å¯ä»¥åˆ›å»ºä¸€ä¸ªæ•°å­—è¯ä¹¦ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰äººéƒ½èƒ½å¤Ÿè·å¾—å—äººå°Šæ•¬çš„ç­¾å‘æƒï¼Œä»è€Œä¸ºè¯ä¹¦ä¿¡æ¯æ‹…ä¿ï¼Œå¹¶ç”¨å…¶ç§æœ‰å¯†é’¥ç­¾å‘è¯ä¹¦ã€‚</strong></p>
<p>å°±åƒ<code>èº«ä»½è¯</code>æ˜¯æƒå¨æœºæ„é¢å‘çš„ï¼Œèƒ½è¯æ˜ä½ çš„èº«ä»½ï¼Œä¸€èˆ¬å¤§å®¶éƒ½å¾ˆä¿¡ä»»ã€‚ä½†æ˜¯ä½ çš„<code>åç‰‡å¡</code>æ˜¯ä½ è‡ªå·±å¼„çš„ï¼Œæˆ–è€…å…¬å¸å‘çš„ï¼Œå¤§å®¶å¯èƒ½å°±çœ‹çœ‹ï¼Œä½†æ˜¯ä¸ä¸€å®šç›¸ä¿¡å°±æ˜¯çœŸçš„ã€‚</p>
<p>æ‰€ä»¥ä½ ä¿¡ç”¨è´·æ—¶ï¼Œç”¨èº«ä»½è¯å¤§å®¶è®¤å¯ï¼Œä½†æ˜¯ä½ ç”¨åç‰‡å¡è‚¯å®šä¸å¯ä»¥ï¼Œå³ä½¿ä½ åç‰‡å¡ä¸Šå†™çš„èŒä½æ˜¯ç»ç†ã€‚</p>
<p><img src="certs.png" alt="å…¸å‹çš„è¯ä¹¦ç»“æ„"></p>
<hr>
<h2 id="è¯ä¹¦çš„ç»„æˆ"><a href="#è¯ä¹¦çš„ç»„æˆ" class="headerlink" title="è¯ä¹¦çš„ç»„æˆ"></a>è¯ä¹¦çš„ç»„æˆ</h2><ol>
<li>â€œå¯¹è±¡çš„åç§°ï¼ˆäººã€æœåŠ¡å™¨ã€ç»„ç»‡ç­‰ï¼‰ï¼›</li>
<li>è¿‡æœŸæ—¶é—´ï¼›</li>
<li>è¯ä¹¦å‘å¸ƒè€…ï¼ˆç”±è°ä¸ºè¯ä¹¦æ‹…ä¿ï¼‰ï¼›</li>
<li>æ¥è‡ªè¯ä¹¦å‘å¸ƒè€…çš„<strong>æ•°å­—ç­¾å</strong>ï¼›</li>
<li><strong>å¯¹è±¡çš„å…¬å¼€å¯†é’¥</strong>ã€‚</li>
</ol>
<h2 id="æœåŠ¡å™¨è¯ä¹¦"><a href="#æœåŠ¡å™¨è¯ä¹¦" class="headerlink" title="æœåŠ¡å™¨è¯ä¹¦"></a>æœåŠ¡å™¨è¯ä¹¦</h2><ol>
<li>Web ç«™ç‚¹çš„åç§°å’Œä¸»æœºåï¼›</li>
<li>Web ç«™ç‚¹çš„<strong>å…¬å¼€å¯†é’¥</strong>ï¼›</li>
<li>ç­¾åé¢å‘æœºæ„çš„åç§°ï¼›</li>
<li>æ¥è‡ªç­¾å<strong>é¢å‘æœºæ„çš„ç­¾å</strong>ã€‚</li>
</ol>
<p>æ‰€ä»¥<strong>å½“æµè§ˆå™¨æ”¶åˆ°è¯ä¹¦åä¼šè¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœè¿™ä¸ªCAï¼ˆè®¤è¯æœºæ„ï¼‰æ˜¯ä¸ªå¾ˆæƒå¨çš„å…¬å…±å‰é¢æœºæ„ï¼Œæµè§ˆå™¨å°±å¯ä»¥å·²ç»çŸ¥é“å®ƒçš„ï¼ˆCAçš„ï¼‰å…¬å¼€å¯†é’¥äº†ã€‚å› ä¸ºæ­£ç‰ˆçš„æµè§ˆå™¨ä¼šé¢„å…ˆå®‰è£…å¾ˆå¤šç­¾åé¢å‘æœºæ„çš„è¯ä¹¦ã€‚æ³¨æ„æµè§ˆå™¨è¿™æ—¶å€™çŸ¥é“çš„å…¬å¼€å¯†é’¥æ˜¯CAè®¤è¯æœºæ„çš„å…¬å¼€å¯†é’¥ï¼Œè€Œä¸æ˜¯æœåŠ¡å™¨ç«¯çš„å…¬å¼€å¯†é’¥ï¼ŒæœåŠ¡å™¨ç«¯çš„å…¬å¼€å¯†é’¥æ˜¯é€šè¿‡CAçš„å…¬å¼€å¯†é’¥è§£å¯†å¾—åˆ°çš„ã€‚</strong></p>
<p>ä¸Šé¢è¿™é‡Œä¸€å®šè¦ç†è§£æ¸…æ¥šï¼Œå†çœ‹ä¸‹é¢çš„æµç¨‹ä¼šæ¸…æ¥šå¾ˆå¤šã€‚</p>
<p>è¯ä¹¦=å…¬é’¥+ç”³è¯·è€…ä¸é¢å‘è€…ä¿¡æ¯+ç­¾åã€‚</p>
<p>è¯ä¹¦ä¼šé¢å‘ç»™æœåŠ¡å™¨ï¼Œæµè§ˆå™¨è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ä¼šç»™æµè§ˆå™¨è¯ä¹¦ï¼Œæµè§ˆå™¨é€šè¿‡ç­¾åå’Œæ—¶é—´ç­‰ï¼Œç”¨CAçš„å…¬é’¥åˆ¤æ–­è¯ä¹¦æ˜¯å¦æœ‰æ•ˆã€‚</p>
<hr>
<h2 id="æ•°å­—ç­¾å"><a href="#æ•°å­—ç­¾å" class="headerlink" title="æ•°å­—ç­¾å"></a>æ•°å­—ç­¾å</h2><p>ä¸Šé¢æåˆ°äº†è¯ä¹¦é‡Œé¢ä¼šåŒ…å«CAçš„ç­¾åã€‚è¿™ä¸ªç­¾åçš„æ„ä¹‰å’Œä½œç”¨æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<blockquote>
<p>â€œæ•°å­—ç­¾åæ˜¯é™„åŠ åœ¨<strong>æŠ¥æ–‡ä¸Š</strong>çš„ç‰¹æ®ŠåŠ å¯†æ ¡éªŒç ã€‚â€<br>ç”¨äºæè¿°æ˜¯è°ç¼–å†™çš„æŠ¥æ–‡ï¼ŒåŒæ—¶è¯æ˜æŠ¥æ–‡æœªè¢«ç¯¡æ”¹è¿‡ã€‚è¿™ç§æŠ€æœ¯è¢«ç§°ä¸ºæ•°å­—ç­¾åï¼ˆdigital signingï¼‰</p>
</blockquote>
<p>æ¯”å¦‚ä¸Šé¢CAè¯ä¹¦çš„ç­¾åï¼Œç›®çš„æ˜¯è¯æ˜CAè¯ä¹¦æ˜¯åˆæ³•çš„ï¼Œæ˜¯CAé¢å‘çš„ã€‚å¹¶ä¸”è¯ä¹¦æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚</p>
<p>ç­¾åå°±åƒäººçš„ç­¾å­—ä¸€æ ·ã€‚ä½†æ˜¯æ¯”äººçš„ç­¾å­—æ›´å¥½çš„æ˜¯å¯ä»¥é€šè¿‡ç¨‹åºåˆ¤æ–­æ˜¯ä¸æ˜¯çœŸçš„æ˜¯ä½ ç­¾çš„å­—ã€‚ä¸‹é¢ä¸¾ä¾‹çœ‹çœ‹ä¸Šé¢çš„CAçš„ç­¾åæ˜¯æ€ä¹ˆç”Ÿæˆçš„ã€‚</p>
<ol>
<li>CAå°†å˜é•¿æŠ¥æ–‡æå–ä¸ºå®šé•¿çš„æ‘˜è¦</li>
<li>CAå¯¹æ‘˜è¦åº”ç”¨äº†ä¸€ä¸ªç­¾åå‡½æ•°ï¼Œå‚æ•°ä¸ºCAçš„ç§é’¥</li>
<li>è®¡ç®—å‡ºç­¾ååCAå°†å…¶é™„åŠ åœ¨æŠ¥æ–‡çš„å°¾éƒ¨ï¼Œå¹¶ä¸”å°†æŠ¥æ–‡å’Œç­¾åä¸€èµ·å‘é€ç»™æœåŠ¡å™¨</li>
<li>ç„¶åå®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨æ—¶ï¼Œæ‹¿åˆ°äº†è¯ä¹¦ã€‚ç„¶åç”¨CAçš„å…¬é’¥è¿›è¡Œç­¾åå‡½æ•°çš„åå‡½æ•°</li>
<li>å¾—åˆ°äº†æ˜æ–‡æ‘˜è¦ã€‚æ‹¿åˆ°æ‘˜è¦åå†ä¸çœŸå®å‘è¿‡æ¥çš„æ–‡æœ¬æ‘˜è¦åšå¯¹æ¯”</li>
<li>è‹¥ä¸ä¸€è‡´ï¼Œåˆ™ç­¾åä¸é€šè¿‡ï¼Œè‹¥ä¸€è‡´ï¼Œåˆ™ä¿¡ä»»æ­¤è¯ä¹¦åŠè¯ä¹¦é‡Œé¢çš„æœåŠ¡å™¨çš„<code>public key</code></li>
</ol>
<p><img src="sign.png" alt="ç­¾åçš„æœºåˆ¶"></p>
<hr>
<h2 id="æ€ä¹ˆç”Ÿæˆè¯ä¹¦"><a href="#æ€ä¹ˆç”Ÿæˆè¯ä¹¦" class="headerlink" title="æ€ä¹ˆç”Ÿæˆè¯ä¹¦"></a>æ€ä¹ˆç”Ÿæˆè¯ä¹¦</h2><ol>
<li>æœåŠ¡å™¨æŠŠ <code>public key</code> åŠä¸€äº›å…¶ä»–é™„åŠ ä¿¡æ¯ç»™åˆ°CA</li>
<li>CA ç”¨è‡ªå·±çš„ <code>private key</code> åŠ å¯†è¿™äº›æ•°æ®ï¼ŒåŠ å¯†å®Œçš„æ•°æ®ç§°ä¸ºæ•°å­—è¯ä¹¦ã€‚</li>
<li>ç„¶åæœåŠ¡å™¨è¿”å›è¯ä¹¦ç»™æµè§ˆå™¨æ—¶ï¼Œè¿”å›çš„æ˜¯ç”¨ CA çš„ <code>private key</code> åŠ å¯†åçš„å†…å®¹ã€‚æµè§ˆå™¨æ”¶åˆ°åï¼Œä¼šé€šè¿‡å·²çŸ¥çš„ CA çš„ <code>public key</code> è¿›è¡Œè§£å¯†ï¼Œæ¥è·å¾—åˆ° B çš„ <code>public key</code>ã€‚</li>
<li>è¿™ä¸ªå¾—åˆ°çš„ <code>public key</code> æ˜¯å—ä¿¡ä»»çš„å…¬é’¥keyã€‚</li>
</ol>
<p><strong>æ‰€ä»¥å¯ä»¥çŸ¥é“ç”Ÿæˆè¯ä¹¦çš„è¿™ä¸ªè¿‡ç§°å…¶å®ä¹Ÿæ˜¯éå¯¹ç§°åŠ å¯†</strong> </p>
<p><strong>æ³¨æ„ç”Ÿæˆè¯ä¹¦å’Œç­¾åçš„æ•´ä¸ªè¿‡ç¨‹ï¼ŒCAéƒ½æ˜¯ä¸éœ€è¦å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡ç«¯çš„ç§é’¥çš„ï¼Œç§é’¥è¦ç¡®ä¿åªèƒ½è‡ªå·±ä½¿ç”¨ã€‚CAä½¿ç”¨çš„ç§é’¥ä¹Ÿä»…ä»…æ˜¯è‡ªå·±çš„ç§é’¥ï¼Œç”¨äºç­¾åã€‚</strong></p>
<hr>
<h2 id="è®¤è¯æµç¨‹"><a href="#è®¤è¯æµç¨‹" class="headerlink" title="è®¤è¯æµç¨‹"></a>è®¤è¯æµç¨‹</h2><p>æŠŠä¸Šé¢é‚£äº›æ¦‚å¿µç†è§£æ¸…æ¥šåï¼Œåé¢è¿™ä¸ªæµç¨‹å°±å¾ˆæ¸…æ™°äº†ã€‚</p>
<ol>
<li>æœåŠ¡å™¨ç”³è¯·å‘ CA ç”³è¯·è¯ä¹¦</li>
<li>æµè§ˆå™¨é¦–æ¬¡å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œ æœåŠ¡å™¨è¿”å›è¯ä¹¦ç»™æµè§ˆå™¨</li>
<li>æµè§ˆå™¨æ‹¿åˆ°è¯ä¹¦ï¼Œé€šè¿‡ç­¾ååŠæ—¶é—´ç­‰ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æ•ˆï¼Œæ˜¯å¦å¯ä¿¡ä»»</li>
<li>è‹¥è¯ä¹¦æœ‰æ•ˆ</li>
<li>å®¢æˆ·ç«¯ç”Ÿæˆéšæœºæ•°ï¼Œç„¶åç”¨è¯ä¹¦ä¸­çš„å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼ŒåŠ å¯†åå‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ç”¨ç§é’¥è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°éšæœºæ•°ã€‚ï¼ˆè¿™ä¸ªè¿‡ç¨‹æ˜¯éå¯¹ç§°åŠ å¯†ï¼‰</li>
<li>ä¹‹åæœåŠ¡å™¨å’Œæµè§ˆå™¨å°±ç”¨è¿™ä¸ªéšæœºæ•°åšä¸ºé’¥åŒ™ï¼Œå¯¹æ•°æ®è¿›è¡ŒåŠ å¯†è§£å¯†ã€‚</li>
</ol>
<p><strong>æ‰€ä»¥çŸ¥é“æ‹¿åˆ°è¯ä¹¦åï¼Œä½¿ç”¨éšæœºæ•°åçš„è¿‡ç§°ï¼Œåº”è¯¥æ˜¯å¯¹ç§°åŠ å¯†</strong>ã€‚</p>
<p>ä¸‹é¢è§£é‡Šä¸ºä»€ä¹ˆä¼šæœ‰è¯ä¹¦å’Œç­¾åè¿™äº›ä¸œè¥¿ã€‚è¯ä¹¦å’Œç­¾åéƒ½æ˜¯ä¸ºäº†ä¿è¯äº’è”ç½‘ä¼ è¾“ä¿¡æ¯å®‰å…¨ã€‚</p>
<hr>
<h2 id="å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†"><a href="#å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†" class="headerlink" title="å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†"></a>å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†</h2><p>å¯¹ç§°å¯†é’¥åŠ å¯†æŠ€æœ¯çš„ç¼ºç‚¹ä¹‹ä¸€å°±æ˜¯å‘é€è€…å’Œæ¥æ”¶è€…åœ¨äº’ç›¸å¯¹è¯ä¹‹å‰ï¼Œ<strong>ä¸€å®šè¦æœ‰ä¸€ä¸ªå…±äº«çš„ä¿å¯†å¯†é’¥</strong>ã€‚</p>
<p>ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥ï¼Œå¸¦æ¥çš„é—®é¢˜å°±æ˜¯ï¼š</p>
<ol>
<li>å¯†é’¥ä»ç½‘ç»œä¼ è¾“æ˜¯ä¸å®‰å…¨çš„ã€‚</li>
<li>è‹¥ç½‘ç»œä¸­æœ‰Nä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ¯ä¸ªèŠ‚ç‚¹éƒ½è¦è·Ÿå…¶ä»–èŠ‚ç‚¹å»ºç«‹è”ç³»ï¼Œåˆ™ä¼šæœ‰N^2ä¸ªèŠ‚ç‚¹ã€‚</li>
</ol>
<p>ä¸ºäº†è§£å†³ä¸Šé¢ä¸¤ä¸ªé—®é¢˜ï¼Œå‡ºç°äº†éå¯¹ç§°åŠ å¯†ï¼ˆâ€œå…¬å¼€å¯†é’¥åŠ å¯†æŠ€æœ¯â€ï¼‰ã€‚</p>
<p>èŠ‚ç‚¹Aå‘èŠ‚ç‚¹Bä¼ é€æ•°æ®ï¼ŒèŠ‚ç‚¹Aç”¨èŠ‚ç‚¹Bçš„å…¬é’¥åŠ å¯†ï¼ŒBæ”¶åˆ°åç”¨è‡ªå·±çš„ç§é’¥è§£å¯†ã€‚</p>
<p><strong>éå¯¹ç§°åŠ å¯†å¯ä»¥ç†è§£æˆï¼Œä¸€ä¸ªèŠ‚ç‚¹æœ‰ä¸¤ä¸ªä¸œè¥¿ï¼šä¸€æŠŠé”ï¼Œä¸€ä¸ªé’¥åŒ™ã€‚é”å¯ä»¥ç»™ä»»ä½•äººï¼Œé’¥åŒ™èŠ‚ç‚¹è‡ªå·±ç•™ç”¨ã€‚æ‰€æœ‰çš„äººéƒ½å¯ä»¥å¸¦ç€é”è¿‡æ¥ï¼Œä½†æ˜¯åªæœ‰è‡ªå·±èƒ½çœ‹åˆ«äººå‘ç»™è‡ªå·±çš„ä¸œè¥¿ã€‚</strong></p>
<p>æ‰€ä»¥éå¯¹ç§°åŠ å¯†è™½ç„¶è¾ƒå®‰å…¨ä¹Ÿä¼šå¸¦æ¥é—®é¢˜ï¼š</p>
<ol>
<li>æ•°æ®è¢«ç¯¡æ”¹ï¼Œå¯†é’¥è¢«æ‹¦æˆªã€‚</li>
<li>è€—æ—¶å¤šï¼ŒåŠ å¯†ä¸è§£å¯†é€Ÿåº¦æ…¢ã€‚</li>
</ol>
<p>å‡è®¾Aå‘é€çš„æ•°æ®è¢«Cæ‹¦æˆªäº†ï¼ŒCç”¨Bçš„å…¬é’¥å’Œè‡ªå·±çš„æ•°æ®åŠ å¯†åä¼ªè£…æˆAå‘é€ç»™Bäº†ã€‚</p>
<p>Bä¹Ÿå¹¶ä¸çŸ¥é“è‡ªå·±æ¥å—åˆ°çš„æ•°æ®ä¸æ˜¯Açš„äº†ï¼Œè€Œæ˜¯Cçš„ã€‚</p>
<p>å› æ­¤å‡ºç°äº†æ•°å­—ç­¾åå’Œæ•°å­—è¯ä¹¦ã€‚</p>
<p>æ•°å­—ç­¾åä¿è¯äº†Bæ”¶åˆ°çš„ä¿¡æ¯å†…å®¹æ²¡æœ‰è¢«ç¯¡æ”¹(Aç”¨hashå¾—åˆ°Açš„æ‘˜è¦ï¼Œå†ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°ç­¾åï¼ŒBæ”¶åˆ°åç”¨Açš„å…¬é’¥è§£å¯†ï¼Œå¾—åˆ°æ‘˜è¦å’Œæ”¶åˆ°çš„å†…å®¹æ¯”å¯¹)</p>
<p>ä½†æ˜¯è¿™å¹¶ä¸èƒ½ä¿è¯å†…å®¹ä¸€å®šæ²¡æœ‰è¢«Cæ‹¦æˆªã€‚</p>
<p><img src="lack.png" alt="ç¬¬ä¸‰æ–¹æ‹¦æˆª"></p>
<p>å› ä¸ºååçš„Cå¯ä»¥æŠŠBä¿å­˜çš„Açš„å…¬é’¥æ›¿æ¢æˆè‡ªå·±çš„å…¬é’¥ã€‚ç„¶åå†’ç”¨Aç»™Bå‘é€ä¿¡æ¯ã€‚Cæ‹¦æˆªAçš„ä¿¡æ¯ï¼Œç„¶åè‡ªå·±å‘é€ä¿¡æ¯ç»™Bï¼Œç”¨Bçš„å…¬é’¥åŠ å¯†ï¼Œç„¶åBç”¨è‡ªå·±çš„ç§é’¥è§£å¯†ã€‚ï¼ˆå¦‚ä¸Šå›¾ï¼‰</p>
<p>æ‰€ä»¥å‡ºç°äº†è¯ä¹¦ã€‚è¯ä¹¦çš„ç›®çš„å°±æ˜¯ä¿è¯äº†æ•°æ®ä¸è¢«ç¯¡æ”¹ï¼Œå¹¶ä¸”ä¿è¯Bå¤„Açš„å…¬é’¥å°±æ˜¯Açš„å…¬é’¥ã€‚</p>
<blockquote>
<p>å…¸å‹çš„å¯¹ç§°åŠ å¯†ç®—æ³•ï¼š AES,DES,Trible DES<br>å…¸å‹çš„éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼š RSA</p>
</blockquote>
<hr>
<h2 id="httpså’ŒTSL-amp-SSLçš„å…³ç³»"><a href="#httpså’ŒTSL-amp-SSLçš„å…³ç³»" class="headerlink" title="httpså’ŒTSL&amp;SSLçš„å…³ç³»"></a>httpså’ŒTSL&amp;SSLçš„å…³ç³»</h2><p>httpsæ˜¯åŸºäº TSL åŠ SSL å®ç°çš„ã€‚TSL å’Œ SSL ä¸»è¦ä¾èµ–ä¸‹é¢è¿™å‡ ç§ç®—æ³•</p>
<ol>
<li>æ•£åˆ—å‡½æ•° Hash: åŸºäºæ•£åˆ—å‡½æ•°éªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§</li>
<li>å¯¹ç§°åŠ å¯†: å¯¹ç§°åŠ å¯†ç®—æ³•é‡‡ç”¨åå•†çš„å¯†é’¥å¯¹æ•°æ®åŠ å¯†</li>
<li>éå¯¹ç§°åŠ å¯†: éå¯¹ç§°åŠ å¯†å®ç°èº«ä»½è®¤è¯å’Œå¯†é’¥åå•†</li>
</ol>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼š<strong>TSL å…¶å®å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†éƒ½ç”¨åˆ°äº†ã€‚å…ˆç”¨éå¯¹ç§°åŠ å¯†è·å¾—å¯¹åº”çš„å¯†é’¥ã€‚å†ç”¨æ”¹å¯†é’¥è¿›è¡Œå¯¹ç§°åŠ å¯†ä¼ è¾“ã€‚</strong>è¿™åœ¨æˆ‘ä»¬ä¸Šé¢çš„è®¤è¯è¿‡ç¨‹ä¸­æœ‰ä½“ç°ã€‚</p>
<p>ä¹‹æ‰€ä»¥åé¢è·å¾—å¯†é’¥åï¼Œå°±ç”¨å¯¹ç§°åŠ å¯†ï¼Œä¸»è¦æ˜¯è§£å†³æ—¶é—´éå¯¹ç§°åŠ å¯†å¤ªæ¶ˆè€—æ—¶é—´å’Œæ€§èƒ½çš„é—®é¢˜ã€‚</p>
<p><img src="ssltsl.png" alt="æµç¨‹å›¾"></p>
<p>æ ‡æ³¨ï¼šä¸Šé¢çš„å›¾ç‰‡æ¥æºäº<a href="https://juejin.im/post/5b88a93df265da43231f1451" target="_blank" rel="noopener">TLS è¯¦è§£</a>ä¸€æ–‡ã€‚æ›´å¤šçš„ SSL æ¡æ‰‹ç­‰ç»†èŠ‚ï¼Œæˆ‘ä¸å…³æ³¨ã€‚</p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…¶å®æˆ‘æœ¬æ¥æ˜¯é‡åˆ°äº†ä¸€ä¸ª<code>https</code>çš„é—®é¢˜, ç„¶åå»äº†è§£äº† tsl å’Œ sslï¼Œ ç„¶ååˆå»äº†è§£äº†éå¯¹ç§°åŠ å¯†å’Œå¯¹ç§°åŠ å¯†ã€‚ç„¶ååˆå»äº†è§£äº†è¯ä¹¦å’ŒCAã€‚</p>
<p>ä¸Šæ–‡æœ‰éƒ¨åˆ†æ¦‚å¿µæ€§æ–‡æ¡ˆ - æ‘˜å½•æ¥è‡ª: [ç¾]David Gourley Brian Totty Marjorie Sayer Sailu Reddy Aushu Aggarwal. â€œHTTPæƒå¨æŒ‡å— (å›¾çµç¨‹åºè®¾è®¡ä¸›ä¹¦)â€ã€‚ iBooks.    </p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬ç¯‡æ–‡ç« ä¸»è¦æ˜¯é’ˆå¯¹æˆ‘å¯¹è¯ä¹¦ï¼Œå¯¹ç§°åŠ å¯†ï¼Œéå¯¹ç§°åŠ å¯†ï¼ŒCAç­‰å†…å®¹çš„ç²—æµ…ç†è§£çš„è®°å½•ã€‚ä¸‹å›¾ä¸ºæˆ‘ç†è§£çš„å¤§è‡´æµç¨‹ã€‚æ–¹ä¾¿åç»­æŸ¥é˜…ã€‚&lt;/p&gt;
&lt;p&gt;å‡ ä¸ªåŸºæœ¬æ¦‚å¿µ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯†ç : å¯¹æ–‡æœ¬è¿›è¡Œç¼–ç ï¼Œä½¿å·çª¥è€…æ— æ³•è¯†åˆ«çš„ç®—æ³•ã€‚&lt;/li&gt;
&lt;li&gt;å¯†é’¥: æ”¹å˜å¯†ç è¡Œä¸ºçš„æ•°å­—åŒ–å‚æ•°ã€‚
    
    </summary>
    
    
      <category term="http" scheme="http://sevencai.github.io/tags/http/"/>
    
  </entry>
  
  <entry>
    <title>ç®€å•åˆ†æbabelå’Œwebpackç¼–è¯‘åçš„æ–‡ä»¶</title>
    <link href="http://sevencai.github.io/2019/03/06/%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90babel%E5%92%8Cwebpack%E7%BC%96%E8%AF%91%E5%90%8E%E7%9A%84%E6%96%87%E4%BB%B6/"/>
    <id>http://sevencai.github.io/2019/03/06/ç®€å•åˆ†æbabelå’Œwebpackç¼–è¯‘åçš„æ–‡ä»¶/</id>
    <published>2019-03-06T08:47:27.000Z</published>
    <updated>2019-03-06T09:06:24.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<ol>
<li><p><code>babel6</code> æˆ– <code>babel7</code> åï¼Œå¯ä»¥ä½¿ç”¨<code>babel-plugin-add-module-exports</code>æ’ä»¶ï¼Œè§£å†³ <code>require(xxx).default</code> å¸¦ <code>default</code> çš„é—®é¢˜ã€‚</p>
</li>
<li><p>webpack ç›´æ¥è¢«ç¼–è¯‘åçš„ es5 jsæ–‡ä»¶æ˜¯æ²¡æ³•ç›´æ¥è¢«importçš„ï¼Œè¢«importåä¼šå¾—åˆ°ç©ºçš„å¯¹è±¡, å¦‚æœè¦ç›´æ¥å¼•ç”¨è¿™ä¸ªæ–‡ä»¶ï¼Œéœ€è¦è®¾ç½®<code>libraryTarget: &#39;xxx&#39;</code>ã€‚</p>
</li>
<li><p>å†™äº†å°demo,äº†è§£äº†ä¸‹babelç¼–è¯‘åçš„æ–‡ä»¶å’Œwebpackç¼–è¯‘åçš„æ–‡ä»¶ã€‚</p>
</li>
</ol>
</blockquote>
<hr>
<h2 id="demoä¾‹å­"><a href="#demoä¾‹å­" class="headerlink" title="demoä¾‹å­"></a>demoä¾‹å­</h2><p>ä¸‹é¢æ˜¯åˆ†æ babel,webpack ç¼–è¯‘åæ–‡ä»¶çš„å°ä¾‹å­ã€‚åé¢çš„å†…å®¹åŸºäºæ­¤demoåˆ†æã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;  </span><br><span class="line">  <span class="keyword">constructor</span>() &#123;  </span><br><span class="line"> </span><br><span class="line">  &#125;  </span><br><span class="line">  </span><br><span class="line">  a() &#123;  </span><br><span class="line">    alert(<span class="string">'b'</span>)  </span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'a'</span>)  </span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="åˆ†æbabel7ç¼–è¯‘åçš„æ–‡ä»¶"><a href="#åˆ†æbabel7ç¼–è¯‘åçš„æ–‡ä»¶" class="headerlink" title="åˆ†æbabel7ç¼–è¯‘åçš„æ–‡ä»¶"></a>åˆ†æbabel7ç¼–è¯‘åçš„æ–‡ä»¶</h2><p>ä¸‹é¢æ˜¯å¯¹ä¸Šé¢çš„ demo è¿›è¡Œ babel ç¼–è¯‘åçš„æ–‡ä»¶åšäº†ä¸€ä¸ªç®€å•çš„åˆ†æï¼Œçœ‹ä¸‹ä»–ä»¬åšäº†ä»€ä¹ˆäº‹æƒ…ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(exports, <span class="string">"__esModule"</span>, &#123;</span><br><span class="line">  value: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> _createClass = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">defineProperties</span>(<span class="params">target, props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; props.length; i++) &#123;</span><br><span class="line">      <span class="keyword">var</span> descriptor = props[i];</span><br><span class="line">      descriptor.enumerable = descriptor.enumerable || <span class="literal">false</span>;</span><br><span class="line">      descriptor.configurable = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="string">"value"</span> <span class="keyword">in</span> descriptor) descriptor.writable = <span class="literal">true</span>;</span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(target, descriptor.key, descriptor);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">Constructor, protoProps, staticProps</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (protoProps) defineProperties(Constructor.prototype, protoProps);</span><br><span class="line">    <span class="keyword">if</span> (staticProps) defineProperties(Constructor, staticProps);</span><br><span class="line">    <span class="keyword">return</span> Constructor;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_classCallCheck</span>(<span class="params">instance, Constructor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!(instance <span class="keyword">instanceof</span> Constructor)) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Cannot call a class as a function"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Test = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    _classCallCheck(<span class="keyword">this</span>, Test);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _createClass(Test, [&#123;</span><br><span class="line">    key: <span class="string">'a'</span>,</span><br><span class="line">    value: <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      alert(<span class="string">'b'</span>);</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'a'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> Test;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line">exports.default = Test;</span><br></pre></td></tr></table></figure>
<p>ä»ä¸‹é¢çš„ Test å¼€å§‹çœ‹ï¼Œå®šä¹‰äº†ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•° Test, Test å†…éƒ¨è°ƒç”¨äº† <code>_classCallCheck</code>, è¿™ä¸ªä¿è¯äº† ES æ¨¡å—ï¼Œåªèƒ½é€šè¿‡ new æ¥è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ­£ç¡®</span></span><br><span class="line"><span class="keyword">let</span> t = <span class="keyword">new</span> Test()</span><br><span class="line"><span class="comment">// é”™è¯¯</span></span><br><span class="line"><span class="keyword">let</span> t = Test()</span><br></pre></td></tr></table></figure>
<p>åé¢åˆæ‰§è¡Œäº† <code>_createClass</code>æ–¹æ³•ï¼ŒæŠŠå‡½æ•°çš„æ–¹æ³•ä»¥ <code>key, value</code> çš„å½¢å¼ä¼ ç»™ å‡½æ•°ä½“ï¼Œç„¶åå‡½æ•°å†…åˆ©ç”¨ <code>defineProperty</code>æ–¹æ³•ï¼Œç»™<code>Test</code>æ·»åŠ å±æ€§ã€‚ä½¿ç”¨ <code>defineProperty</code>çš„æ—¶å€™ï¼Œå®šä¹‰äº†<code>enumerable,configurable,writable</code>çš„å€¼ã€‚<strong>æ³¨æ„ <code>static</code> çš„æ–¹æ³•ï¼Œä¸èƒ½è¢«ç»§æ‰¿ï¼Œåªèƒ½ç”¨ç±»åæ¥è°ƒç”¨ï¼Œåº”è¯¥å†™åœ¨ <code>constructor</code> è€Œä¸æ˜¯ <code>constructor.prototype</code> ä¸Š</strong>ã€‚</p>
<p>æœ€åç›´æ¥æš´éœ²å‡ºäº† <code>default</code> æ–¹æ³•ã€‚<code>exports.default = Test;</code></p>
<p>å¦‚æœæˆ‘ä»¬ç›´æ¥è¿™ä¹ˆä½¿ç”¨çš„è¯ï¼Œè°ƒç”¨ Test æ–¹æ³•æ—¶å°±éœ€è¦è¿™ä¹ˆä½¿ç”¨<code>require(&#39;xxx&#39;).default</code>ï¼Œè¿™å½“ç„¶ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„ã€‚</p>
<p>æ‰€ä»¥å¯ä»¥åˆ©ç”¨æ’ä»¶<code>babel-plugin-add-module-exports</code>å°†<code>exports.default = Test</code>è½¬æ¢ä¸º<code>module.exports = exports.default</code> æˆ–è€… <code>export { _default as default };</code> (è¿™ä¸ªåœ¨babel6,babel7ä¹‹å‰æ˜¯ä¸éœ€è¦çš„ã€‚å¦‚æœä½ ä½¿ç”¨ babel6 or babel7 ä½ å¯ä»¥ä¼šä½¿ç”¨è¿™ä¸ªæ’ä»¶)ã€‚</p>
<p>babel é…ç½®ä¸º<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;  </span><br><span class="line">  <span class="string">"presets"</span>: [  </span><br><span class="line">    [<span class="string">"@babel/preset-env"</span>, &#123;  </span><br><span class="line">      <span class="string">"modules"</span>: <span class="literal">false</span></span><br><span class="line">  &#125;]  </span><br><span class="line">  ],  </span><br><span class="line">  <span class="string">"plugins"</span>: [  </span><br><span class="line">    <span class="string">"add-module-exports"</span>  </span><br><span class="line">  ]  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è‡³äºæ˜¯è½¬æ¢æˆ <code>module.exports = exports.default</code> è¿˜æ˜¯ <code>export { _default as default };</code> å–å†³ä¸æœ‰æ²¡æœ‰è®¾ç½® <code>module:false</code>ã€‚</p>
<p>è‹¥è®¾ç½®äº† <code>module:false</code> ï¼Œbabelä¸ä¼šè¿›è¡Œè½¬æ¢ es6 çš„ import, export ç­‰ã€‚äº¤ç»™åé¢çš„webpackæ¥å¤„ç†ã€‚æ‰€ä»¥ä¼šè½¬æ¢æˆ <code>{ _default as default };</code>ã€‚</p>
<p>è‹¥æ²¡æœ‰è®¾ç½®åˆ™ï¼Œbabelä¼šè½¬æˆ <code>module.exports = exports.default</code>, å› ä¸ºä¼šè®¤ä¸ºä½ è¦çš„æ˜¯çº¯çš„ ES5 è¯­æ³•ã€‚</p>
<p>æ³¨æ„babelï¼Œæœ‰ <code>loose: true, loose: false</code> ä¸¤ç§æ¨¡å¼ï¼Œåˆ†åˆ«è¡¨æ˜äº†ä½ æ˜¯è¦ç”¨ä¸Šé¢é‚£ç§ <code>_createClass</code> çš„å½¢å¼ç”Ÿæˆç¼–è¯‘æ–‡ä»¶ï¼Œè¿˜æ˜¯ä½¿ç”¨ <code>Test.prototype.xxx</code> è¿™ç§ç»§æ‰¿çš„æ¨¡å¼æ¥ç”Ÿæˆæ–‡ä»¶ã€‚å»ºè®®æ˜¯ä¸è¦ä½¿ç”¨ ä¸ä¸¥æ ¼æ¨¡å¼ã€‚</p>
<hr>
<h2 id="åˆ†æ-webpack-ç¼–è¯‘åçš„æ–‡ä»¶"><a href="#åˆ†æ-webpack-ç¼–è¯‘åçš„æ–‡ä»¶" class="headerlink" title="åˆ†æ webpack ç¼–è¯‘åçš„æ–‡ä»¶"></a>åˆ†æ webpack ç¼–è¯‘åçš„æ–‡ä»¶</h2><p>ä¸‹é¢æ˜¯åŒæ ·ä¸€ä¸ª demo è¢«webpackç¼–è¯‘åçš„å†…å®¹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">modules</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> installedModules = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (installedModules[moduleId]) &#123;</span><br><span class="line">      <span class="keyword">return</span> installedModules[moduleId].exports;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">module</span> = (installedModules[moduleId] = &#123;</span><br><span class="line">      i: moduleId,</span><br><span class="line">      l: <span class="literal">false</span>,</span><br><span class="line">      exports: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    modules[moduleId].call(</span><br><span class="line">      <span class="built_in">module</span>.exports,</span><br><span class="line">      <span class="built_in">module</span>,</span><br><span class="line">      <span class="built_in">module</span>.exports,</span><br><span class="line">      __webpack_require__</span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">module</span>.l = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">module</span>.exports;</span><br><span class="line">  &#125;</span><br><span class="line">  __webpack_require__.m = modules;</span><br><span class="line">  __webpack_require__.c = installedModules;</span><br><span class="line">  __webpack_require__.d = <span class="function"><span class="keyword">function</span>(<span class="params">exports, name, getter</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!__webpack_require__.o(exports, name)) &#123;</span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(exports, name, &#123;</span><br><span class="line">        enumerable: <span class="literal">true</span>,</span><br><span class="line">        get: getter</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  __webpack_require__.r = <span class="function"><span class="keyword">function</span>(<span class="params">exports</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Symbol</span> !== <span class="string">"undefined"</span> &amp;&amp; <span class="built_in">Symbol</span>.toStringTag) &#123;</span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(exports, <span class="built_in">Symbol</span>.toStringTag, &#123;</span><br><span class="line">        value: <span class="string">"Module"</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(exports, <span class="string">"__esModule"</span>, &#123;</span><br><span class="line">      value: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  __webpack_require__.t = <span class="function"><span class="keyword">function</span>(<span class="params">value, mode</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (mode &amp; <span class="number">1</span>) value = __webpack_require__(value);</span><br><span class="line">    <span class="keyword">if</span> (mode &amp; <span class="number">8</span>) <span class="keyword">return</span> value;</span><br><span class="line">    <span class="keyword">if</span> (mode &amp; <span class="number">4</span> &amp;&amp; <span class="keyword">typeof</span> value === <span class="string">"object"</span> &amp;&amp; value &amp;&amp; value.__esModule)</span><br><span class="line">      <span class="keyword">return</span> value;</span><br><span class="line">    <span class="keyword">var</span> ns = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">    __webpack_require__.r(ns);</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(ns, <span class="string">"default"</span>, &#123;</span><br><span class="line">      enumerable: <span class="literal">true</span>,</span><br><span class="line">      value: value</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">if</span> (mode &amp; <span class="number">2</span> &amp;&amp; <span class="keyword">typeof</span> value != <span class="string">"string"</span>)</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> value)</span><br><span class="line">        __webpack_require__.d(</span><br><span class="line">          ns,</span><br><span class="line">          key,</span><br><span class="line">          <span class="function"><span class="keyword">function</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> value[key];</span><br><span class="line">          &#125;.bind(<span class="literal">null</span>, key)</span><br><span class="line">        );</span><br><span class="line">    <span class="keyword">return</span> ns;</span><br><span class="line">  &#125;;</span><br><span class="line">  __webpack_require__.n = <span class="function"><span class="keyword">function</span>(<span class="params">module</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> getter =</span><br><span class="line">      <span class="built_in">module</span> &amp;&amp; <span class="built_in">module</span>.__esModule</span><br><span class="line">        ? <span class="function"><span class="keyword">function</span> <span class="title">getDefault</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">module</span>[<span class="string">"default"</span>];</span><br><span class="line">          &#125;</span><br><span class="line">        : <span class="function"><span class="keyword">function</span> <span class="title">getModuleExports</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">module</span>;</span><br><span class="line">          &#125;;</span><br><span class="line">    __webpack_require__.d(getter, <span class="string">"a"</span>, getter);</span><br><span class="line">    <span class="keyword">return</span> getter;</span><br><span class="line">  &#125;;</span><br><span class="line">  __webpack_require__.o = <span class="function"><span class="keyword">function</span>(<span class="params">object, property</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.hasOwnProperty.call(object, property);</span><br><span class="line">  &#125;;</span><br><span class="line">  __webpack_require__.p = <span class="string">""</span>;</span><br><span class="line">  <span class="keyword">return</span> __webpack_require__((__webpack_require__.s = <span class="string">"./class1.mjs"</span>));</span><br><span class="line">&#125;)(&#123;</span><br><span class="line">  <span class="string">"./class1.mjs"</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    __webpack_module__,</span></span></span><br><span class="line"><span class="function"><span class="params">    __webpack_exports__,</span></span></span><br><span class="line"><span class="function"><span class="params">    __webpack_require__</span></span></span><br><span class="line"><span class="function"><span class="params">  </span>) </span>&#123;</span><br><span class="line"><span class="meta">    "use strict"</span>;</span><br><span class="line">    __webpack_require__.r(__webpack_exports__);</span><br><span class="line">    __webpack_require__.d(__webpack_exports__, <span class="string">"default"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> Test;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">_classCallCheck</span>(<span class="params">instance, Constructor</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (!(instance <span class="keyword">instanceof</span> Constructor)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Cannot call a class as a function"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">_defineProperties</span>(<span class="params">target, props</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; props.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> descriptor = props[i];</span><br><span class="line">        descriptor.enumerable = descriptor.enumerable || <span class="literal">false</span>;</span><br><span class="line">        descriptor.configurable = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"value"</span> <span class="keyword">in</span> descriptor) descriptor.writable = <span class="literal">true</span>;</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(target, descriptor.key, descriptor);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">_createClass</span>(<span class="params">Constructor, protoProps, staticProps</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (protoProps) _defineProperties(Constructor.prototype, protoProps);</span><br><span class="line">      <span class="keyword">if</span> (staticProps) _defineProperties(Constructor, staticProps);</span><br><span class="line">      <span class="keyword">return</span> Constructor;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> Test = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">Test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        _classCallCheck(<span class="keyword">this</span>, Test);</span><br><span class="line">      &#125;</span><br><span class="line">      _createClass(Test, [</span><br><span class="line">        &#123;</span><br><span class="line">          key: <span class="string">"a"</span>,</span><br><span class="line">          value: <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            alert(<span class="string">"b"</span>);</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"a"</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]);</span><br><span class="line">      <span class="keyword">return</span> Test;</span><br><span class="line">    &#125;)();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°æ˜¾ç¤ºæºæ–‡ä»¶è¢«ç¼–è¯‘åè·Ÿä¸Šé¢çš„babelæ²¡æœ‰åŒºåˆ«ã€‚è¢«ç¼–è¯‘åçš„å†…å®¹ä½œä¸ºå‚æ•°<code>modules</code>å¸¦åˆ°äº†ç«‹å³æ‰§è¡Œå‡½æ•°é‡Œã€‚æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return __webpack_require__(__webpack_require__.s = &quot;./class1.mjs&quot;);</span><br></pre></td></tr></table></figure>
<p>webpack çš„æ ¸å¿ƒï¼Œå°±æ˜¯<code>__webpack_require</code> è¿™ä¸ªå‡½æ•°åšäº†ä»€ä¹ˆäº‹æƒ…ã€‚</p>
<ol>
<li>æ£€æŸ¥æ˜¯å¦æ¨¡å—å·²ç»ç¼“å­˜ï¼Œå¦‚æœå·²ç»ç¼“å­˜äº†åˆ™ç›´æ¥è¿”å›</li>
<li>å®šä¹‰æ¨¡å— module, <code>module</code> å†…æœ‰ä¸€ä¸ª<code>exports</code>å±æ€§</li>
<li>æ‰§è¡Œ<code>modules[moduleId].call</code>ï¼Œå®é™…ä¸Šå°±æ˜¯è°ƒç”¨äº†è¢«babelç¼–è¯‘åçš„æ¨¡å—ï¼Œå°† <code>module.exports</code>å¼•ç”¨èµ‹å€¼ç»™<code>__webpack_exports__</code></li>
<li>ç„¶åæ‰§è¡Œ<code>__webpack_require__.d(__webpack_exports__, &quot;default&quot;, function() { return Test; });</code>ï¼ŒæŠŠmodule.exportsä¸Šèµ‹å€¼ç»™ç›¸åº”çš„æ¨¡å—ã€‚</li>
<li><code>return __webpack_require__</code>åçš„ç»“æœå³ä¸ºå½“å‰åŠ è½½çš„æ¨¡å—ã€‚</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/******/</span> <span class="function"><span class="keyword">function</span> <span class="title">__webpack_require__</span>(<span class="params">moduleId</span>) </span>&#123;  </span><br><span class="line"><span class="comment">/******/</span>  </span><br><span class="line"><span class="comment">/******/</span>    <span class="comment">// Check if module is in cache  </span></span><br><span class="line"><span class="comment">/******/</span> <span class="keyword">if</span>(installedModules[moduleId]) &#123;  </span><br><span class="line"><span class="comment">/******/</span> 	<span class="keyword">return</span> installedModules[moduleId].exports;  </span><br><span class="line"><span class="comment">/******/</span> &#125;  </span><br><span class="line"><span class="comment">/******/</span>    <span class="comment">// Create a new module (and put it into the cache)  </span></span><br><span class="line"><span class="comment">/******/</span> <span class="keyword">var</span> <span class="built_in">module</span> = installedModules[moduleId] = &#123;  </span><br><span class="line"><span class="comment">/******/</span> 	i: moduleId,  </span><br><span class="line"><span class="comment">/******/</span> 	l: <span class="literal">false</span>,  </span><br><span class="line"><span class="comment">/******/</span> 	exports: &#123;&#125;  </span><br><span class="line"><span class="comment">/******/</span> &#125;;  </span><br><span class="line"><span class="comment">/******/</span>  </span><br><span class="line"><span class="comment">/******/</span>    <span class="comment">// Execute the module function  </span></span><br><span class="line"><span class="comment">/******/</span> modules[moduleId].call(<span class="built_in">module</span>.exports, <span class="built_in">module</span>, <span class="built_in">module</span>.exports, __webpack_require__);  </span><br><span class="line"><span class="comment">/******/</span>  </span><br><span class="line"><span class="comment">/******/</span>    <span class="comment">// Flag the module as loaded  </span></span><br><span class="line"><span class="comment">/******/</span> <span class="built_in">module</span>.l = <span class="literal">true</span>;  </span><br><span class="line"><span class="comment">/******/</span>  </span><br><span class="line"><span class="comment">/******/</span>    <span class="comment">// Return the exports of the module  </span></span><br><span class="line"><span class="comment">/******/</span> <span class="keyword">return</span> <span class="built_in">module</span>.exports;  </span><br><span class="line"><span class="comment">/******/</span> &#125;</span><br></pre></td></tr></table></figure>
<p>ä»åˆšåˆšçš„åˆ†æä¸­å¯ä»¥å¾—åˆ°ï¼š</p>
<p><strong>webpack ç¼–è¯‘åçš„æ–‡ä»¶æ˜¯ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œå¹¶æ²¡æœ‰æš´éœ²å‡ºä»€ä¹ˆå†…å®¹ï¼Œå¦‚æœç›´æ¥copyåˆ°æµè§ˆå™¨é‡Œï¼Œæ˜¯ä¸€ä¸ª Module å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯å¹¶æ²¡æœ‰èµ‹å€¼ç»™ä»»ä½•å€¼å¦‚ window, module.exports, exports ,ä½œç”¨åŸŸåªåœ¨å½“å‰ã€‚å› æ­¤è§£é‡Šäº†ä¸ºä»€ä¹ˆ webpack è¢«ç¼–è¯‘åçš„æ–‡ä»¶æ²¡åŠæ³•ç›´æ¥è¢«<code>import æˆ–è€… require</code></strong>ã€‚</p>
<p>é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œå¯ä»¥åœ¨webpackä¸­è®¾ç½®ï¼š<code>libraryTarget: &#39;xxx&#39;</code>ï¼Œ ç”¨æ¥æŠŠæœ€åå¾—åˆ°çš„å†…å®¹ï¼Œæš´éœ²å‡ºå»ã€‚å¦‚è‹¥å€¼ä¸º <code>commonjs2</code>åˆ™ä¼šæ˜¯æœ€å¤–é¢ä¼šåŠ ä¸Š <code>module.exports</code>, è‹¥å€¼ä¸º <code>commonjs</code>ä¼šæœ€ç»ˆéƒ½ä¸º <code>exports</code>, è‹¥å€¼ä¸º <code>var</code>åˆ™æ˜¯åœ¨windowä¸Šå¯ä»¥ä½¿ç”¨ã€‚è¿˜æœ‰å…¶ä»–çš„å€¼ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚</p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¹‹æ‰€ä»¥ä¼šå‡ºè¿™ç¯‡æ–‡ç« ï¼Œæ˜¯å› ä¸ºæœ€è¿‘åœ¨ä¼˜åŒ–ç»„é‡Œçš„ä¸€äº›å…¬å…±ç»„ä»¶ï¼Œä¼˜åŒ–è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œæœ€åå‘ç°å…¶å®è¿˜æ˜¯å¯¹è¿™äº›æ¬ ç¼ºä¸€äº›äº†è§£ã€‚ä¸æ€»ç»“å‡ºæ¥ï¼Œæ€•æ˜¯å¯¹ä¸èµ·è‡ªå·±è¿™å‡ å¤©çš„çº ç»“ã€‚ğŸ“šğŸŒ²</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;babel6&lt;/code&gt; æˆ– &lt;code&gt;babel7&lt;/code&gt; åï¼Œå¯ä»¥ä½¿ç”¨&lt;code&gt;babel-plugin-add-module-exports&lt;/code&gt;æ’ä»¶ï¼Œè§£å†³ &lt;code&gt;require(xxx
    
    </summary>
    
    
      <category term="å·¥å…·/é…ç½®" scheme="http://sevencai.github.io/tags/%E5%B7%A5%E5%85%B7-%E9%85%8D%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³ IOS å¾®ä¿¡æŸäº›ç‰ˆæœ¬ä¸‹é”®ç›˜æ”¶èµ·é¡µé¢ä¸ºä¸‹ç§»å¯¼è‡´ç‚¹å‡»äº‹ä»¶å¤±æ•ˆé—®é¢˜</title>
    <link href="http://sevencai.github.io/2019/03/01/%E8%A7%A3%E5%86%B3-IOS-%E5%BE%AE%E4%BF%A1%E6%9F%90%E4%BA%9B%E7%89%88%E6%9C%AC%E4%B8%8B%E9%94%AE%E7%9B%98%E6%94%B6%E8%B5%B7%E9%A1%B5%E9%9D%A2%E4%B8%BA%E4%B8%8B%E7%A7%BB%E5%AF%BC%E8%87%B4%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%A4%B1%E6%95%88%E9%97%AE%E9%A2%98/"/>
    <id>http://sevencai.github.io/2019/03/01/è§£å†³-IOS-å¾®ä¿¡æŸäº›ç‰ˆæœ¬ä¸‹é”®ç›˜æ”¶èµ·é¡µé¢ä¸ºä¸‹ç§»å¯¼è‡´ç‚¹å‡»äº‹ä»¶å¤±æ•ˆé—®é¢˜/</id>
    <published>2019-03-01T03:30:36.000Z</published>
    <updated>2019-03-01T03:43:11.000Z</updated>
    
    <content type="html"><![CDATA[<p>æŸå¤©å‘ç°äº†ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡ã€‚</p>
<p>ä¸€èˆ¬æˆ‘ä»¬ä¼šåœ¨ç‚¹å‡»æ”¯ä»˜çš„æ—¶å€™ï¼Œå¼¹å‡ºä¸€ä¸ªæ¨¡æ€æ¡†ï¼Œè®©ç”¨æˆ·é€‰æ‹©æ”¯ä»˜æ¸ é“ã€‚</p>
<p>çªç„¶å‘ç°æŸä¸ªIOSå¾®ä¿¡æ‰‹æœºä¸Šï¼Œå½“ç‚¹å‡»è¾“å…¥é‡‘é¢åï¼Œç”¨æˆ·ç‚¹å‡»æ”¯ä»˜ï¼Œå¼¹çª—å‡ºç°åï¼Œ<strong>æ— æ³•ç‚¹å‡»ä¸­å¼¹çª—ä¸Šçš„æ¸ é“ã€‚ä½†æ˜¯å´èƒ½åœ¨éå¼¹çª—æ‰€åœ¨çš„ç©ºç™½åœ°æ–¹ï¼Œé€‰ä¸­æœ‰åé¦ˆã€‚è¿™ç§æ„Ÿè§‰å°±åƒdomæ˜¾ç¤ºçš„åœ°æ–¹å’ŒdomçœŸå®çš„åœ°æ–¹åˆ†ç¦»äº†ä¸€æ ·è¯¡å¼‚ã€‚</strong>å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="example.png" alt="ç¤ºä¾‹å›¾-ï¼ˆå¾®ä¿¡é’±åŒ…-&gt;QB-&gt;å®˜æ–¹æ¸ é“å®‰å…¨åˆæ”¾å¿ƒï¼‰"><br>æˆ‘ä»¬çŸ¥é“ IOS æœ‰ä¸ªå¾ˆå¥½çš„ä¼˜åŒ–ï¼Œå°±æ˜¯å½“ç”¨æˆ·æ‰‹åŠ¨è¾“å…¥è¾“å…¥æ¡†æ—¶ï¼ŒIOSä¼šè‡ªå·±æŠŠè¾“å…¥æ¡†å¼¹ä¸Šæ¥ï¼Œæ¥ç¡®ä¿è¾“å…¥æ¡†ä¸€å®šåœ¨å¯è§†æ¡†å†…ï¼ŒAndroid æ²¡æœ‰è¿™ä¸ªä¼˜åŒ–ï¼Œä»¥å‰æˆ‘ä»¬è¿˜ç»å¸¸å¯¹å®‰å“åšè¿™ç§ä¼˜åŒ–ã€‚</p>
<p>åæ¥å‘ç°ç¡®å®æ˜¯è¿™ä¸ªä¼˜åŒ–å¯¼è‡´äº†<strong>ã€å¼¹çª—è™½ç„¶æ¢å¤æ­£å¸¸äº†ï¼Œä½†æ˜¯bodyè¿˜æ˜¯åœ¨é”®ç›˜å¼¹ä¸Šå»çš„ä½ç½®ã€‘</strong>ï¼Œ æ˜¯ç”±äº IOS ä¸‹çš„æ¸²æŸ“é—®é¢˜å¯¼è‡´çš„ï¼Œå½“é”®ç›˜å¼¹ä¸‹æ¥çš„æ—¶å€™ï¼Œå¼¹çª—ä¸‹çš„bodyæ²¡æœ‰è§¦å‘é‡ç»˜ã€‚</p>
<p>æ‰€ä»¥é—®é¢˜å˜æˆäº†ç®€å•çš„ï¼Œæ€ä¹ˆè®©é”®ç›˜ä¸‹å»çš„æ—¶å€™ï¼Œbodyèƒ½å¤Ÿé‡ç»˜ã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆæƒ³åˆ°çš„æ˜¯ï¼Œ<strong>é”®ç›˜æ”¶èµ·çš„æ—¶å€™ï¼Œresize äº‹ä»¶åº”è¯¥ä¼šè§¦å‘</strong>ï¼Œè¯•ç€åœ¨ resize ä¸­åšå¤„ç†ï¼Œç»“æœå‘ç°ï¼ŒIOSä¸‹ç«Ÿç„¶ä¸ä¼šè§¦å‘ resize, ä¹Ÿå°±æ˜¯ IOS ä¸‹ï¼Œ<strong>å½“é”®ç›˜æ”¶èµ·çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šæ”¹å˜è§†çª—çš„å¤§å°ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸ä¼šè§¦å‘ resize äº‹ä»¶</strong>ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¦‚æœä½ çš„ body æœ¬æ¥æ˜¯ 100% é«˜åº¦çš„ï¼Œè¢«é”®ç›˜å¼¹ä¸Šå»åï¼Œå¯èƒ½å˜æˆ 120%ï¼Œ ä½ çš„bodyç«Ÿç„¶å¯ä»¥æ»šåŠ¨äº†ã€‚è€Œä¸”ä¸‹é¢æ²¡æœ‰å†…å®¹ï¼Œè¿˜æ˜¯ç™½è‰²çš„ç©ºç™½åŒºåŸŸã€‚<strong>å®‰å“ä¸Šé”®ç›˜æ”¶èµ·æ—¶è§†çª—å¤§å°ä¼šæ”¹å˜ï¼Œæ‰€ä»¥ä¼šè§¦å‘ resize äº‹ä»¶ï¼Œå› æ­¤ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜</strong>ã€‚</p>
<p><code>resize</code> èµ°ä¸é€šï¼Œé‚£æ€ä¹ˆè®©å®ƒè§¦å‘é‡ç»˜å‘¢ï¼Ÿæƒ³åˆ° <code>IOS</code> ä¸‹ï¼Œå½“é”®ç›˜æ”¶èµ·çš„æ—¶å€™ï¼Œ<code>input</code>ä¸ä¼šè¢« <code>focus</code> äº†ï¼ˆå¯ä»¥çœ‹åˆ°å…‰æ ‡æ¶ˆå¤±äº†ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´å¾ˆæœ‰å¯èƒ½è§¦å‘ <code>blur</code> äº‹ä»¶ã€‚ç»è¿‡è¯å®ï¼Œç¡®å®æ˜¯è§¦å‘äº† blurã€‚æ‰€ä»¥ç¡®å®šå»è§¦å‘é‡ç»˜çš„æ—¶æœºå°±æ˜¯ <code>blur</code> æ—¶ã€‚</p>
<p>ç°åœ¨çš„é—®é¢˜å°±æ˜¯é‡ç»˜è¦æ€ä¹ˆå†™å‘¢ï¼Ÿ ä»¥å‰åœ¨ IOS ä¸Šé‡åˆ°äº†å¾ˆå¤šæ¸²æŸ“çš„å‘ï¼Œç»éªŒå‘Šè¯‰æˆ‘ï¼Œåªè¦è®©é¡µé¢ã€åŠ¨ä¸€ä¸‹ã€‘å°±å¯ä»¥äº†ã€‚æ¯”å¦‚è®©é¡µé¢ <code>scrollTop = 0</code>, æˆ–è€…å† <code>focus</code> ä¸€ä¸‹ï¼Œæˆ–è€… <code>click touch</code>ä¸€ä¸‹ä¹‹ç±»çš„ã€‚</p>
<p>è¿™é‡Œä¸ºäº†è®©é¡µé¢ä¸ä¼šç”±äº <code>scrollTop = 0</code> çªç„¶å¾€ä¸Šä¸€ä¸‹ï¼Œå°±å¯ä»¥è®¾ç½® <code>scrollTop = scrollTop</code> ä¹Ÿå¯ä»¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;input @blur=fixbug/&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// fixbug</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.userAgent.iOS) &#123;</span><br><span class="line">   <span class="built_in">document</span>.body &amp;&amp; (<span class="built_in">document</span>.body.scrollTop = <span class="built_in">document</span>.body.scrollTop)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ç§åªèƒ½åœ¨å•ä¸€çš„inputä¸Šåšå¤„ç†ä¸å¤ªå¥½ã€‚å¦‚æœè¦åœ¨æ‰€æœ‰ input ä¸Šéƒ½ç”Ÿæ•ˆå¯ä»¥ç›‘å¬åœ¨<code>document</code>ä¸Šã€‚è¿™æ—¶å€™ï¼Œåªéœ€è¦åˆ¤æ–­ä¸‹æ˜¯ä¸æ˜¯ <code>input</code> æˆ–è€… <code>textarea</code> å…ƒç´ å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è‡ªè¡Œå®ç°æ˜¯å¦æ˜¯ iOS çš„åˆ¤æ–­ï¼Œä¸€èˆ¬æŠŠ ipad,ipod, iphone è·Ÿ navigagor.userAgent indexOf ä¸€ä¸‹å°±è¡Œ</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.userAgent.iOS) &#123;</span><br><span class="line">  <span class="built_in">document</span>.addEventListener(<span class="string">'blur'</span>, e =&gt; &#123;</span><br><span class="line">    [<span class="string">'input'</span>, <span class="string">'textarea'</span>].indexOf(e.target.localName) ï¼== <span class="number">-1</span> &amp;&amp; (<span class="built_in">document</span>.body.scrollTop = <span class="built_in">document</span>.body.scrollTop)</span><br><span class="line">  &#125;, <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œå‘ç°ä¹Ÿæœ‰äººç¢°åˆ°äº†ç±»ä¼¼çš„é—®é¢˜ï¼Œä»–ä»¬æ˜¯ç”¨çš„ <code>scrollIntoView</code>ï¼Œæˆ‘è§‰å¾—ä¹ŸæŒºå¥½çš„ã€‚ä½†æ˜¯ä¸ä¹…ä¹‹å‰ï¼Œæœ‰åŒäº‹åœ¨ IOS 11 ä¸ŠæŸä¸ªç‰ˆæœ¬çš„æ—¶å€™ï¼Œç”¨ <code>scrollIntoView</code>ä¼šé‡åˆ°é¡µé¢å¡ä½æ»‘ä¸åŠ¨çš„æƒ…å†µï¼Œå¹¶ä¸”åªåœ¨IOS11ä¸Šçš„æŸä¸ªå°ç‰ˆæœ¬å‡ºç°ï¼Œæ‹…å¿ƒå®ƒè¿˜ä¼šæœ‰åŒæ ·çš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆè¿˜æ˜¯ä½¿ç”¨äº† <code>document.body.scrollTop</code> æ¥è§£å†³ã€‚</p>
<p>ä»–ä»¬çš„ä»£ç å¦‚ä¸‹ï¼Œæˆ‘ä¹Ÿæƒ³è®°å½•ä¸‹æ¥æ—¥åå‚è€ƒï¼Œéƒ½å¤§åŒå°å¼‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;(/iphone|ipod|ipad/i.test(navigator.appVersion)) &amp;&amp; document.addEventListener(&apos;blur&apos;, (e) =&gt; &#123; &apos;input&apos;, &apos;textarea&apos;].includes(e.target.localName) &amp;&amp; document.body.scrollIntoView(false) &#125;, true)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ‰çš„æ—¶å€™æƒ³æƒ³åšå‰ç«¯çœŸçš„æ˜¯ä»¶ä¸å®¹æ˜“çš„äº‹æƒ…ï¼Œå°¤å…¶æ˜¯è¦è·Ÿæµè§ˆå™¨æ‰“äº¤é“çš„æ—¶å€™ï¼Œçªç„¶æŸå¤©ä½ å¯èƒ½å‘ç°ä¹‹å‰è·‘çš„å¥½å¥½çš„ç‰ˆæœ¬ï¼Œæ€ä¹ˆçªç„¶é—´å‡ºé—®é¢˜äº†ï¼Œä½ ä¼šå…ˆæ€€ç–‘è‡ªå·±ï¼Œå†å»æ‰¾é—®é¢˜ï¼Œå†å»å¤ç°é—®é¢˜ï¼Œå†å»æƒ³æ€ä¹ˆ hackã€‚å…³é”®æ˜¯æœ‰çš„æ—¶å€™ä½ çŸ¥é“äº†æ€ä¹ˆhack,æœ‰å¯èƒ½è¿˜æ˜¯ä¸çŸ¥é“æ˜¯è°çš„bug,ä¸ºä»€ä¹ˆä¼šè¿™æ ·ã€‚å¤ªå¤šå¤–ç•Œå› ç´ ï¼ˆåº”ç”¨ï¼Œç³»ç»Ÿï¼‰å½±å“ä½ çš„åˆ¤æ–­ï¼Œå¹¶ä¸”ä½ å¯èƒ½æ¯”è¾ƒéš¾å»å¹²é¢„æˆ–è€…å»å‘Šè¯‰ä»–ä½ è¿™é‡Œæœ‰bugã€‚ğŸŒ¹</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æŸå¤©å‘ç°äº†ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬æˆ‘ä»¬ä¼šåœ¨ç‚¹å‡»æ”¯ä»˜çš„æ—¶å€™ï¼Œå¼¹å‡ºä¸€ä¸ªæ¨¡æ€æ¡†ï¼Œè®©ç”¨æˆ·é€‰æ‹©æ”¯ä»˜æ¸ é“ã€‚&lt;/p&gt;
&lt;p&gt;çªç„¶å‘ç°æŸä¸ªIOSå¾®ä¿¡æ‰‹æœºä¸Šï¼Œå½“ç‚¹å‡»è¾“å…¥é‡‘é¢åï¼Œç”¨æˆ·ç‚¹å‡»æ”¯ä»˜ï¼Œå¼¹çª—å‡ºç°åï¼Œ&lt;strong&gt;æ— æ³•ç‚¹å‡»ä¸­å¼¹çª—ä¸Šçš„æ¸ é“ã€‚ä½†æ˜¯å´èƒ½åœ¨éå¼¹çª—æ‰€åœ¨çš„ç©ºç™½åœ°æ–¹ï¼Œé€‰ä¸­æœ‰
    
    </summary>
    
    
      <category term="Javascript" scheme="http://sevencai.github.io/tags/Javascript/"/>
    
  </entry>
  
  <entry>
    <title>webpack ç¼–è¯‘ç›®å½•åŸæ ·è¾“å‡ºåŠwebpack4 treeshakingå°ç»“</title>
    <link href="http://sevencai.github.io/2019/02/22/webpack-%E7%BC%96%E8%AF%91%E7%9B%AE%E5%BD%95%E5%8E%9F%E6%A0%B7%E8%BE%93%E5%87%BA%E5%8F%8Awebpack4-treeshaking%E5%B0%8F%E7%BB%93/"/>
    <id>http://sevencai.github.io/2019/02/22/webpack-ç¼–è¯‘ç›®å½•åŸæ ·è¾“å‡ºåŠwebpack4-treeshakingå°ç»“/</id>
    <published>2019-02-22T12:16:03.000Z</published>
    <updated>2019-04-17T13:05:16.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æœ¬æ–‡ä¸»è¦è®°å½•ä¸¤ç‚¹</p>
<ol>
<li><p>å¦‚ä½•åœ¨webpackä¸­ç¼–è¯‘ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶å¹¶ä¸”æŒ‰ç…§ã€åŸç›®å½•ã€‘è¾“å‡ºã€‚</p>
</li>
<li><p>æ€»ç»“åœ¨webpack ä¸­ä½¿ç”¨ treeshaking çš„æ¡ä»¶ã€‚</p>
</li>
</ol>
</blockquote>
<hr>
<h2 id="webpack-ç¼–è¯‘æ–‡ä»¶ç›®å½•å¹¶åŸæ ·è¾“å‡º"><a href="#webpack-ç¼–è¯‘æ–‡ä»¶ç›®å½•å¹¶åŸæ ·è¾“å‡º" class="headerlink" title="webpack ç¼–è¯‘æ–‡ä»¶ç›®å½•å¹¶åŸæ ·è¾“å‡º"></a>webpack ç¼–è¯‘æ–‡ä»¶ç›®å½•å¹¶åŸæ ·è¾“å‡º</h2><p><strong>åœºæ™¯æ˜¯éœ€è¦ç¼–è¯‘ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰jsæ–‡ä»¶ï¼Œå¹¶ä¸”æŠŠè¿™äº›jsæ–‡ä»¶éƒ½æŒ‰ç…§ã€åŸæ¥çš„ç›®å½•ç»“æ„ã€‘è¾“å‡ºã€‚</strong></p>
<p>é¦–å…ˆç¼–è¯‘ä¸€ä¸ªæ–‡ä»¶å¤¹çš„æ‰€æœ‰jsæ–‡ä»¶ï¼Œæ¯”è¾ƒå¥½åšã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>glob</code>æ¥è·å–ç›®å½•ä¸‹çš„æ‰€æœ‰jsæ–‡ä»¶ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Webpack babel transform config  </span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;  </span><br><span class="line">  entry: glob.sync(<span class="string">"./src/**/*.js"</span>),  </span><br><span class="line">  </span><br><span class="line">  mode: <span class="string">"production"</span>,  </span><br><span class="line">  </span><br><span class="line">  output: &#123;  </span><br><span class="line">	filename: <span class="string">'[name].js'</span>,  </span><br><span class="line">	path: path.resolve(__dirname, <span class="string">'./'</span>)  </span><br><span class="line">  &#125;,  </span><br><span class="line">  <span class="comment">// .....  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬åƒå¦‚ä¸Šè¿™ä¹ˆå†™ï¼Œä¼šç›´æ¥è¾“å‡ºä¸€ä¸ª main.js æ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯æ‰€æœ‰è¢«ç¼–è¯‘çš„æ–‡ä»¶éƒ½ä¼šåœ¨åŒæ ·çš„ä¸€ä¸ªæ–‡ä»¶ä¸­è¾“å‡ºã€‚è¿™ä¸æ˜¯æˆ‘æƒ³è¦çš„ï¼Œæˆ‘æƒ³è¦çš„æ˜¯ã€æ¯ä¸ªæ–‡ä»¶å•ç‹¬ç¼–è¯‘ï¼Œå¹¶åŸæ ·ç›®å½•è¾“å‡ºã€‘ã€‚</p>
<p>æŸ¥æ‰¾äº†ä¸‹ <code>webpack</code> æ²¡æœ‰ç›¸å…³çš„é…ç½®, å¦‚æœæˆ‘ä»¬è¦è¾“å‡º<code>module/a/index.js</code>åœ¨ <code>dist/module/a/</code>ç›®å½•ä¸‹ã€‚æˆ‘ä»¬å†å†™ entry æ—¶å°±å¯ä»¥è¿™ä¹ˆå†™:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">entry: &#123;</span><br><span class="line">    <span class="string">'module/a/index'</span>: <span class="string">'module/a/index.js'</span>,</span><br><span class="line">    <span class="string">'module/b/index'</span>: <span class="string">'module/b/index.js'</span>,</span><br><span class="line">&#125;,</span><br><span class="line">output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name].js'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ‰€ä»¥ä¸ºäº†åŠ¨æ€å»è¾“å‡ºåˆ°ç›¸åº”çš„ç›®å½•ï¼Œæˆ‘ä»¬åªéœ€è¦å»æ‰¾åˆ°å¯¹åº”çš„entryå³å¯ã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³è¦åŸæ ·è¾“å‡ºç¼–è¯‘åçš„ src ç›®å½•ä¸‹çš„æ–‡ä»¶, å…ˆç”¨ æ­£åˆ™åŒ¹é…åˆ° å¯¹åº”çš„è·¯å¾„ã€‚ç„¶åå†æ˜ å°„åˆ°entryä¸Šå³å¯ã€‚ä¸»è¦æ˜¯å®ç°ï¼š<br><code>./src/lib/a.js =&gt; ./lib/a.js</code>çš„mapã€‚ç®€å•ç‚¹çš„demoå¯èƒ½å¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> glob = <span class="built_in">require</span>(<span class="string">'glob'</span>)  </span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)  </span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)  </span><br><span class="line"><span class="keyword">const</span> CleanWebpackPlugin = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment">// Get all file entries  </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getEntries</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">  <span class="keyword">let</span> map = &#123;&#125;  </span><br><span class="line">  <span class="keyword">const</span> entryFiles = glob.sync(<span class="string">"./src/**/*.js"</span>)  </span><br><span class="line">  </span><br><span class="line">  entryFiles.forEach(<span class="function"><span class="params">filepath</span> =&gt;</span> &#123;  </span><br><span class="line">    <span class="keyword">let</span> fileDir = <span class="regexp">/.\/src\/(.*?)\.js/</span>.exec(filepath)  </span><br><span class="line">  </span><br><span class="line">    map[fileDir[<span class="number">1</span>]] = filepath  </span><br><span class="line">  &#125;)  </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> map  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Webpack babel transform config  </span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;  </span><br><span class="line">  entry: getEntries(),  </span><br><span class="line">  </span><br><span class="line">  mode: <span class="string">"production"</span>,  </span><br><span class="line">  </span><br><span class="line">  output: &#123;  </span><br><span class="line">    filename: <span class="string">'[name].js'</span>,  </span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'./'</span>)  </span><br><span class="line">  &#125;,  </span><br><span class="line">  </span><br><span class="line">  <span class="built_in">module</span>: &#123;  </span><br><span class="line">    rules: [  </span><br><span class="line">      &#123;  </span><br><span class="line">        test: <span class="regexp">/\.js/</span>,  </span><br><span class="line">        loader: <span class="string">'babel-loader'</span>,  </span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>  </span><br><span class="line">      &#125;  </span><br><span class="line">    ]  </span><br><span class="line">  &#125;,  </span><br><span class="line">  </span><br><span class="line">  plugins: [  </span><br><span class="line">    <span class="keyword">new</span> CleanWebpackPlugin([<span class="string">'lib'</span>]),  </span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123; <span class="string">"process.env.NODE_ENV"</span>: <span class="built_in">JSON</span>.stringify(<span class="string">"production"</span>) &#125;)  </span><br><span class="line">  ]  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="webpack-çš„-treeshaking-æ¡ä»¶"><a href="#webpack-çš„-treeshaking-æ¡ä»¶" class="headerlink" title="webpack çš„ treeshaking æ¡ä»¶"></a>webpack çš„ treeshaking æ¡ä»¶</h2><p>webpack2 çš„ treeshaking ä¸€èˆ¬æˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°ã€‚æœ€è¿‘æœ‰æµè§ˆäº†ç±»ä¼¼çš„æ–‡ç« ï¼Œæ€»ç»“ä¸‹ï¼ˆä¸‹é¢æ˜¯ä½¿ç”¨webpack4çš„ç›¸å…³é…ç½®ï¼‰ï¼š</p>
<p><img src="treeshaking.png" alt="æ–‡æ¡£æˆªå›¾"></p>
<p>ä¹Ÿå°±æ˜¯è¯´å¿…é¡»å¾—</p>
<p>ä½¿ç”¨ treeshake å‡å°‘æ–‡ä»¶ä½“ç§¯çš„4ä¸ªæ¡ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-   ä½¿ç”¨ ES2015 æ¨¡å—è¯­æ³•ï¼ˆå³  `import`  å’Œ  `export`ï¼‰ã€‚</span><br><span class="line">-   åœ¨é¡¹ç›®  `package.json`  æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä¸€ä¸ª &quot;sideEffects&quot; å±æ€§ã€‚</span><br><span class="line">-   ä¸èƒ½æŠŠ ES6 æ¨¡å—ç”¨ babel å…ˆè½¬æ¢æˆ CommonJs, åœ¨`@babel/preset-env`ä¸­ï¼Œè¿™æ˜¯ä¸ªé»˜è®¤è¡Œä¸ºï¼Œéœ€è¦è®¾ç½® `module: false`ç¦ç”¨æ‰ã€‚å…ˆç¼–è¯‘æˆ CommonJs åwebpackå°±æ— æ³•åˆ†æä¾èµ–äº†ã€‚</span><br><span class="line">-   webpack4ä¸­è®¾ç½® mode: productionï¼Œè‡ªåŠ¨å¼€å¯å‹ç¼©, å¦‚æœæ˜¯éwebpack4,åˆ™éœ€è¦å¼•å…¥ä¸€ä¸ªèƒ½å¤Ÿåˆ é™¤æœªå¼•ç”¨ä»£ç (dead code)çš„å‹ç¼©å·¥å…·(minifier)ï¼ˆä¾‹å¦‚  `UglifyJSPlugin`ï¼‰ã€‚</span><br></pre></td></tr></table></figure>
<p>è®¾ç½® module ä¸º false çš„åŸå› å¼•ç”¨å¦‚ä¸‹ï¼š</p>
<blockquote>
<h3 id="modules"><a href="#modules" class="headerlink" title="modules"></a><code>modules</code></h3><p><code>&quot;amd&quot; | &quot;umd&quot; | &quot;systemjs&quot; | &quot;commonjs&quot; | &quot;cjs&quot; | &quot;auto&quot; | false</code>, defaults to  <code>&quot;auto&quot;</code>.<br>Enable transformation of ES6 module syntax to another module type.<br>Setting this to  <code>false</code>  will not transform modules.</p>
</blockquote>
<p>é”™è¯¯ç¤ºèŒƒï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">exports.a = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'a'</span>)    </span><br><span class="line">&#125;    </span><br><span class="line">  </span><br><span class="line">exports.b = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'b'</span>)    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">'./a.js'</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment">// é”™è¯¯ï¼Œéœ€è¦ç”¨ import ,export ES6è¯­æ³• æ‰èƒ½ treeshake</span></span><br><span class="line">api.a()</span><br></pre></td></tr></table></figure></p>
<p>æ­£ç¡®ç¤ºèŒƒï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'a'</span>)  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'b'</span>)  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;a&#125; <span class="keyword">from</span> <span class="string">'./a.js'</span>  </span><br><span class="line">a()</span><br></pre></td></tr></table></figure></p>
<p>ç®€å•ç‚¹çš„ç¤ºä¾‹demo:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js  </span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)  </span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)  </span><br><span class="line"><span class="keyword">const</span> UglifyJSPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">module</span>.exports = &#123;  </span><br><span class="line">  entry: <span class="string">'./test.mjs'</span>,  </span><br><span class="line">  </span><br><span class="line">  mode: <span class="string">"production"</span>,  </span><br><span class="line">  </span><br><span class="line">  output: &#123;  </span><br><span class="line">    filename: <span class="string">'index.js'</span>,  </span><br><span class="line">	path: path.resolve(__dirname, <span class="string">'./dist'</span>)  </span><br><span class="line">  &#125;,  </span><br><span class="line">  </span><br><span class="line">  <span class="built_in">module</span>: &#123;  </span><br><span class="line">    rules: [  </span><br><span class="line">      &#123;  </span><br><span class="line">        test: <span class="regexp">/\.js/</span>,  </span><br><span class="line">        loader: <span class="string">'babel-loader'</span>,  </span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>  </span><br><span class="line">      &#125;  </span><br><span class="line">    ]  </span><br><span class="line">  &#125;,  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">// å½“ mode ä¸º development æ—¶ï¼Œéœ€è¦å¼€å¯ä¸‹é¢çš„ä»£ç ã€‚æ‰èƒ½çœ‹åˆ°`treeshaking`</span></span><br><span class="line">  <span class="comment">// å½“ mode ä¸º production æ—¶ï¼Œä¸éœ€è¦</span></span><br><span class="line">  optimization: &#123;  </span><br><span class="line">    usedExports: <span class="literal">true</span></span><br><span class="line">  &#125;,  </span><br><span class="line">  </span><br><span class="line">  plugins: [  </span><br><span class="line">    <span class="keyword">new</span> webpack.LoaderOptionsPlugin(&#123;  </span><br><span class="line">      minimize: <span class="literal">true</span>,  </span><br><span class="line">      debug: <span class="literal">false</span>  </span><br><span class="line">  &#125;),  </span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123; <span class="string">"process.env.NODE_ENV"</span>: <span class="built_in">JSON</span>.stringify(<span class="string">"production"</span>) &#125;)  </span><br><span class="line">  ]  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="sideEffectsæ€ä¹ˆç†è§£ï¼Ÿ"><a href="#sideEffectsæ€ä¹ˆç†è§£ï¼Ÿ" class="headerlink" title="sideEffectsæ€ä¹ˆç†è§£ï¼Ÿ"></a>sideEffectsæ€ä¹ˆç†è§£ï¼Ÿ</h2><p>sideEffects è¿™ä¸ªä¼°è®¡å†èŠ±ä¸€ä¸ªæ–‡ç« ä¹Ÿè®²ä¸å®Œã€‚å¤§æ¦‚çš„è¡¨è¾¾ä¸‹æ˜¯ï¼š</p>
<p>å¾ˆå¤šæ—¶å€™åœ¨è½¬æ¢ä»£ç åï¼Œæˆ‘ä»¬çš„ä»£ç ä¼šç”±äºè¢«ç¼–è¯‘è€Œäº§ç”Ÿå‰¯ä½œç”¨ï¼Œæ¯”å¦‚ä½ å¯¹ä¸€ä¸ªå‡½æ•°ä½¿ç”¨äº† location.href æˆ–è€… window ä¸ŠåŠ äº†ä¸œè¥¿ï¼Œå³ä½¿ä½ æ²¡æœ‰çœŸçš„ä½¿ç”¨è¿™ä¸ªæ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—ä¹Ÿä¼šè¢«æ‰“åŒ…è¿›åˆ°disté‡Œå»ã€‚</p>
<p>æ‰€ä»¥å¦‚æœä½ çœŸçš„æƒ³å»é™¤é‚£äº›å®Œå…¨æ²¡æœ‰è¢«å¼•ç”¨åˆ°çš„ï¼Œå³ä½¿æœ‰å‰¯ä½œç”¨çš„åŒ…ï¼š<strong>å°±åº”è¯¥æŠŠè¿™äº› åŒ…/æ¨¡å— è¢«æ ‡è®°ä¸º <code>sideEffects: false</code> äº†ï¼Œé‚£ä¹ˆä¸ç®¡å®ƒæ˜¯å¦çœŸçš„æœ‰å‰¯ä½œç”¨ï¼Œåªè¦å®ƒæ²¡æœ‰è¢«å¼•ç”¨åˆ°ï¼Œæ•´ä¸ª æ¨¡å—/åŒ… éƒ½ä¼šè¢«å®Œæ•´çš„ç§»é™¤ã€‚</strong></p>
<p>ä¸¾ä¸ªæˆ‘çœ‹åˆ°çš„å¾ˆå¥½çš„ä¾‹å­ï¼Œä¾‹å­åŸæœ¬å‡ºäºæ–‡ç« <a href="https://juejin.im/post/5b4ff9ece51d45190c18bb65" target="_blank" rel="noopener"># Webpack ä¸­çš„ sideEffects åˆ°åº•è¯¥æ€ä¹ˆç”¨ï¼Ÿ</a>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import DevTools from &apos;mobx-react-devtools&apos;;</span><br><span class="line"></span><br><span class="line">class MyApp extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        ...</span><br><span class="line">        &#123; process.env.NODE_ENV === &apos;production&apos; ? null : &lt;DevTools /&gt; &#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœä½ ä¸åœ¨webpack4ä¸­è®¾ç½® <code>sideEffects: false</code>ï¼Œ é‚£ä¹ˆå³ä½¿ <code>NODE_ENV=production</code>, <code>mobx-react-devtools</code>ä¹Ÿä¼šè¢«å¼•å…¥ã€‚</p>
<p>æ‰€ä»¥<strong>å¦‚æœæˆ‘ä»¬èƒ½ç¡®å®šæˆ–è€…æƒ³è®©è¿™ä¸ªåŒ…ä¸å¯¹åŒ…ä»¥å¤–çš„å¯¹è±¡é€ æˆå½±å“ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å®Œå…¨çš„å¯ä»¥æ”¾å¿ƒè®¾ç½®è¿™ä¸ªå‚æ•°äº†</strong>ã€‚</p>
<p><code>sideEffects</code> ä¸ä¸€å®šæ˜¯ false, æ¯”å¦‚å¯¹ä¸Šé¢çš„ <code>babel polly-fill</code> å°±å¯ä»¥ä½¿ç”¨ <code>sideEffects: [&quot;@babel/polly-fill&quot;]</code>ï¼Œå¡«å…¥ä¸éœ€è¦ <code>treeshaking</code> çš„å³å¯ã€‚</p>
<p>å†æ¯”å¦‚ï¼Œ`import â€˜@babel/polly-fillâ€™, å®é™…ä¸Šä½ æ˜¯æ²¡æœ‰å¯¼å‡ºä»»ä½•æ¨¡å—çš„ï¼Œå¦‚æœä½ ä¸åŠ  sideEffect, webpackå°±ä¼šæŠŠæ•´ä¸ªæ¨¡å—å»æ‰ã€‚</p>
<p>æˆ–è€…<code>&quot;sideEffects&quot;: [&quot;*.css&quot;]</code>ï¼Œæˆ‘ä»¬ä¸éœ€è¦å¯¹cssè¿›è¡Œ <code>treeshaking</code>ã€‚</p>
<p>å…³äº å‰¯ä½œç”¨ï¼Œæ¨èä¸€ç¯‡æ–‡ç« <a href="https://zhuanlan.zhihu.com/p/32831172" target="_blank" rel="noopener">ä½ çš„Tree-Shakingå¹¶æ²¡ä»€ä¹ˆåµç”¨
</a>, ä¹Ÿæ–¹ä¾¿è‡ªå·±åç»­æŸ¥é˜…ã€‚</p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ€è¿‘ä¸»è¦æ˜¯æƒ³å¯¹ç»„é‡Œçš„ä¸€äº›åŒ…åšä¼˜åŒ–ï¼Œåšä¼˜åŒ–çš„è¿‡ç¨‹ä¸­è§£å†³äº†ä¸€äº›é—®é¢˜ï¼Œä¹Ÿå¸¦æ¥äº†ä¸€äº›æ–°çš„ç–‘æƒ‘ã€‚ç–‘æƒ‘è¿˜æ²¡è§£å†³ï¼Œæ‰€ä»¥è¿˜ä¸èƒ½æ€»ç»“æˆæ–‡ç« ã€‚è™½ç„¶ä¸æ˜¯çº ç»“ä¸Šé¢çš„ä¸œè¥¿ï¼Œä½†ä¹Ÿç®—æ˜¯çº ç»“äº†å¥½å‡ å¤©äº†ã€‚(à²¥ _ à²¥)</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦è®°å½•ä¸¤ç‚¹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;å¦‚ä½•åœ¨webpackä¸­ç¼–è¯‘ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶å¹¶ä¸”æŒ‰ç…§ã€åŸç›®å½•ã€‘è¾“å‡ºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ€»ç»“åœ¨webpack ä¸­ä½¿ç”¨ treeshaking çš„æ¡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
      <category term="å·¥å…·/é…ç½®" scheme="http://sevencai.github.io/tags/%E5%B7%A5%E5%85%B7-%E9%85%8D%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>2018å¹´åº¦æ€»ç»“</title>
    <link href="http://sevencai.github.io/2018/12/31/2018%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/"/>
    <id>http://sevencai.github.io/2018/12/31/2018å¹´åº¦æ€»ç»“/</id>
    <published>2018-12-31T09:44:03.000Z</published>
    <updated>2018-12-31T03:04:36.000Z</updated>
    
    <content type="html"><![CDATA[<p>2018å¹´å·²ç»æ˜¯è¿‡å»</p>
<p>å°æ—¶å€™å°è±¡æœ€æ·±çš„ä¸€å¹´æ˜¯2008å¹´</p>
<p>é‚£ä¸€å¹´å¼€äº†è¿åŠ¨ä¼š</p>
<p>é‚£ä¸€å¹´è·Ÿçˆ¸çˆ¸å»äº†åŒ—äº¬</p>
<p>é‚£ä¸€å¹´å¦ˆå¦ˆ40å²</p>
<p>é‚£ä¸€å¹´æˆ‘13å²</p>
<p>é‚£ä¸€å¹´ä¸‹äº†å¤§é›ª</p>
<p>é‚£ä¸€å¹´æ±¶å·åœ°éœ‡</p>
<p>è½¬çœ¼é—´10å¹´å°±è¿‡å»äº†ï¼Œ10å¹´ï¼Œæˆ‘é•¿å¤§äº†</p>
<p>é‚£ä¸ªèƒ†å°çš„æˆ‘ï¼Œå˜äº†æ•¢äºæ‰¿æ‹…çš„æˆ‘</p>
<p>é‚£ä¸ªé—®çˆ¸çˆ¸å¦ˆå¦ˆè¦é’±çš„æˆ‘ï¼Œå˜æˆäº†ç»™çˆ¸çˆ¸å¦ˆå¦ˆä¹°ä¸œè¥¿çš„æˆ‘</p>
<p>é‚£ä¸ªå­¦ç”Ÿï¼Œå˜æˆäº†ç¤¾ä¼šäºº</p>
<p>é‚£ä¸ªä¸€ä¸ªäººï¼Œç°åœ¨å¤šäº†ä¸€ä¸ªäººå’Œä¸€ä¸ªç‹—</p>
<p>å¤šæ•°æ—¶å€™æˆ‘å¼€å¿ƒå¿«ä¹ï¼Œä½†æ˜¯ä¹Ÿæœ‰æ—¶å€™å¿ƒæƒ…ä½è½ï¼Œå´©æºƒå¤§å“­</p>
<p>æˆ‘çƒ­çˆ±æˆ‘çš„å·¥ä½œï¼Œä½†ä¹Ÿæœ‰æ—¶å¼€å§‹ä¼šæƒ³æ€ä¹ˆèƒ½å°‘åŠ ç­</p>
<p>æˆ‘èµšäº†é’±ï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰å­˜ä¸€åˆ†é’±ï¼Œè¿‡ç€ä¸äºå¾…è‡ªå·±å’Œå®¶äººçš„æ—¥å­</p>
<p>æˆ‘å˜äº†å¾ˆå¤šï¼Œä¸å˜çš„æ˜¯æˆ‘è¿˜æ˜¯é‚£ä¸ªå°èƒ–å­ï¼Œæˆ‘ç”šè‡³å·²ç»ä¼šè¯´ä¿çš®è¯</p>
<p>æˆ‘çˆ±æˆ‘çš„å®¶äººï¼Œçˆ±æˆ‘çš„å¦ˆå¦ˆï¼Œä½†æ€»è§‰å¾—è‡ªå·±äºæ¬ å¥¹</p>
<p>æˆ‘è™½ç„¶æ¯å¤©è·Ÿå¥¹æ‰“ç”µè¯ï¼Œä½†æ˜¯å¥¹æ€»æ˜¯è·Ÿæˆ‘éšç’å¥¹çš„å¿ƒäº‹</p>
<p>å·¥ä½œä¸­é‡åˆ°è¿‡ä¸é¡ºçš„æ—¶å€™ï¼Œä»Šå¹´åŒåä¸€é‚£ä¸ªæ˜ŸæœŸï¼Œé‚£ä¸€å¤©ï¼Œæˆ‘è§‰å¾—æ˜¯æˆ‘äººç”Ÿä¸­æœ€éš¾è¿‡çš„ä¸€å¤©</p>
<p>æˆ‘ä¸å¤Ÿå¼ºå¤§</p>
<p>æˆ‘ä»Šå¤©å»äº†æ—¥æœ¬ï¼Œé‡åº†ï¼Œé˜³æ±Ÿï¼Œä¸–ç•Œå¾ˆå¤§ï¼Œæˆ‘ä¹Ÿåœ¨åŠªåŠ›å»çœ‹çœ‹ï¼Œè¿ˆçš„æ­¥å­ä¸å¤§ï¼Œä½†åœ¨å‰è¿›</p>
<p>æˆ‘ä»Šå¹´å·¥ä½œ1å¹´åŠäº†ã€‚ç®—ä¸Šå®ä¹ 2å¹´åŠäº†</p>
<p>æˆ‘ä¾æ—§ä¸åŒ–å¦†ï¼Œç”šè‡³è¿˜é•¿èƒ–äº†5æ–¤</p>
<p>ä¸€ç›´åœ¨åŠªåŠ›æƒ³ç€æ”¹å˜ï¼Œä½†æœ‰æ—¶å€™å¾ˆè®¨åŒè‡ªå·±ä¸ºä»€ä¹ˆä¸æ˜¯é‚£ä¸ªåšæŒä¸æ‡ˆçš„äºº</p>
<p>å·¥ä½œä¸Šè§‰å¾—è‡ªå·±æœ‰è¿›æ­¥ï¼Œä½†æ˜¯è¿˜æœ‰å¾ˆå¤šä¸è¶³ï¼Œæ¸…æ™°å¯è§</p>
<p>æˆ‘åšäº†ä¸€äº›æœ‰æ„ä¹‰çš„äº‹æƒ…ï¼Œæ¯”å¦‚å¸®åŠ©æµæµªç‹—ï¼Œå­¦ä¹ æ€¥æ•‘çŸ¥è¯†</p>
<p>ä¹Ÿåšäº†ä¸€äº›å·¥ä½œä¸Šå¯ä»¥èŠ‚çœåŠ³åŠ¨åŠ›çš„åŠŸèƒ½ï¼Œè™½ç„¶ä¸æ˜¯ KPIï¼Œä½†æ˜¯æˆ‘åšçš„å¾ˆå¼€å¿ƒ</p>
<p>æˆ‘æœ‰ä¸€æ¬¡è¿ç»­ä¸€ä¸ªæ˜ŸæœŸç†¬å¤œï¼Œå°±ç¡å‡ ä¸ªå°æ—¶çš„æ—¶å€™çš„ç»å†</p>
<p>å¤§å§¨å¦ˆè¿˜æ˜¯ä¸€æ ·çš„ç—›çš„æˆ‘æƒ³è·³æ¥¼</p>
<p>æˆ‘å¾ˆçˆ±æˆ‘çš„å°ç‹—ç‹—ï¼Œä½†æ˜¯å®ƒå¥½åƒä¸å¤ªçˆ±æˆ‘ï¼Œæ€»å’¬æˆ‘çš„è¡£æœ</p>
<p>å¤§é¾™å¾ˆæ£’ï¼Œç”Ÿç—…æœ‰ç‚¹å¤š</p>
<p>æˆ‘ä»¬å¼€å§‹ä¸€èµ·ä¼šæ€è€ƒæœªæ¥çš„èŒä¸šå‘å±•</p>
<p>ä¹Ÿæœ‰ä»»æ€§çš„æ—¶å€™ï¼Œä¸€èµ·å“­çš„æ—¶å€™ï¼Œä¸€èµ·ç”Ÿç—…çš„æ—¶å€™</p>
<p>ä»–ç»å†äº†ä¸€ä¸ªæœˆçš„ä½è°·æœŸï¼Œä¸è¿‡ä»–å¾ˆæ£’ï¼Œå¾ˆå¿«å°±è°ƒæ•´è¿‡æ¥</p>
<p>è¿·èŒ«çš„æ—¶å€™ï¼Œæˆ‘ä¼šä¼‘æ¯ä¸€å¤©ï¼Œè°ƒæ•´ä¸€å¤©</p>
<p>æˆ‘å¼€å§‹äº†æ¯å¤©é˜…è¯»è‹±è¯­ï¼Œä½†æ˜¯ä¹Ÿæœ‰æ¼å¤©çš„æ—¶å€™</p>
<p>18å¹´ï¼Œæˆ‘å‡ºäº†ä¸€æ¬¡è½¦ç¥¸ï¼Œæˆ‘ç°åœ¨è¿˜å¾ˆæ¸…æ™°çš„è®°å¾—é‚£ä¸ªæ—¶åˆ»</p>
<p>è¿‡å¥½æ¯ä¸€å¤©å¾ˆé‡è¦ï¼Œå› ä¸ºäººç”ŸçœŸçš„ä¸å¯é¢„æµ‹</p>
<p>åˆšåˆšè·Ÿç»„é‡Œå»åƒäº†ä¸ªé¥­ï¼Œä»Šå¹´é¥­å±€å¾ˆå¤šï¼Œå¾ˆå¼€å¿ƒ</p>
<p>ä»Šå¹´ç»„é‡Œè¿˜æ¥äº†ä¸€ä¸ªå¦¹å­ï¼Œæˆ‘è§‰å¾—è¿™æ˜¯æˆ‘æ˜¥å¤©çš„å¼€å§‹</p>
<p>æˆ‘å†™äº†å¾ˆå¤šæ€»ç»“ä»Šå¹´ï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰å‹‡æ°”å‘åˆ°å…¬å¸ KM ä¸Š</p>
<p>æˆ‘ä»Šå¹´æœ‰è¿›æ­¥ï¼Œæœ‰è®¤çœŸå·¥ä½œï¼Œä¹Ÿæœ‰å¿½ç„¶ä¸æƒ³å¹²çš„æ—¶å€™</p>
<p>é‚£äº›è¿·èŒ«çš„æ—¶å€™ï¼Œæˆ‘æƒ³ä¸ºä»€ä¹ˆä¼šæœ‰äººæ„¿æ„æ¯å¤©ä¸Š12å°æ—¶çš„ç­</p>
<p>é‚£äº›è®¤çœŸå·¥ä½œçš„æ—¶å€™ï¼Œæˆ‘æƒ³ä¸å†™ä»£ç çœŸçš„å¯æƒœäº†</p>
<p>æœ‰çš„æ—¶å€™è§‰å¾—è‡ªå·±æ˜¯ä¸ªèƒ†å°é¬¼</p>
<p>æˆ‘äº«å—æ¯æ¬¡å†™ä¸€æ®µå¾ˆå¥½çš„ä»£ç çš„æ—¶å€™ï¼Œäº«å—æ¯æ¬¡å†™ created by sevencai çš„æ—¶å€™</p>
<p>æˆ‘åœ¨ä¸€å¤©å¤©çš„é•¿å¤§</p>
<p>å¦ˆå¦ˆåœ¨ä¸€å¤©å¤©çš„å˜è€</p>
<p>19å¹´çš„æ—¶å€™ï¼Œæˆ‘å°±24äº†</p>
<p>ä¹Ÿè®¸ä»Šå¹´èƒ½å­˜ç‚¹é’±ï¼Œèƒ½åœ†è€å¦ˆçš„é—¨é¢æ¢¦</p>
<p>å¸Œæœ›å¯¹ PHP,Nodejs æ›´åŠ æ·±å­¦ä¹ </p>
<p>æˆ‘ç°åœ¨å¯¹ä»–ä»¬åªåœç•™åœ¨èƒ½åšå‡ºæ¥ä¸œè¥¿ä¸Šï¼ˆå·¥ç¨‹ä¸Šï¼‰ï¼Œè™½ç„¶å¯¹ä¸€èˆ¬çš„å·¥ä½œæ¥è¯´å¤Ÿç”¨äº†ï¼Œä½†æ›´æ·±å±‚æ¬¡çš„ä¸œè¥¿å¹¶æ²¡æœ‰ä»”ç»†å­¦ä¹ è¿‡ï¼Œå¹¶ä¸”é‡åˆ°é—®èŠ±è´¹çš„æ—¶é—´ä¹Ÿä¼šå¤šäº›</p>
<p>ä¹Ÿè®¸ä»Šå¹´èƒ½ç˜¦ä¸‹æ¥ï¼Œæ”¹æ‰ä¸å‰©é¥­ï¼Œéè¦æŠŠè‡ªå·±åƒæ’‘çš„åæ¯›ç—…</p>
<p>ä¹Ÿè®¸ä»Šå¹´èƒ½å¤Ÿå·¥ä½œé¡ºåˆ©ï¼Œæ˜å¹´è¿™ä¸ªæ—¶å€™ï¼Œè§‰å¾—è‡ªå·±åˆè¿›æ­¥äº†éå¸¸å¤š</p>
<p>ä¹Ÿè®¸å®¶é‡Œäººèº«ä½“éƒ½å¥åº·ï¼Œå¸Œæœ›èº«è¾¹çš„äººéƒ½å¹¸ç¦å¼€å¿ƒ</p>
<p>ä¹Ÿè®¸æˆ‘çš„æ„¿æœ›19å¹´éƒ½ä¼šæˆçœŸ</p>
<p>ä¹Ÿè®¸æˆ‘èƒ½å¤šè¯»ç‚¹ä¹¦</p>
<p>ä¹Ÿè®¸æˆ‘èƒ½æ”¹å˜æ‡’æƒ°</p>
<p>ä¹Ÿè®¸æˆ‘çœŸçš„èƒ½åšæŒä¸‹æ¥åšä¸€ä»¶äº‹æƒ…</p>
<p>ä¹Ÿè®¸æˆ‘èƒ½å˜å¾—æ›´åŠ æœ‰æ•ˆç‡ï¼Œå°‘åŠ ç‚¹ç­</p>
<p>åªè¦æœ‰å¿ƒï¼Œä»è‡ªå·±å¼€å§‹åšå‡ºæ”¹å˜ï¼Œä»å¿ƒé‡Œç”±è¡·çš„å–„è‰¯å’Œå¼€æœ—ï¼ŒåšæŒå’Œè€å¿ƒï¼Œæœªæ¥å¯æœŸï¼Œæˆ‘ä¹Ÿç›¸ä¿¡è‡ªå·±ï¼Œå› ä¸º18å¹´å·²ç»è¿ˆå‡ºäº†ä¸€å°æ­¥äº†ï¼Œä¸æ˜¯å—</p>
<p>å—¯ï¼Œä»Šå¤©æ˜¯2018çš„æœ€åä¸€å¤©ï¼Œå¤©æ°”å¾ˆå†·</p>
<p>2019ï¼Œæˆ‘å‡†å¤‡å¥½äº†ï¼Œä½ æ¥å§ï¼Œå˜»å˜»ğŸŒ¹</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;2018å¹´å·²ç»æ˜¯è¿‡å»&lt;/p&gt;
&lt;p&gt;å°æ—¶å€™å°è±¡æœ€æ·±çš„ä¸€å¹´æ˜¯2008å¹´&lt;/p&gt;
&lt;p&gt;é‚£ä¸€å¹´å¼€äº†è¿åŠ¨ä¼š&lt;/p&gt;
&lt;p&gt;é‚£ä¸€å¹´è·Ÿçˆ¸çˆ¸å»äº†åŒ—äº¬&lt;/p&gt;
&lt;p&gt;é‚£ä¸€å¹´å¦ˆå¦ˆ40å²&lt;/p&gt;
&lt;p&gt;é‚£ä¸€å¹´æˆ‘13å²&lt;/p&gt;
&lt;p&gt;é‚£ä¸€å¹´ä¸‹äº†å¤§é›ª&lt;/p&gt;
&lt;p&gt;é‚£ä¸€å¹´æ±¶å·åœ°éœ‡&lt;/p&gt;
&lt;p&gt;
    
    </summary>
    
    
      <category term="ç”Ÿæ´»" scheme="http://sevencai.github.io/tags/%E7%94%9F%E6%B4%BB/"/>
    
  </entry>
  
  <entry>
    <title>webpack4è¯»ä¹¦ç¬”è®°(äºŒ)</title>
    <link href="http://sevencai.github.io/2018/12/23/webpack4%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E4%BA%8C/"/>
    <id>http://sevencai.github.io/2018/12/23/webpack4è¯»ä¹¦ç¬”è®°-äºŒ/</id>
    <published>2018-12-23T04:57:36.000Z</published>
    <updated>2019-04-15T06:51:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸Šç¯‡æ–‡ç« æ•´ç†äº†å‡ ä¸ªç‚¹ï¼Œè¿™ç¯‡æ–‡ç« æ¥ç€è®°å½•ä¸‹æˆ‘è§‰å¾—æœ‰æ€»ç»“æ„ä¹‰çš„ç‚¹ã€‚</p>
<hr>
<h2 id="loader-å’Œ-puginçš„åŒºåˆ«"><a href="#loader-å’Œ-puginçš„åŒºåˆ«" class="headerlink" title="loader å’Œ puginçš„åŒºåˆ«"></a>loader å’Œ puginçš„åŒºåˆ«</h2><p>loaderä¸Šç¯‡æ€»ç»“äº†ï¼šwebpackåªçŸ¥é“å¤„ç† js ç±»çš„æ–‡ä»¶ï¼Œå¯¹äºå¾ˆå¤šå…¶ä»–ç±»å‹çš„æ¨¡å—å¦‚å›¾ç‰‡ï¼Œå­—ä½“ç­‰ä»–ä¸çŸ¥é“æ€ä¹ˆå¤„ç†ï¼Œè¿™æ—¶å€™å°±å¯ä»¥è®¾ç½®ç›¸å…³çš„loaderï¼Œå‘Šè¯‰å®ƒæ€ä¹ˆå¤„ç†è¿™äº›æ¨¡å—ã€‚</p>
<p><strong>pluginè·Ÿloaderä¸åŒï¼Œæˆ‘ç†è§£pluginæ˜¯å¯ä»¥åœ¨webpackåˆ†ææ‰§è¡Œçš„æŸäº›èŠ‚ç‚¹æˆ–è€…ç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œåšçš„æŸäº›æ“ä½œã€‚</strong></p>
<p>å¦‚ <code>webpackHtmlPlugin</code>,åœ¨æ‰“åŒ…æœ€åå¤„ç†ï¼Œç”Ÿæˆhtmlæ–‡ä»¶ã€‚ <code>cleanWebpackPlugin</code>ï¼Œåœ¨webpackæ‰“åŒ…çš„æœ€å¼€å§‹ï¼ŒæŠŠdistç›®å½•æ¸…ç©ºã€‚</p>
<p><code>plugin</code>æœ‰ç‚¹åƒ<code>react.vue</code>é‡Œçš„å¦‚<code>mounted, beforeRouteEnter</code>ç­‰èŠ‚ç‚¹ï¼Œåœ¨æŸä¸ªæ—¶åˆ»åšæŸäº›äº‹æƒ…ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">  <span class="keyword">new</span> cleanWebpackPlugin(),</span><br><span class="line">  <span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">    template: <span class="string">"src/index.html"</span></span><br><span class="line">  &#125;)</span><br><span class="line"> ]</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ç†è§£sourceMapå’Œwebpack4ä¸­sourcemapçš„ä½¿ç”¨"><a href="#ç†è§£sourceMapå’Œwebpack4ä¸­sourcemapçš„ä½¿ç”¨" class="headerlink" title="ç†è§£sourceMapå’Œwebpack4ä¸­sourcemapçš„ä½¿ç”¨"></a>ç†è§£sourceMapå’Œwebpack4ä¸­sourcemapçš„ä½¿ç”¨</h2><p>sourcemap æ˜¯ä¸€ä¸ªæ˜ å°„å…³ç³»ï¼Œæ˜ å°„äº†æ‰“åŒ…åçš„æŸä¸ªä»£ç ä½ç½®å¯¹åº”äºæ‰“åŒ…å‰çš„ä»£ç ä½ç½®ï¼Œæ–¹ä¾¿å¼€å‘è€…å®šä½é—®é¢˜ã€‚</p>
<p>webpack4ä¸­è®¾ç½® <code>sourcemap</code> å¯ä»¥ä½¿ç”¨ <code>devtool</code> çš„å€¼ï¼Œæˆ–è€…ä½¿ç”¨<code>SourceMapDevToolPlugin</code>å’Œ<code>EvalSourceMapDevToolPlugin</code>ï¼Œä¸¤ä¸ªä¸å¯åŒæ—¶ä½¿ç”¨ã€‚</p>
<p>webpack4, <code>development</code>æ¨¡å¼é»˜è®¤çš„devtoolæ¨¡å¼æ˜¯ eval, è‹¥<code>mode=production</code>å¹¶ä¸”ä¸è®¾ç½® devtool åˆ™æ²¡æœ‰ sourcemapã€‚</p>
<p>æ‰€æœ‰çš„ sourcemap å¯ä»¥è®¾ç½®çš„å€¼ï¼Œæœ‰å¦‚ä¸‹ï¼š</p>
<p><img src="devtool3.png" alt="sourcemap devtool"></p>
<p>æˆ‘è§‰å¾—å¯ä»¥ä¸ç”¨å»åˆ†åˆ«å»è®°å¿†æœ‰å“ªäº›ç±»å‹çš„sourcemap,æ‰€æœ‰çš„sourcemapéƒ½æ˜¯å‡ ç§å…³é”®å­—ç»„åˆè€Œæˆï¼Œæ¯ç§å¯èƒ½ä»£è¡¨ä¸€ä¸ªå«ä¹‰ï¼Œç†è§£å…¶ä¸­çš„å…³é”®å­—ï¼Œç„¶åå†å»ç¿»çœ‹æ–‡æ¡£éœ€è¦å“ªç§å³å¯ã€‚</p>
<p>ä¸‹é¢çœ‹ä¸‹è¿™å‡ ç§å…³é”®å­—,ç†è§£åå†æ¥çœ‹ä¸Šè¿°çš„å°±å¯ä»¥ç†è§£äº†ã€‚</p>
<hr>
<h2 id="1ã€-eval"><a href="#1ã€-eval" class="headerlink" title="1ã€ eval"></a>1ã€ eval</h2><p><strong>ä½¿ç”¨evalåŒ…è£¹æ¨¡å—ä»£ç </strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">"// import Test from './Test'\n// import './1.png'\n// import './1.css'\n// new Test()\n\nconsele.log('log data')\n\n\n//# sourceURL=webpack:///./src/index.js?"</span>);</span><br></pre></td></tr></table></figure>
<h2 id="2ã€-source-map"><a href="#2ã€-source-map" class="headerlink" title="2ã€ source-map"></a>2ã€ source-map</h2><p><strong>äº§ç”Ÿ .map æ–‡ä»¶</strong>ï¼Œsourcemap ä¸ä¼šå’Œ js ä»£ç è€¦åˆåœ¨ä¸€èµ·ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">main.bundle.js</span><br><span class="line">main.bundle.js.map</span><br></pre></td></tr></table></figure></p>
<h2 id="3ã€-cheap"><a href="#3ã€-cheap" class="headerlink" title="3ã€ cheap"></a>3ã€ cheap</h2><p><strong>ä¸åŒ…å«åˆ—ä¿¡æ¯</strong>ï¼Œæ­£å¸¸æƒ…å†µä¸‹æˆ‘ä»¬åªç”¨çŸ¥é“æ˜¯å“ªä¸€è¡Œå°±å¯ä»¥äº†ã€‚å¦‚æœåŠ ä¸Šå“ªä¸€åˆ—ç›¸å½“äºè§£ææ›´è´¹æ—¶é—´ã€‚</p>
<p>å¦‚ï¼ševal, æ­¤æ—¶å…‰æ ‡æ˜¯å€¼åœ¨å‡ºé”™çš„è¡ŒåŠåˆ—ã€‚<br><img src="notcheap.png" alt="eval"></p>
<p>è€Œï¼š<code>cheap-eval-source-map</code>,æ­¤æ—¶å…‰æ ‡åªåœ¨æœ€å‰é¢ã€‚<br><img src="ch.png" alt="cheap"></p>
<h2 id="4ã€inline"><a href="#4ã€inline" class="headerlink" title="4ã€inline"></a>4ã€inline</h2><p>å°† .map æ–‡ä»¶ä½œä¸º DataURIåµŒå…¥ï¼Œè¿™ç§æƒ…å†µå°†ä¸å•ç‹¬ç”Ÿæˆ .map æ–‡ä»¶ï¼Œè€Œæ˜¯è·Ÿbundleæ–‡ä»¶åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtEQUEwQyxnQ0FBZ0M7QUFDMUU7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxnRUFBd0Qsa0JBQWtCO0FBQzFFO0FBQ0EseURBQWlELGNBQWM7QUFDL0Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUF5QyxpQ0FBaUM7QUFDMUUsd0hBQWdILG1CQUFtQixFQUFFO0FBQ3JJO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsbUNBQTJCLDBCQUEwQixFQUFFO0FBQ3ZELHlDQUFpQyxlQUFlO0FBQ2hEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhEQUFzRCwrREFBK0Q7O0FBRXJIO0FBQ0E7OztBQUdBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2xGQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSIsImZpbGUiOiJtYWluLmJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBcIi4vc3JjL2luZGV4LmpzXCIpO1xuIiwiLy8gaW1wb3J0IFRlc3QgZnJvbSAnLi9UZXN0J1xuLy8gaW1wb3J0ICcuLzEucG5nJ1xuLy8gaW1wb3J0ICcuLzEuY3NzJ1xuLy8gbmV3IFRlc3QoKVxuXG5jb25zZWxlLmxvZygnbG9nIGRhdGEnKVxuIl0sInNvdXJjZVJvb3QiOiIifQ=</span></span><br></pre></td></tr></table></figure>
<h2 id="5ã€module"><a href="#5ã€module" class="headerlink" title="5ã€module"></a>5ã€module</h2><p>é™¤äº†æç¤ºä¸šåŠ¡ä»£ç æœ¬èº«çš„mapå¤–ï¼Œå…¶ä»–æ¨¡å—å¦‚loaderï¼Œä¹Ÿä¼šè¢«æ˜ å°„æœ‰ç›¸åº”çš„sourcemapã€‚</p>
<p>å…¶å®çœ‹å®˜æ–¹æ–‡æ¡£ä¼šæ›´åŠ æ¸…æ¥šï¼Œå®ƒä¼šè®²ä¸ºä»€ä¹ˆæœ‰äº›ç±»å‹æ˜¯ä¸é€‚åˆç”Ÿäº§æˆ–è€…å¼€å‘ç¯å¢ƒï¼Œæˆ–è€…èƒ½å¤Ÿå‘Šè¯‰ä½ ä»€ä¹ˆæ˜¯ <code>origin code</code> æˆ–è€… <code>transformed code</code>ã€‚</p>
<p>sourcemapçš„æ›´åŠ ç»†èŠ‚çš„åŸç†ï¼Œå¯ä»¥å‚è€ƒ<a href="http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html" target="_blank" rel="noopener">JavaScript Source Map è¯¦è§£-é˜®ä¸€å³°</a></p>
<hr>
<h2 id="webpack-dev-server-HMR"><a href="#webpack-dev-server-HMR" class="headerlink" title="webpack-dev-server HMR"></a>webpack-dev-server HMR</h2><p>webpack4ä¸­å¼€å¯ </p>
<ol>
<li>å¼€å¯ <code>devsever hot: true, hotOnly: true</code></li>
<li>ä½¿ç”¨ <code>new webpack.HotModuleReplacementPlugin()</code></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">  contentBase: <span class="string">'./dist'</span>, <span class="comment">// æœåŠ¡å™¨æ ¹ç›®å½•</span></span><br><span class="line">  hot: <span class="literal">true</span>,  <span class="comment">// å¼€å¯çƒ­æ›´æ–°</span></span><br><span class="line">  open: <span class="literal">true</span>,  <span class="comment">// è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨</span></span><br><span class="line">  hotOnly: <span class="literal">true</span> <span class="comment">// äººæ›´æ–°å¤±è´¥ï¼Œä¹Ÿä¸è¦è·Ÿæ–°æµè§ˆå™¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·è¿˜ä¸å¤Ÿèƒ½å®ç°jsçš„çƒ­æ›´æ–°ï¼Œå¦‚æœè¦å½¢æˆjsçš„çƒ­æ›´æ–°ï¼Œä½ è¿˜è¦å‘Šè¯‰åœ¨ä»£ç é‡Œå‘Šè¯‰webpack,æˆ‘è¿™ä¸ªæ¨¡å—å¦‚æœè¢«ä¿®æ”¹äº†ï¼Œè¦æ‰§è¡Œä»€ä¹ˆæ“ä½œï¼Œå¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">module</span>.hot) &#123;</span><br><span class="line">  <span class="built_in">module</span>.hot.accept(<span class="string">'./print.js'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Accepting the updated printMe module!'</span>);</span><br><span class="line">    printMe();</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™å‘Šè¯‰äº†æˆ‘ä»¬å¦‚æœprint.jsæ”¹å˜äº†ï¼Œåˆ™ä¼šæ‰“å°ä¸€å¥è¯ã€‚è‹¥æœæ¯ä¸ªåœ°æ–¹éƒ½è¿™ä¹ˆå¹²ï¼Œæˆ‘ä»¬å†™ä»£ç ä¼šå¾ˆç´¯ï¼Œæ‰€ä»¥å¯ä»¥ï¼š</p>
<ol>
<li><strong>å€ŸåŠ©<code>Vue Loader</code>ã€<code>React Hot Loader</code></strong>ï¼Œ æ­¤ loader æ”¯æŒ vue ç»„ä»¶çš„ HMRï¼Œæä¾›å¼€ç®±å³ç”¨ä½“éªŒï¼Œä¸ç”¨è‡ªå·±å†å»å†™<code>module.hot</code></li>
<li><strong>å€ŸåŠ©äº<code>style-loader</code>ï¼Œä½¿ç”¨æ¨¡å—çƒ­æ›¿æ¢æ¥åŠ è½½ CSS</strong> ,æ­¤ loader åœ¨å¹•åä½¿ç”¨äº† <code>module.hot.accept</code>ï¼Œåœ¨ CSS ä¾èµ–æ¨¡å—æ›´æ–°ä¹‹åï¼Œä¼šå°†å…¶ patch(ä¿®è¡¥) åˆ° <code>&lt;style&gt;</code> æ ‡ç­¾ä¸­ã€‚</li>
</ol>
<hr>
<h2 id="webpack-babel"><a href="#webpack-babel" class="headerlink" title="webpack babel"></a>webpack babel</h2><p>ä¸‹é¢å¤§æ¦‚è®°å½•ä¸‹æ•´ä½“çš„æµç¨‹ï¼Œä»¥åŠå‡ ä¸ªæ¨¡å—ä¹‹é—´çš„è”ç³»ã€åŒºåˆ«åŠæ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>å®‰è£…<code>babel-loader</code>,<code>babel-core</code></li>
<li><code>babel-core</code>æ˜¯babelçš„æ ¸å¿ƒåº“,<code>babel-loader</code>æ˜¯babelä¸webpackå…³ç³»çš„æ¡¥æ¢</li>
<li>åœ¨<code>module rule</code>é‡Œè®¾ç½®ï¼Œè‹¥æ˜¯jsæ–‡ä»¶ç»“å°¾ï¼Œç”¨<code>babel-loader</code>å¤„ç†</li>
<li>æ³¨æ„<code>babel-loader</code>åªæ˜¯ä¸webpackæ‰“é€šï¼Œä¸è¿›è¡Œes6è½¬æ¢</li>
<li>æ‰€ä»¥éœ€è¦å®‰è£…<code>babel-preset-env</code>,ä»–è´Ÿè´£è½¬æ¢æ–°çš„es6çš„è¯­æ³•ï¼ˆsyntaxï¼‰,ä½†æ˜¯ä¸ä¼šå»è½¬æ¢mapæˆ–è€…promise,weakmap, findè¿™ç§<strong>å¯¹è±¡å’Œå‡½æ•°</strong>ã€‚åªè½¬æ¢è¯­æ³•å¦‚ç®­å¤´å‡½æ•°æˆ–è€…constè¿™ç§è¯­æ³•</li>
<li>æ‰€ä»¥éœ€è¦<code>babel-polyfill</code>,ä¸ºå½“å‰ç¯å¢ƒæä¾›å«ç‰‡ï¼Œè½¬æ¢ä¸ºæ–°çš„api,</li>
<li>å¦‚æœç›´æ¥å¼•ç”¨ï¼Œæ‰€æœ‰çš„éƒ½ä¼šè¢«æ‰“åŒ…ï¼Œæ‰€ä»¥éœ€è¦æ·»åŠ <code>useBuiltIns</code>,å®ç°æ–¹æ³•è½¬æ¢çš„æŒ‰éœ€åŠ è½½ï¼Œå‡å°‘æ–‡ä»¶æç¤ºï¼Œæ ¹æ®ä¸šåŠ¡ä»£ç é‡Œä½¿ç”¨æƒ…å†µæ¥æ‰“åŒ…ï¼Œä½“ç§¯ä¼šå‡å°‘å¾ˆå¤šã€‚</li>
<li>ä½†æ˜¯<code>babel-polyfill</code>æ˜¯åœ¨windowä¸Šçš„ï¼Œä¼šæ±¡æŸ“å…¨å±€å˜é‡,å¦‚æœæ˜¯æ‰“åŒ…ç±»åº“æˆ–è€…ç¬¬ä¸‰æ–¹åº“å°±ä¸åˆé€‚äº†ã€‚</li>
<li>æ‰€ä»¥éœ€è¦<code>@babel/plugin-transform-runtime</code>è¿™ä¸ªæ’ä»¶ï¼Œè¿™æ ·å¯ä»¥ä¸ç”¨æ±¡æŸ“å…¨å±€å˜é‡ã€‚</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœæ˜¯è‡ªå·±çš„ä¸šåŠ¡ä»£ç </span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"@babel/polyfill"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="string">'node_modules'</span>,</span><br><span class="line">        loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          presets: [</span><br><span class="line">            [</span><br><span class="line">              <span class="string">'@babel/preset-env'</span>,</span><br><span class="line">              &#123;</span><br><span class="line">                targets: &#123;</span><br><span class="line">                  chrome: <span class="string">"64"</span></span><br><span class="line">                &#125;,</span><br><span class="line">                useBuiltIns: <span class="string">'usage'</span></span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// **å¦‚æœæ˜¯ç¬¬ä¸‰æ–¹ç±»åº“**</span></span><br><span class="line"><span class="comment">// npm install --save-dev @babel/plugin-transform-runtime</span></span><br><span class="line"><span class="comment">// npm install --save @babel/runtime</span></span><br><span class="line"><span class="comment">// npm install --save @babel/runtime-corejs2</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="string">'node_modules'</span>,</span><br><span class="line">        loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          <span class="string">"plugins"</span>: [</span><br><span class="line">            [</span><br><span class="line">              <span class="string">"@babel/plugin-transform-runtime"</span>,</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="string">"absoluteRuntime"</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="string">"corejs"</span>: <span class="number">2</span>,</span><br><span class="line">                <span class="string">"helpers"</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="string">"regenerator"</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="string">"useESModules"</span>: <span class="literal">false</span></span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¤‡æ³¨ä¸‹ï¼Œ<code>babel-preset-env</code>ä¸ä¼šè½¬æ¢çš„æœ‰ï¼š</p>
<ol>
<li>å…¨å±€å¯¹è±¡ï¼Œå¦‚ <code>Promise</code>, <code>map</code>, <code>WeakMap</code>ç­‰</li>
<li>å…¨å±€å‡½æ•°ï¼Œå¦‚ <code>Array.from</code>, <code>Object,assign</code>ç­‰</li>
<li>ç¤ºä¾‹æ–¹æ³•ï¼Œå¦‚ <code>Array.prototype.includes</code>ç­‰</li>
</ol>
<p>æ³¨æ„<code>presets</code>çš„æ‰§è¡Œé¡ºåºä¹Ÿæ˜¯ä»ä¸‹å¾€ä¸Šï¼Œä»å³å¾€å·¦çš„é¡ºåºã€‚å¦‚æœæ˜¯ç¬¬ä¸‰æ–¹ç±»åº“:</p>
<p>äº‹å®ä¸Šè¿™äº›é…ç½®éƒ½å¯ä»¥æ”¾åœ¨<code>.babelrc</code>æ–‡ä»¶ä¸­ã€‚</p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬ç¯‡æ–‡ç« ä¸»è¦æ˜¯è‡ªæˆ‘çŸ¥è¯†çš„æ¢³ç†åŠè®°å½•ã€‚</p>
<p>å‘¨æœ«åœ¨å®¶ï¼Œæ€»è§‰å¾—é‚£ç§æ²¡å•¥äº‹ï¼Œä¸ç”¨å‡ºé—¨ï¼Œä¹Ÿä¸ç”¨åŠ ç­ï¼Œçœ‹çœ‹æ¸¸æˆè§†é¢‘ï¼Œçœ‹çœ‹ä¹¦é›é›ç‹—çš„æ—¥å­ï¼Œæ‰å«å‘¨æœ«ã€‚ğŸ“šğŸŒ²</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸Šç¯‡æ–‡ç« æ•´ç†äº†å‡ ä¸ªç‚¹ï¼Œè¿™ç¯‡æ–‡ç« æ¥ç€è®°å½•ä¸‹æˆ‘è§‰å¾—æœ‰æ€»ç»“æ„ä¹‰çš„ç‚¹ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;loader-å’Œ-puginçš„åŒºåˆ«&quot;&gt;&lt;a href=&quot;#loader-å’Œ-puginçš„åŒºåˆ«&quot; class=&quot;headerlink&quot; title=&quot;loader å’Œ pugin
    
    </summary>
    
    
      <category term="å·¥å…·/é…ç½®" scheme="http://sevencai.github.io/tags/%E5%B7%A5%E5%85%B7-%E9%85%8D%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>webpack4è¯»ä¹¦ç¬”è¯•(ä¸€)</title>
    <link href="http://sevencai.github.io/2018/12/22/webpack4%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AF%95/"/>
    <id>http://sevencai.github.io/2018/12/22/webpack4è¯»ä¹¦ç¬”è¯•/</id>
    <published>2018-12-22T12:38:39.000Z</published>
    <updated>2019-04-15T06:44:18.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä»Šæ—¥é¸¡æ±¤ï¼š ä¼˜ç§€çš„å·¥ç¨‹å¸ˆ = ä¸»äººç¿æ„è¯† + è¿½æ±‚å“è¶Šçš„ç²¾ç¥</p>
</blockquote>
<p>å†™è¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯å› ä¸ºwebpack4çš„å‡ºç°ï¼Œå¹¶ä¸”å‘ç°ä»¥å‰æœ‰å¾ˆå¤šä¸œè¥¿å…¶å®ä¸€ç›´éƒ½åœ¨ç”¨ï¼Œä½†æ˜¯æ²¡æœ‰å¾ˆç»†çš„äº†è§£é‡Œé¢çš„ä¸œè¥¿ï¼Œæœ¬ç¯‡æ–‡ç« ä¸»è¦æ¢³ç†ä¸‹ç›¸å…³å†…å®¹ã€‚</p>
<p>æƒ³è¦æŠŠè‡ªå·±çŸ¥é“çš„å’Œä¸çŸ¥é“çš„ï¼Œéƒ½ç³»ç»Ÿçš„æ€»ç»“ä¸‹ã€‚</p>
<p><strong>webpackæ¨¡å—æ‰“åŒ…å·¥å…·  -  a static module bundler</strong></p>
<hr>
<h2 id="webpack4å¦‚ä½•åšåˆ°æ›´å¿«"><a href="#webpack4å¦‚ä½•åšåˆ°æ›´å¿«" class="headerlink" title="webpack4å¦‚ä½•åšåˆ°æ›´å¿«"></a>webpack4å¦‚ä½•åšåˆ°æ›´å¿«</h2><p>éœ€è¦nodejsç‰ˆæœ¬æ–° + webpackç‰ˆæœ¬æ–°</p>
<p>webpack ä¼šåˆ©ç”¨æ–°ç‰ˆ Nodejs çš„ç‰¹æ€§è¿›è¡Œæ›´å¥½çš„ä¼˜åŒ–</p>
<hr>
<h2 id="â€“save-dev-D"><a href="#â€“save-dev-D" class="headerlink" title="â€“save-dev =  -D"></a>â€“save-dev =  -D</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack webpack-cli --save-dev</span><br><span class="line">npm install webpack webpack-cli -D</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="npxå’Œnpmçš„åŒºåˆ«"><a href="#npxå’Œnpmçš„åŒºåˆ«" class="headerlink" title="npxå’Œnpmçš„åŒºåˆ«"></a>npxå’Œnpmçš„åŒºåˆ«</h2><p>npxä¼šå»å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„ node_modules æ‰¾å‘½ä»¤<br>npmä¼šå»å…¨å±€æ‰¾å‘½ä»¤ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œæ‰ä¼šå»å½“å‰çš„node_modulesä¸‹<br>å¦‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm webpack -v æ˜¯å…¨å±€çš„ webpack ç‰ˆæœ¬</span><br><span class="line">npx webpack -v æ˜¯å½“å‰é¡¹ç›®å†…ä½¿ç”¨çš„ webpack ç‰ˆæœ¬</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="å®‰è£…æŸä¸ªç‰ˆæœ¬çš„webpack"><a href="#å®‰è£…æŸä¸ªç‰ˆæœ¬çš„webpack" class="headerlink" title="å®‰è£…æŸä¸ªç‰ˆæœ¬çš„webpack"></a>å®‰è£…æŸä¸ªç‰ˆæœ¬çš„webpack</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// æŸ¥çœ‹webpackçš„å†å²versionä¿¡æ¯</span><br><span class="line">npm info webpack</span><br><span class="line">// å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„version</span><br><span class="line">npm install webpack@version -D</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="webpackæŸ¥è¯¢é…ç½®è·¯å¾„"><a href="#webpackæŸ¥è¯¢é…ç½®è·¯å¾„" class="headerlink" title="webpackæŸ¥è¯¢é…ç½®è·¯å¾„"></a>webpackæŸ¥è¯¢é…ç½®è·¯å¾„</h2><p>webpack éœ€è¦æŒ‡å®šå…¥å£æ–‡ä»¶</p>
<ol>
<li><code>npx webpack index.js</code>å…¥å£æ–‡ä»¶ä¸º <code>index.js</code>, <code>webpack4</code>ä»¥<code>index.js</code>ä½œä¸ºå…¥å£ã€‚</li>
<li>è‹¥ä¸æŒ‡å®šå…¥å£ï¼Œ<code>webpack</code>åˆ™å–æ‰¾ <code>webpack.config.js</code> æ–‡ä»¶ï¼Œè¯»å–é…ç½®æ–‡ä»¶ä¸­çš„<code>entry</code>ã€‚</li>
<li>è‹¥ä¸æŒ‡å®šå…¥å£å¹¶ä¸”æ²¡æœ‰<code>webpack.config.js</code>æ–‡ä»¶ï¼Œåˆ™æŠ¥é”™ã€‚</li>
<li>å¦‚æœä¸æƒ³ç”¨ <code>webpack.config.js</code>ï¼Œå¯ä»¥ä½¿ç”¨<code>npx webpack --config webpackconfig.js</code>æ¥æŒ‡å®šé…ç½®æ–‡ä»¶ã€‚</li>
</ol>
<p>æœ€ç®€å•çš„ demo:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./path/to/my/entry/file.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    <span class="comment">// æ³¨æ„è¿™é‡Œæ˜¯ç»å¯¹è·¯å¾„ï¼Œwebpack4é»˜è®¤æ˜¯è¿™ä¸ªdistè·¯å¾„ï¼Œå¦‚æœä½ ä¸å†™çš„è¯</span></span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    <span class="comment">// filename å¯ä»¥æŒ‡å®šç”Ÿæˆçš„æ–‡ä»¶çš„åç§°</span></span><br><span class="line">    filename: <span class="string">'my-first-webpack.bundle.js'</span>,</span><br><span class="line">    <span class="comment">// filename: '[name].bundle.js',  </span></span><br><span class="line">	<span class="comment">// filename: '[name].js',  </span></span><br><span class="line">	<span class="comment">// filename: '[hash].bundle.js' //b4  </span></span><br><span class="line">	<span class="comment">// filename: '[id].bundle.js'  </span></span><br><span class="line">	<span class="comment">// filename: '[chunkhash].bundle.js',ed  </span></span><br><span class="line">	<span class="comment">// filename: '[contenthash].bundle.js'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>å¦‚ä¸‹åˆ†åˆ«æ˜¯å¯¹åº”çš„ç”Ÿæˆç»“æœï¼š</p>
<p><img src="hash.png" alt="ç›¸å…³filenameé…ç½®"></p>
<p>ä¸ºä»€ä¹ˆ <code>[name].js</code>ç”Ÿæˆçš„å¯¹åº”æ˜¯ <code>main.js</code>å‘¢ï¼Ÿå› ä¸º<code>entry: &#39;xxx&#39; = entry: {main: &#39;xxx&#39;}</code>, çœç•¥äº†åç§°ä¸º <code>main</code> çš„å†™æ³•ã€‚</p>
<p>outputè¿˜æœ‰å¾ˆå¤šoptions,å¯ä»¥å‚ç…§å®˜æ–¹æ–‡æ¡£æ¥çœ‹ã€‚<a href="https://webpack.js.org/configuration/output/" target="_blank" rel="noopener">output</a></p>
<p>æ³¨æ„ä¸€èˆ¬æƒ…å†µæˆ‘ä»¬ä¸ä¼šæŠŠ output é‡Œçš„ filename ç›´æ¥è®¾ç½®ä¸º bundle.js,è¿™æ ·å¦‚æœåˆå¤šä¸ªentry,æœ€åéƒ½è¢«å‘½åä¸º bundle.jsï¼Œwebpackå°±ä¼šæŠ¥é”™äº†ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±è®¾ç½®ä¸º<code>[name].bundle.js</code>å°±æŒºå¥½çš„ã€‚</p>
<p>output é‡Œé¢è¿˜æœ‰æˆ‘ä»¬ç»å¸¸ç”¨åˆ°çš„ <code>publicPath</code>, ç”¨äºè®¾ç½®é™æ€èµ„æºçš„åœ°å€ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥è®¾ç½®å®ƒä¸ºcdnçš„åŸŸåè·¯å¾„ã€‚<code>//cdn.com/h5</code>,æœ€åhtmlæ–‡ä»¶ä¸­ç”Ÿæˆçš„è·¯å¾„å¯èƒ½å°±æ˜¯<code>&lt;script type=&quot;text/javascript&quot; src=&quot;//cdn.com/h5/main.bundle.js&quot;&gt;&lt;/script&gt;</code>è¿™ç§æˆ‘ä»¬éœ€è¦çš„è·¯å¾„ã€‚</p>
<hr>
<h2 id="webpack4-mode"><a href="#webpack4-mode" class="headerlink" title="webpack4 mode"></a>webpack4 mode</h2><p><code>mode: development/production</code> ä¸»è¦åŒºåˆ«åœ¨æ˜¯å¦å‹ç¼©ã€‚å¦‚æœé…ç½®ä¸­ä¸å†™ï¼Œé»˜è®¤æ˜¯ <code>production</code>,å¹¶ä¸”ä¼šæœ‰ warningã€‚</p>
<p>webpackæ‰“åŒ…åæ§åˆ¶å°ä¿¡æ¯ï¼š<br>hash  æœ¬æ¬¡æ‰“åŒ…çš„å”¯ä¸€ä¸€ä¸ªhashå€¼<br>Version  webpackçš„ç‰ˆæœ¬<br>Time  æ‰“åŒ…è€—æ—¶<br>Asset  æ‰“åŒ…åçš„æ–‡ä»¶å<br>Size  æ‰“åŒ…åçš„æ–‡ä»¶å¤§å°<br>Chunks  æ‰“åŒ…åæ–‡ä»¶å¯¹åº”çš„id<br>Chunk Names  æ¯ä¸€ä¸ªæ‰“åŒ…åæ–‡ä»¶å¯¹åº”çš„æ‰“åŒ…æ–‡ä»¶åå­—</p>
<p><img src="webpack.png" alt="æ§åˆ¶å°ä¿¡æ¯"></p>
<p>æœ‰çš„æ—¶å€™æœ‰è­¦å‘Šæ˜¯å› ä¸ºæ²¡æœ‰é…ç½®æ‰“åŒ…çš„æ¨¡å¼ï¼šmodeï¼Œmodeæœ‰ä¸¤ç§è®¾ç½®ï¼šé»˜è®¤çš„æ˜¯productionï¼Œä»£ç ä¼šè¢«å‹ç¼©ï¼Œè¿˜å¯ä»¥æ˜¯developmentï¼Œä»£ç ä¸å‹ç¼©</p>
<hr>
<h2 id="loader"><a href="#loader" class="headerlink" title="loader"></a>loader</h2><p>webpack é»˜è®¤åªçŸ¥é“æ‰“åŒ…jsæ–‡ä»¶ï¼Œpng,css ç­‰æ˜¯ä¸çŸ¥é“åº”è¯¥æ€ä¹ˆå¤„ç†çš„ã€‚</p>
<p><strong>æ‰€ä»¥å¯¹äº png, css, vue è¿™ä¸€ç±»çš„æ¨¡å—èµ„æºï¼Œæˆ‘ä»¬å°±å¾—åœ¨webpacké…ç½®ä¸­ï¼Œå‘Šè¯‰webpackæ€ä¹ˆæ‰“åŒ…ã€‚å…·ä½“å°±æ˜¯æ”¾åœ¨ module é‡Œï¼Œé…ç½®ç›¸å…³çš„ruleï¼Œç„¶åç”¨ç›¸å…³çš„ loader å»å¤„ç†</strong>ã€‚</p>
<p>å› æ­¤å¯ä»¥ç†è§£ä¸ºï¼šloaderå°±æ˜¯æ‰“åŒ…æ–¹æ¡ˆï¼Œå¯¹éjsç»“å°¾æ¨¡å—ï¼Œè¦ç”¨loaderè¿›è¡Œå¤„ç†ã€‚</p>
<hr>
<h2 id="å¤„ç†å›¾ç‰‡çš„loader"><a href="#å¤„ç†å›¾ç‰‡çš„loader" class="headerlink" title="å¤„ç†å›¾ç‰‡çš„loader"></a>å¤„ç†å›¾ç‰‡çš„loader</h2><p>è¿™é‡Œä¸¾ä¾‹ä¸¤ç§å¤„ç†å›¾ç‰‡çš„loader, <code>file-loader</code>åŠ<code>url-loader</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">   <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|jpeg)$/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'file-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            name: <span class="string">'[name]_[hash].[ext]'</span>,</span><br><span class="line">            outputPath: <span class="string">'images/'</span>,</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ›´å¤šç›¸å…³é…ç½®ï¼Œè¦å‚è€ƒ <a href="https://webpack.js.org/loaders/file-loader/#outputpath" target="_blank" rel="noopener">webpack loader</a> ä¸€èŠ‚ã€‚æ ‡æ³¨ä¸¤ä¸ªç»å¸¸ç”¨åˆ°çš„ç‚¹ï¼š</p>
<ol>
<li><code>name</code>æ ‡æ˜ä½ è¦ç”Ÿæˆå›¾ç‰‡çš„åç§°ï¼Œæ¯”å¦‚<code>[name].[ext]</code>å°±æ˜¯åŸæ–‡ä»¶åè¾“å‡ºï¼Œ<code>[name]_[hash].[ext]</code>å°±æ˜¯<code>åç§°+hash</code>åçš„æ–‡ä»¶ï¼Œå¦‚ï¼š<code>1_752df31a916202d90967bed23f618507.png</code>ã€‚</li>
<li><code>outputPath</code>æ ‡æ˜ä½ è¦æŠŠæ–‡ä»¶æ”¾åœ¨å“ªä¸ªç›®å½•ä¸‹ï¼Œå¦‚<code>dist/images</code>ä¸‹ã€‚è®¾ç½®è¿™é‡Œ<code>outputPath</code>è¿˜å¯ä»¥æ˜¯ä¸ªå‡½æ•°ã€‚å¦‚ä¸‹</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">outputPath: <span class="function">(<span class="params">url, resourcePath, context</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/images/</span>.test(context)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`image_output_path/<span class="subst">$&#123;url&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">`output_path/<span class="subst">$&#123;url&#125;</span>`</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‡Œé¢ <code>file-loader</code> åšäº†ä¸¤ä»¶äº‹æƒ…ï¼š</p>
<ol>
<li>ç§»åŠ¨æ–‡ä»¶åˆ°distæ–‡ä»¶ä¸‹</li>
<li>å¾—åˆ°å›¾ç‰‡åç§°ï¼Œä½œä¸ºè¿”å›å€¼ï¼Œè¿”å›åç§°</li>
</ol>
<p>æ³¨æ„file-loaderä¸ä¸€å®šæ˜¯é’ˆå¯¹å›¾ç‰‡ï¼Œå¯¹txtç­‰å…¶ä»–æ–‡ä»¶ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªæ˜¯ <code>url-loader</code>, <code>url-loader</code> å’Œ <code>file-loader</code>ã€‚</p>
<p><code>url-loader</code>å¯ä»¥æŠŠå›¾ç‰‡è½¬æ¢æˆbase64ç¼–ç ï¼Œå¹¶æ”¾äºjsä¸­ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯èŠ‚çº¦äº†ä¸€æ¬¡httpè¯·æ±‚ï¼Œåå¤„æ˜¯å¦‚æœå›¾ç‰‡å¤ªå¤§ï¼Œè½¬æ¢æˆçš„<code>base64</code>å¤ªå¤§ï¼Œå°±ä¼šå¯¼è‡´jså¤ªå¤§ï¼Œå½±å“é¡µé¢çš„åŠ è½½å’Œæ‰§è¡Œã€‚</p>
<p>å› æ­¤æ­£ç¡®ä½¿ç”¨ <code>url-loader</code> çš„å½¢å¼æ˜¯å¦‚æœå›¾ç‰‡å¾ˆå°ï¼Œæ¯”å¦‚æ˜¯ä¸ª <code>icon</code>, é‚£ä¹ˆç”¨ <code>url-loader</code> å°±å¤ªé€‚åˆäº†ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆæ¥å†™ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpg|jpeg|)$/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">'url-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            name: <span class="string">'[name]_[hash].[ext]'</span>,</span><br><span class="line">            outputPath: <span class="string">'images/'</span>,</span><br><span class="line">            limit: <span class="number">20480</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ–‡ä»¶æ¯” 20k è¦å¤§ï¼Œ åˆ™<code>url-loader</code>ä¼šè‡ªåŠ¨ä½¿ç”¨<code>file-loader</code>æ¥å¤„ç†æ–‡ä»¶ã€‚</p>
<hr>
<h2 id="å¤„ç†cssçš„loader"><a href="#å¤„ç†cssçš„loader" class="headerlink" title="å¤„ç†cssçš„loader"></a>å¤„ç†cssçš„loader</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  </span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rule: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">            <span class="string">'style-loader'</span>,</span><br><span class="line">             &#123;</span><br><span class="line">               loader: <span class="string">'css-loader'</span>,</span><br><span class="line">               options: &#123;</span><br><span class="line">                 importLoaders: <span class="number">2</span>,</span><br><span class="line">                 modules: <span class="literal">true</span></span><br><span class="line">               &#125;</span><br><span class="line">             &#125;,</span><br><span class="line">             <span class="string">'sass-loader'</span>,</span><br><span class="line">             <span class="string">'postcss-loader'</span></span><br><span class="line">           ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼š<strong>loaderçš„æ‰§è¡Œé¡ºåºæ˜¯ä»ä¸‹åˆ°ä¸Šï¼Œä»å³åˆ°å·¦</strong>ï¼Œå¦‚ä¸Šé¢å°±æ˜¯å…ˆæ‰§è¡Œ <code>postcss-loader</code>, æœ€åæ‰§è¡Œ<code>style-loader</code>ã€‚å…¶ä¸­åŒºåˆ«è§£é‡Šå¦‚ä¸‹ï¼š</p>
<ol>
<li><code>style-loader</code> ç”¨æ¥æŠŠ style èŠ‚ç‚¹æ·»åŠ åˆ° dom ä¸Šçš„ï¼Œå³è´Ÿè´£æŠŠcssä»£ç æŒ‚è½½åˆ°<head></head>ä¸­é—´ã€‚</li>
<li><code>css-loader</code> ç”¨æ¥æŠŠä¸€ä¸ªæˆ–å¤šä¸ªcssæ–‡ä»¶åˆå¹¶æˆä¸€æ®µcssä»£ç ï¼Œæ¯”å¦‚æœ‰å¤šä¸ªcssæ–‡ä»¶ï¼Œå¯ä»¥åˆæˆä¸€ä¸ªã€‚</li>
<li><code>postcss-loader</code> å¯ä»¥ç”¨æ¥å¸®æˆ‘ä»¬åšcssæ·»åŠ å‰ç¼€ï¼Œæˆ–è€…å‹ç¼©ä¼˜åŒ–cssç­‰å·¥ä½œã€‚ä¸€èˆ¬<code>postcss-loader</code>éœ€è¦å»ºç«‹ä¸€ä¸ª<code>postcss.config.js</code>ç”¨æ¥å†™ç›¸å…³é…ç½®ã€‚å¦‚ï¼š</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">      <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è§£é‡Š<code>css-loader</code>éƒ¨åˆ†å‚æ•°çš„å«ä¹‰ï¼š</p>
<ol>
<li><code>importLoaders: 2</code>ä¿è¯ä¸ç®¡æ˜¯jsä¸­å¼•ç”¨cssæ–‡ä»¶ï¼Œè¿˜æ˜¯jsä¸­å¼•ç”¨jsæ–‡ä»¶ï¼Œéƒ½è¦ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡è¿›è¡Œä½¿ç”¨loader, è€Œä¸æ˜¯åªæœ‰indexé‡Œé¢importçš„cssè¢«ä»ä¸‹åˆ°ä¸Šæ‰§è¡Œï¼Œè€Œcssé‡Œé¢å¼•ç”¨çš„æ–‡ä»¶ä¸ä¼šä»ä¸‹åˆ°ä¸Šæ‰§è¡Œã€‚</li>
<li><code>modules: true</code>ä½¿cssæ”¯æŒæ¨¡å—åŒ–å¼•ç”¨ï¼Œå¦‚ä¸æƒ³è®©æŸä¸ªcssæ–‡ä»¶ä½œç”¨äºå…¨å±€ã€‚<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> style <span class="keyword">from</span> <span class="string">'./1.css'</span></span><br><span class="line"></span><br><span class="line">img.classList.add(style.avatar)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>è¿™æ ·ï¼Œstyleä¸­çš„æ ·å¼å¯ä»¥åªé’ˆå¯¹æŸäº›åœ°æ–¹ç”Ÿæ•ˆï¼Œè€Œä¸æ˜¯å…¨å±€ç”Ÿæ•ˆã€‚å…¶å®æˆ‘æœ€ç»å¸¸ç”¨çš„æ˜¯ <code>import &#39;./1.css&#39;</code> ä½œç”¨äºå…¨å±€,å› ä¸ºæˆ‘ä»¬çš„æ ·å¼éƒ½æ˜¯é‡æ„ç»Ÿä¸€ç»™åˆ°çš„ã€‚</p>
<hr>
<h2 id="å¤„ç†å­—ä½“æ–‡ä»¶çš„loader"><a href="#å¤„ç†å­—ä½“æ–‡ä»¶çš„loader" class="headerlink" title="å¤„ç†å­—ä½“æ–‡ä»¶çš„loader"></a>å¤„ç†å­—ä½“æ–‡ä»¶çš„loader</h2><p>å½“æˆ‘ä»¬å†cssã€sassæ–‡ä»¶ä¸­å¼•å…¥äº†å­—ä½“æ–‡ä»¶ï¼Œå¦‚<code>eot, ttf, svg</code>,å¦‚æœæˆ‘ä»¬ä¸å‘Šè¯‰webpackï¼Œwebpackä¼šæŠ¥é”™<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">font-face</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>: <span class="string">"iconfont"</span>,</span><br><span class="line">    src: <span class="built_in">url</span>(<span class="string">'./font/iconfont.eot'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å› ä¸ºwebpackå¹¶ä¸çŸ¥é“å¦‚ä½•å»å¤„ç†å¹¶å¼•å…¥è¿™äº›æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™è¿™äº›ç»“å°¾çš„æ–‡ä»¶ï¼ˆå­—ä½“ï¼‰ï¼Œä½¿ç”¨ <code>file-loader</code>ï¼Œå¦‚ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  test: <span class="regexp">/\.(eot|ttf|svg)$/</span>,</span><br><span class="line">  use: &#123;</span><br><span class="line">    loader: <span class="string">'file-loader'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>é™¤äº†ä¸Šè¿°loader,è¿˜æœ‰å…¶ä»–å¦‚ <code>xml-loader, cvs-loader</code> ç­‰,å¯ä»¥å‚è€ƒç€ä¸€èŠ‚ã€‚<a href="https://webpack.js.org/guides/asset-management/#loading-fonts" target="_blank" rel="noopener">loader</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">      filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">      path: path.resolve(__dirname, <span class="string">'dist'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">-   <span class="built_in">module</span>: &#123;</span><br><span class="line">-     rules: [</span><br><span class="line">-       &#123;</span><br><span class="line">-         test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">-         use: [</span><br><span class="line">-           <span class="string">'style-loader'</span>,</span><br><span class="line">-           <span class="string">'css-loader'</span></span><br><span class="line">-         ]</span><br><span class="line">-       &#125;,</span><br><span class="line">-       &#123;</span><br><span class="line">-         test: <span class="regexp">/\.(png|svg|jpg|gif)$/</span>,</span><br><span class="line">-         use: [</span><br><span class="line">-           <span class="string">'file-loader'</span></span><br><span class="line">-         ]</span><br><span class="line">-       &#125;,</span><br><span class="line">-       &#123;</span><br><span class="line">-         test: <span class="regexp">/\.(woff|woff2|eot|ttf|otf)$/</span>,</span><br><span class="line">-         use: [</span><br><span class="line">-           <span class="string">'file-loader'</span></span><br><span class="line">-         ]</span><br><span class="line">-       &#125;,</span><br><span class="line">-       &#123;</span><br><span class="line">-         test: <span class="regexp">/\.(csv|tsv)$/</span>,</span><br><span class="line">-         use: [</span><br><span class="line">-           <span class="string">'csv-loader'</span></span><br><span class="line">-         ]</span><br><span class="line">-       &#125;,</span><br><span class="line">-       &#123;</span><br><span class="line">-         test: <span class="regexp">/\.xml$/</span>,</span><br><span class="line">-         use: [</span><br><span class="line">-           <span class="string">'xml-loader'</span></span><br><span class="line">-         ]</span><br><span class="line">-       &#125;</span><br><span class="line">-     ]</span><br><span class="line">-   &#125;</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬ç¯‡ä¸»è¦è·Ÿ loader ç›¸å…³ã€‚ç†è§£webpackæ˜¯ä»»ä½•æ—¶å€™å¯ä»¥æŠŠä»»ä½•ç±»å‹çš„æ–‡ä»¶éƒ½å½“æˆæ¨¡å—å»å¤„ç†ã€‚</p>
<p>ç†è§£ loader æ˜¯ä¸ºäº†å‘Šè¯‰ webpack ä»€ä¹ˆæ ·çš„æ–‡ä»¶ï¼Œåº”è¯¥ç”¨ä»€ä¹ˆæ ·çš„ä¸œè¥¿å¤„ç†ã€‚</p>
<p>å³loader æ˜¯æ‰“åŒ…æ–¹æ¡ˆï¼Œæ˜¯å‘Šè¯‰ webpack é js ç»“å°¾çš„åº”è¯¥æ€ä¹ˆå¤„ç†ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä»Šæ—¥é¸¡æ±¤ï¼š ä¼˜ç§€çš„å·¥ç¨‹å¸ˆ = ä¸»äººç¿æ„è¯† + è¿½æ±‚å“è¶Šçš„ç²¾ç¥&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å†™è¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯å› ä¸ºwebpack4çš„å‡ºç°ï¼Œå¹¶ä¸”å‘ç°ä»¥å‰æœ‰å¾ˆå¤šä¸œè¥¿å…¶å®ä¸€ç›´éƒ½åœ¨ç”¨ï¼Œä½†æ˜¯æ²¡æœ‰å¾ˆç»†çš„äº†è§£é‡Œé¢çš„ä¸œè¥¿ï¼Œæœ¬ç¯‡æ–‡ç« ä¸»è¦æ¢³ç†ä¸‹ç›¸å…³å†…å®¹ã€‚&lt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>import or require?</title>
    <link href="http://sevencai.github.io/2018/12/05/import-or-require/"/>
    <id>http://sevencai.github.io/2018/12/05/import-or-require/</id>
    <published>2018-12-05T13:25:18.000Z</published>
    <updated>2018-12-05T07:16:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹æ‰€ä»¥ä¼šå»å†™è¿™ä¸ªï¼Œæ˜¯å› ä¸ºè‡ªå·±æœ€è¿‘é‡åˆ°äº† import çš„ä¸€ä¸ªé—®é¢˜ã€‚</p>
<p>æ‰¾é—®é¢˜çš„è¿‡ç§°ä¸­ï¼Œå‘ç°è‡ªå·±è™½ç„¶ä¸€ç›´åœ¨ç”¨ importï¼Œä½†å¯¹ require/import çš„åŒºåˆ«å¹¶æ²¡æœ‰äº†è§£çš„å¾ˆå…¨é¢ã€‚</p>
<p>å…·ä½“çš„ç‚¹å°±åœ¨ <code>Imports are hoisted</code>ã€‚è¶æ­¤æœºä¼šå¤§æ¦‚çš„é‡æ–°æ€»ç»“ä¸‹ã€‚</p>
<hr>
<h2 id="å†å²è¿½æº¯"><a href="#å†å²è¿½æº¯" class="headerlink" title="å†å²è¿½æº¯"></a>å†å²è¿½æº¯</h2><blockquote>
<p>äº†è§£å†å²ï¼Œä¸ä¸€å®šæ˜¯ä½¿ç”¨å†å²ï¼Œå´å¯ä»¥å¯¹æ•´ä½“çš„çŸ¥è¯†æœ‰ä¸ªå¤§è‡´çš„è®¤è¯†ã€‚æˆ‘è‡ªå·±æ²¡æœ‰ç»å†è¿‡ <code>SeaJS/RequireJS</code> æ—¶ä»£ï¼Œæ‰€ä»¥å¯¹å®ƒé‡Œé¢å…·ä½“çš„åŸç†å®ç°å’Œç”¨æ³•ä¸æ˜¯ç‰¹åˆ«ç†Ÿæ‚‰ã€‚åªæ˜¯çœ‹åˆ°ç»„é‡Œä»¥å‰åŒäº‹çš„æ—§ä»£ç ï¼Œæ‰å‘ç°é‚£å‡ å¹´ç¡®å®å¯èƒ½å¾ˆç«ã€‚</p>
</blockquote>
<p>å…³äº CommonJS, RequireJS, SeaJS , æˆ‘å¤§è‡´çš„ç”»äº†å¦‚ä¸‹ä¸€ä¸ªå›¾æ¥æè¿°ï¼š</p>
<p><img src="understandstandard.png" alt="å…³ç³»å›¾"></p>
<p>æ€»ç»“ä¸ºä¸‹é¢å‡ ç‚¹ï¼š</p>
<ol>
<li><code>CommonJS</code> å›  <code>Nodejs</code> è€Œç”Ÿï¼Œæ˜¯ <strong><code>Nodejs çš„è§„èŒƒ</code></strong>ï¼Œä¸€ç›´æ²¿ç”¨è‡³ä»Šã€‚</li>
<li>ç”±äºæµè§ˆå™¨ç«¯ä¹Ÿéœ€è¦æ¨¡å—åŒ–çš„åŸå› ï¼Œç”± <code>CommonJS</code> è¡ç”Ÿå‡ºæ¥äº† AMD å’Œ CMD è§„èŒƒã€‚</li>
<li>åŸºäº AMD/CMD è§„èŒƒï¼Œå‡ºç°äº†ä¸¤ä¸ªåŸºäºæ­¤è§„èŒƒçš„åº“ã€‚åˆ†åˆ«æ˜¯ <code>RequireJS</code>, <code>SeaJS</code>ã€‚</li>
<li><code>RequireJS</code> æ˜¯ AMD çš„è§„èŒƒã€‚ç‰¹ç‚¹æ˜¯ï¼š<strong>æå‰åŠ è½½</strong>ã€‚</li>
<li><code>SeaJS</code> æ˜¯ CMD çš„è§„èŒƒã€‚ç‰¹ç‚¹æ˜¯ï¼šæŒ‰éœ€åŠ è½½ã€‚<strong>ç”¨åˆ°æ—¶æ‰åŠ è½½</strong>ã€‚</li>
<li>ç°åœ¨æ–°çš„æ ‡å‡† <code>ES6 import/export</code> å‡ºç°ï¼Œä½†æ˜¯å¾ˆå¤šæµè§ˆå™¨è¿˜æœªå®ç°ï¼Œæ‰€ä»¥æœ€ç»ˆè¿˜æ˜¯éœ€è¦ç”¨ <strong>babel è½¬æ¢æˆ CommonJS</strong>ã€‚</li>
<li><code>import/export</code> æ˜¯å¤§åŠ¿æ‰€è¶‹ã€‚</li>
</ol>
<p>å…·ä½“çš„æƒ³çœ‹ AMD/CMD çš„åŒºåˆ«ï¼Œå¯ä»¥å‚è€ƒ 16 å¹´æˆ‘æ€»ç»“çš„æ–‡ä»¶ã€‚<a href="https://sevencai.github.io/2016/02/18/AMD%E5%92%8CCMD%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E8%81%94%E7%B3%BB/">AMDå’ŒCMDçš„åŒºåˆ«å’Œè”ç³»</a>ã€‚</p>
<hr>
<h2 id="import-require-åŒºåˆ«-Commonjs-pk-ES6"><a href="#import-require-åŒºåˆ«-Commonjs-pk-ES6" class="headerlink" title="import / require åŒºåˆ« (Commonjs pk ES6)"></a>import / require åŒºåˆ« (Commonjs pk ES6)</h2><p><img src="requireimport.png" alt="require pk import"></p>
<h3 id="å†™æ³•ä¸åŒ"><a href="#å†™æ³•ä¸åŒ" class="headerlink" title="å†™æ³•ä¸åŒ"></a>å†™æ³•ä¸åŒ</h3><p>CommonJS çš„æ¨¡å—åŒ–ï¼Œrequire/exports åŸºæœ¬ä¸Šåªæœ‰ä¸‹é¢è¿™å‡ ç§å†™æ³•ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">exports.fs = fs</span><br><span class="line"><span class="built_in">module</span>.exports = fs</span><br><span class="line"></span><br><span class="line">fs.readFileSync(path)</span><br></pre></td></tr></table></figure></p>
<p>import çš„å†™æ³•å¤šç§å¤šæ ·ï¼Œæ¯”å¦‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> cookie <span class="keyword">from</span> <span class="string">'./cookie'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; getCookie, setCookie &#125; <span class="keyword">from</span> <span class="string">'./cookie'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cookie, &#123; getCookie &#125; <span class="keyword">from</span> <span class="string">'./cookie'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‹é¢ä¸¤è€…ç›¸åŒ</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> cookie &#125; <span class="keyword">from</span> <span class="string">'./cookie'</span></span><br><span class="line"><span class="keyword">import</span> cookie <span class="keyword">from</span> <span class="string">'./cookie'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> cookie</span><br><span class="line"><span class="keyword">export</span> cookie</span><br><span class="line"><span class="keyword">export</span> &#123; getCookie, setCookie &#125;</span><br></pre></td></tr></table></figure></p>
<p>ç­‰ç­‰å†™æ³•ã€‚ import æ¯”è¾ƒçµæ´»ï¼Œå¹¶ä¸”æ”¯æŒéƒ¨åˆ†æ¨¡å—çš„å¯¼å…¥ã€‚ä¸åƒ require å…¨éƒ¨å¯¼å…¥ã€‚</p>
<h3 id="åŠ è½½é¡ºåºä¸åŒ-Imports-are-hoisted"><a href="#åŠ è½½é¡ºåºä¸åŒ-Imports-are-hoisted" class="headerlink" title="åŠ è½½é¡ºåºä¸åŒ - Imports are hoisted"></a>åŠ è½½é¡ºåºä¸åŒ - Imports are hoisted</h3><p>ES6 æ¨¡å—æ˜¯ç¼–è¯‘æ—¶åŠ è½½ï¼Œä½¿å¾—é™æ€åˆ†ææˆä¸ºå¯èƒ½ã€‚</p>
<p>import ä¼šæå‰åŠ è½½ï¼Œç±»ä¼¼äº JS é‡Œçš„æ¦‚å¿µ å˜é‡æå‡ã€‚ä¹Ÿå°±å¯ä»¥ç†è§£ä¸º import æ€»è¢«å…ˆç§»åˆ°ä¸Šé¢å»æ‰§è¡Œã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config.js</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'in config'</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; <span class="attr">port</span>: <span class="number">80</span> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'begin load'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> config <span class="keyword">from</span> <span class="string">'./config'</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'load finished'</span>)</span><br></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œ main.js å°†è¿”å›ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">in</span> config</span><br><span class="line">begin load</span><br><span class="line">load finished</span><br></pre></td></tr></table></figure></p>
<p>ä¹Ÿå°±æ˜¯è¯´è¿™ä¹ˆå†™ä¸ä¼šæŠ¥é”™ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">renderData()</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; renderData &#125; <span class="keyword">from</span> <span class="string">'../util'</span></span><br></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯è¿™ä¹ˆå†™ä¼šæŠ¥é”™ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// æŠ¥é”™</span><br><span class="line">if (x === true) &#123;</span><br><span class="line">  import MyModual from &apos;./myModual&apos;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">import x+var from &apos;./&apos; + filename</span><br></pre></td></tr></table></figure></p>
<p>import æ˜¯åœ¨ç¼–è¯‘æ—¶ï¼Œif è¿™äº›è¯­å¥éƒ½ä¼šè¢«å¿½ç•¥ï¼Œä¼šè¢«æåˆ°æœ€ä¸Šé¢ã€‚å› æ­¤ä¼šæŠ¥è¯­æ³•é”™è¯¯ï¼Œè€Œä¸æ˜¯æ‰§è¡Œçš„é”™è¯¯ã€‚æ‰€ä»¥import export æœ€å¥½å°±æ”¾åœ¨æœ€é¡¶å±‚ã€‚ä¸è¦åœ¨å‡½æ•°æˆ–è€…æ¡ä»¶è¯­å¥ä¸­ã€‚</p>
<p>require æ˜¯éé™æ€ç¼–è¯‘ç±»å‹ã€‚æ˜¯ CommonsJS è¿™ç§ï¼Œè¿è¡Œæ—¶åŠ è½½,æ‰€ä»¥å¯ä»¥åŠ¨æ€å»æ‹¼æ¥æ¨¡å—ã€‚</p>
<p>å¯¹äºRequireæ¥è¯´è¿è¡Œç»“æœå°±æ˜¯ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config.js</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'in config'</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;<span class="attr">port</span>: <span class="number">80</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'begin load'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> config = <span class="built_in">require</span>(<span class="string">'./config.mjs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'load finished'</span>)</span><br></pre></td></tr></table></figure></p>
<p>å¾—åˆ°çš„ç»“æœï¼Œè·Ÿæˆ‘ä»¬çš„é¢„æœŸç›¸åŒã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">begin load</span><br><span class="line">in config</span><br><span class="line">load finished</span><br></pre></td></tr></table></figure></p>
<h3 id="Imports-åªå¯è¯»-Imports-are-read-only-views-on-exports"><a href="#Imports-åªå¯è¯»-Imports-are-read-only-views-on-exports" class="headerlink" title="Imports åªå¯è¯» - Imports are read-only views on exports"></a>Imports åªå¯è¯» - Imports are read-only views on exports</h3><p>è¿™ç‚¹å¯ä»¥é˜…è¯»è¿™ä¸ªæ–‡æ¡£ï¼š<a href="http://exploringjs.com/es6/ch_modules.html#sec_imports-as-views-on-exports" target="_blank" rel="noopener">è®²çš„å¾ˆæ¸…æ¥š</a>ã€‚çœ‹ä¸ªä¾‹å­ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// counter.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> counter = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">incCounter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  counter++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; counter, incCounter &#125; <span class="keyword">from</span> <span class="string">'./counter'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The imported value `counter` is live</span></span><br><span class="line"><span class="built_in">console</span>.log(counter); <span class="comment">// 3</span></span><br><span class="line">incCounter();</span><br><span class="line"><span class="built_in">console</span>.log(counter); <span class="comment">// 4</span></span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢è¿™ç§æ˜¯okçš„ï¼Œä½†æ˜¯ä¸‹é¢è¿™ç§æ˜¯ä¸åˆæ³•çš„ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; counter, incCounter &#125; <span class="keyword">from</span> <span class="string">'./counter'</span>;</span><br><span class="line"></span><br><span class="line">counter++ <span class="comment">// TypeError</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>Note that while you canâ€™t change the values of imports, you can change the objects that they are referring to. For example:</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lib.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; obj &#125; <span class="keyword">from</span> <span class="string">'./lib'</span>;</span><br><span class="line"></span><br><span class="line">obj.prop = <span class="number">123</span>; <span class="comment">// OK</span></span><br><span class="line">obj = &#123;&#125;; <span class="comment">// TypeError</span></span><br></pre></td></tr></table></figure>
<p>è¿™ç‚¹æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºï¼Œå˜é‡çš„åœ°å€æ˜¯ä¸èƒ½æ”¹å˜çš„ï¼Œé‡æ–°èµ‹å€¼æ—¶ï¼Œå˜é‡çš„åœ°å€å˜äº†ï¼Œè¿™ä¸ªä¸å…è®¸ï¼Œä½†æ˜¯ä½ å¦‚æœæ”¹å˜å¯¹è±¡çš„é‡Œé¢å±æ€§çš„å€¼ï¼Œåœ°å€æ˜¯ä¸å˜çš„ã€‚</p>
<p>è¿™ä¸ªå°±åƒä½ å£°æ˜ä¸€ä¸ª const obj, ä¹Ÿå¯ä»¥æ›´æ”¹ Obj.value ä¸€æ ·ã€‚</p>
<p>Require ä¸åŒï¼Œä½ å¯ä»¥ä¿®æ”¹é‡Œé¢çš„å†…å®¹ã€‚</p>
<p>æ¨èæ–‡ç« ï¼š <a href="http://es6.ruanyifeng.com/#docs/module" target="_blank" rel="noopener">ruanyifeng-es6-module</a></p>
<h3 id="å€¼å¼•ç”¨-or-å€¼æ‹·è´"><a href="#å€¼å¼•ç”¨-or-å€¼æ‹·è´" class="headerlink" title="å€¼å¼•ç”¨ or å€¼æ‹·è´"></a>å€¼å¼•ç”¨ or å€¼æ‹·è´</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// counter.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> count = <span class="number">0</span></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'increase count to'</span>, ++count, <span class="string">'in counter.js after 500ms'</span>)</span><br><span class="line">&#125;, <span class="number">500</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123;count&#125; <span class="keyword">from</span> <span class="string">'./counter.mjs'</span></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'read count after 1000ms in es6 is'</span>, count)</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°çš„ç»“æœæ˜¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">increase count to 1 in counter.js after 500ms</span><br><span class="line">read count after 1000ms in es6 is 1</span><br></pre></td></tr></table></figure></p>
<p>å¦å¤–ä¸€æ®µä»£ç <br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// counter.js</span></span><br><span class="line">exports.count = <span class="number">0</span></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'increase count to'</span>, ++exports.count, <span class="string">'in counter.js after 500ms'</span>)</span><br><span class="line">&#125;, <span class="number">500</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">const</span> &#123;count&#125; = <span class="built_in">require</span>(<span class="string">'./counter'</span>)</span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'read count after 1000ms in commonjs is'</span>, count)</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure></p>
<p>å¾—åˆ°çš„ç»“æœæ˜¯ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">increase count to <span class="number">1</span> <span class="keyword">in</span> counter.js after <span class="number">500</span>ms</span><br><span class="line">read count after <span class="number">1000</span>ms <span class="keyword">in</span> commonjs is <span class="number">0</span></span><br></pre></td></tr></table></figure></p>
<p>å¤§æ¦‚çš„æ„æ€å…¶å®å°±æ˜¯ï¼š<strong>CommonJSæ¨¡å—æ˜¯è¿è¡Œè¾“å‡º(åŠ è½½)ä¸€ä¸ªå€¼(æˆ–å¯¹è±¡)çš„æ‹·è´ï¼Œè€ŒES6æ¨¡å—åˆ™æ˜¯ç¼–è¯‘æ—¶è¾“å‡º(åŠ è½½)ä¸€ä¸ªå€¼çš„å¼•ç”¨(æˆ–è€…å«åšè¿æ¥).</strong></p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬åœ°æµ‹è¯• import æ—¶å¯ä»¥ä½¿ç”¨ <strong><code>--experimental-modules</code> å®éªŒæ¨¡å—æ ‡å¿—æ¥å¯ç”¨åŠ è½½ <code>ECMAScript Modules</code> çš„ç‰¹æ€§</strong>ã€‚</p>
<p>ä½œä¸ºESæ¨¡å—åŠ è½½çš„æ–‡ä»¶åï¼Œé¡»ä»¥.mjsåç¼€ç»“å°¾</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">node --experimental-modules app.mjs</span><br><span class="line"></span><br><span class="line">// æ­¤ç§æ–¹æ³•ï¼Œåœ¨è¾“å‡ºçš„æ—¶å€™ä¼šæç¤ºï¼š</span><br><span class="line">(node:6527) ExperimentalWarning: The ESM module loader is experimental.</span><br></pre></td></tr></table></figure>
<p>çº¿ä¸Šç¯å¢ƒè¿˜æ˜¯ç”¨ babel å»è½¬ ~</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹æ‰€ä»¥ä¼šå»å†™è¿™ä¸ªï¼Œæ˜¯å› ä¸ºè‡ªå·±æœ€è¿‘é‡åˆ°äº† import çš„ä¸€ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æ‰¾é—®é¢˜çš„è¿‡ç§°ä¸­ï¼Œå‘ç°è‡ªå·±è™½ç„¶ä¸€ç›´åœ¨ç”¨ importï¼Œä½†å¯¹ require/import çš„åŒºåˆ«å¹¶æ²¡æœ‰äº†è§£çš„å¾ˆå…¨é¢ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“çš„ç‚¹å°±åœ¨ &lt;code&gt;Imports are hoiste
    
    </summary>
    
    
      <category term="Javascript" scheme="http://sevencai.github.io/tags/Javascript/"/>
    
  </entry>
  
  <entry>
    <title>async await åšäº†ä»€ä¹ˆäº‹æƒ…</title>
    <link href="http://sevencai.github.io/2018/12/03/async-await-%E5%81%9A%E4%BA%86%E4%BB%80%E4%B9%88%E4%BA%8B%E6%83%85/"/>
    <id>http://sevencai.github.io/2018/12/03/async-await-åšäº†ä»€ä¹ˆäº‹æƒ…/</id>
    <published>2018-12-03T13:10:02.000Z</published>
    <updated>2018-12-04T04:04:16.000Z</updated>
    
    <content type="html"><![CDATA[<p>ç»„é‡Œçš„ä¸€ä¸ªæœ‰è¶£åˆå¾ˆä¸¥è°¨çš„åŒäº‹ï¼Œä»Šå¤©åœ¨çº ç»“ä¸€ä¸ªä¸çœ‹èµ·æ¥æ˜¯é—®é¢˜çš„é—®é¢˜ï¼Œå…¶å®è¿™ç§æ„Ÿè§‰å°±åƒä½ ç»å¸¸è¿™ä¹ˆç”¨æˆ–è€…è¿™ä¹ˆæƒ³çš„ä¸€ä¸ªä¸œè¥¿ï¼ŒæŸä¸€å¤©æŸä¸ªæ—¶åˆ»ï¼Œä½ çªç„¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆäº†ï¼Œå°±åƒæˆ‘å¶å°”ä¼šå»çº ç»“ä¸ºä»€ä¹ˆæŸä¸ªæ±‰å­—æ˜¯è¿™æ ·å†™ï¼š</p>
<p><img src="testasyncawait.png" alt="é—®é¢˜"></p>
<p>ä»–è®¤ä¸ºæœ€ååº”è¯¥ res === b,è€Œä¸æ˜¯ res === a, æˆ‘è®¤ä¸ºå¾ˆæ˜æ˜¾åº”è¯¥ res === a, å› ä¸ºå¤§å®¶å¹³æ—¶ä¸€ç›´éƒ½æ˜¯è¿™ä¹ˆç”¨çš„, ä½†æ˜¯è·Ÿä»–è®²ç†ç”±çš„æ—¶å€™ï¼Œç«Ÿç„¶è¯­å¡äº†ã€‚</p>
<hr>
<h2 id="å…³äº-async-ğŸš¶"><a href="#å…³äº-async-ğŸš¶" class="headerlink" title="å…³äº async ğŸš¶"></a>å…³äº async ğŸš¶</h2><p>äºæ˜¯æˆ‘å»æ‰¾äº†ä¸€æ®µ MDN ä¸Šçš„è§£é‡Šï¼š</p>
<blockquote>
<p>å½“è°ƒç”¨ä¸€ä¸ª async å‡½æ•°æ—¶ï¼Œ<strong>ä¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡</strong>ã€‚å½“è¿™ä¸ª async å‡½æ•°è¿”å›ä¸€ä¸ªå€¼æ—¶ï¼Œ<strong>Promise çš„ resolve æ–¹æ³•ä¼šè´Ÿè´£ä¼ é€’è¿™ä¸ªå€¼</strong>ï¼›å½“ async å‡½æ•°æŠ›å‡ºå¼‚å¸¸æ—¶ï¼ŒPromise çš„ reject æ–¹æ³•ä¹Ÿä¼šä¼ é€’è¿™ä¸ªå¼‚å¸¸å€¼ã€‚</p>
</blockquote>
<p>ä¸Šé¢è¿™å¥è¯æˆ‘ç”¨ä¸¤ä¸ªç²—ä½“æ ‡æ˜äº†ä¸¤å¥è¯ï¼Œç¬¬ä¸€å¥è¯æ„æ€æ˜æ˜¾ï¼Œæ„ä¸ºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è°ƒç”¨ test() å¾—åˆ°çš„æ˜¯ä¸€ä¸ª Promise, ä¹Ÿå°±æ˜¯æ— è®ºå‡½æ•°å†…è¿”å›ï¼ˆreturnï¼‰çš„æ˜¯ä»€ä¹ˆï¼ˆå¸¸é‡ or å­—ç¬¦ä¸² or Promise or å…¶å®ƒï¼‰ï¼Œ async æ€»ä¼šç”¨ <code>Promise.resolve</code> åŒ…ä¸€å±‚ï¼Œå¦‚è‹¥ async é‡Œé¢æœ‰å¼‚å¸¸ï¼Œ ä¼š <code>throw Error</code>ã€‚</strong></p>
<p><strong>å¦‚æœ test å†…ä»€ä¹ˆéƒ½ä¸è¿”å›ï¼Œä¹Ÿä¼šå¾—åˆ° <code>Promise.resolve(undefined)</code>, æ€»ä¹‹ async æ€»è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚</strong></p>
<p>å†çœ‹åé¢ä¸€å¥è§£é‡Šï¼š Promise çš„ resolve æ–¹æ³•ä¼šè´Ÿè´£ä¼ é€’è¿™ä¸ªå€¼ï¼›</p>
<p>å“‡ï¼Œæ˜¯ä¸æ˜¯çªç„¶é—´è§‰å¾—æˆ‘åŒäº‹ç–‘æƒ‘çš„æ˜¯å¯¹çš„äº†ã€‚å…¶å®ä¸è¦å—è¿™å¥è¯çš„å½±å“ã€‚å®ƒè¯´çš„ä¼ é€’ï¼Œå…¶å®å°±æ˜¯returnè¿‡å»çš„æ—¶å€™æ˜¯ä¼ é€’çš„ã€‚æ€»ç»“ä¸‹ï¼š æˆ‘ä»¬å°±ç†è§£ä¸ºï¼šasync è¿”å›äº†ä¸€ä¸ªåŒ…å«æ”¹å€¼çš„ Promiseã€‚</p>
<p>åˆ†æä¸‹é¢è¿™æ®µä»£ç çš„æ‰§è¡Œï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test()</span><br><span class="line">    .then(<span class="function"><span class="params">res</span> =&gt;</span> res === a)</span><br><span class="line">    <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆ <code>test().then(a =&gt; { a === {} })</code> åˆæ˜¯å¯¹çš„äº†å‘¢ï¼Ÿ ä¸æ˜¯è¯´è¿”å›äº†ä¸€ä¸ª Promise å—ï¼Ÿ æ€ä¹ˆåˆæ˜¯ä¸€ä¸ªå¯¹è±¡å€¼äº†ï¼Ÿ(æ³¨æ„è¿™é‡Œæ˜¯å€¼å¼•ç”¨ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¿™ä¹ˆæ¯”è¾ƒ)</p>
<p><strong>è¿™æ˜¯å› ä¸º <code>Promise.then</code> é‡Œé¢ä¼šåœ¨é‡æ–°æ¥æ”¶è¿™ä¸ªå€¼çš„æ—¶å€™ï¼Œå¾—åˆ°çš„ä¸å†æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ªè¢«è§£æè¿‡äº†çš„å€¼</strong>ã€‚ ä¹Ÿå°±æ˜¯è¯´ä¸‹é¢è¿™æ®µä»£ç çš„å«ä¹‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.then(<span class="function"><span class="params">r</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// è¿”å›ä¸€ä¸ª Promise ï¼Œå†…å®¹ä¸º statusCode 404</span></span><br><span class="line">    <span class="keyword">return</span> getServerStatusCode(r);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// res ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä¸æ˜¯ä¸€ä¸ª Promise, å› ä¸ºå·²ç»è¢«è§£æè¿‡äº†</span></span><br><span class="line">    <span class="built_in">console</span>.log(res.statusCode);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ—¶å€™ï¼Œä½  then é‡Œé¢çš„å€¼ï¼Œå°±è·Ÿä½ ç”¨ await å¾—åˆ°çš„ä¸€æ ·äº†ã€‚</p>
<hr>
<h2 id="å…³äº-await-ğŸ‘‚"><a href="#å…³äº-await-ğŸ‘‚" class="headerlink" title="å…³äº await ğŸ‘‚"></a>å…³äº await ğŸ‘‚</h2><p>await ç­‰å¾…çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<blockquote>
<p>await  æ“ä½œç¬¦ç”¨äºç­‰å¾…ä¸€ä¸ªPromise å¯¹è±¡ã€‚å®ƒåªèƒ½åœ¨å¼‚æ­¥å‡½æ•° <code>async function</code> ä¸­ä½¿ç”¨ã€‚</p>
</blockquote>
<p>ä¸Šé¢æ˜¯ MDN é‡Œçš„è¯´æ˜ï¼Œæˆ‘è§‰å¾—ä¸å¤ªå¯¹ï¼Œ await ä¸ä¸€å®šæ˜¯ç­‰å¾…ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå®ƒè¦ç­‰å¾…çš„æ˜¯<strong>ä¸€ä¸ª Promise å¯¹è±¡æˆ–è€…ä»»ä½•è¦ç­‰å¾…çš„å€¼ã€‚</strong>ã€‚</p>
<p>å¦‚æœå®ƒç­‰å¾…çš„ä¸æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¦‚ await 3 , é‚£ä¹ˆè¡¨è¾¾å¼çš„è¿ç®—ç»“æœå°±æ˜¯å®ƒç­‰å¾…çš„ä¸œè¥¿ã€‚</p>
<p>å¦‚æœå®ƒç­‰å¾…çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œ å¦‚ <code>await Promise.resolve(3)</code>, é‚£ä¹ˆ await ä¼šé˜»å¡åé¢çš„ä»£ç ï¼Œç­‰å¾… Promise å¯¹è±¡ <code>resolve or reject</code>ã€‚</p>
<p>çœ‹ä¸‹ä¸‹é¢è¿™ç§æƒ…å†µï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="built_in">Promise</span>.reject(&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">abc</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> a &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> obj = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        obj = <span class="keyword">await</span> abc()</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"err"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"main"</span>, obj === a) <span class="comment">// false</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"test"</span>, obj === &#123;&#125;) <span class="comment">// false</span></span><br><span class="line">    <span class="built_in">console</span>.log(obj) <span class="comment">// null</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(obj) === <span class="built_in">JSON</span>.stringify(a))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜æ˜¾ï¼Œ obj æ˜¯ç­‰äº null çš„ï¼Œå› ä¸º await ç­‰å¾…çš„æ˜¯ä¸€ä¸ª reject çš„ç»“æœã€‚å¯¼è‡´äº†å¼‚å¸¸è¢«æŠ›å‡ºæ¥äº†ã€‚æ‰€ä»¥èµ‹å€¼ç­‰å·¥ä½œéƒ½æ²¡æœ‰è¿›è¡Œã€‚</p>
<blockquote>
<p>await è¡¨è¾¾å¼ä¼šæš‚åœå½“å‰ <code>async function</code> çš„æ‰§è¡Œï¼Œç­‰å¾… Promise å¤„ç†å®Œæˆã€‚è‹¥ Promise æ­£å¸¸å¤„ç†(fulfilled)ï¼Œå…¶å›è°ƒçš„resolveå‡½æ•°å‚æ•°ä½œä¸º await è¡¨è¾¾å¼çš„å€¼ï¼Œç»§ç»­æ‰§è¡Œ <code>async function</code>ã€‚</p>
<p>è‹¥ Promise å¤„ç†å¼‚å¸¸(rejected)ï¼Œawait è¡¨è¾¾å¼ä¼šæŠŠ Promise çš„<strong>å¼‚å¸¸åŸå› æŠ›å‡º</strong>ã€‚</p>
<p>å¦å¤–ï¼Œå¦‚æœ await æ“ä½œç¬¦åçš„è¡¨è¾¾å¼çš„å€¼ä¸æ˜¯ä¸€ä¸ª Promiseï¼Œåˆ™è¿”å›è¯¥å€¼æœ¬èº«ã€‚</p>
</blockquote>
<p>MDN çš„è§£é‡Šè·Ÿæˆ‘ä»¬ç†è§£çš„ç›¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´ <strong>await å¦‚æœå¾—åˆ°çš„æ˜¯ä¸€ä¸ª reject çš„ç»“æœï¼Œä¼šç›´æ¥ throw ä¸€ä¸ª Error å‡ºæ¥ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸ºäº†é¿å…æŠ¥é”™ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ <code>async await</code> è¿›è¡Œ <code>try catch</code> çš„åŸå› </strong>ã€‚</p>
<hr>
<h2 id="ä½¿ç”¨-async-await-è¦æ³¨æ„çš„åœ°æ–¹"><a href="#ä½¿ç”¨-async-await-è¦æ³¨æ„çš„åœ°æ–¹" class="headerlink" title="ä½¿ç”¨ async await è¦æ³¨æ„çš„åœ°æ–¹"></a>ä½¿ç”¨ async await è¦æ³¨æ„çš„åœ°æ–¹</h2><p>async await è®¾è®¡æœ¬èº«æ˜¯ä¸ºäº†è®©æˆ‘ä»¬é˜²æ­¢åœ°ç‹±å›è°ƒçš„ï¼Œä½†æ˜¯æ˜¯ä¸èƒ½å¤Ÿæ»¥ç”¨ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªå¾ˆç»å…¸çš„ä¾‹å­ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> pizza = <span class="keyword">await</span> selectPizza()</span><br><span class="line">  <span class="keyword">const</span> drink = <span class="keyword">await</span> selectDrink()</span><br><span class="line"></span><br><span class="line">  order(pizza, drink); <span class="comment">// async call</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢çš„ <code>getPizzaInfo</code> å’Œ <code>getDrinkInfo</code> å®é™…å¹¶æ²¡æœ‰ä»»ä½•ä¾èµ–å…³ç³»ï¼Œè¿™ä¹ˆå†™è¿˜å¢åŠ äº†ç­‰å¾…çš„æ—¶é—´ã€‚æ‰€ä»¥åœ¨ç”¨ async await çš„æ—¶å€™ï¼Œä¸€å®šè¦å……åˆ†ç†è§£ä»–ä»¬çš„å…³ç³»ã€‚å¯ä»¥ä¼˜åŒ–å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> pizzaPromise = selectPizza();</span><br><span class="line">  <span class="keyword">const</span> drinkPromise = selectDrink();</span><br><span class="line">  <span class="keyword">const</span> pizza = <span class="keyword">await</span> pizzaPromise;</span><br><span class="line">  <span class="keyword">const</span> drink = <span class="keyword">await</span> drinkPromise;</span><br><span class="line">  order(pizza, drink); <span class="comment">// async call</span></span><br><span class="line">&#125;)();</span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="built_in">Promise</span>.all([selectPizza(), selectDrink()]).then(order); <span class="comment">// async call</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>å†ä¸¾ä¸ªä¾‹å­ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  b();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">c(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  d();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>æœ€åå†™æˆäº†ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> a();</span><br><span class="line"><span class="keyword">await</span> b();</span><br><span class="line"><span class="keyword">await</span> c();</span><br><span class="line"><span class="keyword">await</span> d();</span><br></pre></td></tr></table></figure></p>
<p>è¿™ç§åŸæœ¬ d åªéœ€è¦ç­‰å¾… c çš„ï¼Œç»“æœå˜æˆè¦ç­‰å¾… a,b,cã€‚ æ—¶é—´æ…¢äº†å¾ˆå¤šã€‚æ€§èƒ½ä¸å¥½ã€‚ç¨æ”¹ä¸€ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> aPromise = a()</span><br><span class="line"><span class="keyword">const</span> cPromise = c()</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> aPromise()</span><br><span class="line">b()</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> cPromise()</span><br><span class="line">d()</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ä¼šç¨å¾®å¥½ç‚¹äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œ dç”±åŸæ¥çš„éœ€è¦ç­‰å¾… c, å˜æˆäº†éœ€è¦ç­‰å¾… a,c(å¦‚æœaçš„è¿”å›æ—¶é—´è¦å¤§äºc)</p>
<p>æ‰€ä»¥å¯ä»¥æ”¹æˆä¸‹é¢è¿™ä¸¤ç§æ–¹å¼ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span>() &#123;</span><br><span class="line">    <span class="keyword">await</span> a()</span><br><span class="line"></span><br><span class="line">    b()</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span>() &#123;</span><br><span class="line">    <span class="keyword">await</span> c()</span><br><span class="line"></span><br><span class="line">    d()</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…æ”¹ä¸º</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all([a(), c()])</span><br><span class="line">    .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Promise</span>.all([b(), d()])</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure></p>
<p>æ€»ä¹‹ç”¨ async, await çš„æ—¶å€™å¾—å¤šæƒ³æƒ³ã€‚</p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ‰å¥½å¥‡å¿ƒå’Œæ¢ç´¢çŸ¥è¯†çš„æ¬²æœ›æ˜¯å¥½äº‹ï¼Œå½“åˆ«äººé—®ä½ çš„é—®é¢˜çš„æ—¶å€™ï¼Œå¦‚æœä½ ä¸èƒ½æŠŠåˆ«äººè§£é‡Šæ¸…æ¥šçš„æ—¶å€™ï¼Œé‚£ä¹ˆå¯èƒ½ä»–çš„é—®é¢˜åŒæ ·å°±æ˜¯ä½ çš„é—®é¢˜~</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»„é‡Œçš„ä¸€ä¸ªæœ‰è¶£åˆå¾ˆä¸¥è°¨çš„åŒäº‹ï¼Œä»Šå¤©åœ¨çº ç»“ä¸€ä¸ªä¸çœ‹èµ·æ¥æ˜¯é—®é¢˜çš„é—®é¢˜ï¼Œå…¶å®è¿™ç§æ„Ÿè§‰å°±åƒä½ ç»å¸¸è¿™ä¹ˆç”¨æˆ–è€…è¿™ä¹ˆæƒ³çš„ä¸€ä¸ªä¸œè¥¿ï¼ŒæŸä¸€å¤©æŸä¸ªæ—¶åˆ»ï¼Œä½ çªç„¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆäº†ï¼Œå°±åƒæˆ‘å¶å°”ä¼šå»çº ç»“ä¸ºä»€ä¹ˆæŸä¸ªæ±‰å­—æ˜¯è¿™æ ·å†™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;testasyncawait.png&quot; a
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>æ€»ç»“å‡ ä¸ªæœ€è¿‘é‡åˆ°çš„é—®é¢˜</title>
    <link href="http://sevencai.github.io/2018/11/27/%E6%80%BB%E7%BB%93%E5%87%A0%E4%B8%AA%E6%9C%80%E8%BF%91%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>http://sevencai.github.io/2018/11/27/æ€»ç»“å‡ ä¸ªæœ€è¿‘é‡åˆ°çš„é—®é¢˜/</id>
    <published>2018-11-27T13:08:19.000Z</published>
    <updated>2018-11-27T13:19:43.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘çœ‹äº†äº›æ–‡ç« ï¼Œé‡åˆ°äº†å†™é—®é¢˜ï¼ŒèŠ±äº†ç‚¹æ—¶é—´æ€»ç»“å¦‚ä¸‹ã€‚</p>
<hr>
<h2 id="localhost-å’Œ-127-0-0-1"><a href="#localhost-å’Œ-127-0-0-1" class="headerlink" title="localhost å’Œ 127.0.0.1"></a>localhost å’Œ 127.0.0.1</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ç”µè„‘å¯èƒ½æœ‰<strong>ä¸‰å—ç½‘å¡</strong>ã€‚åˆ†åˆ«æ˜¯ğŸŒ¹ï¼š</p>
<ol>
<li>ä¸€å—å« loopback çš„è™šæ‹Ÿç½‘å¡</li>
<li>ä¸€å—å« ethernet çš„æœ‰é™ç½‘å¡</li>
<li>ä¸€å—å« wlan çš„æ— é™ç½‘å¡</li>
</ol>
<p>æˆ‘ä»¬ç”µè„‘çš„æœ¬æœº IP ï¼Œå¯ä»¥ç†è§£ä¸ºæ—¶çœŸå®ç½‘å¡çš„ IP, æœ‰é™å’Œæ— é™åˆ†åˆ«æœ‰ä¸€ä¸ªã€‚æ˜¯ç½‘ç»œå‡ºå£IPã€‚</p>
<p>ç°åœ¨ä¸»è¦æ˜¯äº†è§£ä¸‹è¿™ä¸ª è™šæ‹Ÿçš„ç½‘å¡ loopback å®ƒæ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒå’Œ 127.0.0.1 çš„å…³ç³»ã€‚</p>
<p>127.0.0.1 åˆ° 127.255.255.255æ•´ä¸ªéƒ½æ˜¯ç¯å›åœ°å€(loopback)ï¼Œç”¨æ¥æµ‹è¯•æœ¬æœºçš„TCP/IPåè®®æ ˆï¼Œå‘å¾€è¿™æ®µAç±»åœ°å€<strong>æ•°æ®åŒ…ä¸ä¼šå‡ºç½‘å¡ï¼Œç½‘ç»œè®¾å¤‡ä¸ä¼šå¯¹å…¶åšè·¯ç”±</strong>, ä¹Ÿå°±æ˜¯åªåœ¨æœ¬åœ°åšå›ç¯è®¿é—®ï¼Œæ•…åªèƒ½æœ¬æœºè®¿é—®ã€‚</p>
<p><strong>æ‰€ä»¥ç¯å›åœ°å€æ˜¯ä¸»æœºç”¨äºå‘è‡ªèº«å‘é€é€šä¿¡çš„ä¸€ä¸ªç‰¹æ®Šåœ°å€ï¼Œæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç›®çš„åœ°å€ã€‚å› æ­¤å¦‚æœä¸€å°ä¸»æœºä¸Šçš„ä¸¤é¡¹æœåŠ¡å¦‚æœä½¿ç”¨çš„æ˜¯ç¯å›åœ°å€è€Œéåˆ†é…çš„ä¸»æœºåœ°å€ï¼Œå°±å¯ä»¥ç»•å¼€ TCP/IP åè®®æ ˆçš„ä¸‹å±‚ï¼Œä¸ç”¨å†é€šè¿‡é“¾è·¯å±‚ï¼Œç‰©ç†å±‚ï¼Œä»¥å¤ªç½‘ç­‰ä¼ å‡ºå»ã€‚</strong></p>
<p><strong>è€Œlocalhost æ˜¯ä¸€ä¸ª åŸŸåï¼Œä¸€èˆ¬æŒ‡å‘ 127.0.0.1ï¼Œ å®é™…ä¸Šå®ƒä¹Ÿå¯ä»¥æŒ‡å‘ä»»ä½•ä¸€ä¸ªip, å¯ä»¥å»ç³»ç»Ÿæ–‡ä»¶ä¸­ä¿®æ”¹</strong>ã€‚</p>
<p>ä¹‹æ‰€ä»¥å»äº†è§£è¿™ä¸ªï¼Œå…¶å®æ˜¯å› ä¸ºæœ€è¿‘è¸©äº†ä¸‹é¢ä¸ªå‘ï¼Œé¡ºå¸¦ä¹Ÿå»äº†è§£äº†ä¸‹è¿™ä¸ªã€‚</p>
<hr>
<h2 id="whistle-è½¬å‘-header-host-è¢«æ›´æ”¹é—®é¢˜"><a href="#whistle-è½¬å‘-header-host-è¢«æ›´æ”¹é—®é¢˜" class="headerlink" title="whistle è½¬å‘ header host è¢«æ›´æ”¹é—®é¢˜"></a>whistle è½¬å‘ header host è¢«æ›´æ”¹é—®é¢˜</h2><p>âåŒäº‹Bä¸ºäº†åœ¨é¡µé¢å†… include ä¸€ä¸ª php cgi è¿”å›çš„ token, å¸Œæœ›èƒ½å¤Ÿåœ¨ apache é‡Œé¢é…ç½®ä»£ç†è½¬å‘ï¼Œå½“çœ‹åˆ°äº†è¿™ä¸ªincludeçš„ cgi åï¼Œå³è½¬å‘åˆ°å¯¹åº”çš„ æœºå™¨ä¸Šã€‚</p>
<p>å¥¹å‘ç° php çš„æ¥å£å·²ç»æˆåŠŸè½¬å‘åˆ°æµ‹è¯•æœºå™¨ä¸Šï¼Œä½†æ˜¯è¿”å›çš„å†…å®¹ä¸æ­£å¸¸ï¼Œåœ¨å¸®å¥¹è°ƒè¯•æ¥å£åï¼Œå‘ç°åå°æ¥å£éªŒè¯äº† Valid Host, è€Œå¥¹çš„ host è¿˜æ˜¯æœ¬æœºçš„ localhostã€‚</p>
<p>å¥¹ç›¸å…³çš„whistle é…ç½®ä¸ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pay.qq.com  localhost/wechat_h5/dist/h5/store/views/</span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥é€šè¿‡ pay.qq.com/index.shtml ç›´æ¥è®¿é—®åˆ°å¯¹åº”çš„æœ¬åœ°é¡µé¢ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆ header é‡Œé¢çš„ host ç«Ÿç„¶ä¸æ˜¯ pay.qq.com è€Œæ˜¯ localhost å‘¢ï¼ŸâŒ</p>
<p>è¿™é‡Œæ˜¯ç”±äº whistle å¯¼è‡´çš„ã€‚</p>
<p>whistle å¯¹äºä¸Šé¢è¿™ç§é…ç½®ï¼Œ<strong>ä¼šè®¤ä¸ºæ˜¯ä¸€ä¸ª rule</strong>, ç›´æ¥æ•´ä¸ªé“¾æ¥ç±»ä¼¼è¢« 302 è·³è½¬äº†ï¼Œå¯¼è‡´äº† header é‡Œçš„ host ä¹Ÿè¢«ä¿®æ”¹ä¸ºäº† localhost, æ‰€ä»¥ä¸èƒ½é€šè¿‡æ¥å£æ ¡éªŒã€‚</p>
<p>éœ€è¦æ”¹æˆå¦‚ä¸‹é…ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pay.qq.com/wechat_h5/dist/h5/store/views/ localhost</span><br></pre></td></tr></table></figure></p>
<p>è¿™ç§æƒ…å†µï¼Œ<strong>whistle ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ª host ä»£ç†ï¼Œ header é‡Œé¢çš„å†…å®¹ä¸ä¼šå—å½±å“</strong>ã€‚</p>
<p>ä¸¤ç§ç±»ä¼¼ç›¸ä¼¼çš„å†™æ³•ï¼Œè¿˜æ˜¯æœ‰ä¸ä¸€æ ·çš„æ•ˆæœï¼Œå¦‚æœä¸æ˜¯è¿™ç§åå°ä¼šéªŒè¯ valid host çš„æƒ…å†µï¼Œä¸¤ç§éƒ½å¯ä»¥ç”¨ã€‚</p>
<hr>
<h2 id="es6-promise-ä¸æ”¯æŒ-finally"><a href="#es6-promise-ä¸æ”¯æŒ-finally" class="headerlink" title="es6-promise ä¸æ”¯æŒ finally?"></a>es6-promise ä¸æ”¯æŒ finally?</h2><p><code>es6-promise</code> æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„ <code>promise polyfill</code> åº“ ï¼Œä½†æ˜¯é—æ†¾çš„æ˜¯ç›®å‰å®ƒè¿˜ä¸æ”¯æŒ finallyï¼Œå¦‚æœç”¨ <code>es6-promise</code> ï¼Œåˆæƒ³ç”¨ <code>finally</code> ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿå¯ä»¥ç®€å•çš„ç”¨ <code>then</code> æ¥ä»£æ›¿ <code>finally</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">printPersonFullName() &#123;</span><br><span class="line">    <span class="keyword">return</span> fetch(<span class="string">'./data/person.json'</span>)</span><br><span class="line">           .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">return</span> response.json();</span><br><span class="line">           &#125;)</span><br><span class="line">           .then(<span class="function"><span class="params">person</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;person.firstName&#125;</span> <span class="subst">$&#123;person.lastName&#125;</span>`</span>);</span><br><span class="line">           &#125;)</span><br><span class="line">           .catch(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="built_in">console</span>.log(<span class="string">'error'</span>)</span><br><span class="line">           &#125;)</span><br><span class="line">           .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="built_in">console</span>.log(<span class="string">'finally'</span>);</span><br><span class="line">           &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æœ€åä¸€ä¸ª then æ–¹æ³•ä¸€å®šä¼šè¿›å…¥ï¼ŒåŠæ—¶ä¹‹å‰ catch åˆ°äº† errorã€‚å¯ä»¥ç®€å•çš„æ¥æ›¿ä»£ finallyã€‚</p>
<hr>
<h2 id="ç¥å¥‡çš„translate3d"><a href="#ç¥å¥‡çš„translate3d" class="headerlink" title="ç¥å¥‡çš„translate3d"></a>ç¥å¥‡çš„translate3d</h2><p><code>ios safari</code> ä¸‹ï¼Œå¦‚æœä½ ç»å¸¸ç”¨ <code>position: fixed</code>ï¼Œ å¯èƒ½ä¼šé‡åˆ°ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼Œæ¯”å¦‚é¡µé¢å¡ä½ï¼Œé¡µé¢ç™½å±ç­‰é—®é¢˜ã€‚</p>
<p>è¿™æ—¶å€™ä½ å¯ä»¥è¯•è¯•ç¥å¥‡çš„ translate3d, å®ƒä¼šè§¦å‘ GPU çš„é‡æ–°åŠ é€Ÿã€‚<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.Element-header</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(0,0,0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Element-header--fixed</span> &#123;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¸å¤ªäº†è§£ CSS çš„æˆ‘ï¼Œé è¿™ä¸ªè§£å†³äº†å¾ˆå¤šé—®é¢˜ã€‚<a href="https://stanko.github.io/ios-safari-scroll-position-fixed/" target="_blank" rel="noopener">ç›¸å…³å‚è€ƒæ–‡ç« </a>ã€‚</p>
<p>å»ºè®®æ˜¯<code>safari</code>ä¸­èƒ½ä¸ç”¨<code>fixed</code>å°±ä¸ç”¨ <code>fixed</code>ã€‚</p>
<hr>
<h2 id="Promise-Anti-patterns"><a href="#Promise-Anti-patterns" class="headerlink" title="Promise Anti-patterns"></a>Promise Anti-patterns</h2><p>æœ€è¿‘çœ‹äº†ä¸€ç¯‡æ–‡ç« ï¼Œè®²çš„ä¸é”™ï¼Œå¤§æ¦‚è®²çš„å°±æ˜¯è¯´å¸¸è§çš„ä¸€äº›é”™è¯¯çš„ Promise ç”¨æ³•ã€‚åœ¨è¿™é‡Œè®°å½•ä¸‹ï¼Œä¾›è‡ªå·±ç»å¸¸ç¿»çœ‹ã€‚åŸæ–‡ç« åœ°å€åœ¨<a href="http://taoofcode.net/promise-anti-patterns/" target="_blank" rel="noopener">æ­¤ã€‚</a></p>
<h3 id="Nested-Promises"><a href="#Nested-Promises" class="headerlink" title="Nested Promises"></a>Nested Promises</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">loadSomething().then(<span class="function"><span class="keyword">function</span>(<span class="params">something</span>) </span>&#123;</span><br><span class="line">  loadAnotherthing().then(<span class="function"><span class="keyword">function</span>(<span class="params">another</span>) </span>&#123;</span><br><span class="line">    DoSomethingOnThem(something, another);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>To fix:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">q.all([loadSomething(), loadAnotherThing()])</span><br><span class="line">    .spread(<span class="function"><span class="keyword">function</span>(<span class="params">something, another</span>) </span>&#123;</span><br><span class="line">        DoSomethingOnThem(something, another);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="The-Broken-Chain"><a href="#The-Broken-Chain" class="headerlink" title="The Broken Chain"></a>The Broken Chain</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anAsyncCall</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> promise = doSomethingAsync();</span><br><span class="line">    promise.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        somethingComplicated();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> promise;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>To Fixed:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anAsyncCall</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> promise = doSomethingAsync();</span><br><span class="line">    <span class="keyword">return</span> promise.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        somethingComplicated()</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="The-Collection-Kerfuffle"><a href="#The-Collection-Kerfuffle" class="headerlink" title="The Collection Kerfuffle"></a>The Collection Kerfuffle</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">workMyCollection</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> resultArr = [];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">_recursive</span>(<span class="params">idx</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (idx &gt;= resultArr.length) <span class="keyword">return</span> resultArr;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> doSomethingAsync(arr[idx]).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">            resultArr.push(res);</span><br><span class="line">            <span class="keyword">return</span> _recursive(idx + <span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> _recursive(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>To fix, use map &amp; reduce:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">workMyCollection</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> q.all(arr.map(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> doSomethingAsync(item);</span><br><span class="line">    &#125;));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// or you want them in series</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">workMyCollection</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> arr.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">promise, item</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> doSomethingAsyncWithResult(item, result);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;, q());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="The-Ghost-Promise"><a href="#The-Ghost-Promise" class="headerlink" title="The Ghost Promise"></a>The Ghost Promise</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> promise;</span><br><span class="line"><span class="keyword">if</span> (asyncCallNeeded)</span><br><span class="line">    promise = doSomethingAsync();</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    promise = Q.resolve(<span class="number">42</span>);</span><br><span class="line"></span><br><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    doSomethingCool();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>To fix:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”¨ Q åŒ…ä¸€å±‚</span></span><br><span class="line">Q(asyncCallNeeded ? doSomethingAsync() : <span class="number">42</span>)</span><br><span class="line">    .then(</span><br><span class="line">        <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">            doSomethingGood();</span><br><span class="line">        &#125;)</span><br><span class="line">    .catch(</span><br><span class="line">        <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">            handleTheError();</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="The-Overly-Keen-Error-Handler"><a href="#The-Overly-Keen-Error-Handler" class="headerlink" title="The Overly Keen Error Handler"></a>The Overly Keen Error Handler</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">somethingAsync.then(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> somethingElseAsync();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">        handleMyError(err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>To fix :<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é¿å…ä¸Šé¢fufilledå†…çš„errorä¸è¢« catch åˆ°</span></span><br><span class="line">somethingAsync</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> somethingElseAsync();</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">        handleMyError(err);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="The-Forgotten-Promise"><a href="#The-Forgotten-Promise" class="headerlink" title="The Forgotten Promise"></a>The Forgotten Promise</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> deferred = Q.defer();</span><br><span class="line">doSomethingAsync().then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    res = manipulateMeInSomeWay(res);</span><br><span class="line">    deferred.resolve(res);</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    deferred.reject(err);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> deferred.promise;</span><br></pre></td></tr></table></figure>
<p>To fix:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é¿å…ä¸Šè¿°æ— æ„ä¹‰çš„åˆ›å»º promise</span></span><br><span class="line"><span class="keyword">return</span> doSomethingAsync().then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> manipulateMeInSomeWay(res);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>çœ‹äº†ä¸€äº›æ–‡ç« ï¼Œå…¶å®å¤šçœ‹çœ‹è¿™äº›æ€»ç»“ç±»çš„æ–‡ç« ï¼Œç„¶åè‡ªå·±æŠŠè‡ªå·±å·¥ä½œä¸­é‡åˆ°çš„é—®é¢˜æ€»ç»“å‡ºæ¥æ˜¯ä¸ªå¾ˆå¥½çš„äº‹æƒ…ï¼Œæ¢³ç†äº†è‡ªå·±çš„è„‘è¢‹ç“œå“ˆå“ˆã€‚ ä»Šå¤©å¥½ç´¯å•Šï¼Œå¯èƒ½æ˜¯ç”Ÿç—…çš„åŸå› ï¼Œæ—©ç‚¹å›å®¶äº†ã€‚9ç‚¹20ã€‚ç»™è€å¦ˆæ‰“ä¸ªâ˜ï¸ï¼Œå›å»å†çœ‹çœ‹ä¹¦ï¼Œé›é›ç‹—ğŸ©ï¼Œå®Œç¾ğŸ˜Š~</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘çœ‹äº†äº›æ–‡ç« ï¼Œé‡åˆ°äº†å†™é—®é¢˜ï¼ŒèŠ±äº†ç‚¹æ—¶é—´æ€»ç»“å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;localhost-å’Œ-127-0-0-1&quot;&gt;&lt;a href=&quot;#localhost-å’Œ-127-0-0-1&quot; class=&quot;headerlink&quot; title=&quot;localhost å’Œ 
    
    </summary>
    
    
      <category term="Javascript" scheme="http://sevencai.github.io/tags/Javascript/"/>
    
  </entry>
  
  <entry>
    <title>è®°å‡ ä¸ªå°çŸ¥è¯†ç‚¹</title>
    <link href="http://sevencai.github.io/2018/11/20/%E8%AE%B0%E5%87%A0%E4%B8%AA%E5%B0%8F%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
    <id>http://sevencai.github.io/2018/11/20/è®°å‡ ä¸ªå°çŸ¥è¯†ç‚¹/</id>
    <published>2018-11-20T13:14:33.000Z</published>
    <updated>2018-11-20T13:21:50.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>å¥½ä¹…éƒ½æ²¡æœ‰æ›´æ–°åšå®¢äº†ï¼Œä¹‹å‰ç»å†äº†ç–¯ç‹‚çš„ä¸€æ®µåŠ ç­æ—¶é—´ï¼Œæ”¶è·äº†ä¸‹é¢ä¸€å¥è¯ï¼Œå¯¹æˆ‘æ¥è¯´å¾ˆçè´µçš„ç»éªŒã€‚ğŸ“’</p>
<p><strong>å†çŸ­ä¹Ÿè¦è®°å¾—æ€è€ƒï¼Œå†å¿™ä¹Ÿè¦è®°å¾—æ—¶ä¸æ—¶åœä¸‹æ¥ï¼Œä¸æ…Œä¸å¿™ä¸€æ­¥æ­¥èµ°ç¨³</strong>~ğŸ“š</p>
</blockquote>
<hr>
<h2 id="åœ¨-url-ä¸Šå¢åŠ å‚æ•°"><a href="#åœ¨-url-ä¸Šå¢åŠ å‚æ•°" class="headerlink" title="åœ¨ url ä¸Šå¢åŠ å‚æ•°"></a>åœ¨ url ä¸Šå¢åŠ å‚æ•°</h2><p>ä¸‹é¢è¿™æ®µæ˜¯ä¸€æ®µç»™ url å¢åŠ å‚æ•°çš„ä»£ç ç‰‡æ®µï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åœ¨ url ä¸Šæ·»åŠ å‚æ•°</span></span><br><span class="line"><span class="comment"> * @param arr  Array or Object</span></span><br><span class="line"><span class="comment"> * @param url</span></span><br><span class="line"><span class="comment"> * @return &#123;string|*&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addParam</span>(<span class="params">arr, url</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> names = <span class="built_in">Object</span>.keys(arr)</span><br><span class="line">  <span class="keyword">var</span> postfix = serializeParams(arr)</span><br><span class="line"></span><br><span class="line">  url = delParam(names, url)</span><br><span class="line">  url += <span class="regexp">/(\?|&amp;)$/</span>.test(url) ? <span class="string">""</span> + postfix : <span class="regexp">/\?/</span>.test(url) ? <span class="string">"&amp;"</span> + postfix : <span class="string">"?"</span> + postfix</span><br><span class="line">  <span class="keyword">return</span> url</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>é™¤å»å†™æ³•é—®é¢˜ï¼Œé€»è¾‘ä¸Šèƒ½çœ‹å‡ºæœ‰ä»€ä¹ˆé—®é¢˜å—âŒï¼Ÿ</p>
<p>å®ƒåªæ”¯æŒä¸å¸¦ hash çš„å¢åŠ å‚æ•°ï¼Œå¯¹äºå¸¦ hash çš„url, å®ƒåŸºæœ¬ä¸èƒ½ä½¿ç”¨ã€‚å› ä¸ºè¿™ä¸ªæ–¹æ³•å·²ç»è¢«å…¶ä»–äººä½¿ç”¨ï¼Œä¸ºäº†æœ€å°çš„æ”¹åŠ¨æ€§ï¼Œå¯ä»¥åœ¨ä¸Šé¢å†å°è£…ä¸€æ¬¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addHashParam</span>(<span class="params">arr, url</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> [prefix, suffix] = url.split(<span class="string">"#"</span>)</span><br><span class="line">  <span class="keyword">let</span> addedUrl = addParam(arr, prefix)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (suffix) &#123;</span><br><span class="line">    <span class="keyword">return</span> [addedUrl, <span class="string">"#"</span>, suffix].join(<span class="string">""</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> addedUrl</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç®€å•çš„ split ä¸€ä¸‹ï¼Œå†å¯¹ hash ä¹‹å‰çš„è¿›è¡Œ addParam, æœ€åå†æ‹¼æ¥å›å»å³å¯ã€‚</p>
<hr>
<h2 id="chrome-breakpoints"><a href="#chrome-breakpoints" class="headerlink" title="chrome breakpoints"></a>chrome breakpoints</h2><p>ä»Šå¤©åˆæŠŠ chrome çš„ <a href="https://developers.google.com/web/tools/chrome-devtools/javascript/breakpoints?hl=zh-cn" target="_blank" rel="noopener">breakpoints çš„æ–‡æ¡£</a>çŸäº†ä¸€éã€‚å¸Œæœ›è‡ªå·±èƒ½æŠŠä¸‹é¢è¿™ä¸ªå›¾è®°æ¸…æ¥šï¼š</p>
<p><img src="chromebreakpoint.png" alt="Overview of when to use each breakpoint type"></p>
<p>å¹³æ—¶è¿˜æ˜¯å¾—åˆ»æ„æœ‰æ„çš„å»ä½¿ç”¨ä¸åŒçš„ç±»å‹æ–­ç‚¹å½¢å¼ï¼Œè¿™æ ·æ‰ä¸ä¼šå¦‚æœçªç„¶äº‹ä»¶å¾ˆç´§å‘ç°é—®é¢˜æ—¶ï¼Œæ‰‹å¿™è„šä¹±ã€‚</p>
<p>æ¯”å¦‚ä¸Šé¢è¿™äº›æ–­ç‚¹ç±»å‹ä¸­ï¼Œ <code>Line-of-code</code>ï¼Œ<code>Conditional line-of-code</code>ï¼Œ<code>Exception</code> ç”¨çš„æ¯”è¾ƒå¤šï¼Œå…¶ä»–å‡ ä¸ªå¦‚ <code>DOM</code>, <code>Xhr</code>, <code>Function</code> ç”¨çš„æ¯”è¾ƒğŸ“’å°‘ã€‚</p>
<hr>
<h2 id="å…³äºç½‘ç»œçš„å°çŸ¥è¯†"><a href="#å…³äºç½‘ç»œçš„å°çŸ¥è¯†" class="headerlink" title="å…³äºç½‘ç»œçš„å°çŸ¥è¯†"></a>å…³äºç½‘ç»œçš„å°çŸ¥è¯†</h2><p>æœ€è¿‘å…¬å¸çš„ç½‘ç»œéƒ¨åˆ†æ‰“é€šäº†ï¼Œå¯¹äº mac pro è€Œè¨€ï¼Œä»¥å‰éå¸¸ä¸å¥½çœŸæœºè°ƒè¯•ï¼Œç°åœ¨éå¸¸æ–¹ä¾¿äº†æˆ‘ä»¬ã€‚å»äº†è§£äº†ä¸‹è¿™é‡Œé¢çš„å·¥ä½œã€‚</p>
<blockquote>
<p>åŒä¸€ç½‘æ®µï¼šè¦åˆ¤æ–­ä¸¤ä¸ªIPåœ°å€æ˜¯ä¸æ˜¯åœ¨åŒä¸€ä¸ªç½‘æ®µï¼Œå°±å°†å®ƒä»¬çš„IPåœ°å€åˆ†åˆ«ä¸<strong>å­ç½‘æ©ç </strong>åš<strong>ä¸è¿ç®—</strong>ï¼Œå¾—åˆ°çš„ç»“æœä¸€ç½‘ç»œå·ï¼Œå¦‚æœç½‘ç»œå·ç›¸åŒï¼Œå°±åœ¨åŒä¸€å­ç½‘ï¼Œå¦åˆ™ï¼Œä¸åœ¨åŒä¸€å­ç½‘ã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœä¸¤ä¸ªè®¾å¤‡çš„ IP åœ°å€å‰ä¸‰ä½éƒ½æ˜¯ä¸€æ ·çš„è¯ï¼Œå°±ç®—æ˜¯ä½äºåŒä¸€ç½‘æ®µã€‚</p>
</blockquote>
<p>æŠ“åŒ…æˆ–è€…çœŸæœºè°ƒè¯•éœ€è¦ç”µè„‘å’Œæ‰‹æœºåœ¨åŒä¸€ç½‘æ®µä¸‹ã€‚ ç°åœ¨ç”±äºç½‘ç»œæ‰“é€šï¼Œéƒ½åœ¨åŒä¸€å±€åŸŸç½‘å†…ï¼Œç›´æ¥æ‰‹æœºä¸Šé…ç½®ä»£ç†ï¼Œè¿æ¥ç”µè„‘ç›¸åº”çš„ç«¯å£å³å¯ã€‚ä¸€èˆ¬æˆ‘ä»¬ä¸ºäº†æŠ“åŒ…ï¼Œç”µè„‘ä¸Šä¼šè£… fiddler or charles or whistle, æˆ‘è¿™é‡Œä½¿ç”¨ whistle å¼€å¯äº†ä¸€ä¸ªæ–°ç«¯å£ï¼Œæ‰‹æœºå°±è¿è¿™ä¸ªç«¯å£å³å¯æŠ“åŒ…ã€‚</p>
<p>åŸå…ˆç”±äºæˆ‘ä»¬çš„æ‰‹æœºå’Œç”µè„‘ä¸æ˜¯åŒä¸€ä¸ªç½‘ç»œï¼Œæ‰€ä»¥æ‰éœ€è¦è½¯APå¦‚ å°ç±³ WIFI è¿™ç§ä¸œè¥¿å»ä½¿æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€ä¸ªç½‘ç»œé‡Œï¼Œè¿›è¡ŒæŠ“åŒ…ã€‚</p>
<p>è¿™é‡Œå‡ºæ¥äº†ä¸€ä¸ªæ–°è¯ï¼Œå«åš <strong>è½¯AP</strong>ã€‚</p>
<p>è½¯APæŒ‡çš„æ˜¯ï¼š<strong>â€œè½¯APâ€çš„æ— çº¿äº§å“åœ¨å¸‚åœºä¸Šé¢‡ä¸ºå¸¸è§ï¼Œè½¯APå°±æ˜¯Soft-APï¼Œå®ƒçš„ç¡¬ä»¶éƒ¨åˆ†å°±æ˜¯ä¸€å—æ ‡å‡†çš„æ— çº¿ç½‘å¡ï¼Œä½†å…¶é€šè¿‡é©±åŠ¨ç¨‹åºä½¿å…¶æä¾›ä¸APä¸€æ ·çš„ä¿¡å·è½¬æ¥ã€è·¯ç”±ç­‰åŠŸèƒ½</strong>ã€‚ä¸ä¼ ç»ŸAPç›¸æ¯”ï¼Œå®ƒçš„æˆæœ¬å¾ˆä½ï¼ŒåŠŸèƒ½ä¸Šä¹Ÿèƒ½å‡‘åˆã€‚</p>
<p>ç®€å•çš„ç†è§£è¯<strong>AP å°±æ˜¯ AccessPoint ,æ˜¯æ— é™è®¿é—®çƒ­ç‚¹çš„ç®€ç§°ï¼Œæ— é™è·¯ç”±å™¨å¯ä»¥ç§°ä¸º AP, è½¯AP åˆ™æ˜¯ç”¨è½¯ä»¶å’Œæ— çº¿ç‹å¡ç»“åˆæ¨¡æ‹Ÿå‡ºæ¥çš„</strong>ã€‚</p>
<p>æ˜¯å¦éœ€è¦è¿™ä¸ªè½¯APè·Ÿæˆ‘ä»¬çš„ç½‘ç»œæœ‰å…³ç³»ã€‚è‹¥ç”µè„‘å’Œæ‰‹æœºå¤„äºä¸€ä¸ªç½‘æ®µï¼Œå°±ä¸éœ€è¦è½¯APåˆ›å»ºWIFIç½‘ç»œã€‚è‹¥ä¸åœ¨ä¸€ä¸ªç½‘ç»œï¼Œå°±éœ€è¦ç”¨åˆ°è½¯APè½¯ä»¶ã€‚æ¯”å¦‚ä½ çš„ç”µè„‘æ˜¯è¿çš„è‡ªå®¶çš„WIFI,ä½ çš„æ‰‹æœºæ˜¯4Gç½‘ç»œã€‚æˆ–è€…ä½ çš„ç”µè„‘æ˜¯æœ‰é™ç½‘ç»œï¼Œæ‰‹æœºæ˜¯æ— çº¿ç½‘ç»œï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½å°±ä¸åœ¨ä¸€ä¸ªç½‘æ®µä¸Šã€‚</p>
<blockquote>
<p>åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…æ˜¯å¯ä»¥ç›¸äº’è¿æ¥åˆ°å¯¹æ–¹çš„å¹¿æ’­çš„ï¼Œä¹Ÿå¯ä»¥å†’è®¤æ¥æ”¶ç«¯æ¥æˆªå–æ•°æ®ã€‚æˆ–è€…æ··ä¹±arpæ•°æ®åŒ…ï¼Œè¿›è¡Œå…¨éƒ¨æŠ“å–ã€‚é‚£ä¹ˆå¦‚ä½•å°†macå’ŒiPhoneè¿æ¥åˆ°åŒä¸€ä¸ªå±€åŸŸç½‘å‘¢ï¼Ÿæ–¹æ³•ä¸€ï¼Œå°†ä¸¤ä¸ªè®¾å¤‡éƒ½è¿æ¥ä¸€ä¸ªwifiè·¯ç”±å™¨ï¼›æ–¹æ³•äºŒï¼Œå°†macè¿æ¥ä»¥å¤ªç½‘ï¼Œç„¶ååœ¨ ç³»ç»Ÿåå¥½è®¾ç½®â€”â€”å…±äº« ä¸­è®¾ç½®å…±äº«ä»¥å¤ªç½‘æ¥æºçš„è¿æ¥ï¼Œç„¶åç”¨wifiç«¯å£å…±äº«ç»™ç”µè„‘ï¼ˆæ‰‹æœºï¼‰ã€‚ç„¶åå†å°†æ‰‹æœºå»è¿æ¥ç”µè„‘å‘æ•£å‡ºçš„wifiã€‚</p>
</blockquote>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¦å¯¹æœªæ¥æœ‰ä¿¡å¿ƒï¼Œè¦å¯¹è‡ªå·±åšçš„äº‹æƒ…å†™çš„ä»£ç æŠ±æœ‰ä¿¡å¿µï¼Œè¦è·Ÿéšè‡ªå·±çš„å¿ƒã€‚ï¼ˆä¸æ˜¯å¯¹åˆ«äººçš„é¸¡æ±¤ï¼Œæ˜¯å¯¹è‡ªå·±çš„é¼“åŠ±ï¼ŒåŠ æ²¹ï¼‰ğŸŒ¹</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å¥½ä¹…éƒ½æ²¡æœ‰æ›´æ–°åšå®¢äº†ï¼Œä¹‹å‰ç»å†äº†ç–¯ç‹‚çš„ä¸€æ®µåŠ ç­æ—¶é—´ï¼Œæ”¶è·äº†ä¸‹é¢ä¸€å¥è¯ï¼Œå¯¹æˆ‘æ¥è¯´å¾ˆçè´µçš„ç»éªŒã€‚ğŸ“’&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å†çŸ­ä¹Ÿè¦è®°å¾—æ€è€ƒï¼Œå†å¿™ä¹Ÿè¦è®°å¾—æ—¶ä¸æ—¶åœä¸‹æ¥ï¼Œä¸æ…Œä¸å¿™ä¸€æ­¥æ­¥èµ°ç¨³&lt;/strong&gt;~ğŸ“š&lt;/p&gt;
&lt;/blockquote
    
    </summary>
    
    
      <category term="ç¬”è®°" scheme="http://sevencai.github.io/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>è®°å‡ ä¸ªå°é—®é¢˜</title>
    <link href="http://sevencai.github.io/2018/08/31/%E8%AE%B0%E5%87%A0%E4%B8%AA%E5%B0%8F%E9%97%AE%E9%A2%98/"/>
    <id>http://sevencai.github.io/2018/08/31/è®°å‡ ä¸ªå°é—®é¢˜/</id>
    <published>2018-08-31T13:06:47.000Z</published>
    <updated>2018-08-31T13:08:45.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="swiper-v-for-ä¸­-click-ä¸ç”Ÿæ•ˆ"><a href="#swiper-v-for-ä¸­-click-ä¸ç”Ÿæ•ˆ" class="headerlink" title="swiper v-for ä¸­ click ä¸ç”Ÿæ•ˆ"></a>swiper v-for ä¸­ click ä¸ç”Ÿæ•ˆ</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;swiper-slide</span><br><span class="line">	v-<span class="keyword">for</span>=<span class="string">"(item, index) in bannerAds"</span></span><br><span class="line">	v-bind:key=<span class="string">"index"</span></span><br><span class="line">	@click.native=<span class="string">"linkAds(item)"</span></span><br><span class="line">	:style=<span class="string">"'background-image:url('+ item.url +')'"</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/swiper-slide&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ çš„ swiper ä¹Ÿæ˜¯ä½¿ç”¨äº† v-for å¹¶ä¸” click ä½œç”¨åœ¨ v-for æ‰€åœ¨çš„å…ƒç´ ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½ä¼šå¯¼è‡´ click äº‹ä»¶ä¸ä¼šæ‰§è¡Œã€‚è¿™æ—¶å€™è¯•è¯•åœ¨ç”¨ <code>@click.native</code> å¯è§£å†³é—®é¢˜ã€‚</p>
<p>ç±»ä¼¼çš„é—®é¢˜è¿˜æœ‰ <code>router-link</code> ä¸ŠåŠ  click ä¹Ÿä¸ç”Ÿæ•ˆã€‚æ–¹æ³•ç›¸åŒã€‚</p>
<p>ä¸€èˆ¬æ˜¯è‡ªå·±å®šä¹‰çš„ç»„ä»¶ï¼Œæˆ–è€… vue è‡ªå®šä¹‰çš„æ ‡ç­¾ï¼Œå¦‚ä¸Šé¢çš„ <code>router-link</code>ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å¯ä»¥ç†è§£ä¸ºï¼Œ<strong><code>.native</code> ä¿®é¥°ç¬¦å°±æ˜¯ç”¨æ¥æ³¨å†Œå…ƒç´ çš„åŸç”Ÿäº‹ä»¶è€Œä¸æ˜¯ç»„ä»¶è‡ªå®šä¹‰äº‹ä»¶çš„ã€‚æ˜¯æŠŠç»„ä»¶å˜å›åŸç”ŸDOMçš„ä¸€ç§æ–¹å¼ï¼Œç›¸å½“äºç»™ç»„ä»¶ç»‘å®šåŸç”Ÿäº‹ä»¶ã€‚å¯¹åŸç”Ÿhtmlæ ‡ç­¾æ— ç”¨ã€‚</strong>å› ä¸ºæœ¬èº«Vueæ˜¯æœ‰è‡ªå·±çš„ä¸€å¥—è¿›è¡Œä¼ é€’çš„æœºåˆ¶ï¼Œè¿™æ ·å‘Šè¯‰äº†Vue,ç”¨åŸç”Ÿçš„äº‹ä»¶ï¼Œè€Œä¸æ˜¯Vueè‡ªå·±çš„é‚£ä¸€å¥—äº‹ä»¶è§¦å‘æœºåˆ¶ã€‚</p>
<hr>
<h2 id="å¯¹è±¡çš„-filter"><a href="#å¯¹è±¡çš„-filter" class="headerlink" title="å¯¹è±¡çš„ filter"></a>å¯¹è±¡çš„ filter</h2><p>ä¸€èˆ¬æˆ‘ä»¬ä¼šå¾ˆä¹ æƒ¯å»ç”¨ arr.filter å»å¸®æˆ‘ä»¬åšä¸€äº›è¿‡æ»¤çš„äº‹æƒ…ï¼Œé‚£ä¹ˆå¦‚æœæ˜¯æƒ³è¦ç»™ object map åšä¸€äº›è¿‡æ»¤çš„äº‹æƒ…ï¼Œæˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·å°è£…ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * å¯¹è±¡è¿‡æ»¤å™¨</span></span><br><span class="line"><span class="comment"> * @param obj</span></span><br><span class="line"><span class="comment"> * @param filterFunction</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">objectFilter</span>(<span class="params">obj, filterFunction</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.assign(</span><br><span class="line">    ...Object.keys(obj)</span><br><span class="line">      .filter(<span class="function"><span class="params">key</span> =&gt;</span> filterFunction(obj[key]))</span><br><span class="line">      .map(<span class="function"><span class="params">key</span> =&gt;</span> (&#123; [key]: obj[key] &#125;))</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¹è±¡è¿‡æ»¤å™¨</span></span><br><span class="line"><span class="comment"> * arr.reduce(callback[, initialValue])</span></span><br><span class="line"><span class="comment"> * callback(accumulator, currentValue, currentIndex, array)</span></span><br><span class="line"><span class="comment"> * @param obj</span></span><br><span class="line"><span class="comment"> * @param filterFunction</span></span><br><span class="line"><span class="comment"> * @returns &#123;&#123;&#125;&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">filterObject</span>(<span class="params">obj, filterFunction</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.keys(obj)</span><br><span class="line">    .filter(<span class="function"><span class="params">key</span> =&gt;</span> filterFunction(obj[key]))</span><br><span class="line">    .reduce(<span class="function">(<span class="params">res, currKey</span>) =&gt;</span> (res[currKey] = obj[key]), &#123;&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Ravené…ç½®æŸäº›æ—¶å€™ä¸å‘é€é”™è¯¯æ•°æ®"><a href="#Ravené…ç½®æŸäº›æ—¶å€™ä¸å‘é€é”™è¯¯æ•°æ®" class="headerlink" title="Ravené…ç½®æŸäº›æ—¶å€™ä¸å‘é€é”™è¯¯æ•°æ®"></a>Ravené…ç½®æŸäº›æ—¶å€™ä¸å‘é€é”™è¯¯æ•°æ®</h2><p><code>shouldSendCallback</code>è®¾ç½®åªæœ‰ production ç¯å¢ƒæ‰å‘é€é”™è¯¯æ•°æ®ï¼Œæœ¬åœ°çš„é”™è¯¯å†…å®¹ä¸å‘é€åˆ° sentry ä¸Šã€‚</p>
<p><code>dataCallback</code>åœ¨å‘é€æ•°æ®ä¹‹å‰æƒ³è¦åšçš„äº‹æƒ…ï¼Œå¯ä»¥æ”¾è¿™é‡Œé¢ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Raven.config(<span class="string">"xxxx"</span>, &#123;</span><br><span class="line">  environment: process.env.NODE_ENV,</span><br><span class="line">  release: process.env.VERSION,</span><br><span class="line">  sampleRate: <span class="number">0.1</span>,</span><br><span class="line">  dataCallback: <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (process.env.NODE_ENV != <span class="string">"production"</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">  &#125;,</span><br><span class="line">  shouldSendCallback: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> process.env.NODE_ENV == <span class="string">"production"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">  .addPlugin(RavenVue, Vue)</span><br><span class="line">  .install()</span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;swiper-v-for-ä¸­-click-ä¸ç”Ÿæ•ˆ&quot;&gt;&lt;a href=&quot;#swiper-v-for-ä¸­-click-ä¸ç”Ÿæ•ˆ&quot; class=&quot;headerlink&quot; title=&quot;swiper v-for ä¸­ click ä¸ç”Ÿæ•ˆ&quot;&gt;&lt;/a&gt;swiper v-for ä¸­
    
    </summary>
    
    
      <category term="Javascript" scheme="http://sevencai.github.io/tags/Javascript/"/>
    
  </entry>
  
  <entry>
    <title>The Linux Command Line è¯»ä¹¦ç¬”è®°ï¼ˆä¸‰ï¼‰</title>
    <link href="http://sevencai.github.io/2018/08/23/The-Linux-Command-Line-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/"/>
    <id>http://sevencai.github.io/2018/08/23/The-Linux-Command-Line-è¯»ä¹¦ç¬”è®°ï¼ˆä¸‰ï¼‰/</id>
    <published>2018-08-23T07:27:57.000Z</published>
    <updated>2018-08-23T07:55:37.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¬¬11ç« ï¼šshell-ç¯å¢ƒ-ğŸ¡"><a href="#ç¬¬11ç« ï¼šshell-ç¯å¢ƒ-ğŸ¡" class="headerlink" title="ç¬¬11ç« ï¼šshell ç¯å¢ƒ ğŸ¡"></a>ç¬¬11ç« ï¼šshell ç¯å¢ƒ ğŸ¡</h1><blockquote>
<p>shell åœ¨ shell ä¼šè¯ä¸­ä¿å­˜ç€å¤§é‡ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯è¢«ç§°ä¸º (shell çš„) ç¯å¢ƒã€‚ ç¨‹åºè·å–ç¯å¢ƒä¸­çš„æ•°æ®ï¼ˆå³ç¯å¢ƒå˜é‡ï¼‰æ¥äº†è§£æœ¬æœºçš„é…ç½®ã€‚è™½ç„¶å¤§å¤šæ•°ç¨‹åºç”¨é…ç½®æ–‡ä»¶æ¥å­˜å‚¨ç¨‹åºè®¾ç½®ï¼Œ ä¸€äº›ç¨‹åºä¼šæ ¹æ®ç¯å¢ƒå˜é‡æ¥è°ƒæ•´ä»–ä»¬çš„è¡Œä¸ºã€‚çŸ¥é“äº†è¿™äº›ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ç¯å¢ƒå˜é‡æ¥è‡ªå®šåˆ¶ shell ä½“éªŒã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-   printenv - æ‰“å°éƒ¨åˆ†æˆ–æ‰€æœ‰çš„ç¯å¢ƒå˜é‡</span><br><span class="line">-   <span class="built_in">set</span> - è®¾ç½® shell é€‰é¡¹</span><br><span class="line">-   <span class="built_in">export</span> â€” å¯¼å‡ºç¯å¢ƒå˜é‡ï¼Œè®©éšåæ‰§è¡Œçš„ç¨‹åºçŸ¥é“ã€‚</span><br><span class="line">-   <span class="built_in">alias</span> - åˆ›å»ºå‘½ä»¤åˆ«å</span><br></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h2 id="printenv-amp-set"><a href="#printenv-amp-set" class="headerlink" title="printenv &amp; set"></a>printenv &amp; set</h2><blockquote>
<p>shell åœ¨ç¯å¢ƒä¸­å­˜å‚¨äº†ä¸¤ç§åŸºæœ¬ç±»å‹çš„æ•°æ®ï¼Œè™½ç„¶ bash å‡ ä¹æ— æ³•åˆ†è¾¨è¿™äº›æ•°æ®çš„ç±»å‹ã€‚ å®ƒä»¬æ˜¯<strong>ç¯å¢ƒå˜é‡å’Œ shell å˜é‡</strong>ã€‚Shell å˜é‡æ˜¯ bash å­˜æ”¾çš„å°‘é‡æ•°æ®ã€‚å‰©ä¸‹çš„éƒ½æ˜¯ ç¯å¢ƒå˜é‡ã€‚é™¤äº†å˜é‡ï¼Œshell ä¹Ÿå­˜å‚¨äº†ä¸€äº›å¯ç¼–ç¨‹çš„æ•°æ®ï¼Œå³åˆ«åå’Œ shell å‡½æ•°ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ bash çš„å†…å»ºå‘½ä»¤ setï¼Œæˆ–è€…æ˜¯ printenv ç¨‹åºæ¥æŸ¥çœ‹ç¯å¢ƒå˜é‡ã€‚<strong>set å‘½ä»¤å¯ä»¥ æ˜¾ç¤º shell æˆ–ç¯å¢ƒå˜é‡ï¼Œè€Œ printenv åªæ˜¯æ˜¾ç¤ºç¯å¢ƒå˜é‡ã€‚</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">printenv | less</span><br><span class="line"></span><br><span class="line"><span class="comment">// printenv æ”¯æŒæŸ¥çœ‹æŸä¸ªç¯å¢ƒå˜é‡</span></span><br><span class="line">printenv USER   =&gt; sevencai</span><br></pre></td></tr></table></figure>
<p>å½“ä½¿ç”¨æ²¡æœ‰å¸¦é€‰é¡¹å’Œå‚æ•°çš„ set å‘½ä»¤æ—¶ï¼Œshell å˜é‡ï¼Œç¯å¢ƒå˜é‡ï¼Œå’Œå®šä¹‰çš„ shell å‡½æ•° éƒ½ä¼šè¢«æ˜¾ç¤ºã€‚ä¸åŒäº printenv å‘½ä»¤ï¼Œset å‘½ä»¤çš„è¾“å‡ºå¾ˆå‹å¥½åœ°æŒ‰ç…§é¦–å­—æ¯é¡ºåºæ’åˆ—ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> | less</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$HOME</span></span><br><span class="line"></span><br><span class="line">// åˆ«åæ— æ³•é€šè¿‡ä½¿ç”¨ <span class="built_in">set</span> æˆ– printenv æ¥æŸ¥çœ‹ã€‚ ç”¨ä¸å¸¦å‚æ•°çš„ <span class="built_in">alias</span> æ¥æŸ¥çœ‹åˆ«å:</span><br><span class="line"><span class="built_in">alias</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="å¦‚ä½•å»ºç«‹-shell-ç¯å¢ƒï¼Ÿ"><a href="#å¦‚ä½•å»ºç«‹-shell-ç¯å¢ƒï¼Ÿ" class="headerlink" title="å¦‚ä½•å»ºç«‹ shell ç¯å¢ƒï¼Ÿ"></a>å¦‚ä½•å»ºç«‹ shell ç¯å¢ƒï¼Ÿ</h2><blockquote>
<p>When we log on to the system, the bash program starts, and reads a series of configuration scripts called startup files, which define the default environment shared by all users. This is followed by more startup files in our home directory that define our personal environment. The exact sequence depends on the type of shell session being started. There are two kinds: a login shell session and a non-login shell session.</p>
</blockquote>
<p>ç™»å½•shellæˆ–è€…éç™»å½•shelléƒ½ä¼šå»è¯»å–ç›¸åº”çš„æ–‡ä»¶ï¼Œä½†æ˜¯è¯»å–çš„æ–‡ä»¶å¤šå°‘ä¼šæœ‰åŒºåˆ«ã€‚ä¾‹å¦‚ï¼š</p>
<p>ç™»å½•shellå¯èƒ½ä¼šè¯»å–ï¼š</p>
<p><img src="login.png" alt="login"></p>
<p>éç™»å½•shellå¯èƒ½ä¼šè¯»å–ï¼š</p>
<p><img src="unlogin.png" alt="unlogin.png"></p>
<p>ä¸€ä¸ªå…¸å‹çš„ .bashrc æ–‡ä»¶å¯èƒ½é•¿ä¸‹é¢è¿™æ ·ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .bash_profile</span></span><br><span class="line"><span class="comment"># Get the aliases and functions</span></span><br><span class="line"><span class="keyword">if</span> [ -f ~/.bashrc ]; <span class="keyword">then</span></span><br><span class="line">. ~/.bashrc</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># User specific environment and startup programs</span></span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH</span><br></pre></td></tr></table></figure></p>
<p>ç¿»è¯‘è¿‡æ¥å¯èƒ½æ˜¯ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">If the file ~/.bashrc exists, <span class="keyword">then</span></span><br><span class="line"><span class="built_in">read</span> the ~/.bashrc file.</span><br></pre></td></tr></table></figure></p>
<p><strong>æ˜¯å¦æ›¾ç»å¯¹ shell æ€æ ·çŸ¥é“åœ¨å“ªé‡Œæ‰¾åˆ°æˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥çš„å‘½ä»¤æ„Ÿåˆ°è¿·æƒ‘ï¼Ÿä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬è¾“å…¥ ls åï¼Œ shell ä¸ä¼šæŸ¥æ‰¾æ•´ä¸ªè®¡ç®—æœºç³»ç»Ÿæ¥æ‰¾åˆ° /bin/lsï¼ˆls å‘½ä»¤çš„å…¨è·¯å¾„åï¼‰ï¼Œç›¸åï¼Œå®ƒæŸ¥æ‰¾ä¸€ä¸ªç›®å½•åˆ—è¡¨ï¼Œ è¿™äº›ç›®å½•åŒ…å«åœ¨ PATH å˜é‡ä¸­ã€‚</strong></p>
<p>æˆ‘ä»¬å¯¹äºæ–‡ä»¶ .bashrc çš„ä¿®æ”¹ä¸ä¼šç”Ÿæ•ˆï¼Œç›´åˆ°æˆ‘ä»¬å…³é—­ç»ˆç«¯ä¼šè¯ï¼Œå†é‡æ–°å¯åŠ¨ä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œ å› ä¸º .bashrc æ–‡ä»¶åªæ˜¯åœ¨åˆšå¼€å§‹å¯åŠ¨ç»ˆç«¯ä¼šè¯æ—¶è¯»å–ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥å¼ºè¿« bash é‡æ–°è¯»å–ä¿®æ”¹è¿‡çš„ .bashrc æ–‡ä»¶ï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> l.=<span class="string">'ls -d .* --color=auto'</span></span><br><span class="line"><span class="built_in">alias</span> ll=<span class="string">'ls -l --color=auto'</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> .bashrc</span><br></pre></td></tr></table></figure></p>
<hr>
<h1 id="ç¬¬12ç« ï¼š-viç®€ä»‹ğŸ©"><a href="#ç¬¬12ç« ï¼š-viç®€ä»‹ğŸ©" class="headerlink" title="ç¬¬12ç« ï¼š viç®€ä»‹ğŸ©"></a>ç¬¬12ç« ï¼š viç®€ä»‹ğŸ©</h1><p>è¿™ä¸ªæˆ‘å·²ç»æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œè¿™é‡Œè¿˜æ˜¯åˆ—å‡ºä¸‹ä¹¦é‡Œçš„æ€»ç»“ï¼Œæ•´ä½“çš„æ€»ç»“ä¹¦é‡Œå†™çš„æŒºå¥½ï¼š</p>
<blockquote>
<p>viï¼ˆå‘éŸ³â€œvee eyeâ€ï¼‰ï¼Œå¤§å¤šæ•° Linux å‘è¡Œç‰ˆä¸åŒ…å«çœŸæ­£çš„ viï¼›è€Œæ˜¯è‡ªå¸¦ä¸€æ¬¾é«˜çº§æ›¿ä»£ç‰ˆæœ¬ï¼Œå«åš vimï¼ˆå®ƒæ˜¯â€œvi improvedâ€çš„ç®€å†™ï¼‰ç”± Bram Moolenaar å¼€å‘çš„ã€‚vim ç›¸å¯¹äºä¼ ç»Ÿçš„ Unix vi æ¥è¯´ï¼Œå–å¾—äº†å®è´¨æ€§è¿›æ­¥ã€‚é€šå¸¸ï¼Œvim åœ¨ Linux ç³»ç»Ÿä¸­æ˜¯â€œviâ€çš„ç¬¦å·é“¾æ¥ï¼ˆæˆ–åˆ«åï¼‰ã€‚</p>
</blockquote>
<h2 id="ç§»åŠ¨å…‰æ ‡"><a href="#ç§»åŠ¨å…‰æ ‡" class="headerlink" title="ç§»åŠ¨å…‰æ ‡"></a>ç§»åŠ¨å…‰æ ‡</h2><p><img src="move.png" alt="move"></p>
<p>è¡¥å……ä¸€ä¸ªï¼š<code>0,$,^,g_</code>  çš„åŒºåˆ«å’Œè”ç³»ã€‚<code>0,$</code>æ˜¯åˆ°è¡Œå¤´å’Œè¡Œå°¾ï¼Œ<code>^,g_</code>åˆ°éblankå­—ç¬¦ä½ç½®ã€‚<code>J</code>åˆå¹¶è¡Œã€‚</p>
<h2 id="æ–‡æœ¬åˆ é™¤å‘½ä»¤"><a href="#æ–‡æœ¬åˆ é™¤å‘½ä»¤" class="headerlink" title="æ–‡æœ¬åˆ é™¤å‘½ä»¤"></a>æ–‡æœ¬åˆ é™¤å‘½ä»¤</h2><p><img src="delete.png" alt="delete"></p>
<h2 id="å¤åˆ¶å‘½ä»¤"><a href="#å¤åˆ¶å‘½ä»¤" class="headerlink" title="å¤åˆ¶å‘½ä»¤"></a>å¤åˆ¶å‘½ä»¤</h2><p><img src="copy.png" alt="copy"></p>
<h2 id="å…¨å±€æŸ¥æ‰¾ä¸æ›¿æ¢"><a href="#å…¨å±€æŸ¥æ‰¾ä¸æ›¿æ¢" class="headerlink" title="å…¨å±€æŸ¥æ‰¾ä¸æ›¿æ¢"></a>å…¨å±€æŸ¥æ‰¾ä¸æ›¿æ¢</h2><p>å¦‚<code>:%s/Line/line/g</code></p>
<p>æŸ¥æ‰¾ä¸€è¡Œå†…çš„æ˜¯ç”¨ <code>f</code> å‘½ä»¤ï¼ŒæŸ¥æ‰¾ä¸‹ä¸€ä¸ªå‡ºç°çš„ï¼Œæ˜¯ç”¨ <code>/</code>å‘½ä»¤ã€‚</p>
<p><img src="replace.png" alt="replace"></p>
<h2 id="å¤šè¡Œç¼–è¾‘"><a href="#å¤šè¡Œç¼–è¾‘" class="headerlink" title="å¤šè¡Œç¼–è¾‘"></a>å¤šè¡Œç¼–è¾‘</h2><ol>
<li>vi file1 file2 file3â€¦</li>
<li>:n ä»è¿™ä¸ªæ–‡ä»¶åˆ‡æ¢ä¸‹ä¸€ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨è¿™ä¸ª ex å‘½ä»¤</li>
<li>:N å›åˆ°å…ˆå‰çš„æ–‡ä»¶ä½¿ç”¨:N</li>
<li>:buffers æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æ­£åœ¨ç¼–è¾‘çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä½¿ç”¨:buffers å‘½ä»¤ã€‚è¿è¡Œè¿™ä¸ª å‘½ä»¤åï¼Œå±å¹•é¡¶éƒ¨å°±ä¼šæ˜¾ç¤ºå‡ºä¸€ä¸ªæ–‡ä»¶åˆ—è¡¨, :buffers 2 å°±åˆ‡æ¢åˆ°2å·æ–‡ä»¶äº†ã€‚</li>
</ol>
<hr>
<h1 id="ç¬¬13ç« ï¼šè‡ªå®šåˆ¶-shell-æç¤ºç¬¦-ğŸ’‰"><a href="#ç¬¬13ç« ï¼šè‡ªå®šåˆ¶-shell-æç¤ºç¬¦-ğŸ’‰" class="headerlink" title="ç¬¬13ç« ï¼šè‡ªå®šåˆ¶ shell æç¤ºç¬¦ ğŸ’‰"></a>ç¬¬13ç« ï¼šè‡ªå®šåˆ¶ shell æç¤ºç¬¦ ğŸ’‰</h1><p>å’Œ Linux å†…çš„è®¸å¤šç¨‹åºä¸€æ ·ï¼Œshell æç¤ºç¬¦æ˜¯å¯é«˜åº¦é…ç½®çš„ï¼Œè™½ç„¶æˆ‘ä»¬æŠŠå®ƒç›¸å½“å¤šåœ°çœ‹ä½œæ˜¯ç†æ‰€å½“ç„¶çš„ï¼Œ ä½†æ˜¯æˆ‘ä»¬ä¸€æ—¦å­¦ä¼šäº†æ€æ ·æ§åˆ¶å®ƒï¼Œshell æç¤ºç¬¦æ˜¯ä¸€ä¸ªç›¸å½“æœ‰ç”¨çš„å·¥å…·ã€‚</p>
<p>æˆ‘ä»¬çš„é»˜è®¤æç¤ºç¬¦å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[me@linuxbox ~]$</span><br></pre></td></tr></table></figure></p>
<p>æ³¨æ„å®ƒåŒ…å«æˆ‘ä»¬çš„ç”¨æˆ·åï¼Œä¸»æœºåå’Œå½“å‰å·¥ä½œç›®å½•ï¼Œä½†æ˜¯å®ƒåˆæ˜¯æ€æ ·å¾—åˆ°è¿™äº›ä¸œè¥¿çš„å‘¢ï¼Ÿ ç»“æœè¯æ˜éå¸¸ç®€å•ã€‚æç¤ºç¬¦æ˜¯ç”±ä¸€ä¸ªç¯å¢ƒå˜é‡å®šä¹‰çš„ï¼Œå«åš PS1ï¼ˆæ˜¯â€œprompt string oneâ€ çš„ç®€å†™ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ echo å‘½ä»¤æ¥æŸ¥çœ‹ PS1çš„å†…å®¹ã€‚</p>
<h2 id="è®¤è¯†-PS1"><a href="#è®¤è¯†-PS1" class="headerlink" title="è®¤è¯†$PS1"></a>è®¤è¯†$PS1</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[me@linuxbox ~]$ <span class="built_in">echo</span> <span class="variable">$PS1</span></span><br><span class="line"><span class="variable">$&#123;ret_status&#125;</span> %&#123;<span class="variable">$fg</span>[cyan]%&#125;%c%&#123;<span class="variable">$reset_color</span>%&#125; $(git_prompt_info)</span><br></pre></td></tr></table></figure>
<h2 id="æ›´æ”¹-PS1"><a href="#æ›´æ”¹-PS1" class="headerlink" title="æ›´æ”¹ $PS1"></a>æ›´æ”¹ $PS1</h2><p>æˆ‘ä»¬å¯ä»¥é¦–å…ˆå¤‡ä»½ä¸‹ $PS1, ç„¶åå†éšæ„ä¿®æ”¹ $PS1, æœ€åå†é‡æ–°å˜å›æ¥å°±å¯ä»¥äº†ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// å¤‡ä»½ PS1</span><br><span class="line">ps1_old=<span class="string">"<span class="variable">$PS1</span>"</span></span><br><span class="line"></span><br><span class="line">// éšæ„ä¿®æ”¹ PS1</span><br><span class="line">$ PS1=<span class="string">"\a\$ "</span></span><br><span class="line"></span><br><span class="line">// æœ€åæ”¹å›æ¥</span><br><span class="line">PS1=<span class="variable">$ps1_old</span></span><br></pre></td></tr></table></figure></p>
<p>å…¶å®è¿™ä¸ªæˆ‘å¹³æ—¶è‚¯å®šä¸ä¼šç”¨ï¼Œä½†æ˜¯çœ‹ç€çœ‹ç€è¿˜æŒºæœ‰æ„æ€çš„ï¼Œå°±éšæ„è®°å½•äº†ä¸‹ã€‚</p>
<hr>
<h1 id="æ€»ç»“-ğŸŒº"><a href="#æ€»ç»“-ğŸŒº" class="headerlink" title="æ€»ç»“ ğŸŒº"></a>æ€»ç»“ ğŸŒº</h1><p>è¿™å‡ ä¸ªç« èŠ‚ä¸»è¦æ˜¯æ€»ç»“äº†<code>é…ç½®æ–‡ä»¶å’Œ shell ç¯å¢ƒ</code>è¿™ ä¸€å¼ ã€‚è¿™ç« å†…å®¹å°‘ç”¨ï¼Œä½†æ˜¯å¯¹äºç†è§£æ•´ä½“ shell æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚</p>
<p>æ—¶é—´éƒ½æ˜¯æŒ¤å‡ºæ¥çš„ï¼Œäº‹å®è¯æ˜åˆ©ç”¨å¥½ä¸­åˆå’Œæ™šä¸Šå›å®¶ä¹‹å‰çš„æ—¶é—´ï¼Œä¹Ÿæ˜¯èƒ½æœ‰æ‰€æ”¶è·ã€‚ğŸ“š</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ç¬¬11ç« ï¼šshell-ç¯å¢ƒ-ğŸ¡&quot;&gt;&lt;a href=&quot;#ç¬¬11ç« ï¼šshell-ç¯å¢ƒ-ğŸ¡&quot; class=&quot;headerlink&quot; title=&quot;ç¬¬11ç« ï¼šshell ç¯å¢ƒ ğŸ¡&quot;&gt;&lt;/a&gt;ç¬¬11ç« ï¼šshell ç¯å¢ƒ ğŸ¡&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;s
    
    </summary>
    
    
      <category term="è¯»ä¹¦ç¬”è®°" scheme="http://sevencai.github.io/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>The Linux Command Line è¯»ä¹¦ç¬”è®°ï¼ˆäºŒï¼‰</title>
    <link href="http://sevencai.github.io/2018/08/17/The-Linux-Command-Line-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <id>http://sevencai.github.io/2018/08/17/The-Linux-Command-Line-è¯»ä¹¦ç¬”è®°ï¼ˆäºŒï¼‰/</id>
    <published>2018-08-17T09:11:25.000Z</published>
    <updated>2018-08-17T09:29:08.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«"><a href="#ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«" class="headerlink" title="ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«"></a>ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«</h1><blockquote>
<p>Unix ä¼ ç»Ÿä¸­çš„æ“ä½œç³»ç»Ÿä¸åŒäºé‚£äº› MS-DOS ä¼ ç»Ÿä¸­çš„ç³»ç»Ÿï¼ŒåŒºåˆ«åœ¨äºå®ƒä»¬ä¸ä»…æ˜¯å¤šä»»åŠ¡ç³»ç»Ÿï¼Œè€Œä¸”ä¹Ÿæ˜¯ å¤šç”¨æˆ·ç³»ç»Ÿã€‚è¿™åˆ°åº•æ„å‘³ç€ä»€ä¹ˆï¼Ÿå®ƒæ„å‘³ç€å¤šä¸ªç”¨æˆ·å¯ä»¥åœ¨åŒä¸€æ—¶é—´ä½¿ç”¨åŒä¸€å°è®¡ç®—æœºã€‚<br>ä¸ºäº†ä½¿å¤šç”¨æˆ·ç‰¹æ€§ä»˜è¯¸å®è·µï¼Œé‚£ä¹ˆå¿…é¡»å‘æ˜ä¸€ç§æ–¹æ³•æ¥<strong>é˜»æ­¢ç”¨æˆ·å½¼æ­¤ä¹‹é—´å—åˆ°å½±å“</strong>ã€‚æ¯•ç«Ÿï¼Œä¸€ä¸ª ç”¨æˆ·çš„è¡Œä¸ºä¸èƒ½å¯¼è‡´è®¡ç®—æœºå´©æºƒï¼Œä¹Ÿä¸èƒ½ä¹±åŠ¨å±äºå¦ä¸€ä¸ªç”¨æˆ·çš„æ–‡ä»¶ã€‚</p>
</blockquote>
<p>ä¸»è¦çš„å‘½ä»¤æœ‰ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">id â€“ æ˜¾ç¤ºç”¨æˆ·èº«ä»½å·ï¼ˆæ¯ä¸ªç”¨æˆ·éƒ½ä¼šæœ‰ä¸ª idï¼‰</span><br><span class="line">chmod â€“ æ›´æ”¹æ–‡ä»¶æ¨¡å¼</span><br><span class="line"><span class="built_in">umask</span> â€“ è®¾ç½®é»˜è®¤çš„æ–‡ä»¶æƒé™ (è¿™ä¸ªæˆ‘åŸºæœ¬ä¸ä¼šç”¨åˆ°ï¼Œæš‚æ—¶å¿½ç•¥)</span><br><span class="line">su â€“ ä»¥å¦ä¸€ä¸ªç”¨æˆ·çš„èº«ä»½æ¥è¿è¡Œ shell</span><br><span class="line">sudo â€“ ä»¥å¦ä¸€ä¸ªç”¨æˆ·çš„èº«ä»½æ¥æ‰§è¡Œå‘½ä»¤</span><br><span class="line">chown â€“ æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…</span><br><span class="line">chgrp â€“ æ›´æ”¹æ–‡ä»¶ç»„æ‰€æœ‰æƒ</span><br><span class="line">passwd â€“ æ›´æ”¹ç”¨æˆ·å¯†ç </span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="chmod-æ›´æ”¹æ–‡ä»¶æ¨¡å¼"><a href="#chmod-æ›´æ”¹æ–‡ä»¶æ¨¡å¼" class="headerlink" title="chmod-æ›´æ”¹æ–‡ä»¶æ¨¡å¼"></a>chmod-æ›´æ”¹æ–‡ä»¶æ¨¡å¼</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-rw-r--r--    1 sevencai  TENCENT\Domain Users     523  8 15 15:36 README.md</span><br></pre></td></tr></table></figure>
<p><strong>åˆ—è¡¨çš„å‰åä¸ªå­—ç¬¦æ˜¯æ–‡ä»¶çš„å±æ€§ã€‚è¿™åä¸ªå­—ç¬¦çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è¡¨æ˜æ–‡ä»¶ç±»å‹ã€‚</strong></p>
<p>å…·ä½“å¯èƒ½æœ‰çš„å€¼æœ‰ï¼š</p>
<p><img src="firstletter.png" alt="first letter"></p>
<p><strong>å‰©ä¸‹çš„ä¹ä¸ªå­—ç¬¦å«åšæ–‡ä»¶æ¨¡å¼ï¼Œä»£è¡¨ç€æ–‡ä»¶æ‰€æœ‰è€…ã€æ–‡ä»¶ç»„æ‰€æœ‰è€…å’Œå…¶ä»–äººçš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ã€‚</strong></p>
<p><img src="filemode.png" alt="filemode"></p>
<p><img src="attribute.png" alt="attribute"></p>
<p>å¦‚<code>-rwxr-xr-x</code>æ ‡è¯†çš„å«ä¹‰æ˜¯ï¼šä¸€ä¸ªæ™®é€šæ–‡ä»¶ï¼Œå¯¹æ–‡ä»¶æ‰€æœ‰è€…æ¥è¯´å¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œã€‚ä¹Ÿå¯ä»¥è¢«å…¶ä»–çš„æ‰€æœ‰äººè¯»å–å’Œæ‰§è¡Œã€‚</p>
<p><strong>æˆ‘ä»¬ä½¿ç”¨å…«è¿›åˆ¶æ•°å­—æ¥è®¾ç½®æ‰€æœŸæœ›çš„æƒé™æ¨¡å¼ã€‚å› ä¸ºæ¯ä¸ªå…«è¿›åˆ¶æ•°å­—ä»£è¡¨äº† 3ä¸ªäºŒè¿›åˆ¶æ•°å­—ï¼Œè¿™ç§å¯¹åº”å…³ç³»ï¼Œæ­£å¥½æ˜ å°„åˆ°ç”¨æ¥å­˜å‚¨æ–‡ä»¶æ¨¡å¼æ‰€ä½¿ç”¨çš„æ–¹æ¡ˆä¸Šã€‚</strong></p>
<p>å¯¹åº”çš„å€¼ä¸ºï¼š</p>
<p><img src="otcal.png" alt="octal"></p>
<p>é€šè¿‡ä½¿ç”¨3ä¸ªå…«è¿›åˆ¶æ•°å­—ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè®¾ç½®æ–‡ä»¶æ‰€æœ‰è€…ã€ç”¨æˆ·ç»„å’Œå…¶ä»–äººçš„æƒé™ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 600 foo.txt</span><br><span class="line">chmod 755 shell.sh</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡ä¼ é€’å‚æ•° â€œ600â€ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè®¾ç½®æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™ä¸ºè¯»å†™æƒé™ï¼Œè€Œåˆ é™¤ç”¨æˆ·ç»„å’Œå…¶ä»–äººçš„æ‰€æœ‰ æƒé™ã€‚è™½ç„¶å…«è¿›åˆ¶åˆ°äºŒè¿›åˆ¶çš„æ˜ å°„çœ‹èµ·æ¥ä¸æ–¹ä¾¿ï¼Œä½†é€šå¸¸åªä¼šç”¨åˆ°ä¸€äº›å¸¸è§çš„æ˜ å°„å…³ç³»ï¼š 7 (rwx)ï¼Œ6 (rw-)ï¼Œ5 (r-x)ï¼Œ4 (râ€“)ï¼Œå’Œ 0 (â€”)ã€‚</p>
<p>chmod å‘½ä»¤è¿˜æ”¯æŒä¸€ç§ç¬¦å·è¡¨ç¤ºæ³•ï¼Œæ¥æŒ‡å®šæ–‡ä»¶æ¨¡å¼ã€‚ç¬¦å·è¡¨ç¤ºæ³•åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šæ›´æ”¹ä¼šå½±å“è°ï¼Œ è¦æ‰§è¡Œå“ªä¸ªæ“ä½œï¼Œè¦è®¾ç½®å“ªç§æƒé™ã€‚é€šè¿‡å­—ç¬¦ â€œuâ€ã€â€œgâ€ã€â€œoâ€å’Œ â€œaâ€ çš„ç»„åˆæ¥æŒ‡å®š è¦å½±å“çš„å¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="ugoa.png" alt="ugoa"></p>
<p><strong>å¦‚æœæ²¡æœ‰æŒ‡å®šå­—ç¬¦ï¼Œåˆ™å‡å®šä½¿ç”¨â€allâ€ã€‚æ‰§è¡Œçš„æ“ä½œå¯èƒ½æ˜¯ä¸€ä¸ªâ€œï¼‹â€å­—ç¬¦ï¼Œè¡¨ç¤ºåŠ ä¸Šä¸€ä¸ªæƒé™ï¼Œ ä¸€ä¸ªâ€œï¼â€ï¼Œè¡¨ç¤ºåˆ æ‰ä¸€ä¸ªæƒé™ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªâ€œï¼â€ï¼Œè¡¨ç¤ºåªæœ‰æŒ‡å®šçš„æƒé™å¯ç”¨ï¼Œå…¶å®ƒæ‰€æœ‰çš„æƒé™è¢«åˆ é™¤ã€‚</strong></p>
<p>æœ‰ä¸‹é¢è¿™äº›ä¾‹å­ï¼ˆæˆ‘æ„Ÿè§‰è¿™ç§æˆ‘åº”è¯¥ä¸ä¼šç»å¸¸ç”¨ï¼Œå…ˆå‰ä¸€ç›´ç”¨ä¸Šé¢çš„äºŒè¿›åˆ¶æ¨¡å¼æ¯”è¾ƒå¤šï¼‰ï¼š</p>
<p><img src="other.png" alt="ugoa+-"></p>
<hr>
<h2 id="su-åŠ-sudo"><a href="#su-åŠ-sudo" class="headerlink" title="su åŠ sudo"></a>su åŠ sudo</h2><blockquote>
<p>su ï¼ ä»¥å…¶ä»–ç”¨æˆ·èº«ä»½å’Œç»„ ID è¿è¡Œä¸€ä¸ª shell<br>è¯­æ³•ç±»ä¼¼ï¼š su [-[l]] [user]</p>
</blockquote>
<p>å¦‚æœåŒ…å«â€-lâ€é€‰é¡¹ï¼Œé‚£ä¹ˆä¼šä¸ºæŒ‡å®šç”¨æˆ·å¯åŠ¨ä¸€ä¸ªéœ€è¦ç™»å½•çš„ shellã€‚è¿™æ„å‘³ç€ä¼šåŠ è½½æ­¤ç”¨æˆ·çš„ shell ç¯å¢ƒï¼Œ å¹¶ä¸”å·¥ä½œç›®å½•ä¼šæ›´æ”¹åˆ°è¿™ä¸ªç”¨æˆ·çš„å®¶ç›®å½•ã€‚è¿™é€šå¸¸æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚å¦‚æœä¸æŒ‡å®šç”¨æˆ·ï¼Œé‚£ä¹ˆå°±å‡å®šæ˜¯ è¶…çº§ç”¨æˆ·ã€‚æ³¨æ„ï¼ˆä¸å¯æ€è®®åœ°ï¼‰ï¼Œé€‰é¡¹â€-lâ€å¯ä»¥ç¼©å†™ä¸ºâ€-â€œï¼Œè¿™æ˜¯ç»å¸¸ç”¨åˆ°çš„å½¢å¼ã€‚</p>
<p>å› æ­¤ä¸ºäº†å¯åŠ¨è¶…çº§ç”¨æˆ·æˆ‘ä»¬å¯èƒ½ä¼šè¿™æ ·æ‰§è¡Œ<code>su -</code>ã€‚</p>
<p>å¦‚æœä»¥<code>su -c &#39;command&#39;</code>è¿™æ ·çš„æ–¹å¼å¯åŠ¨ä¸€ä¸ª shell, æ˜¯å¯ä»¥æ‰§è¡Œå•ä¸ªçš„<code>command</code>å‘½ä»¤ï¼Œè€Œä¸æ˜¯é‡æ–°å¯åŠ¨äº†ä¸€ä¸ªå¯ä»¥äº¤äº’çš„shellã€‚æ³¨æ„ command è¦ç”¨ å¼•å·å¼•èµ·æ¥ã€‚å¦‚<code>su -c &#39;ls -l /root/*&#39;</code>ã€‚</p>
<p><strong>sudo å‘½ä»¤åœ¨å¾ˆå¤šæ–¹é¢éƒ½ç›¸ä¼¼äº su å‘½ä»¤ï¼Œä½†æ˜¯ sudo è¿˜æœ‰ä¸€äº›éå¸¸é‡è¦çš„åŠŸèƒ½ã€‚ç®¡ç†å‘˜èƒ½å¤Ÿé…ç½® sudo å‘½ä»¤ï¼Œä»è€Œå…è®¸ä¸€ä¸ªæ™®é€šç”¨æˆ·ä»¥ä¸åŒçš„èº«ä»½ï¼ˆé€šå¸¸æ˜¯è¶…çº§ç”¨æˆ·ï¼‰ï¼Œé€šè¿‡ä¸€ç§éå¸¸å¯æ§çš„æ–¹å¼ æ¥æ‰§è¡Œå‘½ä»¤ã€‚å°¤å…¶æ˜¯ï¼Œåªæœ‰ä¸€ä¸ªç”¨æˆ·å¯ä»¥æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªç‰¹æ®Šå‘½ä»¤æ—¶ï¼Œï¼ˆæ›´ä½“ç°äº† sudo å‘½ä»¤çš„æ–¹ä¾¿æ€§ï¼‰ã€‚</strong></p>
<p>æ‰§è¡Œ <code>sudo -l</code>å¯ä»¥çœ‹å½“å‰è¢«èµ‹äºˆäº†å“ªäº›æƒé™å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">âœ  midas-welfare git:(master) sudo -l</span><br><span class="line">Password:</span><br><span class="line">Matching Defaults entries for sevencai on SEVENCAI-MB2:</span><br><span class="line">    env_reset ......</span><br><span class="line">User sevencai may run the following commands on SEVENCAI-MB2:</span><br><span class="line">    (ALL) ALL</span><br></pre></td></tr></table></figure></p>
<p>æ‰€ä»¥è¿™é‡Œæ€»ç»“ä¸‹ su å’Œ sudo çš„åŒºåˆ«å’Œè”ç³»ï¼š</p>
<ol>
<li><code>sudo</code> å‘½ä»¤éœ€è¦è¾“å…¥å½“å‰ç”¨æˆ·çš„å¯†ç ï¼Œ<code>su</code> å‘½ä»¤éœ€è¦è¾“å…¥ root ç”¨æˆ·çš„å¯†ç ã€‚</li>
<li><code>sudo</code> å‘½ä»¤åªå…è®¸ä½¿ç”¨æå‡çš„æƒé™è¿è¡Œå•ä¸ªå‘½ä»¤ï¼Œè€Œ <code>su</code> å‘½ä»¤ä¼šå¯åŠ¨ä¸€ä¸ªæ–°çš„ shellï¼ŒåŒæ—¶å…è®¸ä½¿ç”¨ root æƒé™è¿è¡Œå°½å¯èƒ½å¤šçš„å‘½ä»¤ï¼Œç›´åˆ°æ˜ç¡®é€€å‡ºç™»å½•</li>
</ol>
<p><strong>æ‰€ä»¥æ ¹æ®ç¬¬ä¸€æ¡ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å°±å®‰å…¨æ€§è€Œè¨€ï¼Œ<code>sudo</code> æ¯” <code>su</code> æ›´å¥½ã€‚<code>su</code>æ„å‘³ç€è¦ä¸å…¶ä»–ç”¨æˆ·å…±äº« root å¯†ç ï¼Œè¿™æ˜¯ä¸€ä»¶æ¯”è¾ƒå±é™©çš„äº‹æƒ…ã€‚å¹¶ä¸”å¯¹äº <code>su</code> è€Œè¨€å¦‚æœè¦æ’¤é”€ç‰¹å®šç”¨æˆ·çš„è¶…çº§ï¼ˆrootï¼‰æƒé™ï¼Œå”¯ä¸€çš„åŠæ³•å°±æ˜¯æ›´æ”¹ root å¯†ç ï¼Œç„¶åå†å‘ŠçŸ¥å…¶ä»–ç”¨æˆ·ã€‚å¾ˆéº»çƒ¦ã€‚ä½†æ˜¯ <code>sudo</code> å°±ä¸ä¸€æ ·äº†,å¦‚æœæƒ³è¦é˜»æ­¢æŸä¸ªç”¨æˆ·è®¿é—® root æƒé™ï¼Œåªéœ€è¦è°ƒæ•´ <code>sudoers</code> è¿™ä¸ªæ–‡ä»¶ä¸­çš„é…ç½®å³å¯ã€‚</strong></p>
<p>The key difference between <code>sudo</code> and <code>su</code> is <code>sudo</code> runs a command as root, whereas <code>su</code> makes you root.</p>
<hr>
<h2 id="chown-ï¼-æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„"><a href="#chown-ï¼-æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„" class="headerlink" title="chown ï¼ æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„"></a>chown ï¼ æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„</h2><p><strong>chown å‘½ä»¤è¢«ç”¨æ¥æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„ã€‚ä½¿ç”¨è¿™ä¸ªå‘½ä»¤éœ€è¦è¶…çº§ç”¨æˆ·æƒé™ã€‚</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown [owner][:[group]] file...</span><br></pre></td></tr></table></figure>
<p><img src="chown.png" alt="chown"></p>
<p>ä¸‹é¢è¿™ä¸ªä¾‹å­æ¯”è¾ƒå®ç”¨ï¼Œæœ‰ä¸¤ä¸ªç”¨æˆ·ï¼Œjanetæ‹¥æœ‰è¶…çº§ç”¨æˆ·è®¿é—®æƒé™ï¼Œè€Œ tony æ²¡æœ‰ã€‚ç”¨æˆ· janet æƒ³è¦ä» å¥¹çš„å®¶ç›®å½•å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶åˆ°ç”¨æˆ· tony çš„å®¶ç›®å½•ã€‚å› ä¸ºç”¨æˆ· janet æƒ³è¦ tony èƒ½å¤Ÿç¼–è¾‘è¿™ä¸ªæ–‡ä»¶ï¼Œ janet æŠŠè¿™ä¸ªæ–‡ä»¶çš„æ‰€æœ‰è€…æ›´æ”¹ä¸º tony:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[janet@linuxbox ~]$ sudo cp myfile.txt ~tony</span><br><span class="line">Password:</span><br><span class="line">[janet@linuxbox ~]$ sudo ls -l ~tony/myfile.txt</span><br><span class="line">-rw-r--r-- <span class="number">1</span> root  root <span class="number">8031</span> <span class="number">2008</span><span class="number">-03</span><span class="number">-20</span> <span class="number">14</span>:<span class="number">30</span> /home/tony/myfile.txt</span><br><span class="line">[janet@linuxbox ~]$ sudo chown tony: ~tony/myfile.txt</span><br><span class="line">[janet@linuxbox ~]$ sudo ls -l ~tony/myfile.txt</span><br><span class="line">-rw-r--r-- <span class="number">1</span> tony  tony <span class="number">8031</span> <span class="number">2008</span><span class="number">-03</span><span class="number">-20</span> <span class="number">14</span>:<span class="number">30</span> /home/tony/myfile.txt</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="æ›´æ”¹ç”¨æˆ·å¯†ç "><a href="#æ›´æ”¹ç”¨æˆ·å¯†ç " class="headerlink" title="æ›´æ”¹ç”¨æˆ·å¯†ç "></a>æ›´æ”¹ç”¨æˆ·å¯†ç </h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">passwd [user]</span><br><span class="line">sudo passwd root æ›´æ”¹ root ç”¨æˆ·çš„å¯†ç </span><br></pre></td></tr></table></figure>
<p>passwd å‘½ä»¤å°†ä¼šè¯•ç€å¼ºè¿«ä½ ä½¿ç”¨â€œå¼ºâ€å¯†ç ã€‚è¿™æ„å‘³ç€å®ƒä¼šæ‹’ç»æ¥å—å¤ªçŸ­çš„å¯†ç ã€ä¸å…ˆå‰ç›¸ä¼¼çš„å¯†ç ã€ å­—å…¸ä¸­çš„å•è¯ä½œä¸ºå¯†ç æˆ–è€…æ˜¯å¤ªå®¹æ˜“çŒœåˆ°çš„å¯†ç ã€‚</p>
<hr>
<h1 id="ç¬¬åç« ï¼šè¿›ç¨‹ğŸš“"><a href="#ç¬¬åç« ï¼šè¿›ç¨‹ğŸš“" class="headerlink" title="ç¬¬åç« ï¼šè¿›ç¨‹ğŸš“"></a>ç¬¬åç« ï¼šè¿›ç¨‹ğŸš“</h1><p>å†…æ ¸ç»´æŠ¤æ¯ä¸ªè¿›ç¨‹çš„ä¿¡æ¯ï¼Œä»¥æ­¤æ¥ä¿æŒäº‹æƒ…æœ‰åºã€‚ä¾‹å¦‚ï¼Œç³»ç»Ÿåˆ†é…ç»™æ¯ä¸ªè¿›ç¨‹ä¸€ä¸ªæ•°å­—ï¼Œè¿™ä¸ªæ•°å­—å«åš è¿›ç¨‹(process) ID æˆ– PIDã€‚PID å·æŒ‰å‡åºåˆ†é…ï¼Œinit è¿›ç¨‹çš„ PID æ€»æ˜¯1ã€‚å†…æ ¸ä¹Ÿå¯¹åˆ†é…ç»™æ¯ä¸ªè¿›ç¨‹çš„å†…å­˜å’Œå°±ç»ªçŠ¶æ€è¿›è¡Œè·Ÿè¸ªä»¥ä¾¿ç»§ç»­æ‰§è¡Œè¿™ä¸ªè¿›ç¨‹ã€‚ åƒæ–‡ä»¶ä¸€æ ·ï¼Œè¿›ç¨‹ä¹Ÿæœ‰æ‰€æœ‰è€…å’Œç”¨æˆ· IDï¼Œæœ‰æ•ˆç”¨æˆ· IDï¼Œç­‰ç­‰ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-   ps â€“ æŠ¥å‘Šå½“å‰è¿›ç¨‹å¿«ç…§</span><br><span class="line">-   top â€“ æ˜¾ç¤ºä»»åŠ¡</span><br><span class="line">-   <span class="built_in">jobs</span> â€“ åˆ—å‡ºæ´»è·ƒçš„ä»»åŠ¡</span><br><span class="line">-   <span class="built_in">bg</span> â€“ æŠŠä¸€ä¸ªä»»åŠ¡æ”¾åˆ°åå°æ‰§è¡Œ</span><br><span class="line">-   <span class="built_in">fg</span> â€“ æŠŠä¸€ä¸ªä»»åŠ¡æ”¾åˆ°å‰å°æ‰§è¡Œ</span><br><span class="line">-   <span class="built_in">kill</span> â€“ ç»™ä¸€ä¸ªè¿›ç¨‹å‘é€ä¿¡å·</span><br><span class="line">-   killall â€“ æ€æ­»æŒ‡å®šåå­—çš„è¿›ç¨‹</span><br><span class="line">-   shutdown â€“ å…³æœºæˆ–é‡å¯ç³»ç»Ÿ</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="æŸ¥çœ‹è¿›ç¨‹"><a href="#æŸ¥çœ‹è¿›ç¨‹" class="headerlink" title="æŸ¥çœ‹è¿›ç¨‹"></a>æŸ¥çœ‹è¿›ç¨‹</h2><p>æŸ¥çœ‹è¿›ç¨‹ï¼Œæœ€å¸¸ä½¿ç”¨åœ°å‘½ä»¤ï¼ˆæœ‰å‡ ä¸ªå‘½ä»¤ï¼‰æ˜¯ ps(process)ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ps</span><br><span class="line"></span><br><span class="line">  PID TTY           TIME CMD</span><br><span class="line">54944 ttys000    0:00.14 /Applications/iTerm.app/Contents/MacOS/iTerm2 --server login -fp sevencai</span><br><span class="line">55003 ttys000    0:00.61 -zsh</span><br><span class="line">10488 ttys001    0:00.27 /Applications/iTerm.app/Contents/MacOS/iTerm2 --server login -fp sevencai</span><br><span class="line">10492 ttys001    0:02.66 -zsh</span><br></pre></td></tr></table></figure></p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œps ä¸ä¼šæ˜¾ç¤ºå¾ˆå¤šè¿›ç¨‹ä¿¡æ¯ï¼Œåªæ˜¯åˆ—å‡ºä¸å½“å‰ç»ˆç«¯ä¼šè¯ç›¸å…³çš„è¿›ç¨‹ã€‚ä¸ºäº†å¾—åˆ°æ›´å¤šä¿¡æ¯ï¼Œ æˆ‘ä»¬éœ€è¦åŠ ä¸Šä¸€äº›é€‰é¡¹ã€‚TTY æ˜¯ â€œTeletypeâ€(ç›´è¯‘ç”µä¼ æ‰“å­—æœº) çš„ç®€å†™ï¼Œæ˜¯æŒ‡è¿›ç¨‹çš„æ§åˆ¶ç»ˆç«¯ã€‚TIME å­—æ®µè¡¨ç¤º è¿›ç¨‹æ‰€æ¶ˆè€—çš„ CPU æ—¶é—´æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŠ ä¸Š â€œxâ€ é€‰é¡¹ï¼ˆæ³¨æ„æ²¡æœ‰å¼€å¤´çš„ â€œ-â€œ å­—ç¬¦ï¼‰ï¼Œå‘Šè¯‰ ps å‘½ä»¤ï¼Œå±•ç¤ºæ‰€æœ‰è¿›ç¨‹ï¼Œä¸ç®¡å®ƒä»¬ç”±ä»€ä¹ˆ ç»ˆç«¯ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰æ§åˆ¶ã€‚åœ¨ TTY ä¸€æ ä¸­å‡ºç°çš„ â€œ?â€ ï¼Œè¡¨ç¤ºæ²¡æœ‰æ§åˆ¶ç»ˆç«¯ã€‚ä½¿ç”¨è¿™ä¸ª â€œxâ€ é€‰é¡¹ï¼Œå¯ä»¥ çœ‹åˆ°æˆ‘ä»¬æ‰€æ‹¥æœ‰çš„æ¯ä¸ªè¿›ç¨‹çš„ä¿¡æ¯ã€‚</span></span><br><span class="line">ps x</span><br><span class="line">ps x | less</span><br><span class="line"></span><br><span class="line"><span class="comment">// èƒ½å¤Ÿæ˜¾ç¤ºå±äºæ¯ä¸ªç”¨æˆ·çš„è¿›ç¨‹ä¿¡æ¯ã€‚ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ï¼Œå¯ä»¥å”¤é†’ â€œBSD é£æ ¼â€ çš„è¾“å‡ºç»“æœã€‚</span></span><br><span class="line">ps aux</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ç”¨-top-å‘½ä»¤åŠ¨æ€æŸ¥çœ‹è¿›ç¨‹"><a href="#ç”¨-top-å‘½ä»¤åŠ¨æ€æŸ¥çœ‹è¿›ç¨‹" class="headerlink" title="ç”¨ top å‘½ä»¤åŠ¨æ€æŸ¥çœ‹è¿›ç¨‹"></a>ç”¨ top å‘½ä»¤åŠ¨æ€æŸ¥çœ‹è¿›ç¨‹</h2><p><strong>è™½ç„¶ ps å‘½ä»¤èƒ½å¤Ÿå±•ç¤ºè®¸å¤šè®¡ç®—æœºè¿è¡ŒçŠ¶æ€çš„ä¿¡æ¯ï¼Œä½†æ˜¯å®ƒåªæ˜¯æä¾› ps å‘½ä»¤æ‰§è¡Œæ—¶åˆ»çš„æœºå™¨çŠ¶æ€å¿«ç…§ã€‚ ä¸ºäº†çœ‹åˆ°æ›´å¤šåŠ¨æ€çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>top</code> å‘½ä»¤ã€‚</strong></p>
<p>top ç¨‹åºæ¥å—ä¸€ç³»åˆ—ä»é”®ç›˜è¾“å…¥çš„å‘½ä»¤ã€‚ä¸¤ä¸ªæœ€æœ‰è¶£çš„å‘½ä»¤æ˜¯ h å’Œ qã€‚hï¼Œæ˜¾ç¤ºç¨‹åºçš„å¸®åŠ©å±å¹•ï¼Œqï¼Œ é€€å‡º top ç¨‹åºã€‚</p>
<hr>
<h2 id="é€šè¿‡-kill-å‘½ä»¤ç»™è¿›ç¨‹å‘é€ä¿¡å·"><a href="#é€šè¿‡-kill-å‘½ä»¤ç»™è¿›ç¨‹å‘é€ä¿¡å·" class="headerlink" title="é€šè¿‡ kill å‘½ä»¤ç»™è¿›ç¨‹å‘é€ä¿¡å·"></a>é€šè¿‡ kill å‘½ä»¤ç»™è¿›ç¨‹å‘é€ä¿¡å·</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> [-signal] PID...</span><br><span class="line"></span><br><span class="line"><span class="built_in">kill</span> -1 13546</span><br><span class="line"><span class="built_in">kill</span> -9 pid (æˆ‘ç»å¸¸ç”¨)</span><br></pre></td></tr></table></figure>
<p>å…·ä½“çš„ <code>-signal</code> çš„å¯é€‰å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="kill.png" alt="kill"></p>
<hr>
<h1 id="æ€»ç»“ğŸŒ¹"><a href="#æ€»ç»“ğŸŒ¹" class="headerlink" title="æ€»ç»“ğŸŒ¹"></a>æ€»ç»“ğŸŒ¹</h1><p>åŠ ä¸Šè¿™ç¯‡æ–‡ç« ï¼Œ<code>The Linux Command Line</code> çš„ç¬¬ä¸€ç« å°±ç»“æŸäº†ã€‚æˆ‘é›¶é›¶æ•£æ•£çš„èŠ±çš„æ—¶é—´å»æ•´ç†çš„ï¼Œä¸­é—´ä¹Ÿå»é™¤äº†ä¸€äº›æˆ‘åŸºæœ¬ä¸Šä¸æ€ä¹ˆç”¨åˆ°çš„ï¼Œç€é‡åŠ å¼ºäº†ä¸‹æˆ‘ç»å¸¸ç”¨åˆ°çš„ä¸€äº›å‘½ä»¤ã€‚</p>
<p>æ¯”å¦‚ kill ï¼Œæˆ‘ä»¥å‰ç»å¸¸ç”¨åˆ° kill -9, ä½†æ˜¯å…¶å®ä¸€ç›´ä¸çŸ¥é“è¿™ä¸ª -9 æ˜¯ä»€ä¹ˆä¸œè¥¿ã€‚ç°åœ¨è¿›è¡Œç¨å¾®ç³»ç»Ÿä¸€ç‚¹çš„å­¦ä¹ ï¼Œæ‰“å‘½ä»¤ä¸å†ä¾é ç†Ÿæ‚‰å’Œæ›¾ç»ç”¨è¿‡ï¼Œè€Œæ˜¯æœ‰ç†è§£çš„ã€‚ğŸ“šâ„ï¸</p>
<p>åŒ…æ‹¬è¿˜æœ‰  sudo åŠ su, ä»¥å‰ä¸€ç›´æœ‰ç”¨è¿‡ï¼Œä½†æ˜¯æ¨¡æ‹Ÿä¸¤å¯ï¼Œå¹¶ä¸çŸ¥é“ä¸¤è€…çš„åŒºåˆ«ã€‚ç°åœ¨éƒ½å¤§è‡´çš„æœ‰äº†è§£ã€‚ä»¥åçœ‹è¿ç»´åŒå­¦æ•²å‘½ä»¤ï¼Œæˆ‘çœ‹å®ƒæ•² su or sudo å°±çŸ¥é“å®ƒæ˜¯å¤§æ¦‚çš„åŒºåˆ«æ˜¯ä»€ä¹ˆäº†ã€‚æƒ³è¦åšä»€ä¹ˆäº‹æƒ…ã€‚ğŸ¶</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«&quot;&gt;&lt;a href=&quot;#ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«&quot; class=&quot;headerlink&quot; title=&quot;ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«&quot;&gt;&lt;/a&gt;ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;Unix ä¼ ç»Ÿä¸­çš„æ“ä½œç³»ç»Ÿä¸åŒäºé‚£äº› MS-DOS
    
    </summary>
    
    
      <category term="è¯»ä¹¦ç¬”è®°" scheme="http://sevencai.github.io/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>The Linux Command Line è¯»ä¹¦ç¬”è®°ï¼ˆä¸€ï¼‰</title>
    <link href="http://sevencai.github.io/2018/08/10/The-Linux-Command-Line-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <id>http://sevencai.github.io/2018/08/10/The-Linux-Command-Line-è¯»ä¹¦ç¬”è®°ï¼ˆä¸€ï¼‰/</id>
    <published>2018-08-10T12:54:15.000Z</published>
    <updated>2018-08-10T13:18:59.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘è¯» <em>The Linux Command Line</em> çš„è¯»ä¹¦ç¬”è®°ã€‚ç”µå­ç‰ˆçš„ä¹¦çš„åœ°å€æ˜¯ï¼š<a href="http://billie66.github.io/TLCL/book/index.html" target="_blank" rel="noopener">TLCL</a>ã€‚ç›¸æ¯”äºé¸Ÿå”ï¼Œè¿™æœ¬ä¹¦å¥½åœ¨æ¯”è¾ƒå°‘ï¼Œé‡ç‚¹æ¯”è¾ƒçªå‡ºï¼Œå¤§éƒ¨åˆ†é‡Œé¢çš„å‘½ä»¤éƒ½æ˜¯æˆ‘ä¼šç»å¸¸ç”¨åˆ°çš„ã€‚ç¼ºç‚¹æ˜¯ä¹Ÿå­˜åœ¨å°‘é‡å†—ä½™çš„å†…å®¹ã€‚ä¸ä¾¿äºæˆ‘æŸ¥æ‰¾å’Œå­¦ä¹ ã€‚å› æ­¤æˆ‘æŠŠæˆ‘éœ€è¦çš„ä¸œè¥¿ä»ä¸­æŠ½å–å‡ºæ¥ï¼Œæ€»ç»“å¹¶ä¸”æç‚¼ï¼Œä»¥ä¾¿æ—¥åçš„æŸ¥æ‰¾å’Œå­¦ä¹ ã€‚æ­¤ç¯‡ç¬”è®°ğŸ“’æ˜¯ä¹¦çš„ç¬¬ä¸€ç« åˆ°ç¬¬ä¹ç« ã€‚</p>
</blockquote>
<h2 id="ç¬¬ä¸€ç« ï¼šä»€ä¹ˆæ˜¯-shellğŸ "><a href="#ç¬¬ä¸€ç« ï¼šä»€ä¹ˆæ˜¯-shellğŸ " class="headerlink" title="ç¬¬ä¸€ç« ï¼šä»€ä¹ˆæ˜¯ shellğŸ "></a>ç¬¬ä¸€ç« ï¼šä»€ä¹ˆæ˜¯ shellğŸ </h2><p>shell å°±æ˜¯ä¸€ä¸ªç¨‹åºï¼Œå®ƒæ¥å—ä»é”®ç›˜è¾“å…¥çš„å‘½ä»¤ï¼Œ ç„¶åæŠŠå‘½ä»¤ä¼ é€’ç»™æ“ä½œç³»ç»Ÿå»æ‰§è¡Œã€‚å‡ ä¹æ‰€æœ‰çš„ Linux å‘è¡Œç‰ˆéƒ½æä¾›ä¸€ä¸ªåä¸º bash çš„ æ¥è‡ª GNU é¡¹ç›®çš„ shell ç¨‹åºã€‚â€œbashâ€ æ˜¯ â€œBourne Again SHellâ€ çš„é¦–å­—æ¯ç¼©å†™ï¼Œ æ‰€æŒ‡çš„æ˜¯è¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œbash æ˜¯æœ€åˆ Unix ä¸Šç”± Steve Bourne å†™æˆ shell ç¨‹åº sh çš„å¢å¼ºç‰ˆã€‚</p>
<blockquote>
<p>[me@linuxbox ~]$</p>
</blockquote>
<ol>
<li>ä»£è¡¨ username@machinename ï¼Œåé¢å¯èƒ½æ˜¯ $ or #ï¼Œå…¶ä¸­ # ä»£è¡¨äº†ä½ æœ‰ root æƒé™ï¼Œ å¯¹åº”çš„ $ å¯èƒ½ä»£è¡¨çš„å°±æ˜¯æ™®é€šçš„ç”¨æˆ·ã€‚</li>
<li>ä¸€äº›ç®€å•çš„å‘½ä»¤å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">date  å½“å‰æ—¶é—´</span><br><span class="line">cal  æ—¥æœŸ</span><br><span class="line">df  æŸ¥çœ‹ç£ç›˜å‰©ä½™ç©ºé—´çš„æ•°é‡</span><br><span class="line"><span class="built_in">exit</span>  ç»ˆæ­¢ä¼šè¯</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ç¬¬äºŒç« ï¼šæ–‡ä»¶ç³»ç»Ÿä¸­è·³è½¬"><a href="#ç¬¬äºŒç« ï¼šæ–‡ä»¶ç³»ç»Ÿä¸­è·³è½¬" class="headerlink" title="ç¬¬äºŒç« ï¼šæ–‡ä»¶ç³»ç»Ÿä¸­è·³è½¬"></a>ç¬¬äºŒç« ï¼šæ–‡ä»¶ç³»ç»Ÿä¸­è·³è½¬</h2><p>ç›¸å…³å‘½ä»¤ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pwd</span> æ‰“å°å‡ºå½“å‰å·¥ä½œç›®å½•å</span><br><span class="line"><span class="built_in">cd</span>  dir æ›´æ”¹ç›®å½•</span><br><span class="line">ls  åˆ—å‡ºç›®å½•å†…å®¹ï¼Œä¸åŒ…æ‹¬å¸¦ . çš„éšè—ç›®å½•</span><br><span class="line">ls  -a å¯ä»¥åˆ—å‡ºå¸¦ . éšè—çš„ç›®å½•</span><br><span class="line"><span class="built_in">cd</span>  æ›´æ”¹å·¥ä½œç›®å½•åˆ°ä½ çš„å®¶ç›®å½•</span><br><span class="line"><span class="built_in">cd</span>  - æ›´æ”¹å·¥ä½œç›®å½•åˆ°å…ˆå‰çš„å·¥ä½œç›®å½•</span><br><span class="line"><span class="built_in">cd</span>  ~user_name æ›´æ”¹å·¥ä½œç›®å½•åˆ°ç”¨æˆ·å®¶ç›®å½•</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="ç¬¬ä¸‰ç« ï¼šæ¢ç©¶æ“ä½œç³»ç»Ÿ"><a href="#ç¬¬ä¸‰ç« ï¼šæ¢ç©¶æ“ä½œç³»ç»Ÿ" class="headerlink" title="ç¬¬ä¸‰ç« ï¼šæ¢ç©¶æ“ä½œç³»ç»Ÿ"></a>ç¬¬ä¸‰ç« ï¼šæ¢ç©¶æ“ä½œç³»ç»Ÿ</h2><p>ç›¸å…³å‘½ä»¤ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ls    åˆ—å‡ºç›®å½•å†…å®¹</span><br><span class="line">file   ç¡®å®šæ–‡ä»¶ç±»å‹</span><br><span class="line">less   æµè§ˆæ–‡ä»¶å†…å®¹</span><br><span class="line"></span><br><span class="line">ls -l    ä½¿ç”¨ ls å‘½ä»¤çš„â€œ-lâ€é€‰é¡¹ï¼Œåˆ™ç»“æœä»¥é•¿æ¨¡å¼è¾“å‡º === ll</span><br><span class="line">ls -lt   <span class="string">"t"</span>é€‰é¡¹æŒ‰æ–‡ä»¶ä¿®æ”¹æ—¶é—´çš„å…ˆåæ¥æ’åº</span><br><span class="line">file filename   æŸ¥çœ‹æ–‡ä»¶çš„ç±»å‹</span><br></pre></td></tr></table></figure></p>
<h3 id="å‘½ä»¤æ ¼å¼"><a href="#å‘½ä»¤æ ¼å¼" class="headerlink" title="å‘½ä»¤æ ¼å¼"></a>å‘½ä»¤æ ¼å¼</h3><blockquote>
<p>å‘½ä»¤åç»å¸¸ä¼šå¸¦æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æ¥æ›´æ­£å‘½ä»¤è¡Œä¸ºçš„é€‰é¡¹ï¼Œ æ›´è¿›ä¸€æ­¥ï¼Œé€‰é¡¹åé¢ä¼šå¸¦æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼Œè¿™äº›å‚æ•°æ˜¯å‘½ä»¤ä½œç”¨çš„å¯¹è±¡ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> -options arguments</span><br><span class="line">ls -lt --reverse</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><code>options</code> : é€‰é¡¹, ä¸€èˆ¬æ˜¯ -l  è¿™ç§å½¢å¼ï¼Œä¹Ÿæ”¯æŒé•¿é€‰é¡¹ï¼Œé•¿é€‰é¡¹ç”±ä¸¤ä¸ªä¸­åˆ’çº¿åŠ ä¸Šä¸€ä¸ªå­—ç»„æˆã€‚å¦‚ <code>--reverse</code>ã€‚ å½“ç„¶ä¹Ÿæœ‰ä¸¤ç§åˆå¹¶çš„ã€‚å¦‚ä¸Šã€‚</p>
<p>ä¸‹é¢è¿™å¼ å›¾æ¥æºäºä¹¦é‡Œçš„å¯¹lsçš„å‘½ä»¤çš„ä¸€éƒ¨åˆ†åˆ—ä¸¾ï¼Œçº¢è‰²çš„æ¡†æ˜¯æˆ‘ç»å¸¸ç”¨çš„ï¼š</p>
<p><img src="ls.png" alt="ls"></p>
<h3 id="less"><a href="#less" class="headerlink" title="less"></a>less</h3><p>less å‘½ä»¤æ˜¯ä¸€ä¸ªç”¨æ¥æµè§ˆæ–‡æœ¬æ–‡ä»¶çš„ç¨‹åº,less ç¨‹åºå…è®¸ä½ å‰åæ»šåŠ¨æ–‡ä»¶ã€‚</p>
<blockquote>
<p>æ ¼å¼ä¸ºï¼š less filename<br>å¦‚ less a.log<br>å¦‚ ps -ef | less ä»¥åˆ†é¡µçš„å½¢å¼æŸ¥çœ‹å½“å‰è¿›ç¨‹ (è¿™ä¸ªå¥½ç”¨)</p>
</blockquote>
<p><img src="less.png" alt="less"></p>
<p>ä¸Šé¢è¿™ä¸ªå›¾é‡Œæ˜¯ä¸æ˜¯æ„Ÿè§‰è·Ÿ vim å‘½ä»¤å¾ˆåƒï¼Œæˆ‘å†è¡¥å……å‡ ä¸ªï¼Œæ˜¯æˆ‘ç»å¸¸ç”¨åˆ°çš„ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-   /å­—ç¬¦ä¸²ï¼šå‘ä¸‹æœç´¢<span class="string">"å­—ç¬¦ä¸²"</span>çš„åŠŸèƒ½</span><br><span class="line">-   ?å­—ç¬¦ä¸²ï¼šå‘ä¸Šæœç´¢<span class="string">"å­—ç¬¦ä¸²"</span>çš„åŠŸèƒ½</span><br><span class="line">-   nï¼šé‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰</span><br><span class="line">-   Nï¼šåå‘é‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰</span><br><span class="line">-   b å‘åç¿»ä¸€é¡µ</span><br><span class="line">-   d å‘åç¿»åŠé¡µ</span><br><span class="line">-   ç©ºæ ¼é”® æ»šåŠ¨ä¸€é¡µ</span><br><span class="line">-   å›è½¦é”® æ»šåŠ¨ä¸€è¡Œ</span><br><span class="line">-   u å‘å‰æ»šåŠ¨åŠé¡µ</span><br><span class="line">-   y å‘å‰æ»šåŠ¨ä¸€è¡Œ</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ç¬¬å››ç« ï¼šæ“ä½œæ–‡ä»¶å’Œç›®å½•"><a href="#ç¬¬å››ç« ï¼šæ“ä½œæ–‡ä»¶å’Œç›®å½•" class="headerlink" title="ç¬¬å››ç« ï¼šæ“ä½œæ–‡ä»¶å’Œç›®å½•"></a>ç¬¬å››ç« ï¼šæ“ä½œæ–‡ä»¶å’Œç›®å½•</h2><p>ä¸»è¦å‘½ä»¤æœ‰ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-   cp â€” å¤åˆ¶æ–‡ä»¶å’Œç›®å½•</span><br><span class="line">-   mv â€” ç§»åŠ¨/é‡å‘½åæ–‡ä»¶å’Œç›®å½•</span><br><span class="line">-   mkdir â€” åˆ›å»ºç›®å½•</span><br><span class="line">-   rm â€” åˆ é™¤æ–‡ä»¶å’Œç›®å½•</span><br><span class="line">-   ln â€” åˆ›å»ºç¡¬é“¾æ¥å’Œç¬¦å·é“¾æ¥</span><br></pre></td></tr></table></figure></p>
<p>è¿™å‡ ä¸ªå‘½ä»¤æˆ‘ä»¬æœ€ç†Ÿæ‚‰ä¸è¿‡äº†ã€‚ä¸‹é¢ç®€å•çš„åˆ—ä¸¾äº†è¿™å‡ ä¸ªçš„ä¸€äº›åŸºæœ¬ç”¨æ³•ã€‚</p>
<h3 id="cp-å¤åˆ¶æ–‡ä»¶å’Œç›®å½•"><a href="#cp-å¤åˆ¶æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="cp å¤åˆ¶æ–‡ä»¶å’Œç›®å½•"></a>cp å¤åˆ¶æ–‡ä»¶å’Œç›®å½•</h3><p><img src="cp.png" alt="cp"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è‹¥ file2 å­˜åœ¨ï¼Œåˆ™è¦†ç›–oré‡å†™ï¼Œè‹¥ä¸å­˜åœ¨åˆ™åˆ›å»º</span></span><br><span class="line">cp file1 file2</span><br><span class="line"></span><br><span class="line"><span class="comment">// -i ä»£è¡¨ info, æ‰€ä»¥è·Ÿä¸Šé¢ç›¸åŒï¼Œåªæ˜¯è¦†ç›–oré‡å†™ä¼šæœ‰æç¤º</span></span><br><span class="line">cp -i file1 file2</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤åˆ¶æ–‡ä»¶ file1 å’Œæ–‡ä»¶ file2 åˆ°ç›®å½• dir1ã€‚ç›®å½• dir1 å¿…é¡»å­˜åœ¨</span></span><br><span class="line">cp file1 file2 dir1</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ä¸€ä¸ªé€šé…ç¬¦ï¼Œåœ¨ç›®å½• dir1 ä¸­çš„æ‰€æœ‰æ–‡ä»¶éƒ½è¢«å¤åˆ¶åˆ°ç›®å½• dir2 ä¸­ã€‚ dir2 å¿…é¡»å·²ç»å­˜åœ¨</span></span><br><span class="line">cp dir1<span class="comment">/* dir2</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">// å¤åˆ¶ç›®å½• dir1 ä¸­çš„å†…å®¹åˆ°ç›®å½• dir2ã€‚</span></span><br><span class="line"><span class="comment">// å¦‚æœç›®å½• dir2 ä¸å­˜åœ¨ï¼Œ åˆ›å»ºç›®å½• dir2ï¼Œæ“ä½œå®Œæˆåï¼Œç›®å½• dir2 ä¸­çš„å†…å®¹å’Œ dir1 ä¸­çš„ä¸€æ ·</span></span><br><span class="line"><span class="comment">cp -r dir1 dir2</span></span><br></pre></td></tr></table></figure>
<h3 id="mv-ç§»åŠ¨å’Œé‡å‘½åæ–‡ä»¶"><a href="#mv-ç§»åŠ¨å’Œé‡å‘½åæ–‡ä»¶" class="headerlink" title="mv ç§»åŠ¨å’Œé‡å‘½åæ–‡ä»¶"></a>mv ç§»åŠ¨å’Œé‡å‘½åæ–‡ä»¶</h3><p><img src="mv.png" alt="mv"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœ file2 å­˜åœ¨ï¼Œå®ƒçš„å†…å®¹ä¼šè¢« file1 çš„å†…å®¹é‡å†™ã€‚</span></span><br><span class="line"><span class="comment">// å¦‚æœ file2 ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º file2ã€‚ è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œfile1 éƒ½ä¸å†å­˜åœ¨</span></span><br><span class="line">mv file1 file2</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡å†™æ—¶ä¼šæç¤ºç”¨æˆ·</span></span><br><span class="line">mv -i file1 file2</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç§»åŠ¨ file1 å’Œ file2 åˆ°ç›®å½• dir1 ä¸­ã€‚dir1 å¿…é¡»å·²ç»å­˜åœ¨</span></span><br><span class="line">mv file1 file2 dir1</span><br></pre></td></tr></table></figure>
<h3 id="rm-åˆ é™¤æ–‡ä»¶å’Œç›®å½•"><a href="#rm-åˆ é™¤æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="rm - åˆ é™¤æ–‡ä»¶å’Œç›®å½•"></a>rm - åˆ é™¤æ–‡ä»¶å’Œç›®å½•</h3><p><img src="rm.png" alt="rm"><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é»˜é»˜åœ°åˆ é™¤æ–‡ä»¶</span></span><br><span class="line">rm file1</span><br><span class="line"></span><br><span class="line"><span class="comment">// é™¤äº†åœ¨åˆ é™¤æ–‡ä»¶ä¹‹å‰ï¼Œæç¤ºç”¨æˆ·ç¡®è®¤ä¿¡æ¯ä¹‹å¤–ï¼Œå’Œä¸Šé¢çš„å‘½ä»¤ä½œç”¨ä¸€æ ·</span></span><br><span class="line">rm -i file1</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤æ–‡ä»¶ file1, ç›®å½• dir1ï¼ŒåŠ dir1 ä¸­çš„å†…å®¹</span></span><br><span class="line">rm -r file1 dir1</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒä¸Šï¼Œé™¤äº†å¦‚æœæ–‡ä»¶ file1ï¼Œæˆ–ç›®å½• dir1 ä¸å­˜åœ¨çš„è¯ï¼Œrm ä»ä¼šç»§ç»­æ‰§è¡Œã€‚</span></span><br><span class="line">rm -rf file1 dir1</span><br></pre></td></tr></table></figure></p>
<p><strong>ä¸è¦ç”¨ <code>rm -rf</code>, ç”¨ <code>rm -ri</code> å§ï¼Œç»™è‡ªå·±ä¸€ç‚¹åæ‚”çš„ä½™åœ°ã€‚</strong></p>
<h3 id="ln-â€”-åˆ›å»ºé“¾æ¥"><a href="#ln-â€”-åˆ›å»ºé“¾æ¥" class="headerlink" title="ln â€” åˆ›å»ºé“¾æ¥"></a>ln â€” åˆ›å»ºé“¾æ¥</h3><blockquote>
<p>å»ºç«‹ç¬¦å·é“¾æ¥çš„ç›®çš„æ˜¯ä¸ºäº†å…‹æœç¡¬é“¾æ¥çš„ä¸¤ä¸ªç¼ºç‚¹ï¼šç¡¬é“¾æ¥ä¸èƒ½è·¨è¶Šç‰©ç†è®¾å¤‡ï¼Œ ç¡¬é“¾æ¥ä¸èƒ½å…³è”ç›®å½•ï¼Œåªèƒ½æ˜¯æ–‡ä»¶ã€‚ç¬¦å·é“¾æ¥æ˜¯æ–‡ä»¶çš„ç‰¹æ®Šç±»å‹ï¼Œå®ƒåŒ…å«ä¸€ä¸ªæŒ‡å‘ ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•çš„æ–‡æœ¬æŒ‡é’ˆã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºç¡¬é“¾æ¥</span></span><br><span class="line">ln file link</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºç¬¦å·é“¾æ¥ï¼ˆsoftï¼‰</span></span><br><span class="line">ln -s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶</span><br><span class="line">ln -s item link</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>å…³äºè¿™é‡Œæˆ‘æœ‰ä¸€äº›å®é™…å¯ä»¥ç”¨åˆ°è½¯ç¡¬é“¾æ¥çš„åœºæ™¯ã€‚ç¨åå†è¡¥å……ã€‚</p>
<h3 id="é€šé…ç¬¦"><a href="#é€šé…ç¬¦" class="headerlink" title="é€šé…ç¬¦"></a>é€šé…ç¬¦</h3><p>ä¹¦é‡Œå…ˆç®€å•çš„è®²äº†ä¸‹é€šé…ç¬¦ï¼Œæˆ‘è§‰å¾—åªçœ‹ä¾‹å­å°±å¥½äº†ã€‚<br><img src="tongpei.png" alt="é€šé…ç¬¦"></p>
<hr>
<h2 id="ç¬¬äº”ç« ï¼šä½¿ç”¨å‘½ä»¤"><a href="#ç¬¬äº”ç« ï¼šä½¿ç”¨å‘½ä»¤" class="headerlink" title="ç¬¬äº”ç« ï¼šä½¿ç”¨å‘½ä»¤"></a>ç¬¬äº”ç« ï¼šä½¿ç”¨å‘½ä»¤</h2><p>ä¸»è¦çš„å‡ ä¸ªæœ‰ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-   <span class="built_in">type</span> â€“ æ˜¾ç¤ºå‘½ä»¤çš„ç±»å‹</span><br><span class="line">-   <span class="built_in">which</span> â€“ æ˜¾ç¤ºä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºçš„ä½ç½®</span><br><span class="line">-   man â€“ æ˜¾ç¤ºå‘½ä»¤æ‰‹å†Œé¡µ</span><br><span class="line">-   apropos â€“ æ˜¾ç¤ºä¸€ç³»åˆ—é€‚åˆçš„å‘½ä»¤</span><br><span class="line">-   info â€“ æ˜¾ç¤ºå‘½ä»¤ info</span><br><span class="line">-   whatis â€“ æ˜¾ç¤ºä¸€ä¸ªå‘½ä»¤çš„ç®€æ´æè¿°</span><br><span class="line">-   <span class="built_in">alias</span> â€“ åˆ›å»ºå‘½ä»¤åˆ«å</span><br></pre></td></tr></table></figure></p>
<p>ä¸‹é¢ä¸¾ä¸€äº›ä¾‹å­ï¼Œè¿™ä¸ªæ›´å¥½ç†è§£ä¸€äº›ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// <span class="built_in">type</span> å‘½ä»¤æ˜¯ shell å†…éƒ¨å‘½ä»¤ï¼Œå®ƒä¼šæ˜¾ç¤ºå‘½ä»¤çš„ç±»åˆ«ï¼Œç»™å‡ºä¸€ä¸ªç‰¹å®šçš„å‘½ä»¤åï¼ˆåšä¸ºå‚æ•°ï¼‰</span><br><span class="line"><span class="built_in">type</span> ls     =&gt; ls is an <span class="built_in">alias</span> <span class="keyword">for</span> ls -G</span><br><span class="line"><span class="built_in">type</span> <span class="built_in">cd</span>     =&gt; <span class="built_in">cd</span> is a shell <span class="built_in">builtin</span></span><br><span class="line"><span class="built_in">type</span> <span class="built_in">type</span>   =&gt; <span class="built_in">type</span> is a shell builtins</span><br><span class="line"></span><br><span class="line">// è¿™ä¸ªå‘½ä»¤åªå¯¹å¯æ‰§è¡Œç¨‹åºæœ‰æ•ˆï¼Œä¸åŒ…æ‹¬å†…å»ºå‘½ä»¤å’Œå‘½ä»¤åˆ«å</span><br><span class="line"><span class="built_in">which</span> node  =&gt; /usr/<span class="built_in">local</span>/bin/node</span><br><span class="line"><span class="built_in">which</span> npm   =&gt; /usr/<span class="built_in">local</span>/bin/npm</span><br><span class="line"></span><br><span class="line">// è¾“å…¥â€œ<span class="built_in">help</span>â€ï¼Œæ¥ç€æ˜¯ shell å†…éƒ¨å‘½ä»¤å, æ³¨æ„åé¢è·Ÿçš„ä¸€å®šè¦æ˜¯ <span class="built_in">builtin</span> commands</span><br><span class="line"><span class="built_in">help</span> <span class="built_in">cd</span></span><br><span class="line"><span class="built_in">help</span> <span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">// --<span class="built_in">help</span> - æ˜¾ç¤ºç”¨æ³•ä¿¡æ¯,å®ƒä¸è¦æ±‚æ˜¯ <span class="built_in">builtin</span> commands, æ˜¯å¯æ‰§è¡Œç¨‹åºå³å¯</span><br><span class="line">mkdir --<span class="built_in">help</span> | less</span><br><span class="line">tar --<span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">// è®¸å¤šå¸Œæœ›è¢«å‘½ä»¤è¡Œä½¿ç”¨çš„å¯æ‰§è¡Œç¨‹åº</span><br><span class="line">// æä¾›äº†ä¸€ä¸ªæ­£å¼çš„æ–‡æ¡£ï¼Œå«åšæ‰‹å†Œæˆ–æ‰‹å†Œé¡µ(man page)ã€‚</span><br><span class="line">// ä¸€ä¸ªç‰¹æ®Šçš„å«åš man çš„åˆ†é¡µç¨‹åºï¼Œå¯ç”¨æ¥æµè§ˆä»–ä»¬ã€‚</span><br><span class="line">man <span class="built_in">which</span></span><br><span class="line">man ls</span><br></pre></td></tr></table></figure></p>
<p>å…³äº alias æˆ‘è§‰å¾—å¾ˆå¥½ç”¨ï¼Œå•ç‹¬æ‹¿å‡ºæ¥ï¼š</p>
<p><strong>è¯­æ³•æ˜¯ï¼š <code>alias name=&#39;string&#39;</code>å®é™…ä¸Šæˆ‘ä»¬å¹³æ—¶å†™ å‘½ä»¤ æ—¶ï¼Œæ˜¯å¯ä»¥å‡ ä¸ªä¸€èµ·å†™çš„ï¼Œæ¯”å¦‚ <code>cd /usr; ls; cd -</code>ã€‚å¦‚æœè¿™ä¸ªå‘½ä»¤ä½ ç»å¸¸ç”¨ï¼Œè€Œä¸”ä¸æƒ³è¦æ¯æ¬¡éƒ½æ‰“æŠ˜ä¸‰ä¸ªå‘½ä»¤ï¼Œé‚£ä¹ˆä½ å¯ä»¥æŠŠå®ƒåšæˆä¸€ä¸ªåˆ«åã€‚è¿™æ ·æ¯æ¬¡å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ‡æ¢äº†ã€‚å¦‚æˆ‘ä»¬ç»™ä¸Šé¢ä¸€ä¸ªå‘½ä»¤èµ·åå« test, åœ¨æ¯æ¬¡èµ·åˆ«åå‰ï¼Œè®°å¾—ç”¨ type è¯•ä¸‹ï¼Œçœ‹è¿™ä¸ªåˆ«åæ˜¯å¦è¢«å ç”¨äº†ã€‚</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// bash: <span class="built_in">type</span>: foo: not found  å¯ä»¥åˆ›å»ºä¸ºåˆ«å</span><br><span class="line"><span class="built_in">type</span> <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">// <span class="built_in">test</span> is a shell <span class="built_in">builtin</span> å·²ç»è¢«ä½¿ç”¨äº†ï¼Œä¸èƒ½åˆ›å»ºäº†</span><br><span class="line"><span class="built_in">type</span> <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">// <span class="built_in">test</span> ä¸ºæˆ‘ä»¬çš„å‘½ä»¤äº†</span><br><span class="line"><span class="built_in">alias</span> <span class="built_in">test</span>=<span class="string">'cd /usr; ls; cd -'</span></span><br><span class="line"></span><br><span class="line">// æ­¤æ—¶æˆ‘ä»¬æŸ¥çœ‹å°±ä¼šæ˜¾ç¤ºï¼š foo is aliased to `<span class="built_in">cd</span> /usr; ls ; <span class="built_in">cd</span> -<span class="string">'</span></span><br><span class="line"><span class="string">type test</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ç¬¬å…­ç« ï¼šé‡å®šå‘"><a href="#ç¬¬å…­ç« ï¼šé‡å®šå‘" class="headerlink" title="ç¬¬å…­ç« ï¼šé‡å®šå‘"></a>ç¬¬å…­ç« ï¼šé‡å®šå‘</h2><blockquote>
<p>â€I/Oâ€ä»£è¡¨è¾“å…¥/è¾“å‡ºï¼Œ é€šè¿‡è¿™ä¸ªå·¥å…·ï¼Œä½ å¯ä»¥é‡å®šå‘å‘½ä»¤çš„è¾“å…¥è¾“å‡ºï¼Œå‘½ä»¤çš„è¾“å…¥æ¥è‡ªæ–‡ä»¶ï¼Œè€Œè¾“å‡ºä¹Ÿå­˜åˆ°æ–‡ä»¶ã€‚ ä¹Ÿå¯ä»¥æŠŠå¤šä¸ªå‘½ä»¤è¿æ¥èµ·æ¥ç»„æˆä¸€ä¸ªå¼ºå¤§çš„å‘½ä»¤ç®¡é“ã€‚</p>
</blockquote>
<p>ä¸»è¦çš„å‘½ä»¤æœ‰ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-   cat ï¼ è¿æ¥æ–‡ä»¶</span><br><span class="line">-   sort ï¼ æ’åºæ–‡æœ¬è¡Œ</span><br><span class="line">-   uniq ï¼ æŠ¥é“æˆ–çœç•¥é‡å¤è¡Œ</span><br><span class="line">-   grep ï¼ æ‰“å°åŒ¹é…è¡Œ</span><br><span class="line">-   wc ï¼ æ‰“å°æ–‡ä»¶ä¸­æ¢è¡Œç¬¦ï¼Œå­—ï¼Œå’Œå­—èŠ‚ä¸ªæ•°</span><br><span class="line">-   head ï¼ è¾“å‡ºæ–‡ä»¶ç¬¬ä¸€éƒ¨åˆ†</span><br><span class="line">-   tail - è¾“å‡ºæ–‡ä»¶æœ€åä¸€éƒ¨åˆ†</span><br><span class="line">-   tee - ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ï¼Œå¹¶åŒæ—¶å†™åˆ°æ ‡å‡†è¾“å‡ºå’Œæ–‡ä»¶</span><br></pre></td></tr></table></figure></p>
<h3 id="æ ‡å‡†è¾“å‡ºé‡å®šå‘"><a href="#æ ‡å‡†è¾“å‡ºé‡å®šå‘" class="headerlink" title="æ ‡å‡†è¾“å‡ºé‡å®šå‘"></a>æ ‡å‡†è¾“å‡ºé‡å®šå‘</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ls -l ls-output.txt</span><br><span class="line">ls -l /bin/usr &gt; ls-output.txt  ä¸è¿½åŠ ï¼Œæ¯æ¬¡éƒ½è¢«ä»å¤´è¦†ç›–</span><br><span class="line">ls -l /usr/bin &gt;&gt; ls-output.txt   è¿½åŠ åˆ°æ–‡ä»¶ä¸­</span><br><span class="line">&gt; ls-output.txt  æ¸…ç©ºæŸä¸ªæ–‡ä»¶</span><br></pre></td></tr></table></figure>
<h3 id="æ ‡å‡†é”™è¯¯é‡å®šå‘"><a href="#æ ‡å‡†é”™è¯¯é‡å®šå‘" class="headerlink" title="æ ‡å‡†é”™è¯¯é‡å®šå‘"></a>æ ‡å‡†é”™è¯¯é‡å®šå‘</h3><blockquote>
<p>æ ‡å‡†é”™è¯¯é‡å®šå‘æ²¡æœ‰ä¸“ç”¨çš„é‡å®šå‘æ“ä½œç¬¦ã€‚ä¸ºäº†é‡å®šå‘æ ‡å‡†é”™è¯¯ï¼Œæˆ‘ä»¬å¿…é¡»å‚è€ƒå…¶æ–‡ä»¶æè¿°ç¬¦ã€‚ ä¸€ä¸ªç¨‹åºå¯ä»¥åœ¨å‡ ä¸ªç¼–å·çš„æ–‡ä»¶æµä¸­çš„ä»»ä¸€ä¸ªä¸Šäº§ç”Ÿè¾“å‡ºã€‚è™½ç„¶æˆ‘ä»¬å·²ç»å°†è¿™äº›æ–‡ä»¶æµçš„å‰ ä¸‰ä¸ªç§°ä½œæ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯ï¼Œshell å†…éƒ¨åˆ†åˆ«å°†å…¶ç§°ä¸ºæ–‡ä»¶æè¿°ç¬¦0ã€1å’Œ2ã€‚shell ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦æä¾› äº†ä¸€ç§è¡¨ç¤ºæ³•æ¥é‡å®šå‘æ–‡ä»¶ã€‚å› ä¸ºæ ‡å‡†é”™è¯¯å’Œæ–‡ä»¶æè¿°ç¬¦2ä¸€æ ·ï¼Œæˆ‘ä»¬ç”¨è¿™ç§ è¡¨ç¤ºæ³•æ¥é‡å®šå‘æ ‡å‡†é”™è¯¯ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å½“ /bin/usr ä¸å­˜åœ¨æ—¶æŠ¥é”™å°†è¾“å‡ºåˆ° ls-error.txt ä¸­</span></span><br><span class="line">ls -l /bin/usr <span class="number">2</span>&gt; ls-error.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ‰çš„æ—¶å€™å¯èƒ½æˆ‘ä»¬éœ€è¦é‡å®šå‘æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯åˆ°åŒä¸€ä¸ªæ–‡ä»¶</span></span><br><span class="line">ls -l /bin/usr &gt; ls-output.txt <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç°åœ¨çš„ bash ç‰ˆæœ¬æä¾›äº†ç¬¬äºŒç§æ–¹æ³•ï¼Œæ›´ç²¾ç®€åˆç†çš„æ–¹æ³•æ¥æ‰§è¡Œè¿™ç§è”åˆçš„é‡å®šå‘</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨å•å•ä¸€ä¸ªè¡¨ç¤ºæ³• &amp;&gt; æ¥é‡å®šå‘æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯åˆ°æ–‡ä»¶</span></span><br><span class="line">ls -l /bin/usr &amp;&gt; ls-output.txt</span><br></pre></td></tr></table></figure>
<h3 id="å¤„ç†ä¸éœ€è¦çš„è¾“å‡º"><a href="#å¤„ç†ä¸éœ€è¦çš„è¾“å‡º" class="headerlink" title="å¤„ç†ä¸éœ€è¦çš„è¾“å‡º"></a>å¤„ç†ä¸éœ€è¦çš„è¾“å‡º</h3><p>æœ‰æ—¶å€™â€œæ²‰é»˜æ˜¯é‡‘â€ï¼Œæˆ‘ä»¬ä¸æƒ³è¦ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºç»“æœï¼Œåªæƒ³æŠŠå®ƒä»¬æ‰”æ‰ã€‚è¿™ç§æƒ…å†µ å°¤å…¶é€‚ç”¨äºé”™è¯¯å’ŒçŠ¶æ€ä¿¡æ¯ã€‚ç³»ç»Ÿé€šè¿‡é‡å®šå‘è¾“å‡ºç»“æœåˆ°ä¸€ä¸ªå«åšâ€/dev/nullâ€çš„ç‰¹æ®Šæ–‡ä»¶ï¼Œ ä¸ºæˆ‘ä»¬æä¾›äº†è§£å†³é—®é¢˜çš„æ–¹æ³•ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯ç³»ç»Ÿè®¾å¤‡ï¼Œå«åšä½å­˜å‚¨æ¡¶ï¼Œå®ƒå¯ä»¥ æ¥å—è¾“å…¥ï¼Œå¹¶ä¸”å¯¹è¾“å…¥ä¸åšä»»ä½•å¤„ç†ã€‚ä¸ºäº†éšç’å‘½ä»¤é”™è¯¯ä¿¡æ¯ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·åšã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// å¤„ç†ä¸éœ€è¦çš„è¾“å‡º</span><br><span class="line">ls -l /bin/usr 2&gt; /dev/null</span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢çš„æ¯”è¾ƒå°‘ç”¨åˆ°ï¼ŒåŸºæœ¬ä¸Šæˆ‘ä¹‹å‰æ²¡æœ‰ç”¨åˆ°è¿‡ã€‚</p>
<h3 id="æ ‡å‡†è¾“å…¥é‡å®šå‘"><a href="#æ ‡å‡†è¾“å…¥é‡å®šå‘" class="headerlink" title="æ ‡å‡†è¾“å…¥é‡å®šå‘"></a>æ ‡å‡†è¾“å…¥é‡å®šå‘</h3><h4 id="cat-å‘½ä»¤"><a href="#cat-å‘½ä»¤" class="headerlink" title="cat å‘½ä»¤"></a>cat å‘½ä»¤</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// cat å‘½ä»¤è¯»å–ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶</span><br><span class="line">// cat ç»å¸¸è¢«ç”¨æ¥æ˜¾ç¤ºç®€çŸ­çš„æ–‡æœ¬æ–‡ä»¶ä¸åˆ†é¡µ</span><br><span class="line">cat [file]</span><br><span class="line">cat z.txt</span><br><span class="line">cat &lt; lazy_dog.txt  å°†æ ‡å‡†è¾“å…¥ï¼Œè¾“å‡ºåˆ° æ–‡ä»¶ä¸­</span><br></pre></td></tr></table></figure>
<h4 id="ç®¡é“çº¿"><a href="#ç®¡é“çº¿" class="headerlink" title="ç®¡é“çº¿"></a>ç®¡é“çº¿</h4><blockquote>
<p>å‘½ä»¤ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®å¹¶è¾“é€åˆ°æ ‡å‡†è¾“å‡ºçš„èƒ½åŠ›è¢«ä¸€ä¸ªç§°ä¸ºç®¡é“çº¿çš„ shell ç‰¹æ€§æ‰€åˆ©ç”¨ã€‚ ä½¿ç”¨ç®¡é“æ“ä½œç¬¦â€|â€ï¼ˆç«–æ ï¼‰ï¼Œä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å‡ºå¯ä»¥é€šè¿‡ç®¡é“é€è‡³å¦ä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å…¥ï¼š</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">command1 | command2</span><br><span class="line">ls -l /usr/bin | less</span><br></pre></td></tr></table></figure>
<p><strong>ç®¡é“çº¿ç»å¸¸ç”¨æ¥å¯¹æ•°æ®å®Œæˆå¤æ‚çš„æ“ä½œã€‚æœ‰å¯èƒ½ä¼šæŠŠå‡ ä¸ªå‘½ä»¤æ”¾åœ¨ä¸€èµ·ç»„æˆä¸€ä¸ªç®¡é“çº¿ã€‚ é€šå¸¸ï¼Œä»¥è¿™ç§æ–¹å¼ä½¿ç”¨çš„å‘½ä»¤è¢«ç§°ä¸ºè¿‡æ»¤å™¨ã€‚è¿‡æ»¤å™¨æ¥å—è¾“å…¥ï¼Œä»¥æŸç§æ–¹å¼æ”¹å˜å®ƒï¼Œç„¶å è¾“å‡ºå®ƒã€‚</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /bin /usr/bin | sort | less</span><br></pre></td></tr></table></figure>
<h4 id="uniq-æŠ¥é“æˆ–å¿½ç•¥é‡å¤è¡Œ"><a href="#uniq-æŠ¥é“æˆ–å¿½ç•¥é‡å¤è¡Œ" class="headerlink" title="uniq - æŠ¥é“æˆ–å¿½ç•¥é‡å¤è¡Œ"></a>uniq - æŠ¥é“æˆ–å¿½ç•¥é‡å¤è¡Œ</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ—è¡¨ä¸­ä¸åŒ…å«é‡å¤å¥å­</span></span><br><span class="line">ls /bin /usr/bin | sort | uniq | less</span><br></pre></td></tr></table></figure>
<h4 id="wc-ï¼-æ‰“å°è¡Œæ•°ã€å­—æ•°å’Œå­—èŠ‚æ•°"><a href="#wc-ï¼-æ‰“å°è¡Œæ•°ã€å­—æ•°å’Œå­—èŠ‚æ•°" class="headerlink" title="wc ï¼ æ‰“å°è¡Œæ•°ã€å­—æ•°å’Œå­—èŠ‚æ•°"></a>wc ï¼ æ‰“å°è¡Œæ•°ã€å­—æ•°å’Œå­—èŠ‚æ•°</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// wcï¼ˆå­—è®¡æ•°ï¼‰å‘½ä»¤æ˜¯ç”¨æ¥æ˜¾ç¤ºæ–‡ä»¶æ‰€åŒ…å«çš„è¡Œæ•°ã€å­—æ•°å’Œå­—èŠ‚æ•°</span></span><br><span class="line">wc ls-output.txt</span><br><span class="line"><span class="number">7902</span> <span class="number">64566</span> <span class="number">503634</span> ls-output.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">// â€-lâ€é€‰é¡¹é™åˆ¶å‘½ä»¤è¾“å‡ºåªèƒ½ æŠ¥é“è¡Œæ•°ã€‚æ·»åŠ  wc åˆ°ç®¡é“çº¿æ¥ç»Ÿè®¡æ•°æ®ï¼Œæ˜¯ä¸ªå¾ˆä¾¿åˆ©çš„æ–¹æ³•</span></span><br><span class="line">ls /bin /usr/bin | sort | uniq | wc -l</span><br></pre></td></tr></table></figure>
<h4 id="grep-ï¼-æ‰“å°åŒ¹é…è¡Œ"><a href="#grep-ï¼-æ‰“å°åŒ¹é…è¡Œ" class="headerlink" title="grep ï¼ æ‰“å°åŒ¹é…è¡Œ"></a>grep ï¼ æ‰“å°åŒ¹é…è¡Œ</h4><p>grep æ˜¯ä¸ªå¾ˆå¼ºå¤§çš„ç¨‹åºï¼Œç”¨æ¥æ‰¾åˆ°æ–‡ä»¶ä¸­çš„åŒ¹é…æ–‡æœ¬ã€‚è¿™æ ·ä½¿ç”¨ grep å‘½ä»¤ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â€-iâ€ä½¿å¾— grep åœ¨æ‰§è¡Œæœç´¢æ—¶å¿½ç•¥å¤§å°å†™ï¼ˆé€šå¸¸ï¼Œæœç´¢æ˜¯å¤§å°å†™ æ•æ„Ÿçš„ï¼‰ï¼Œâ€-vâ€é€‰é¡¹ä¼šå‘Šè¯‰ grep åªæ‰“å°ä¸åŒ¹é…çš„è¡Œã€‚</span><br><span class="line">ls /bin /usr/bin | sort | uniq | grep zip</span><br></pre></td></tr></table></figure></p>
<h4 id="head-tail-ï¼-æ‰“å°æ–‡ä»¶å¼€å¤´éƒ¨åˆ†-ç»“å°¾éƒ¨åˆ†"><a href="#head-tail-ï¼-æ‰“å°æ–‡ä»¶å¼€å¤´éƒ¨åˆ†-ç»“å°¾éƒ¨åˆ†" class="headerlink" title="head / tail ï¼ æ‰“å°æ–‡ä»¶å¼€å¤´éƒ¨åˆ†/ç»“å°¾éƒ¨åˆ†"></a>head / tail ï¼ æ‰“å°æ–‡ä»¶å¼€å¤´éƒ¨åˆ†/ç»“å°¾éƒ¨åˆ†</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// head å‘½ä»¤æ‰“å°æ–‡ä»¶çš„å‰åè¡Œï¼Œè€Œ tail å‘½ä»¤æ‰“å°æ–‡ä»¶çš„ååè¡Œã€‚ -n ç”¨æ¥æŒ‡å®š</span></span><br><span class="line">head -n <span class="number">5</span> ls-output.txt</span><br><span class="line">total <span class="number">343496</span></span><br><span class="line">tail -n <span class="number">5</span> ls-output.txt</span><br><span class="line">ls /usr/bin | tail -n <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// tail æœ‰ä¸€ä¸ªé€‰é¡¹å…è®¸ä½ å®æ—¶åœ°æµè§ˆæ–‡ä»¶ã€‚å½“è§‚å¯Ÿæ—¥å¿—æ–‡ä»¶çš„è¿›å±•æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬åŒæ—¶åœ¨è¢«å†™å…¥ã€‚</span></span><br><span class="line">tail -f /<span class="keyword">var</span>/log/messages</span><br></pre></td></tr></table></figure>
<p><strong>ä½¿ç”¨â€-fâ€é€‰é¡¹ï¼Œtail å‘½ä»¤ç»§ç»­ç›‘æµ‹è¿™ä¸ªæ–‡ä»¶ï¼Œå½“æ–°çš„å†…å®¹æ·»åŠ åˆ°æ–‡ä»¶åï¼Œå®ƒä»¬ä¼šç«‹å³ å‡ºç°åœ¨å±å¹•ä¸Šã€‚è¿™ä¼šä¸€ç›´ç»§ç»­ä¸‹å»ç›´åˆ°ä½ è¾“å…¥ Ctrl-cã€‚</strong></p>
<h4 id="tee-ï¼-ä»-Stdin-è¯»å–æ•°æ®ï¼Œå¹¶åŒæ—¶è¾“å‡ºåˆ°-Stdout-å’Œæ–‡ä»¶"><a href="#tee-ï¼-ä»-Stdin-è¯»å–æ•°æ®ï¼Œå¹¶åŒæ—¶è¾“å‡ºåˆ°-Stdout-å’Œæ–‡ä»¶" class="headerlink" title="tee ï¼ ä» Stdin è¯»å–æ•°æ®ï¼Œå¹¶åŒæ—¶è¾“å‡ºåˆ° Stdout å’Œæ–‡ä»¶"></a>tee ï¼ ä» Stdin è¯»å–æ•°æ®ï¼Œå¹¶åŒæ—¶è¾“å‡ºåˆ° Stdout å’Œæ–‡ä»¶</h4><p>ä¸ºäº†å’Œæˆ‘ä»¬çš„ç®¡é“éšå–»ä¿æŒä¸€è‡´ï¼ŒLinux æä¾›äº†ä¸€ä¸ªå«åš tee çš„å‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤åˆ¶é€ äº† ä¸€ä¸ªâ€teeâ€ï¼Œå®‰è£…åˆ°æˆ‘ä»¬çš„ç®¡é“ä¸Šã€‚tee ç¨‹åºä»æ ‡å‡†è¾“å…¥è¯»å…¥æ•°æ®ï¼Œå¹¶ä¸”åŒæ—¶å¤åˆ¶æ•°æ® åˆ°æ ‡å‡†è¾“å‡ºï¼ˆå…è®¸æ•°æ®ç»§ç»­éšç€ç®¡é“çº¿æµåŠ¨ï¼‰å’Œä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ã€‚å½“åœ¨æŸä¸ªä¸­é—´å¤„ç† é˜¶æ®µæ¥æ•æ‰ä¸€ä¸ªç®¡é“çº¿çš„å†…å®¹æ—¶ï¼Œè¿™å¾ˆæœ‰å¸®åŠ©ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬é‡å¤æ‰§è¡Œä¸€ä¸ªå…ˆå‰çš„ä¾‹å­ï¼Œ è¿™æ¬¡åŒ…å« tee å‘½ä»¤ï¼Œåœ¨ grep è¿‡æ»¤ç®¡é“çº¿çš„å†…å®¹ä¹‹å‰ï¼Œæ¥æ•æ‰æ•´ä¸ªç›®å½•åˆ—è¡¨åˆ°æ–‡ä»¶ ls.txtï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /usr/bin | tee ls.txt | grep zip</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="ä»-shell-çœ¼ä¸­çœ‹ä¸–ç•Œ-Echo"><a href="#ä»-shell-çœ¼ä¸­çœ‹ä¸–ç•Œ-Echo" class="headerlink" title="ä» shell çœ¼ä¸­çœ‹ä¸–ç•Œ- Echo"></a>ä» shell çœ¼ä¸­çœ‹ä¸–ç•Œ- Echo</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-   <span class="built_in">echo</span> ï¼ æ˜¾ç¤ºä¸€è¡Œæ–‡æœ¬</span><br></pre></td></tr></table></figure>
<p>åˆ©ç”¨ echo ä½ å¯ä»¥åšä¸‹é¢è¿™äº›äº‹æƒ…ã€‚è¿™ä¸ª echo è·Ÿ php é‡Œçš„ echo éå¸¸çš„åƒã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> this is a <span class="built_in">test</span></span><br><span class="line">// this is a <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> *</span><br><span class="line">// Applications Desktop Documents Downloads Library Movies Music Pictures Public</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> D*</span><br><span class="line">// Desktop Documents Downloads</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> *s</span><br><span class="line">// Documents Pictures Templates Videos</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> [[:upper:]]*</span><br><span class="line">// Desktop Documents Music Pictures Public Templates Videos</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> /usr/*/share</span><br><span class="line">// /usr/a/share  /user/b/share</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> ~</span><br><span class="line">// /Users/sevencai</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> $((2 + 2))</span><br><span class="line">// 4</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> $(($((5**2)) * 3))</span><br><span class="line">// 5*5 *3 = 75</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Front-&#123;A,B,C&#125;-Back</span><br><span class="line">// Front-A-Back Front-B-Back Front-C-Back</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Number_&#123;1,5&#125;</span><br><span class="line">// Number_1 Number_2 Number_3 Number_4 Number_5</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$USER</span></span><br><span class="line">// sevencai</span><br><span class="line"></span><br><span class="line">// æŸ¥çœ‹æœ‰æ•ˆå˜é‡</span><br><span class="line">printenv | less</span><br><span class="line"></span><br><span class="line">// å‘½ä»¤æ›¿æ¢</span><br><span class="line"><span class="built_in">echo</span> $(ls)</span><br><span class="line">ls -l $(<span class="built_in">which</span> cp)</span><br><span class="line"></span><br><span class="line"> // åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå•è¯åˆ†å‰²æœºåˆ¶ä¼šåœ¨å•è¯ä¸­å¯»æ‰¾ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦ï¼Œå’Œæ¢è¡Œç¬¦ï¼Œå¹¶æŠŠå®ƒä»¬çœ‹ä½œ å•è¯ä¹‹é—´çš„ç•Œå®šç¬¦ã€‚è¿™æ„å‘³ç€æ— å¼•ç”¨çš„ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦éƒ½ä¸æ˜¯æ–‡æœ¬çš„ä¸€éƒ¨åˆ†ï¼Œ å®ƒä»¬åªä½œä¸ºåˆ†éš”ç¬¦ä½¿ç”¨ã€‚ç”±äºå®ƒä»¬æŠŠå•è¯åˆ†ä¸ºä¸åŒçš„å‚æ•°ï¼Œæ‰€ä»¥åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ å‘½ä»¤è¡ŒåŒ…å«ä¸€ä¸ªå¸¦æœ‰å››ä¸ªä¸åŒå‚æ•°çš„å‘½ä»¤ã€‚</span><br><span class="line"><span class="built_in">echo</span> this is a    <span class="built_in">test</span></span><br><span class="line">// this is a <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">// <span class="variable">$1</span> å½“åšç¬¬ä¸€ä¸ªå˜é‡ï¼Œå› ä¸º `1` æ˜¯æ²¡æœ‰å®šä¹‰çš„å˜é‡ï¼Œæ‰€ä»¥ä¸ºç©º</span><br><span class="line"><span class="built_in">echo</span> The total is <span class="variable">$100</span>.00</span><br><span class="line">// The total is 00.00</span><br><span class="line"></span><br><span class="line">// åœ¨åŒå¼•å·ä¸­ï¼Œå‚æ•°å±•å¼€ã€ç®—æœ¯è¡¨è¾¾å¼å±•å¼€å’Œå‘½ä»¤æ›¿æ¢ä»ç„¶æœ‰æ•ˆ</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$USER</span> <span class="variable">$((2+2)</span>) <span class="variable">$(cal)</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"this is a    test"</span></span><br><span class="line">// this is a    <span class="built_in">test</span></span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œæˆ‘è§‰å¾—å¤§è‡´çš„äº†è§£ä¸‹å°±è¡Œã€‚å› ä¸ºçœŸå®æƒ…å†µä¸‹ï¼Œæˆ‘ç”¨åˆ°çš„éå¸¸éå¸¸å°‘ã€‚</p>
<hr>
<h2 id="é”®ç›˜é«˜çº§æŠ€å·§"><a href="#é”®ç›˜é«˜çº§æŠ€å·§" class="headerlink" title="é”®ç›˜é«˜çº§æŠ€å·§"></a>é”®ç›˜é«˜çº§æŠ€å·§</h2><h3 id="ç§»åŠ¨å…‰æ ‡"><a href="#ç§»åŠ¨å…‰æ ‡" class="headerlink" title="ç§»åŠ¨å…‰æ ‡"></a>ç§»åŠ¨å…‰æ ‡</h3><p><img src="jiqiao.png" alt="å¤åˆ¶"></p>
<h3 id="å‰ªåˆ‡å¤åˆ¶"><a href="#å‰ªåˆ‡å¤åˆ¶" class="headerlink" title="å‰ªåˆ‡å¤åˆ¶"></a>å‰ªåˆ‡å¤åˆ¶</h3><p><img src="copy.png" alt="å‰ªåˆ‡"></p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»Šå¤©å°±åˆ°è¿™é‡Œå§ï¼Œæˆ‘æ‹…å¿ƒå› ä¸ºä»Šå¤©å·²ç»çœ‹äº†å¾ˆå¤šäº†ï¼Œå°±åé¢æŠŠè¿™ä¸ªçœ‹å®Œè¿™æœ¬ä¹¦è®°å½•ä¸‹æ¥å½“åšä»»åŠ¡å»å®Œæˆäº†ï¼Œè¿™æ ·è¿èƒŒäº†æˆ‘çš„åˆè¡·ã€‚æ‰€ä»¥æœ‰æ•ˆçš„æ—¶é—´ï¼Œåšæ­£ç¡®çš„äº‹æƒ…ã€‚æ”¹å¤©æˆ‘å†æ¥æ€»ç»“åé¢å‡ ç« èŠ‚ã€‚</p>
<p>å›å®¶ğŸŒ¶å•¦ï¼Œâœˆï¸æ˜å¤©å»æ¥æˆ‘çš„å°ç‹—ç‹—ï¼Œå¯ä¹ï¼ï¼ï¼ å˜»å˜»ã€‚å¼€å¿ƒã€‚å¼€å¿ƒã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘è¯» &lt;em&gt;The Linux Command Line&lt;/em&gt; çš„è¯»ä¹¦ç¬”è®°ã€‚ç”µå­ç‰ˆçš„ä¹¦çš„åœ°å€æ˜¯ï¼š&lt;a href=&quot;http://billie66.github.io/TLCL/book/index.html&quot; target=&quot;_bl
    
    </summary>
    
    
      <category term="è¯»ä¹¦ç¬”è®°" scheme="http://sevencai.github.io/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>é¡¹ç›®æ€»ç»“</title>
    <link href="http://sevencai.github.io/2018/08/09/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/"/>
    <id>http://sevencai.github.io/2018/08/09/é¡¹ç›®æ€»ç»“/</id>
    <published>2018-08-09T13:23:13.000Z</published>
    <updated>2018-08-09T14:03:48.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æœ€è¿‘ä¸€ä¸ªå¤šæœˆåŠ äº†å¾ˆå¤šç­ï¼Œåšäº†ä¸€ä¸ªæ¯”è¾ƒç´§æ€¥çš„é¡¹ç›® Nodejs + Vueå…¨å®¶æ¡¶ï¼Œæ„Ÿè§‰è‡ªå·±æ”¶è·å¤šå¤šã€‚ä»Šå¤©å·²ç»å‘å¸ƒäº†ç°ç½‘ç‰ˆæœ¬ï¼Œè¶çƒ­æ€»ç»“å’Œæ¢³ç†ä¸‹ã€‚</p>
</blockquote>
<hr>
<h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><ol>
<li><code>Nodejs koa2</code>,  <code>async await</code>ç”¨çš„å¾ˆèˆ’é€‚ã€‚</li>
<li><code>Vue å…¨å®¶æ¡¶</code>,<code>vue webpack vuex</code>å¯å¿«é€Ÿå¼€å‘ã€‚</li>
<li>å‰åç«¯åˆ†ç¦»ï¼Œ<code>Nodejs</code> ç«¯çº¯åš <code>Api</code> å±‚ã€‚</li>
<li><code>pm2</code> è¿›ç¨‹ç®¡ç†å·¥å…·ã€‚åˆç†Ÿæ‚‰äº†å¾ˆå¤šå‘½ä»¤å’Œè¸©äº†ä¸€äº›å‘ã€‚</li>
<li><code>log4js</code>æ—¥å¿—æ‰“å°å·¥å…·ã€‚äº†è§£äº†éƒ¨é—¨çš„æ—¥å¿—è§„èŒƒï¼Œç”¨äºæŸ¥è¯¢é—®é¢˜ã€‚</li>
<li>æ•°æ®åº“ç”¨çš„ <code>sequelize</code>ã€‚</li>
<li>ç™»å½•ç”¨çš„ <code>koa-generic-session</code>ã€‚</li>
<li>äº†è§£äº† ToB çš„ä¸€äº›æ¦‚å¿µåŠæ€æƒ³ã€‚</li>
</ol>
<p>ä»¥åå°±æŠ›å¼ƒ PHP è¿™ä¸ªä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€å§ã€‚ä»¥ä¸‹ä¸»è¦æ˜¯è‡ªå·±å¯¹è‡ªå·±é—®é¢˜çš„ä¸€äº›æ¢³ç†ã€‚å¹¶ä¸æ¶‰åŠåˆ°ä»»ä½•çš„çœŸå®é¡¹ç›®ä»£ç âŒ¨ï¸ğŸ ã€‚</p>
<hr>
<h2 id="è·å–ç”¨æˆ·çš„IPä¿¡æ¯"><a href="#è·å–ç”¨æˆ·çš„IPä¿¡æ¯" class="headerlink" title="è·å–ç”¨æˆ·çš„IPä¿¡æ¯"></a>è·å–ç”¨æˆ·çš„IPä¿¡æ¯</h2><p>åœ¨å¾ˆå¤šç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬Nodejså±‚éœ€è¦æŠŠç”¨æˆ·çš„ ip ä¼ ç»™åå°çš„ cgi, cgi ä¼šæ ¹æ®è¿™ä¸ª ip åšä¸€äº›ç­–ç•¥ï¼Œå¦‚é£æ§ï¼Œè¥é”€ç­‰ç­‰ã€‚è¿™å°±æ¶‰åŠåˆ° ip æ€ä¹ˆå–çš„æ¦‚å¿µï¼Œä½ å¯èƒ½ä¼šæ¥è§¦åˆ°è¿™å‡ ä¸ª ip:</p>
<ol>
<li>ctx.request.ip</li>
<li>ctx.headers[â€˜x-forwarded-forâ€™]</li>
<li>ctx.headers[â€˜x-real-ipâ€™]</li>
</ol>
<p>å…ˆæ¥æ™®åŠä¸‹ <code>x-forwarded-for</code>åŠ <code>x-real-ip</code>ã€‚</p>
<p><code>x-forwarded-for</code>çš„æ ¼å¼ä¸€èˆ¬ä¸ºï¼š<code>X-Forwarded-For: client1, proxy1, proxy2</code>  å¦‚ï¼š<code>X-Forwarded-For: 1.1.1.1, 2.2.2.2, 3.3.3.3</code></p>
<blockquote>
<p>æœ€å·¦è¾¹ï¼ˆclient1ï¼‰æ˜¯æœ€åŸå§‹å®¢æˆ·ç«¯çš„IPåœ°å€, ä»£ç†æœåŠ¡å™¨æ¯æˆåŠŸæ”¶åˆ°ä¸€ä¸ªè¯·æ±‚ï¼Œå°±æŠŠ<strong>è¯·æ±‚æ¥æºIPåœ°å€</strong>æ·»åŠ åˆ°å³è¾¹ã€‚ åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™ä¸ªè¯·æ±‚æˆåŠŸé€šè¿‡äº†ä¸‰å°ä»£ç†æœåŠ¡å™¨ï¼šproxy1, proxy2 åŠ proxy3ã€‚è¯·æ±‚ç”±client1å‘å‡ºï¼Œåˆ°è¾¾äº†proxy3ï¼ˆproxy3å¯èƒ½æ˜¯è¯·æ±‚çš„ç»ˆç‚¹ï¼‰ã€‚è¯·æ±‚åˆšä»client1ä¸­å‘å‡ºæ—¶ï¼ŒXFFæ˜¯ç©ºçš„ï¼Œè¯·æ±‚è¢«å‘å¾€proxy1ï¼›é€šè¿‡proxy1çš„æ—¶å€™ï¼Œclient1è¢«æ·»åŠ åˆ°XFFä¸­ï¼Œä¹‹åè¯·æ±‚è¢«å‘å¾€proxy2;é€šè¿‡proxy2çš„æ—¶å€™ï¼Œproxy1è¢«æ·»åŠ åˆ°XFFä¸­ï¼Œä¹‹åè¯·æ±‚è¢«å‘å¾€proxy3ï¼›é€šè¿‡proxy3æ—¶ï¼Œproxy2è¢«æ·»åŠ åˆ°XFFä¸­ï¼Œä¹‹åè¯·æ±‚çš„çš„å»å‘ä¸æ˜ï¼Œå¦‚æœproxy3ä¸æ˜¯è¯·æ±‚ç»ˆç‚¹ï¼Œè¯·æ±‚ä¼šè¢«ç»§ç»­è½¬å‘ã€‚<strong>é‰´äºä¼ªé€ è¿™ä¸€å­—æ®µéå¸¸å®¹æ˜“ï¼Œåº”è¯¥è°¨æ…ä½¿ç”¨X-Forwarded-Forå­—æ®µã€‚æ­£å¸¸æƒ…å†µä¸‹XFFä¸­æœ€åä¸€ä¸ªIPåœ°å€æ˜¯æœ€åä¸€ä¸ªä»£ç†æœåŠ¡å™¨çš„IPåœ°å€, è¿™é€šå¸¸æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¯é çš„ä¿¡æ¯æ¥æºã€‚</strong> â€“ç»´åŸºç™¾ç§‘</p>
</blockquote>
<p>è€Œ <code>x-real-ip</code>æ²¡æœ‰ç›¸å…³æ ‡å‡†ï¼Œä½†æ˜¯åœ¨åå‘ä»£ç†å’Œæ­£å‘ä»£ç†ä¸‹ï¼Œå®ƒçš„å€¼å¯èƒ½ä¸åŒã€‚<strong>æ­£å‘ä»£ç†æ—¶ï¼Œè®°å½•çš„æ˜¯å®¢æˆ·ç«¯çš„çœŸå®ipã€‚ åå‘ä»£ç†æ—¶ï¼Œè®°å½•çš„æ˜¯æœ€åä¸€çº§çš„ä»£ç†ipã€‚</strong></p>
<p>æ‰€ä»¥ï¼š<code>x-real-ip</code> åŠ <code>x-forwarded-for</code>è¿™ä¸¤ä¸ª ip å°±æ˜¯å¾ˆæ™®é€šçš„è¯·æ±‚å¤´ï¼Œå®ƒä»¬æ˜¯å¯ä»¥è¢«ç¯¡æ”¹çš„ã€‚æ¯”å¦‚ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://www.my.com:8089 -H <span class="string">'X-Forwarded-For: 1.1.1.1'</span> -H <span class="string">'X-Real-IP: 2.2.2.2'</span></span><br></pre></td></tr></table></figure></p>
<p>é‚£ä¹ˆè¿™ä¸¤ä¸ªå€¼éƒ½å®¹æ˜“è¢«ç¯¡æ”¹ï¼Œä¸å¯ä¿¡ï¼Œæˆ‘ä»¬è¦æ‹¿åˆ°ç”¨æˆ·çœŸå®çš„ ip æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>ä¸€èˆ¬åœ¨å»ºç«‹  TCP è¿æ¥æ—¶ï¼Œä¼šäº§ç”ŸçœŸå®çš„ IP, å«åš <code>Remote Address</code>ã€‚å› ä¸ºæ˜¯å»ºç«‹åœ¨ TCP ä¸­ï¼Œæ‰€ä»¥è¿™ä¸ª ip ä¸èƒ½è¢«ç¯¡æ”¹ã€‚ä¸€æ—¦ç¯¡æ”¹ï¼Œæ¡æ‰‹ä¸æˆåŠŸï¼Œé‚£ä¹ˆåé¢è‡ªç„¶å°±æ²¡æœ‰äº†ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬è¦å–çœŸå®çš„ ip,åº”è¯¥ä»è¿™ä¸ªå­—æ®µé‡Œå–ã€‚</p>
<p>å®é™…ä¸Šåº”è¯¥å–é‚£ä¸ªå€¼ï¼Œè·Ÿä½  nginx çš„é…ç½®æœ‰å…³ç³»ã€‚æ¯”å¦‚ä¸€èˆ¬é…ç½® nginx åå‘ä»£ç†çš„æ—¶å€™å¯èƒ½è¿™æ ·é…ç½®ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line"></span><br><span class="line">// è‹¥ XFF æœ‰å€¼ï¼Œåˆ™ <span class="variable">$proxy_add_x_forwarded_for</span> = <span class="variable">$XFF</span>, <span class="variable">$remote_addr</span>  (<span class="variable">$XFF</span>ä¸<span class="variable">$remote_addr</span>é€—å·åˆ†å‰²ï¼Œ<span class="variable">$remote_addr</span>åœ¨å…¶å)</span><br><span class="line">// è‹¥ XFF æ²¡æœ‰å€¼ï¼Œåˆ™ <span class="variable">$proxy_add_x_forwarded_for</span> = <span class="variable">$remote_addr</span></span><br></pre></td></tr></table></figure></p>
<p>åƒè¿™æ ·èµ‹å€¼åï¼Œå¦‚æœä½ æ˜¯é€šè¿‡ nginx åå‘ä»£ç†æ¥çš„ï¼Œnginx ä¼šæŠŠç”¨æˆ·å®é™… ip ï¼ˆ$remote_addrï¼‰èµ‹å€¼ç»™ <code>X-Real-IP</code>,è¿™æ—¶å€™å®ƒä¹Ÿæ˜¯çœŸå®çš„ç”¨æˆ·IPäº†ã€‚è€Œ XFF ä¹Ÿæ˜¯æœ‰äº†ç”¨æˆ·çš„çœŸå®IPã€‚</p>
<p>é€šè¿‡è¿™æ ·çš„ nginx é…ç½®ã€‚æ•´ä¸ªå†…å®¹å°±æ— æ³•è¢«ç¯¡æ”¹å’Œæ„é€ ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä» <code>X-Real-IP</code> å’Œ <code>XFF</code>çš„æœ€åä¸€æˆª è·å¾—ç”¨æˆ·çœŸå®çš„ IP äº†ã€‚</p>
<p>æ‰€ä»¥æˆ‘æœ€åæ˜¯æ€ä¹ˆä¼ ä»€ä¹ˆå­—æ®µç»™åå°çš„å‘¢ï¼Ÿ<strong>æˆ‘æœ€åä¼ çš„æ˜¯ <code>x-forwarded-ip</code>ï¼Œ æ‹¿åˆ°è¿™ä¸€ç³»åˆ—çš„ ip list åï¼Œåå°ä¼šå»é€šè¿‡ç½‘æ®µæ ¡éªŒï¼Œåˆ¤æ–­å‡ºå“ªä¸ªæ˜¯å¤–ç½‘ ip, ç„¶åæŠŠè¿™ä¸ª ip å½“æˆæ˜¯ç”¨æˆ·çœŸå®çš„ ipã€‚</strong> cgi è¿˜æ˜¯å¾ˆä¸¥è°¨çš„ã€‚</p>
<p>æœ€å¼€å§‹è°ˆåˆ°çš„ <code>ctx.request.ip</code> æ˜¯æœ€åä¸€æ¬¡çš„ ip, æ‰€ä»¥æœ‰å¯èƒ½æ˜¯ä»£ç†æœºå™¨çš„ ipã€‚</p>
<p>é‡åˆ°ä¸€ç¯‡å¥½æ–‡ç« ï¼š<a href="https://imququ.com/post/x-forwarded-for-header-in-http.html" target="_blank" rel="noopener">x-forwarded-for-header-in-http</a></p>
<p>ä¸€ä¸ªå®ä¾‹ï¼Œåˆ¤æ–­ç”¨æˆ·IPæ˜¯å¦æ­£å¸¸ï¼š<a href="https://pay.weixin.qq.com/wiki/doc/api/H5.php?chapter=15_5" target="_blank" rel="noopener">å¾®ä¿¡H5æ”¯ä»˜éœ€åˆ¤æ–­ä¸‹å•IPå’Œæ”¯ä»˜IPæ˜¯å¦ä¸€è‡´</a></p>
<hr>
<h2 id="å…³äº-PM2-çš„-cluster-æ¨¡å¼"><a href="#å…³äº-PM2-çš„-cluster-æ¨¡å¼" class="headerlink" title="å…³äº PM2 çš„ cluster æ¨¡å¼"></a>å…³äº PM2 çš„ cluster æ¨¡å¼</h2><p>pm2 æ˜¯å¾ˆå¥½çš„è¿›ç¨‹ç®¡ç†å™¨ï¼Œæœ‰è‡ªåŠ¨é‡å¯ç­‰åŠŸèƒ½ï¼Œå¹¶ä¸”è¿˜è‡ªå¸¦è´Ÿè½½å‡è¡¡ã€‚æˆ‘è¿™é‡Œå°±ä¸è®²å…·ä½“çš„ cluster æ¨¡å¼å’Œ pm2 äº†ã€‚å°±åªè®²ä¸‹æˆ‘é‡åˆ°çš„å‘ã€‚</p>
<p>cluster æ¨¡å¼ä¸‹ï¼Œlog4js æ—¥å¿—ï¼Œæ— æ³•æ­£å¸¸æ‰“å°ã€‚è¿™ä¸ªå·²ç»æœ‰ç›¸å…³çš„ issue,åœ°å€åœ¨<a href="https://github.com/log4js-node/log4js-node/issues/265" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚å¤§æ¦‚çš„æ„æ€æ˜¯ cluster æ¨¡å¼ä¸‹ï¼Œå¹¶æ²¡æœ‰ master è¿›ç¨‹ï¼Œè€Œæ˜¯åªæœ‰å¤šä¸ª worker å­è¿›ç¨‹ã€‚è€Œ log4js åªåœ¨ master è¿›ç¨‹ä¸‹ï¼Œæ‰ä¼šè¿›è¡Œæ‰“å°æ—¥å¿—çš„æ“ä½œã€‚ä¹‹æ‰€ä»¥è¿™æ ·æ˜¯å› ä¸ºå¤šä¸ª worker æ“ä½œåŒä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼ˆä¸€èˆ¬æˆ‘ä»¬æ—¥å¿—æ–‡ä»¶åªæœ‰ä¸€å¥—é…ç½®ï¼‰å¯èƒ½ä¼šå¯¼è‡´æœ‰é”™ä¹±ç­‰é—®é¢˜ã€‚æœ‰è§£å†³é—®é¢˜çš„æ–¹æ³•ï¼Œéƒ½åœ¨é‚£ä¸ª issue é‡Œï¼Œä½†æ˜¯æˆ‘æ€»è§‰å¾—ä¸å¤ªå¥½ã€‚</p>
<p>å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œåœ¨ cluster æ¨¡å¼ä¸‹ï¼Œåˆ©ç”¨ restart å‘½ä»¤æ— æ³•å®Œå…¨é‡å¯è¿›ç¨‹ï¼Œfork æ¨¡å¼ä¸‹å°±ä¸ä¼šï¼ŒçŒœæµ‹æ˜¯ cluster æ¨¡å¼æœ‰å¤šä¸ª worker, é‡å¯æ˜¯å¦éœ€è¦ restart æŒ‡å®šæ˜¯å“ªä¸ªå­è¿›ç¨‹æ‰å¯ä»¥ï¼Ÿè¿˜å‘ç°ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªå­è¿›ç¨‹ï¼Œä¸æŒ‡å®šä¹Ÿä¼šä¸èƒ½é‡å¯ã€‚æˆ‘æ˜å¤©ä¼šå»éªŒè¯ä¸‹ã€‚</p>
<p>é‡åˆ°äº†ä¸€ç¯‡å¥½æ–‡ç« ï¼š <a href="http://www.acuriousanimal.com/2017/08/20/using-pm2-to-manage-cluster.html" target="_blank" rel="noopener">using-pm2-to-manage-cluster</a></p>
<hr>
<h2 id="ç™»å½•æ€éªŒè¯"><a href="#ç™»å½•æ€éªŒè¯" class="headerlink" title="ç™»å½•æ€éªŒè¯"></a>ç™»å½•æ€éªŒè¯</h2><p>æˆ‘ä»¬åˆ©ç”¨äº†<code>koa session</code>, <code>cookie session</code> è¿™ç§å½¢å¼ã€‚å¼€å§‹çš„æ—¶å€™æˆ‘æŠŠè¿™é‡Œæƒ³å¤æ‚äº†ï¼Œæƒ³è¦ç»“åˆå¾®ä¿¡çš„ç™»å½•æ€ã€‚ä½†å®é™…ä¸Šçº¯ session cookie è¿™ç§åè€Œæ›´å¥½ã€‚</p>
<blockquote>
<p>å¤§æ¦‚æµç¨‹æ˜¯ï¼šç”¨æˆ·ç™»å½•ç½‘ç«™ï¼Œè°ƒç”¨å¾®ä¿¡ç™»å½•ï¼Œæ‹‰èµ·æˆæƒï¼Œæˆæƒçš„åœ°å€è°ƒç”¨ Nodejs åå°çš„ä¸€ä¸ªè‡ªå·±å°è£…çš„æ¥å£ã€‚åœ¨è¿™ä¸ªæ¥å£é‡Œè·å¾—ç”¨æˆ·çš„ openid ï¼Œæ ¡éªŒç”¨æˆ·çš„æƒé™å¹¶ä¸”è®¾ç½® <code>ctx.session.sessionId</code>ï¼Œç„¶åè¿”å›åˆ°å‰ç«¯ï¼Œå‰ç«¯è°ƒç”¨åå°çš„æ¥å£ï¼Œé€šè¿‡å·²ç»ç§ä¸‹çš„ <code>sessionId</code> å³å¯åˆ¤æ–­å‡ºç”¨æˆ·çš„æƒé™ï¼Œç„¶åå†è¿”å›ç»™å‰ç«¯ã€‚å‰ç«¯å†é’ˆå¯¹èº«ä»½åˆ°å¯¹åº”çš„è·¯ç”±ã€‚</p>
</blockquote>
<p>é‚£ä¹ˆä½ è‚¯å®šä¼šé—®ï¼Œä¸ºä»€ä¹ˆä¸åœ¨ç›´æ¥è®¾ç½® sessionId çš„æ—¶å€™æŠŠç”¨æˆ·ä¿¡æ¯è¿”å›äº†å‘¢ï¼Ÿè¿™æ ·ä¹Ÿå¯ä»¥çš„ï¼Œé‚£ä¹ˆç›¸å½“äºä½ å¾®ä¿¡æˆæƒçš„å›è°ƒåœ°å€è¦å†™ä¸€ä¸ªå‰ç«¯çš„é¡µé¢ï¼Œ ç„¶ååœ¨è¿™ä¸ªé¡µé¢ä¸­å†æ¥åˆ¤æ–­ç”¨æˆ·æ ¹æ®èº«ä»½åˆ°å“ªä¸ªé¡µé¢ã€‚è¿™ä¸ªå‰ç«¯é¡µé¢ä½ éœ€è¦å•ç‹¬çš„ä¹Ÿå»ç»´æŠ¤ã€‚è¿™æ ·ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä½ ä¹Ÿè®¸ä¼šé—®ï¼Œæˆ‘ä¸ç”¨å•ç‹¬å†å†™ä¸ªé¡µé¢ï¼Œç”¨é¦–é¡µå°±å¥½äº†ã€‚ä½†æ˜¯ç”¨é¦–é¡µä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æœ€ç»ˆç”±äºæˆæƒï¼Œä½ çš„é¦–é¡µå°±å¸¦ä¸Šäº† code, è¿˜è¦ç”¨ replaceState ä»€ä¹ˆçš„å»æ‰ï¼Œæˆ‘è§‰å¾—å¾ˆä¸æ•´æ´ã€‚ä½†æ˜¯ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚è¿™ä¸¤ç§æ–¹å¼æœ¬è´¨ä¸Šéƒ½å¯ä»¥ã€‚åªä¸è¿‡ç¬¬ä¸€ç§å·æ‡’äº†ï¼Œç›´æ¥redirectåˆ°é¦–é¡µï¼Œé¦–é¡µå†å‘ä¸€æ¬¡è¯·æ±‚ã€‚</p>
<p>æˆ‘ç”¨çš„ç™»å½•ä¸­é—´ä»¶æ˜¯ï¼š <code>koa-generic-session</code>ã€‚<code>app.use</code>ä¸‹é¢è¿™ä¸ªä¸­é—´ä»¶å³å¯ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sequelizeObj = connectDb.db[dbName]</span><br><span class="line"></span><br><span class="line">sessionConfig.options.store = <span class="keyword">new</span> SequelizeStore(sequelizeObj, &#123;</span><br><span class="line">  sync: <span class="literal">false</span>,</span><br><span class="line">  tableName: <span class="string">'t_session'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> session(sessionConfig.options)</span><br></pre></td></tr></table></figure></p>
<p>å­˜å‚¨å¹¶æ²¡æœ‰å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œæ˜¯å­˜åœ¨äº†æ•°æ®åº“é‡Œï¼Œè¿™é‡Œç”¨çš„<code>koa-generic-session-sequelize</code>ã€‚<strong>ä¸æ”¾åœ¨å†…å­˜é‡Œçš„åŸå› æ˜¯æœ‰å¤šå°æœºå™¨ï¼Œå­˜åœ¨å†…å­˜ä¸­ä¸èƒ½å…±äº«åº”è¯¥ä¼šæœ‰é—®é¢˜ã€‚</strong></p>
<p>è®¾ç½® session cookie çš„æ—¶å€™ï¼Œåœ¨å‰ç«¯ cookie é‡Œï¼Œå°±ä¼šæœ‰å¯¹åº”çš„å€¼ï¼Œç„¶åæ¯æ¬¡è¯·æ±‚é¡µé¢ï¼Œéƒ½ä¼šæŠŠè¿™ä¸ª cookie å¸¦ä¸Šï¼Œå»æ•°æ®åº“é‡Œæ‰¾å¯¹åº”çš„ session æ˜¯å¦å¤±æ•ˆã€‚å¦‚æœæ²¡æœ‰å¤±æ•ˆï¼Œè®¤ä¸ºok,é‚£ä¹ˆå°±å¯ä»¥è·³è¿‡éªŒè¯çš„è¿‡ç§°äº†ã€‚</p>
<p>è¿˜å¯ä»¥åŠ ä¸Š app.keys ï¼Œç„¶åå†å¯¹åº”çš„ options é‡ŒåŠ ä¸Š  signkeysã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.keys = [<span class="string">'im a newer secret'</span>, <span class="string">'i like turtle'</span>];</span><br><span class="line">app.keys = <span class="keyword">new</span> KeyGrip([<span class="string">'im a newer secret'</span>, <span class="string">'i like turtle'</span>], <span class="string">'sha256'</span>);</span><br><span class="line"></span><br><span class="line">ctx.cookies.set(<span class="string">'name'</span>, <span class="string">'tobi'</span>, &#123; <span class="attr">signed</span>: <span class="literal">true</span> &#125;);</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œä½ çš„ cookie çš„å€¼ï¼Œå°±ä¼šè¢«åŠ å¯†äº†ã€‚å‰ç«¯çœ‹åˆ°çš„ cookie å¯èƒ½æ˜¯ä¸€ä¸ªåŠ å¯†è¿‡çš„ä¸²ã€‚ç„¶åä½ åˆ°æœåŠ¡å™¨ç«¯ get cookie çš„æ—¶å€™ï¼Œå®ƒä¼šè‡ªåŠ¨å¸®ä½ è§£å¯†ã€‚å¾—åˆ°å¯¹åº”çš„å€¼å»å’Œæ•°æ®åº“é‡Œçš„sessionè¿›è¡Œæ¯”å¯¹ã€‚</p>
<p>é‚£å¦‚æœå‰ç«¯çš„å¾®ä¿¡ç™»å½•æ€è¿‡æœŸäº†æ€ä¹ˆåŠå‘¢ï¼Ÿæ¯”è¾ƒç®€å•ï¼Œå‰ç«¯å‘ç°ç™»å½•æ€å¤±è´¥ï¼Œæ¯”å¦‚ç™»å½•æ€å¤±è´¥çš„è¿”å›ç æ˜¯1111ï¼Œé‚£ä¹ˆ1111æ—¶é‡æ–°æ‹‰èµ·å¾®ä¿¡ç™»å½•å³å¯ã€‚</p>
<hr>
<h2 id="æ—¥å¿—ç®¡ç†"><a href="#æ—¥å¿—ç®¡ç†" class="headerlink" title="æ—¥å¿—ç®¡ç†"></a>æ—¥å¿—ç®¡ç†</h2><p>æ—¥å¿—ç®¡ç†å¯¹äºä¸€ä¸ªå¤§å‹çš„é¡¹ç›®æ¥è¯´ï¼Œå°¤å…¶æ˜¯æ¶‰åŠåˆ°æ”¯ä»˜çš„éå¸¸é‡è¦ï¼Œä»–ç”¨äºå¸®ä½ æŸ¥çœ‹ç”¨æˆ·åšäº†ä»€ä¹ˆäº‹æƒ…ï¼Œæˆ–è€…ç³»ç»Ÿå‡ºäº†ä»€ä¹ˆâŒã€‚éå¸¸çš„é‡è¦ã€‚</p>
<p><strong>æ—¥å¿—æˆ‘è¿™é‡Œç”¨çš„ log4js, åˆ†ä¸ºäº†å››ç§ category, åˆ†åˆ«ç”¨æ¥è®°å½• db æ“ä½œï¼Œè®¿é—®æ—¥å¿—ï¼Œå¼€å‘è€… debug ä¿¡æ¯ï¼Œcgi ä¿¡æ¯æ—¥å¿—ï¼Œé”™è¯¯æ—¥å¿—ã€‚è¿™äº›éœ€è¦æ”¾åœ¨ä¸åŒçš„æ–‡ä»¶é‡Œï¼Œä¾¿äºå¼€å‘è€…æ‰¾é—®é¢˜ã€‚</strong></p>
<p>ä½ å¯ä»¥è®¾ç½®ä¸åŒçš„ categories, æ¯ä¸ª categories é‡Œè®¾ç½® level å’Œä¸åŒçš„ appendersã€‚ æ¯ä¸€ä¸ª appenders éƒ½å¯ä»¥è®¾ç½®ä¸åŒ filename ç­‰ç­‰ã€‚</p>
<p>é‚£ä¹ˆè¿™ä¸ª db çš„æ“ä½œæ—¥å¿—ï¼Œæ€ä¹ˆæ‰“å°å‘¢ï¼Ÿ sequelize å»ºç«‹è·Ÿ db é“¾æ¥æ—¶ï¼Œå¯ä»¥ä¼ å…¥ logging è¿™ä¸ª option, åœ¨è¿™ä¸ª logging é‡Œè®¾ç½® sequelize çš„æ‰“å°æ–¹æ³•ã€‚å¦‚ä¸‹é¢æˆ‘å°±æ˜¯æŠŠæ‰“å°dbçš„æ“ä½œæ—¥å¿—é€šè¿‡ log4js æ‰“å…¥äº†æ—¥å¿—ä¸­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.options.logging = <span class="function"><span class="params">msg</span> =&gt;</span> &#123;</span><br><span class="line">  dbLogger.debug(msg)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="koa2-çš„é”™è¯¯å¤„ç†"><a href="#koa2-çš„é”™è¯¯å¤„ç†" class="headerlink" title="koa2 çš„é”™è¯¯å¤„ç†"></a>koa2 çš„é”™è¯¯å¤„ç†</h2><p>è¿™ä¸ªé”™è¯¯å¤„ç†çš„æ–¹æ³•ï¼Œç½‘ä¸Šåˆ°å¤„éƒ½æ˜¯çš„äº†ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é”™è¯¯å¤„ç†ä¸­é—´ä»¶</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> next()</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    ctx.response.status = err.statusCode || err.status || <span class="number">500</span></span><br><span class="line"></span><br><span class="line">    ctx.response.body = &#123;</span><br><span class="line">      message: <span class="string">'ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•!'</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ctx.app.emit(<span class="string">'error'</span>, err, ctx)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// app.js ä¸­æ¥æ”¶ error äº‹ä»¶ï¼Œå¹¶ä¸”ä¸ŠæŠ¥åˆ°é”™è¯¯æ—¥å¿—ä¸­</span></span><br><span class="line">app.on(<span class="string">'error'</span>, (err, ctx) =&gt; &#123;</span><br><span class="line"> ctx.errorLogger(<span class="string">`name=<span class="subst">$&#123;err.name&#125;</span>&amp;msg=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(err.message)&#125;</span>&amp;stack=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(err.stack)&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œæ³¨æ„å¦‚æœä½ ç›´æ¥æ‰“å°çš„æ˜¯ err å¯¹è±¡ï¼Œä¸€èˆ¬åªæœ‰å®ƒçš„ msg ä¼šè¢«æ‰“å°å‡ºæ¥ï¼Œå¦‚æœä½ æƒ³è¦æ›´å¤šä¿¡æ¯ï¼Œä¸€å®šè¦æŠŠ stack æ‰“å‡ºæ¥ã€‚è¿™ä¸ªæˆ‘ç–å¿½äº†ï¼ŒåŒäº‹å¸®æˆ‘æå‡ºæ¥äº†ï¼Œå¾ˆæ£’å¾ˆä¼˜ç§€ã€‚</p>
<p>æˆ‘å»ç½‘ä¸ŠæŸ¥äº†ä¸‹ï¼Œè¿™ä¸ªé”™è¯¯å¤„ç†å…¶å®æ˜¯ koa2 é‡Œçš„é»˜è®¤æ–¹å¼ï¼Œåªä¸è¿‡æˆ‘ä»¬åˆè‡ªå·±å»é‡å†™äº†ï¼Œä»–æœ¬èº«çš„æ˜¯è¿™æ ·çš„ï¼š</p>
<p>å¯ä»¥çœ‹ä¸‹è¿™ç¯‡æ–‡æ¡£ï¼š<a href="https://github.com/koajs/koa/blob/master/docs/error-handling.md#default-error-handler" target="_blank" rel="noopener">error-handling.md#default-error-handler</a></p>
<p>ä»–é‡Œé¢æ¨èäº†ä¸€ç§å†™æ³•ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> next();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="comment">// will only respond with JSON</span></span><br><span class="line">    ctx.status = err.statusCode || err.status || <span class="number">500</span>;</span><br><span class="line">    ctx.body = &#123;</span><br><span class="line">      message: err.message</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p><strong>æˆ‘è§‰å¾—è¿™ç§å†™æ³•å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œå› ä¸ºå¦‚æœä½ è¿™ä¸ªæ˜¯æ•°æ®åº“çš„æŸäº›åœ°æ–¹å‡ºé”™äº†ï¼Œå¯èƒ½ä¼šåœ¨ err.message é‡Œæš´éœ²ä¸€äº›ä½ æœºå™¨ ip åŠä¸€äº›å…¶ä»–çš„ä¿¡æ¯ï¼Œè¿™ä¸ªæ˜¯ä¸å®‰å…¨çš„ã€‚ç»Ÿä¸€ç»™ç”¨æˆ·ä¸€ä¸ªå›å¤ï¼Œç„¶åæ‰“åˆ°ç³»ç»Ÿé”™è¯¯æ—¥å¿—ä¸­ï¼Œæ˜¯æ¯”è¾ƒå¥½çš„åšæ³•ã€‚</strong></p>
<p>è¿™é‡Œé€”ä¸­çœ‹åˆ°äº†ä¸€ç¯‡æ–‡ç« ï¼š <a href="http://www.52cik.com/2018/05/27/koa-error.html" target="_blank" rel="noopener">å¤§æ¦‚è®²çš„æ˜¯koaé”™è¯¯å¤„ç†çš„å†™æ³•</a></p>
<p>æ³¨æ„é”™è¯¯å¤„ç†æœ€å¥½è¢«å½“åšæœ€å‰é¢çš„ä¸€ä¸ªä¸­é—´ä»¶ã€‚</p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…ˆå†™è¿™ä¹ˆå¤šï¼Œå…¶å®è¿˜æœ‰å¾ˆå¤šå¾ˆå°çš„ç»†èŠ‚ã€‚ä¸‹æ¬¡å†æ•´ç†æ•´ç†ï¼Œå½“ç„¶ä¸Šé¢åªæ˜¯æˆ‘è‡ªå·±çš„ç†è§£ï¼Œå¯èƒ½ä¹Ÿæœ‰æˆ‘ç†è§£é”™äº†çš„ã€‚æˆ‘ä¼šç»å¸¸çœ‹å®ƒï¼Œç„¶åçœ‹è‡ªå·±æ˜¯å¦åé¢åˆæ–°çš„è®¤è¯†æ¥æ¨ç¿»ç°åœ¨çš„æƒ³æ³•ã€‚è¿™ä¸ªé¡¹ç›®æ˜¯æˆ‘è·Ÿç€ç»„é‡Œå¦å¤–ä¸€ä¸ªå¾ˆå¤šå¹´ç»éªŒçš„è€å¸æœºä¸€èµ·åšçš„ï¼Œåœ¨ä»–èº«ä¸Šï¼Œæˆ‘å­¦ä¹ åˆ°äº†ä¸¥è°¨çš„æ€åº¦ã€‚æœ‰å¾ˆå¤šåœ°æ–¹ä»–éƒ½æ¯”æˆ‘æœ‰ç»éªŒï¼Œä¹Ÿç»™æˆ‘æŒ‡å‡ºäº†ä¸€äº›é—®é¢˜ã€‚æ‰€ä»¥è¯´å…¬å¸å’Œè€æ¿ç»™ä»–é‚£ä¹ˆå¤šå·¥èµ„æ˜¯åº”è¯¥çš„å•Šã€‚ä¼˜ç§€å“ˆå“ˆã€‚ğŸ‘ğŸ“š</p>
<p>ğŸŒ²å¸Œæœ›ä¸‹æ¬¡æœ‰æœºä¼šè¯•ä¸‹ Vue SSRã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœ€è¿‘ä¸€ä¸ªå¤šæœˆåŠ äº†å¾ˆå¤šç­ï¼Œåšäº†ä¸€ä¸ªæ¯”è¾ƒç´§æ€¥çš„é¡¹ç›® Nodejs + Vueå…¨å®¶æ¡¶ï¼Œæ„Ÿè§‰è‡ªå·±æ”¶è·å¤šå¤šã€‚ä»Šå¤©å·²ç»å‘å¸ƒäº†ç°ç½‘ç‰ˆæœ¬ï¼Œè¶çƒ­æ€»ç»“å’Œæ¢³ç†ä¸‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id=&quot;å†™åœ¨å‰é¢&quot;&gt;&lt;a href=&quot;#å†™åœ¨å‰é¢&quot; 
    
    </summary>
    
    
      <category term="Nodejs" scheme="http://sevencai.github.io/tags/Nodejs/"/>
    
  </entry>
  
</feed>
