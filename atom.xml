<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Seven&#39;s Blog</title>
  <subtitle>Share, Learn, Enjoy, Keep</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://sevencai.github.io/"/>
  <updated>2019-02-22T12:29:46.000Z</updated>
  <id>http://sevencai.github.io/</id>
  
  <author>
    <name>Seven Cai</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>webpack ç¼–è¯‘ç›®å½•åŸæ ·è¾“å‡ºåŠwebpack4 treeshakingå°ç»“</title>
    <link href="http://sevencai.github.io/2019/02/22/webpack-%E7%BC%96%E8%AF%91%E7%9B%AE%E5%BD%95%E5%8E%9F%E6%A0%B7%E8%BE%93%E5%87%BA%E5%8F%8Awebpack4-treeshaking%E5%B0%8F%E7%BB%93/"/>
    <id>http://sevencai.github.io/2019/02/22/webpack-ç¼–è¯‘ç›®å½•åŸæ ·è¾“å‡ºåŠwebpack4-treeshakingå°ç»“/</id>
    <published>2019-02-22T12:16:03.000Z</published>
    <updated>2019-02-22T12:29:46.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æœ¬æ–‡ä¸»è¦è®°å½•ä¸¤ç‚¹</p>
<ol>
<li><p>å¦‚ä½•åœ¨webpackä¸­ç¼–è¯‘ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶å¹¶ä¸”æŒ‰ç…§ã€åŸç›®å½•ã€‘è¾“å‡ºã€‚</p>
</li>
<li><p>æ€»ç»“åœ¨webpack ä¸­ä½¿ç”¨ treeshaking çš„æ¡ä»¶ã€‚</p>
</li>
</ol>
</blockquote>
<hr>
<h2 id="webpack-ç¼–è¯‘æ–‡ä»¶ç›®å½•å¹¶åŸæ ·è¾“å‡º"><a href="#webpack-ç¼–è¯‘æ–‡ä»¶ç›®å½•å¹¶åŸæ ·è¾“å‡º" class="headerlink" title="webpack ç¼–è¯‘æ–‡ä»¶ç›®å½•å¹¶åŸæ ·è¾“å‡º"></a>webpack ç¼–è¯‘æ–‡ä»¶ç›®å½•å¹¶åŸæ ·è¾“å‡º</h2><p><strong>åœºæ™¯æ˜¯éœ€è¦ç¼–è¯‘ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰jsæ–‡ä»¶ï¼Œå¹¶ä¸”æŠŠè¿™äº›jsæ–‡ä»¶éƒ½æŒ‰ç…§ã€åŸæ¥çš„ç›®å½•ç»“æ„ã€‘è¾“å‡ºã€‚</strong></p>
<p>é¦–å…ˆç¼–è¯‘ä¸€ä¸ªæ–‡ä»¶å¤¹çš„æ‰€æœ‰jsæ–‡ä»¶ï¼Œæ¯”è¾ƒå¥½åšã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>glob</code>æ¥è·å–ç›®å½•ä¸‹çš„æ‰€æœ‰jsæ–‡ä»¶ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Webpack babel transform config  </span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;  </span><br><span class="line">  entry: glob.sync(<span class="string">"./src/**/*.js"</span>),  </span><br><span class="line">  </span><br><span class="line">  mode: <span class="string">"production"</span>,  </span><br><span class="line">  </span><br><span class="line">  output: &#123;  </span><br><span class="line">	filename: <span class="string">'[name].js'</span>,  </span><br><span class="line">	path: path.resolve(__dirname, <span class="string">'./'</span>)  </span><br><span class="line">  &#125;,  </span><br><span class="line">  <span class="comment">// .....  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬åƒå¦‚ä¸Šè¿™ä¹ˆå†™ï¼Œä¼šç›´æ¥è¾“å‡ºä¸€ä¸ª main.js æ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯æ‰€æœ‰è¢«ç¼–è¯‘çš„æ–‡ä»¶éƒ½ä¼šåœ¨åŒæ ·çš„ä¸€ä¸ªæ–‡ä»¶ä¸­è¾“å‡ºã€‚è¿™ä¸æ˜¯æˆ‘æƒ³è¦çš„ï¼Œæˆ‘æƒ³è¦çš„æ˜¯ã€æ¯ä¸ªæ–‡ä»¶å•ç‹¬ç¼–è¯‘ï¼Œå¹¶åŸæ ·ç›®å½•è¾“å‡ºã€‘ã€‚</p>
<p>æŸ¥æ‰¾äº†ä¸‹ <code>webpack</code> æ²¡æœ‰ç›¸å…³çš„é…ç½®, å¦‚æœæˆ‘ä»¬è¦è¾“å‡º<code>module/a/index.js</code>åœ¨ <code>dist/module/a/</code>ç›®å½•ä¸‹ã€‚æˆ‘ä»¬å†å†™ entry æ—¶å°±å¯ä»¥è¿™ä¹ˆå†™:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">entry: &#123;</span><br><span class="line">    <span class="string">'module/a/index'</span>: <span class="string">'module/a/index.js'</span>,</span><br><span class="line">    <span class="string">'module/b/index'</span>: <span class="string">'module/b/index.js'</span>,</span><br><span class="line">&#125;,</span><br><span class="line">output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'[name].js'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ‰€ä»¥ä¸ºäº†åŠ¨æ€å»è¾“å‡ºåˆ°ç›¸åº”çš„ç›®å½•ï¼Œæˆ‘ä»¬åªéœ€è¦å»æ‰¾åˆ°å¯¹åº”çš„entryå³å¯ã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³è¦åŸæ ·è¾“å‡ºç¼–è¯‘åçš„ src ç›®å½•ä¸‹çš„æ–‡ä»¶, å…ˆç”¨ æ­£åˆ™åŒ¹é…åˆ° å¯¹åº”çš„è·¯å¾„ã€‚ç„¶åå†æ˜ å°„åˆ°entryä¸Šå³å¯ã€‚ä¸»è¦æ˜¯å®ç°ï¼š<br><code>./src/lib/a.js =&gt; ./lib/a.js</code>çš„mapã€‚ç®€å•ç‚¹çš„demoå¯èƒ½å¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> glob = <span class="built_in">require</span>(<span class="string">'glob'</span>)  </span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)  </span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)  </span><br><span class="line"><span class="keyword">const</span> CleanWebpackPlugin = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment">// Get all file entries  </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getEntries</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">  <span class="keyword">let</span> map = &#123;&#125;  </span><br><span class="line">  <span class="keyword">const</span> entryFiles = glob.sync(<span class="string">"./src/**/*.js"</span>)  </span><br><span class="line">  </span><br><span class="line">  entryFiles.forEach(<span class="function"><span class="params">filepath</span> =&gt;</span> &#123;  </span><br><span class="line">    <span class="keyword">let</span> fileDir = <span class="regexp">/.\/src\/(.*?)\.js/</span>.exec(filepath)  </span><br><span class="line">  </span><br><span class="line">    map[fileDir[<span class="number">1</span>]] = filepath  </span><br><span class="line">  &#125;)  </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> map  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Webpack babel transform config  </span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;  </span><br><span class="line">  entry: getEntries(),  </span><br><span class="line">  </span><br><span class="line">  mode: <span class="string">"production"</span>,  </span><br><span class="line">  </span><br><span class="line">  output: &#123;  </span><br><span class="line">    filename: <span class="string">'[name].js'</span>,  </span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'./'</span>)  </span><br><span class="line">  &#125;,  </span><br><span class="line">  </span><br><span class="line">  <span class="built_in">module</span>: &#123;  </span><br><span class="line">    rules: [  </span><br><span class="line">      &#123;  </span><br><span class="line">        test: <span class="regexp">/\.js/</span>,  </span><br><span class="line">        loader: <span class="string">'babel-loader'</span>,  </span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>  </span><br><span class="line">      &#125;  </span><br><span class="line">    ]  </span><br><span class="line">  &#125;,  </span><br><span class="line">  </span><br><span class="line">  plugins: [  </span><br><span class="line">    <span class="keyword">new</span> CleanWebpackPlugin([<span class="string">'lib'</span>]),  </span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123; <span class="string">"process.env.NODE_ENV"</span>: <span class="built_in">JSON</span>.stringify(<span class="string">"production"</span>) &#125;)  </span><br><span class="line">  ]  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="webpack-çš„-treeshaking-æ¡ä»¶"><a href="#webpack-çš„-treeshaking-æ¡ä»¶" class="headerlink" title="webpack çš„ treeshaking æ¡ä»¶"></a>webpack çš„ treeshaking æ¡ä»¶</h2><p>webpack2 çš„ treeshaking ä¸€èˆ¬æˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°ã€‚æœ€è¿‘æœ‰æµè§ˆäº†ç±»ä¼¼çš„æ–‡ç« ï¼Œæ€»ç»“ä¸‹ï¼ˆä¸‹é¢æ˜¯ä½¿ç”¨webpack4çš„ç›¸å…³é…ç½®ï¼‰ï¼š</p>
<p><img src="treeshaking.png" alt="æ–‡æ¡£æˆªå›¾"></p>
<p>ä¹Ÿå°±æ˜¯è¯´å¿…é¡»å¾—</p>
<p>ä½¿ç”¨ treeshake å‡å°‘æ–‡ä»¶ä½“ç§¯çš„4ä¸ªæ¡ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-   ä½¿ç”¨ ES2015 æ¨¡å—è¯­æ³•ï¼ˆå³  `import`  å’Œ  `export`ï¼‰ã€‚</span><br><span class="line">-   åœ¨é¡¹ç›®  `package.json`  æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä¸€ä¸ª &quot;sideEffects&quot; å±æ€§ã€‚</span><br><span class="line">-   ä¸èƒ½æŠŠ ES6 æ¨¡å—ç”¨ babel å…ˆè½¬æ¢æˆ CommonJs, åœ¨`@babel/preset-env`ä¸­ï¼Œè¿™æ˜¯ä¸ªé»˜è®¤è¡Œä¸ºï¼Œéœ€è¦è®¾ç½® `module: false`ç¦ç”¨æ‰ã€‚å…ˆç¼–è¯‘æˆ CommonJs åwebpackå°±æ— æ³•åˆ†æä¾èµ–äº†ã€‚</span><br><span class="line">-   webpack4ä¸­è®¾ç½® mode: productionï¼Œè‡ªåŠ¨å¼€å¯å‹ç¼©, å¦‚æœæ˜¯éwebpack4,åˆ™éœ€è¦å¼•å…¥ä¸€ä¸ªèƒ½å¤Ÿåˆ é™¤æœªå¼•ç”¨ä»£ç (dead code)çš„å‹ç¼©å·¥å…·(minifier)ï¼ˆä¾‹å¦‚  `UglifyJSPlugin`ï¼‰ã€‚</span><br></pre></td></tr></table></figure>
<p>è®¾ç½® module ä¸º false çš„åŸå› å¼•ç”¨å¦‚ä¸‹ï¼š</p>
<blockquote>
<h3 id="modules"><a href="#modules" class="headerlink" title="modules"></a><code>modules</code></h3><p><code>&quot;amd&quot; | &quot;umd&quot; | &quot;systemjs&quot; | &quot;commonjs&quot; | &quot;cjs&quot; | &quot;auto&quot; | false</code>, defaults to  <code>&quot;auto&quot;</code>.<br>Enable transformation of ES6 module syntax to another module type.<br>Setting this to  <code>false</code>  will not transform modules.</p>
</blockquote>
<p>é”™è¯¯ç¤ºèŒƒï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">exports.a = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'a'</span>)    </span><br><span class="line">&#125;    </span><br><span class="line">  </span><br><span class="line">exports.b = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'b'</span>)    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">'./a.js'</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment">// é”™è¯¯ï¼Œéœ€è¦ç”¨ import ,export ES6è¯­æ³• æ‰èƒ½ treeshake</span></span><br><span class="line">api.a()</span><br></pre></td></tr></table></figure></p>
<p>æ­£ç¡®ç¤ºèŒƒï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'a'</span>)  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'b'</span>)  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;a&#125; <span class="keyword">from</span> <span class="string">'./a.js'</span>  </span><br><span class="line">a()</span><br></pre></td></tr></table></figure></p>
<p>ç®€å•ç‚¹çš„ç¤ºä¾‹demo:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js  </span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)  </span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)  </span><br><span class="line"><span class="keyword">const</span> UglifyJSPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">module</span>.exports = &#123;  </span><br><span class="line">  entry: <span class="string">'./test.mjs'</span>,  </span><br><span class="line">  </span><br><span class="line">  mode: <span class="string">"production"</span>,  </span><br><span class="line">  </span><br><span class="line">  output: &#123;  </span><br><span class="line">    filename: <span class="string">'index.js'</span>,  </span><br><span class="line">	path: path.resolve(__dirname, <span class="string">'./dist'</span>)  </span><br><span class="line">  &#125;,  </span><br><span class="line">  </span><br><span class="line">  <span class="built_in">module</span>: &#123;  </span><br><span class="line">    rules: [  </span><br><span class="line">      &#123;  </span><br><span class="line">        test: <span class="regexp">/\.js/</span>,  </span><br><span class="line">        loader: <span class="string">'babel-loader'</span>,  </span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>  </span><br><span class="line">      &#125;  </span><br><span class="line">    ]  </span><br><span class="line">  &#125;,  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">// å½“ mode ä¸º development æ—¶ï¼Œéœ€è¦å¼€å¯ä¸‹é¢çš„ä»£ç ã€‚</span></span><br><span class="line">  <span class="comment">// å½“ mode ä¸º production æ—¶ï¼Œä¸éœ€è¦</span></span><br><span class="line">  optimization: &#123;  </span><br><span class="line">    minimizer: [  </span><br><span class="line">      <span class="keyword">new</span> UglifyJSPlugin(&#123;  </span><br><span class="line">        uglifyOptions: &#123;  </span><br><span class="line">          compress: &#123;  </span><br><span class="line">            warnings: <span class="literal">true</span>  </span><br><span class="line">          &#125;,  </span><br><span class="line">          output: &#123;  </span><br><span class="line">            comments: <span class="literal">false</span>  </span><br><span class="line">          &#125;,  </span><br><span class="line">          sourceMap: <span class="literal">true</span>  </span><br><span class="line">        &#125;  </span><br><span class="line">      &#125;)  </span><br><span class="line">    ]  </span><br><span class="line">  &#125;,  </span><br><span class="line">  </span><br><span class="line">  plugins: [  </span><br><span class="line">    <span class="keyword">new</span> webpack.LoaderOptionsPlugin(&#123;  </span><br><span class="line">      minimize: <span class="literal">true</span>,  </span><br><span class="line">      debug: <span class="literal">false</span>  </span><br><span class="line">  &#125;),  </span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123; <span class="string">"process.env.NODE_ENV"</span>: <span class="built_in">JSON</span>.stringify(<span class="string">"production"</span>) &#125;)  </span><br><span class="line">  ]  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="sideEffectsæ€ä¹ˆç†è§£ï¼Ÿ"><a href="#sideEffectsæ€ä¹ˆç†è§£ï¼Ÿ" class="headerlink" title="sideEffectsæ€ä¹ˆç†è§£ï¼Ÿ"></a>sideEffectsæ€ä¹ˆç†è§£ï¼Ÿ</h2><p>sideEffects è¿™ä¸ªä¼°è®¡å†èŠ±ä¸€ä¸ªæ–‡ç« ä¹Ÿè®²ä¸å®Œã€‚å¤§æ¦‚çš„è¡¨è¾¾ä¸‹æ˜¯ï¼š</p>
<p>å¾ˆå¤šæ—¶å€™åœ¨è½¬æ¢ä»£ç åï¼Œæˆ‘ä»¬çš„ä»£ç ä¼šç”±äºè¢«ç¼–è¯‘è€Œäº§ç”Ÿå‰¯ä½œç”¨ï¼Œæ¯”å¦‚ä½ å¯¹ä¸€ä¸ªå‡½æ•°ä½¿ç”¨äº† location.href æˆ–è€… window ä¸ŠåŠ äº†ä¸œè¥¿ï¼Œå³ä½¿ä½ æ²¡æœ‰çœŸçš„ä½¿ç”¨è¿™ä¸ªæ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—ä¹Ÿä¼šè¢«æ‰“åŒ…è¿›åˆ°disté‡Œå»ã€‚</p>
<p>æ‰€ä»¥å¦‚æœä½ çœŸçš„æƒ³å»é™¤é‚£äº›å®Œå…¨æ²¡æœ‰è¢«å¼•ç”¨åˆ°çš„ï¼Œå³ä½¿æœ‰å‰¯ä½œç”¨çš„åŒ…ï¼š<strong>å°±åº”è¯¥æŠŠè¿™äº› åŒ…/æ¨¡å— è¢«æ ‡è®°ä¸º <code>sideEffects: false</code> äº†ï¼Œé‚£ä¹ˆä¸ç®¡å®ƒæ˜¯å¦çœŸçš„æœ‰å‰¯ä½œç”¨ï¼Œåªè¦å®ƒæ²¡æœ‰è¢«å¼•ç”¨åˆ°ï¼Œæ•´ä¸ª æ¨¡å—/åŒ… éƒ½ä¼šè¢«å®Œæ•´çš„ç§»é™¤ã€‚</strong></p>
<p>ä¸¾ä¸ªæˆ‘çœ‹åˆ°çš„å¾ˆå¥½çš„ä¾‹å­ï¼Œä¾‹å­åŸæœ¬å‡ºäºæ–‡ç« <a href="https://juejin.im/post/5b4ff9ece51d45190c18bb65" target="_blank" rel="noopener"># Webpack ä¸­çš„ sideEffects åˆ°åº•è¯¥æ€ä¹ˆç”¨ï¼Ÿ</a>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import DevTools from &apos;mobx-react-devtools&apos;;</span><br><span class="line"></span><br><span class="line">class MyApp extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        ...</span><br><span class="line">        &#123; process.env.NODE_ENV === &apos;production&apos; ? null : &lt;DevTools /&gt; &#125;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœä½ ä¸åœ¨webpack4ä¸­è®¾ç½® <code>sideEffects: false</code>ï¼Œ é‚£ä¹ˆå³ä½¿ <code>NODE_ENV=production</code>, <code>mobx-react-devtools</code>ä¹Ÿä¼šè¢«å¼•å…¥ã€‚</p>
<p>æ‰€ä»¥<strong>å¦‚æœæˆ‘ä»¬èƒ½ç¡®å®šæˆ–è€…æƒ³è®©è¿™ä¸ªåŒ…ä¸å¯¹åŒ…ä»¥å¤–çš„å¯¹è±¡é€ æˆå½±å“ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å®Œå…¨çš„å¯ä»¥æ”¾å¿ƒè®¾ç½®è¿™ä¸ªå‚æ•°äº†</strong>ã€‚</p>
<p>å…³äº å‰¯ä½œç”¨ï¼Œæ¨èä¸€ç¯‡æ–‡ç« <a href="https://zhuanlan.zhihu.com/p/32831172" target="_blank" rel="noopener">ä½ çš„Tree-Shakingå¹¶æ²¡ä»€ä¹ˆåµç”¨
</a>, ä¹Ÿæ–¹ä¾¿è‡ªå·±åç»­æŸ¥é˜…ã€‚</p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ€è¿‘ä¸»è¦æ˜¯æƒ³å¯¹ç»„é‡Œçš„ä¸€äº›åŒ…åšä¼˜åŒ–ï¼Œåšä¼˜åŒ–çš„è¿‡ç¨‹ä¸­è§£å†³äº†ä¸€äº›é—®é¢˜ï¼Œä¹Ÿå¸¦æ¥äº†ä¸€äº›æ–°çš„ç–‘æƒ‘ã€‚ç–‘æƒ‘è¿˜æ²¡è§£å†³ï¼Œæ‰€ä»¥è¿˜ä¸èƒ½æ€»ç»“æˆæ–‡ç« ã€‚è™½ç„¶ä¸æ˜¯çº ç»“ä¸Šé¢çš„ä¸œè¥¿ï¼Œä½†ä¹Ÿç®—æ˜¯çº ç»“äº†å¥½å‡ å¤©äº†ã€‚(à²¥ _ à²¥)</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦è®°å½•ä¸¤ç‚¹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;å¦‚ä½•åœ¨webpackä¸­ç¼–è¯‘ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶å¹¶ä¸”æŒ‰ç…§ã€åŸç›®å½•ã€‘è¾“å‡ºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ€»ç»“åœ¨webpack ä¸­ä½¿ç”¨ treeshaking çš„æ¡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
      <category term="å·¥å…·/é…ç½®" scheme="http://sevencai.github.io/tags/%E5%B7%A5%E5%85%B7-%E9%85%8D%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>2018å¹´åº¦æ€»ç»“</title>
    <link href="http://sevencai.github.io/2018/12/31/2018%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/"/>
    <id>http://sevencai.github.io/2018/12/31/2018å¹´åº¦æ€»ç»“/</id>
    <published>2018-12-31T09:44:03.000Z</published>
    <updated>2018-12-31T03:04:36.000Z</updated>
    
    <content type="html"><![CDATA[<p>2018å¹´å·²ç»æ˜¯è¿‡å»</p>
<p>å°æ—¶å€™å°è±¡æœ€æ·±çš„ä¸€å¹´æ˜¯2008å¹´</p>
<p>é‚£ä¸€å¹´å¼€äº†è¿åŠ¨ä¼š</p>
<p>é‚£ä¸€å¹´è·Ÿçˆ¸çˆ¸å»äº†åŒ—äº¬</p>
<p>é‚£ä¸€å¹´å¦ˆå¦ˆ40å²</p>
<p>é‚£ä¸€å¹´æˆ‘13å²</p>
<p>é‚£ä¸€å¹´ä¸‹äº†å¤§é›ª</p>
<p>é‚£ä¸€å¹´æ±¶å·åœ°éœ‡</p>
<p>è½¬çœ¼é—´10å¹´å°±è¿‡å»äº†ï¼Œ10å¹´ï¼Œæˆ‘é•¿å¤§äº†</p>
<p>é‚£ä¸ªèƒ†å°çš„æˆ‘ï¼Œå˜äº†æ•¢äºæ‰¿æ‹…çš„æˆ‘</p>
<p>é‚£ä¸ªé—®çˆ¸çˆ¸å¦ˆå¦ˆè¦é’±çš„æˆ‘ï¼Œå˜æˆäº†ç»™çˆ¸çˆ¸å¦ˆå¦ˆä¹°ä¸œè¥¿çš„æˆ‘</p>
<p>é‚£ä¸ªå­¦ç”Ÿï¼Œå˜æˆäº†ç¤¾ä¼šäºº</p>
<p>é‚£ä¸ªä¸€ä¸ªäººï¼Œç°åœ¨å¤šäº†ä¸€ä¸ªäººå’Œä¸€ä¸ªç‹—</p>
<p>å¤šæ•°æ—¶å€™æˆ‘å¼€å¿ƒå¿«ä¹ï¼Œä½†æ˜¯ä¹Ÿæœ‰æ—¶å€™å¿ƒæƒ…ä½è½ï¼Œå´©æºƒå¤§å“­</p>
<p>æˆ‘çƒ­çˆ±æˆ‘çš„å·¥ä½œï¼Œä½†ä¹Ÿæœ‰æ—¶å¼€å§‹ä¼šæƒ³æ€ä¹ˆèƒ½å°‘åŠ ç­</p>
<p>æˆ‘èµšäº†é’±ï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰å­˜ä¸€åˆ†é’±ï¼Œè¿‡ç€ä¸äºå¾…è‡ªå·±å’Œå®¶äººçš„æ—¥å­</p>
<p>æˆ‘å˜äº†å¾ˆå¤šï¼Œä¸å˜çš„æ˜¯æˆ‘è¿˜æ˜¯é‚£ä¸ªå°èƒ–å­ï¼Œæˆ‘ç”šè‡³å·²ç»ä¼šè¯´ä¿çš®è¯</p>
<p>æˆ‘çˆ±æˆ‘çš„å®¶äººï¼Œçˆ±æˆ‘çš„å¦ˆå¦ˆï¼Œä½†æ€»è§‰å¾—è‡ªå·±äºæ¬ å¥¹</p>
<p>æˆ‘è™½ç„¶æ¯å¤©è·Ÿå¥¹æ‰“ç”µè¯ï¼Œä½†æ˜¯å¥¹æ€»æ˜¯è·Ÿæˆ‘éšç’å¥¹çš„å¿ƒäº‹</p>
<p>å·¥ä½œä¸­é‡åˆ°è¿‡ä¸é¡ºçš„æ—¶å€™ï¼Œä»Šå¹´åŒåä¸€é‚£ä¸ªæ˜ŸæœŸï¼Œé‚£ä¸€å¤©ï¼Œæˆ‘è§‰å¾—æ˜¯æˆ‘äººç”Ÿä¸­æœ€éš¾è¿‡çš„ä¸€å¤©</p>
<p>æˆ‘ä¸å¤Ÿå¼ºå¤§</p>
<p>æˆ‘ä»Šå¤©å»äº†æ—¥æœ¬ï¼Œé‡åº†ï¼Œé˜³æ±Ÿï¼Œä¸–ç•Œå¾ˆå¤§ï¼Œæˆ‘ä¹Ÿåœ¨åŠªåŠ›å»çœ‹çœ‹ï¼Œè¿ˆçš„æ­¥å­ä¸å¤§ï¼Œä½†åœ¨å‰è¿›</p>
<p>æˆ‘ä»Šå¹´å·¥ä½œ1å¹´åŠäº†ã€‚ç®—ä¸Šå®ä¹ 2å¹´åŠäº†</p>
<p>æˆ‘ä¾æ—§ä¸åŒ–å¦†ï¼Œç”šè‡³è¿˜é•¿èƒ–äº†5æ–¤</p>
<p>ä¸€ç›´åœ¨åŠªåŠ›æƒ³ç€æ”¹å˜ï¼Œä½†æœ‰æ—¶å€™å¾ˆè®¨åŒè‡ªå·±ä¸ºä»€ä¹ˆä¸æ˜¯é‚£ä¸ªåšæŒä¸æ‡ˆçš„äºº</p>
<p>å·¥ä½œä¸Šè§‰å¾—è‡ªå·±æœ‰è¿›æ­¥ï¼Œä½†æ˜¯è¿˜æœ‰å¾ˆå¤šä¸è¶³ï¼Œæ¸…æ™°å¯è§</p>
<p>æˆ‘åšäº†ä¸€äº›æœ‰æ„ä¹‰çš„äº‹æƒ…ï¼Œæ¯”å¦‚å¸®åŠ©æµæµªç‹—ï¼Œå­¦ä¹ æ€¥æ•‘çŸ¥è¯†</p>
<p>ä¹Ÿåšäº†ä¸€äº›å·¥ä½œä¸Šå¯ä»¥èŠ‚çœåŠ³åŠ¨åŠ›çš„åŠŸèƒ½ï¼Œè™½ç„¶ä¸æ˜¯ KPIï¼Œä½†æ˜¯æˆ‘åšçš„å¾ˆå¼€å¿ƒ</p>
<p>æˆ‘æœ‰ä¸€æ¬¡è¿ç»­ä¸€ä¸ªæ˜ŸæœŸç†¬å¤œï¼Œå°±ç¡å‡ ä¸ªå°æ—¶çš„æ—¶å€™çš„ç»å†</p>
<p>å¤§å§¨å¦ˆè¿˜æ˜¯ä¸€æ ·çš„ç—›çš„æˆ‘æƒ³è·³æ¥¼</p>
<p>æˆ‘å¾ˆçˆ±æˆ‘çš„å°ç‹—ç‹—ï¼Œä½†æ˜¯å®ƒå¥½åƒä¸å¤ªçˆ±æˆ‘ï¼Œæ€»å’¬æˆ‘çš„è¡£æœ</p>
<p>å¤§é¾™å¾ˆæ£’ï¼Œç”Ÿç—…æœ‰ç‚¹å¤š</p>
<p>æˆ‘ä»¬å¼€å§‹ä¸€èµ·ä¼šæ€è€ƒæœªæ¥çš„èŒä¸šå‘å±•</p>
<p>ä¹Ÿæœ‰ä»»æ€§çš„æ—¶å€™ï¼Œä¸€èµ·å“­çš„æ—¶å€™ï¼Œä¸€èµ·ç”Ÿç—…çš„æ—¶å€™</p>
<p>ä»–ç»å†äº†ä¸€ä¸ªæœˆçš„ä½è°·æœŸï¼Œä¸è¿‡ä»–å¾ˆæ£’ï¼Œå¾ˆå¿«å°±è°ƒæ•´è¿‡æ¥</p>
<p>è¿·èŒ«çš„æ—¶å€™ï¼Œæˆ‘ä¼šä¼‘æ¯ä¸€å¤©ï¼Œè°ƒæ•´ä¸€å¤©</p>
<p>æˆ‘å¼€å§‹äº†æ¯å¤©é˜…è¯»è‹±è¯­ï¼Œä½†æ˜¯ä¹Ÿæœ‰æ¼å¤©çš„æ—¶å€™</p>
<p>18å¹´ï¼Œæˆ‘å‡ºäº†ä¸€æ¬¡è½¦ç¥¸ï¼Œæˆ‘ç°åœ¨è¿˜å¾ˆæ¸…æ™°çš„è®°å¾—é‚£ä¸ªæ—¶åˆ»</p>
<p>è¿‡å¥½æ¯ä¸€å¤©å¾ˆé‡è¦ï¼Œå› ä¸ºäººç”ŸçœŸçš„ä¸å¯é¢„æµ‹</p>
<p>åˆšåˆšè·Ÿç»„é‡Œå»åƒäº†ä¸ªé¥­ï¼Œä»Šå¹´é¥­å±€å¾ˆå¤šï¼Œå¾ˆå¼€å¿ƒ</p>
<p>ä»Šå¹´ç»„é‡Œè¿˜æ¥äº†ä¸€ä¸ªå¦¹å­ï¼Œæˆ‘è§‰å¾—è¿™æ˜¯æˆ‘æ˜¥å¤©çš„å¼€å§‹</p>
<p>æˆ‘å†™äº†å¾ˆå¤šæ€»ç»“ä»Šå¹´ï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰å‹‡æ°”å‘åˆ°å…¬å¸ KM ä¸Š</p>
<p>æˆ‘ä»Šå¹´æœ‰è¿›æ­¥ï¼Œæœ‰è®¤çœŸå·¥ä½œï¼Œä¹Ÿæœ‰å¿½ç„¶ä¸æƒ³å¹²çš„æ—¶å€™</p>
<p>é‚£äº›è¿·èŒ«çš„æ—¶å€™ï¼Œæˆ‘æƒ³ä¸ºä»€ä¹ˆä¼šæœ‰äººæ„¿æ„æ¯å¤©ä¸Š12å°æ—¶çš„ç­</p>
<p>é‚£äº›è®¤çœŸå·¥ä½œçš„æ—¶å€™ï¼Œæˆ‘æƒ³ä¸å†™ä»£ç çœŸçš„å¯æƒœäº†</p>
<p>æœ‰çš„æ—¶å€™è§‰å¾—è‡ªå·±æ˜¯ä¸ªèƒ†å°é¬¼</p>
<p>æˆ‘äº«å—æ¯æ¬¡å†™ä¸€æ®µå¾ˆå¥½çš„ä»£ç çš„æ—¶å€™ï¼Œäº«å—æ¯æ¬¡å†™ created by sevencai çš„æ—¶å€™</p>
<p>æˆ‘åœ¨ä¸€å¤©å¤©çš„é•¿å¤§</p>
<p>å¦ˆå¦ˆåœ¨ä¸€å¤©å¤©çš„å˜è€</p>
<p>19å¹´çš„æ—¶å€™ï¼Œæˆ‘å°±24äº†</p>
<p>ä¹Ÿè®¸ä»Šå¹´èƒ½å­˜ç‚¹é’±ï¼Œèƒ½åœ†è€å¦ˆçš„é—¨é¢æ¢¦</p>
<p>å¸Œæœ›å¯¹ PHP,Nodejs æ›´åŠ æ·±å­¦ä¹ </p>
<p>æˆ‘ç°åœ¨å¯¹ä»–ä»¬åªåœç•™åœ¨èƒ½åšå‡ºæ¥ä¸œè¥¿ä¸Šï¼ˆå·¥ç¨‹ä¸Šï¼‰ï¼Œè™½ç„¶å¯¹ä¸€èˆ¬çš„å·¥ä½œæ¥è¯´å¤Ÿç”¨äº†ï¼Œä½†æ›´æ·±å±‚æ¬¡çš„ä¸œè¥¿å¹¶æ²¡æœ‰ä»”ç»†å­¦ä¹ è¿‡ï¼Œå¹¶ä¸”é‡åˆ°é—®èŠ±è´¹çš„æ—¶é—´ä¹Ÿä¼šå¤šäº›</p>
<p>ä¹Ÿè®¸ä»Šå¹´èƒ½ç˜¦ä¸‹æ¥ï¼Œæ”¹æ‰ä¸å‰©é¥­ï¼Œéè¦æŠŠè‡ªå·±åƒæ’‘çš„åæ¯›ç—…</p>
<p>ä¹Ÿè®¸ä»Šå¹´èƒ½å¤Ÿå·¥ä½œé¡ºåˆ©ï¼Œæ˜å¹´è¿™ä¸ªæ—¶å€™ï¼Œè§‰å¾—è‡ªå·±åˆè¿›æ­¥äº†éå¸¸å¤š</p>
<p>ä¹Ÿè®¸å®¶é‡Œäººèº«ä½“éƒ½å¥åº·ï¼Œå¸Œæœ›èº«è¾¹çš„äººéƒ½å¹¸ç¦å¼€å¿ƒ</p>
<p>ä¹Ÿè®¸æˆ‘çš„æ„¿æœ›19å¹´éƒ½ä¼šæˆçœŸ</p>
<p>ä¹Ÿè®¸æˆ‘èƒ½å¤šè¯»ç‚¹ä¹¦</p>
<p>ä¹Ÿè®¸æˆ‘èƒ½æ”¹å˜æ‡’æƒ°</p>
<p>ä¹Ÿè®¸æˆ‘çœŸçš„èƒ½åšæŒä¸‹æ¥åšä¸€ä»¶äº‹æƒ…</p>
<p>ä¹Ÿè®¸æˆ‘èƒ½å˜å¾—æ›´åŠ æœ‰æ•ˆç‡ï¼Œå°‘åŠ ç‚¹ç­</p>
<p>åªè¦æœ‰å¿ƒï¼Œä»è‡ªå·±å¼€å§‹åšå‡ºæ”¹å˜ï¼Œä»å¿ƒé‡Œç”±è¡·çš„å–„è‰¯å’Œå¼€æœ—ï¼ŒåšæŒå’Œè€å¿ƒï¼Œæœªæ¥å¯æœŸï¼Œæˆ‘ä¹Ÿç›¸ä¿¡è‡ªå·±ï¼Œå› ä¸º18å¹´å·²ç»è¿ˆå‡ºäº†ä¸€å°æ­¥äº†ï¼Œä¸æ˜¯å—</p>
<p>å—¯ï¼Œä»Šå¤©æ˜¯2018çš„æœ€åä¸€å¤©ï¼Œå¤©æ°”å¾ˆå†·</p>
<p>2019ï¼Œæˆ‘å‡†å¤‡å¥½äº†ï¼Œä½ æ¥å§ï¼Œå˜»å˜»ğŸŒ¹</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;2018å¹´å·²ç»æ˜¯è¿‡å»&lt;/p&gt;
&lt;p&gt;å°æ—¶å€™å°è±¡æœ€æ·±çš„ä¸€å¹´æ˜¯2008å¹´&lt;/p&gt;
&lt;p&gt;é‚£ä¸€å¹´å¼€äº†è¿åŠ¨ä¼š&lt;/p&gt;
&lt;p&gt;é‚£ä¸€å¹´è·Ÿçˆ¸çˆ¸å»äº†åŒ—äº¬&lt;/p&gt;
&lt;p&gt;é‚£ä¸€å¹´å¦ˆå¦ˆ40å²&lt;/p&gt;
&lt;p&gt;é‚£ä¸€å¹´æˆ‘13å²&lt;/p&gt;
&lt;p&gt;é‚£ä¸€å¹´ä¸‹äº†å¤§é›ª&lt;/p&gt;
&lt;p&gt;é‚£ä¸€å¹´æ±¶å·åœ°éœ‡&lt;/p&gt;
&lt;p&gt;
    
    </summary>
    
    
      <category term="ç”Ÿæ´»" scheme="http://sevencai.github.io/tags/%E7%94%9F%E6%B4%BB/"/>
    
  </entry>
  
  <entry>
    <title>import or require?</title>
    <link href="http://sevencai.github.io/2018/12/05/import-or-require/"/>
    <id>http://sevencai.github.io/2018/12/05/import-or-require/</id>
    <published>2018-12-05T13:25:18.000Z</published>
    <updated>2018-12-05T07:16:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹æ‰€ä»¥ä¼šå»å†™è¿™ä¸ªï¼Œæ˜¯å› ä¸ºè‡ªå·±æœ€è¿‘é‡åˆ°äº† import çš„ä¸€ä¸ªé—®é¢˜ã€‚</p>
<p>æ‰¾é—®é¢˜çš„è¿‡ç§°ä¸­ï¼Œå‘ç°è‡ªå·±è™½ç„¶ä¸€ç›´åœ¨ç”¨ importï¼Œä½†å¯¹ require/import çš„åŒºåˆ«å¹¶æ²¡æœ‰äº†è§£çš„å¾ˆå…¨é¢ã€‚</p>
<p>å…·ä½“çš„ç‚¹å°±åœ¨ <code>Imports are hoisted</code>ã€‚è¶æ­¤æœºä¼šå¤§æ¦‚çš„é‡æ–°æ€»ç»“ä¸‹ã€‚</p>
<hr>
<h2 id="å†å²è¿½æº¯"><a href="#å†å²è¿½æº¯" class="headerlink" title="å†å²è¿½æº¯"></a>å†å²è¿½æº¯</h2><blockquote>
<p>äº†è§£å†å²ï¼Œä¸ä¸€å®šæ˜¯ä½¿ç”¨å†å²ï¼Œå´å¯ä»¥å¯¹æ•´ä½“çš„çŸ¥è¯†æœ‰ä¸ªå¤§è‡´çš„è®¤è¯†ã€‚æˆ‘è‡ªå·±æ²¡æœ‰ç»å†è¿‡ <code>SeaJS/RequireJS</code> æ—¶ä»£ï¼Œæ‰€ä»¥å¯¹å®ƒé‡Œé¢å…·ä½“çš„åŸç†å®ç°å’Œç”¨æ³•ä¸æ˜¯ç‰¹åˆ«ç†Ÿæ‚‰ã€‚åªæ˜¯çœ‹åˆ°ç»„é‡Œä»¥å‰åŒäº‹çš„æ—§ä»£ç ï¼Œæ‰å‘ç°é‚£å‡ å¹´ç¡®å®å¯èƒ½å¾ˆç«ã€‚</p>
</blockquote>
<p>å…³äº CommonJS, RequireJS, SeaJS , æˆ‘å¤§è‡´çš„ç”»äº†å¦‚ä¸‹ä¸€ä¸ªå›¾æ¥æè¿°ï¼š</p>
<p><img src="understandstandard.png" alt="å…³ç³»å›¾"></p>
<p>æ€»ç»“ä¸ºä¸‹é¢å‡ ç‚¹ï¼š</p>
<ol>
<li><code>CommonJS</code> å›  <code>Nodejs</code> è€Œç”Ÿï¼Œæ˜¯ <strong><code>Nodejs çš„è§„èŒƒ</code></strong>ï¼Œä¸€ç›´æ²¿ç”¨è‡³ä»Šã€‚</li>
<li>ç”±äºæµè§ˆå™¨ç«¯ä¹Ÿéœ€è¦æ¨¡å—åŒ–çš„åŸå› ï¼Œç”± <code>CommonJS</code> è¡ç”Ÿå‡ºæ¥äº† AMD å’Œ CMD è§„èŒƒã€‚</li>
<li>åŸºäº AMD/CMD è§„èŒƒï¼Œå‡ºç°äº†ä¸¤ä¸ªåŸºäºæ­¤è§„èŒƒçš„åº“ã€‚åˆ†åˆ«æ˜¯ <code>RequireJS</code>, <code>SeaJS</code>ã€‚</li>
<li><code>RequireJS</code> æ˜¯ AMD çš„è§„èŒƒã€‚ç‰¹ç‚¹æ˜¯ï¼š<strong>æå‰åŠ è½½</strong>ã€‚</li>
<li><code>SeaJS</code> æ˜¯ CMD çš„è§„èŒƒã€‚ç‰¹ç‚¹æ˜¯ï¼šæŒ‰éœ€åŠ è½½ã€‚<strong>ç”¨åˆ°æ—¶æ‰åŠ è½½</strong>ã€‚</li>
<li>ç°åœ¨æ–°çš„æ ‡å‡† <code>ES6 import/export</code> å‡ºç°ï¼Œä½†æ˜¯å¾ˆå¤šæµè§ˆå™¨è¿˜æœªå®ç°ï¼Œæ‰€ä»¥æœ€ç»ˆè¿˜æ˜¯éœ€è¦ç”¨ <strong>babel è½¬æ¢æˆ CommonJS</strong>ã€‚</li>
<li><code>import/export</code> æ˜¯å¤§åŠ¿æ‰€è¶‹ã€‚</li>
</ol>
<p>å…·ä½“çš„æƒ³çœ‹ AMD/CMD çš„åŒºåˆ«ï¼Œå¯ä»¥å‚è€ƒ 16 å¹´æˆ‘æ€»ç»“çš„æ–‡ä»¶ã€‚<a href="https://sevencai.github.io/2016/02/18/AMD%E5%92%8CCMD%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E8%81%94%E7%B3%BB/">AMDå’ŒCMDçš„åŒºåˆ«å’Œè”ç³»</a>ã€‚</p>
<hr>
<h2 id="import-require-åŒºåˆ«-Commonjs-pk-ES6"><a href="#import-require-åŒºåˆ«-Commonjs-pk-ES6" class="headerlink" title="import / require åŒºåˆ« (Commonjs pk ES6)"></a>import / require åŒºåˆ« (Commonjs pk ES6)</h2><p><img src="requireimport.png" alt="require pk import"></p>
<h3 id="å†™æ³•ä¸åŒ"><a href="#å†™æ³•ä¸åŒ" class="headerlink" title="å†™æ³•ä¸åŒ"></a>å†™æ³•ä¸åŒ</h3><p>CommonJS çš„æ¨¡å—åŒ–ï¼Œrequire/exports åŸºæœ¬ä¸Šåªæœ‰ä¸‹é¢è¿™å‡ ç§å†™æ³•ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">exports.fs = fs</span><br><span class="line"><span class="built_in">module</span>.exports = fs</span><br><span class="line"></span><br><span class="line">fs.readFileSync(path)</span><br></pre></td></tr></table></figure></p>
<p>import çš„å†™æ³•å¤šç§å¤šæ ·ï¼Œæ¯”å¦‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> cookie <span class="keyword">from</span> <span class="string">'./cookie'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; getCookie, setCookie &#125; <span class="keyword">from</span> <span class="string">'./cookie'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cookie, &#123; getCookie &#125; <span class="keyword">from</span> <span class="string">'./cookie'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‹é¢ä¸¤è€…ç›¸åŒ</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> cookie &#125; <span class="keyword">from</span> <span class="string">'./cookie'</span></span><br><span class="line"><span class="keyword">import</span> cookie <span class="keyword">from</span> <span class="string">'./cookie'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> cookie</span><br><span class="line"><span class="keyword">export</span> cookie</span><br><span class="line"><span class="keyword">export</span> &#123; getCookie, setCookie &#125;</span><br></pre></td></tr></table></figure></p>
<p>ç­‰ç­‰å†™æ³•ã€‚ import æ¯”è¾ƒçµæ´»ï¼Œå¹¶ä¸”æ”¯æŒéƒ¨åˆ†æ¨¡å—çš„å¯¼å…¥ã€‚ä¸åƒ require å…¨éƒ¨å¯¼å…¥ã€‚</p>
<h3 id="åŠ è½½é¡ºåºä¸åŒ-Imports-are-hoisted"><a href="#åŠ è½½é¡ºåºä¸åŒ-Imports-are-hoisted" class="headerlink" title="åŠ è½½é¡ºåºä¸åŒ - Imports are hoisted"></a>åŠ è½½é¡ºåºä¸åŒ - Imports are hoisted</h3><p>ES6 æ¨¡å—æ˜¯ç¼–è¯‘æ—¶åŠ è½½ï¼Œä½¿å¾—é™æ€åˆ†ææˆä¸ºå¯èƒ½ã€‚</p>
<p>import ä¼šæå‰åŠ è½½ï¼Œç±»ä¼¼äº JS é‡Œçš„æ¦‚å¿µ å˜é‡æå‡ã€‚ä¹Ÿå°±å¯ä»¥ç†è§£ä¸º import æ€»è¢«å…ˆç§»åˆ°ä¸Šé¢å»æ‰§è¡Œã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config.js</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'in config'</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; <span class="attr">port</span>: <span class="number">80</span> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'begin load'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> config <span class="keyword">from</span> <span class="string">'./config'</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'load finished'</span>)</span><br></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œ main.js å°†è¿”å›ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">in</span> config</span><br><span class="line">begin load</span><br><span class="line">load finished</span><br></pre></td></tr></table></figure></p>
<p>ä¹Ÿå°±æ˜¯è¯´è¿™ä¹ˆå†™ä¸ä¼šæŠ¥é”™ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">renderData()</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; renderData &#125; <span class="keyword">from</span> <span class="string">'../util'</span></span><br></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯è¿™ä¹ˆå†™ä¼šæŠ¥é”™ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// æŠ¥é”™</span><br><span class="line">if (x === true) &#123;</span><br><span class="line">  import MyModual from &apos;./myModual&apos;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">import x+var from &apos;./&apos; + filename</span><br></pre></td></tr></table></figure></p>
<p>import æ˜¯åœ¨ç¼–è¯‘æ—¶ï¼Œif è¿™äº›è¯­å¥éƒ½ä¼šè¢«å¿½ç•¥ï¼Œä¼šè¢«æåˆ°æœ€ä¸Šé¢ã€‚å› æ­¤ä¼šæŠ¥è¯­æ³•é”™è¯¯ï¼Œè€Œä¸æ˜¯æ‰§è¡Œçš„é”™è¯¯ã€‚æ‰€ä»¥import export æœ€å¥½å°±æ”¾åœ¨æœ€é¡¶å±‚ã€‚ä¸è¦åœ¨å‡½æ•°æˆ–è€…æ¡ä»¶è¯­å¥ä¸­ã€‚</p>
<p>require æ˜¯éé™æ€ç¼–è¯‘ç±»å‹ã€‚æ˜¯ CommonsJS è¿™ç§ï¼Œè¿è¡Œæ—¶åŠ è½½,æ‰€ä»¥å¯ä»¥åŠ¨æ€å»æ‹¼æ¥æ¨¡å—ã€‚</p>
<p>å¯¹äºRequireæ¥è¯´è¿è¡Œç»“æœå°±æ˜¯ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config.js</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'in config'</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;<span class="attr">port</span>: <span class="number">80</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'begin load'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> config = <span class="built_in">require</span>(<span class="string">'./config.mjs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'load finished'</span>)</span><br></pre></td></tr></table></figure></p>
<p>å¾—åˆ°çš„ç»“æœï¼Œè·Ÿæˆ‘ä»¬çš„é¢„æœŸç›¸åŒã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">begin load</span><br><span class="line">in config</span><br><span class="line">load finished</span><br></pre></td></tr></table></figure></p>
<h3 id="Imports-åªå¯è¯»-Imports-are-read-only-views-on-exports"><a href="#Imports-åªå¯è¯»-Imports-are-read-only-views-on-exports" class="headerlink" title="Imports åªå¯è¯» - Imports are read-only views on exports"></a>Imports åªå¯è¯» - Imports are read-only views on exports</h3><p>è¿™ç‚¹å¯ä»¥é˜…è¯»è¿™ä¸ªæ–‡æ¡£ï¼š<a href="http://exploringjs.com/es6/ch_modules.html#sec_imports-as-views-on-exports" target="_blank" rel="noopener">è®²çš„å¾ˆæ¸…æ¥š</a>ã€‚çœ‹ä¸ªä¾‹å­ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// counter.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> counter = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">incCounter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  counter++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; counter, incCounter &#125; <span class="keyword">from</span> <span class="string">'./counter'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The imported value `counter` is live</span></span><br><span class="line"><span class="built_in">console</span>.log(counter); <span class="comment">// 3</span></span><br><span class="line">incCounter();</span><br><span class="line"><span class="built_in">console</span>.log(counter); <span class="comment">// 4</span></span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢è¿™ç§æ˜¯okçš„ï¼Œä½†æ˜¯ä¸‹é¢è¿™ç§æ˜¯ä¸åˆæ³•çš„ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; counter, incCounter &#125; <span class="keyword">from</span> <span class="string">'./counter'</span>;</span><br><span class="line"></span><br><span class="line">counter++ <span class="comment">// TypeError</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>Note that while you canâ€™t change the values of imports, you can change the objects that they are referring to. For example:</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lib.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; obj &#125; <span class="keyword">from</span> <span class="string">'./lib'</span>;</span><br><span class="line"></span><br><span class="line">obj.prop = <span class="number">123</span>; <span class="comment">// OK</span></span><br><span class="line">obj = &#123;&#125;; <span class="comment">// TypeError</span></span><br></pre></td></tr></table></figure>
<p>è¿™ç‚¹æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºï¼Œå˜é‡çš„åœ°å€æ˜¯ä¸èƒ½æ”¹å˜çš„ï¼Œé‡æ–°èµ‹å€¼æ—¶ï¼Œå˜é‡çš„åœ°å€å˜äº†ï¼Œè¿™ä¸ªä¸å…è®¸ï¼Œä½†æ˜¯ä½ å¦‚æœæ”¹å˜å¯¹è±¡çš„é‡Œé¢å±æ€§çš„å€¼ï¼Œåœ°å€æ˜¯ä¸å˜çš„ã€‚</p>
<p>è¿™ä¸ªå°±åƒä½ å£°æ˜ä¸€ä¸ª const obj, ä¹Ÿå¯ä»¥æ›´æ”¹ Obj.value ä¸€æ ·ã€‚</p>
<p>Require ä¸åŒï¼Œä½ å¯ä»¥ä¿®æ”¹é‡Œé¢çš„å†…å®¹ã€‚</p>
<p>æ¨èæ–‡ç« ï¼š <a href="http://es6.ruanyifeng.com/#docs/module" target="_blank" rel="noopener">ruanyifeng-es6-module</a></p>
<h3 id="å€¼å¼•ç”¨-or-å€¼æ‹·è´"><a href="#å€¼å¼•ç”¨-or-å€¼æ‹·è´" class="headerlink" title="å€¼å¼•ç”¨ or å€¼æ‹·è´"></a>å€¼å¼•ç”¨ or å€¼æ‹·è´</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// counter.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> count = <span class="number">0</span></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'increase count to'</span>, ++count, <span class="string">'in counter.js after 500ms'</span>)</span><br><span class="line">&#125;, <span class="number">500</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123;count&#125; <span class="keyword">from</span> <span class="string">'./counter.mjs'</span></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'read count after 1000ms in es6 is'</span>, count)</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°çš„ç»“æœæ˜¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">increase count to 1 in counter.js after 500ms</span><br><span class="line">read count after 1000ms in es6 is 1</span><br></pre></td></tr></table></figure></p>
<p>å¦å¤–ä¸€æ®µä»£ç <br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// counter.js</span></span><br><span class="line">exports.count = <span class="number">0</span></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'increase count to'</span>, ++exports.count, <span class="string">'in counter.js after 500ms'</span>)</span><br><span class="line">&#125;, <span class="number">500</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">const</span> &#123;count&#125; = <span class="built_in">require</span>(<span class="string">'./counter'</span>)</span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'read count after 1000ms in commonjs is'</span>, count)</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure></p>
<p>å¾—åˆ°çš„ç»“æœæ˜¯ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">increase count to <span class="number">1</span> <span class="keyword">in</span> counter.js after <span class="number">500</span>ms</span><br><span class="line">read count after <span class="number">1000</span>ms <span class="keyword">in</span> commonjs is <span class="number">0</span></span><br></pre></td></tr></table></figure></p>
<p>å¤§æ¦‚çš„æ„æ€å…¶å®å°±æ˜¯ï¼š<strong>CommonJSæ¨¡å—æ˜¯è¿è¡Œè¾“å‡º(åŠ è½½)ä¸€ä¸ªå€¼(æˆ–å¯¹è±¡)çš„æ‹·è´ï¼Œè€ŒES6æ¨¡å—åˆ™æ˜¯ç¼–è¯‘æ—¶è¾“å‡º(åŠ è½½)ä¸€ä¸ªå€¼çš„å¼•ç”¨(æˆ–è€…å«åšè¿æ¥).</strong></p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬åœ°æµ‹è¯• import æ—¶å¯ä»¥ä½¿ç”¨ <strong><code>--experimental-modules</code> å®éªŒæ¨¡å—æ ‡å¿—æ¥å¯ç”¨åŠ è½½ <code>ECMAScript Modules</code> çš„ç‰¹æ€§</strong>ã€‚</p>
<p>ä½œä¸ºESæ¨¡å—åŠ è½½çš„æ–‡ä»¶åï¼Œé¡»ä»¥.mjsåç¼€ç»“å°¾</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">node --experimental-modules app.mjs</span><br><span class="line"></span><br><span class="line">// æ­¤ç§æ–¹æ³•ï¼Œåœ¨è¾“å‡ºçš„æ—¶å€™ä¼šæç¤ºï¼š</span><br><span class="line">(node:6527) ExperimentalWarning: The ESM module loader is experimental.</span><br></pre></td></tr></table></figure>
<p>çº¿ä¸Šç¯å¢ƒè¿˜æ˜¯ç”¨ babel å»è½¬ ~</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¹‹æ‰€ä»¥ä¼šå»å†™è¿™ä¸ªï¼Œæ˜¯å› ä¸ºè‡ªå·±æœ€è¿‘é‡åˆ°äº† import çš„ä¸€ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æ‰¾é—®é¢˜çš„è¿‡ç§°ä¸­ï¼Œå‘ç°è‡ªå·±è™½ç„¶ä¸€ç›´åœ¨ç”¨ importï¼Œä½†å¯¹ require/import çš„åŒºåˆ«å¹¶æ²¡æœ‰äº†è§£çš„å¾ˆå…¨é¢ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“çš„ç‚¹å°±åœ¨ &lt;code&gt;Imports are hoiste
    
    </summary>
    
    
      <category term="Javascript" scheme="http://sevencai.github.io/tags/Javascript/"/>
    
  </entry>
  
  <entry>
    <title>async await åšäº†ä»€ä¹ˆäº‹æƒ…</title>
    <link href="http://sevencai.github.io/2018/12/03/async-await-%E5%81%9A%E4%BA%86%E4%BB%80%E4%B9%88%E4%BA%8B%E6%83%85/"/>
    <id>http://sevencai.github.io/2018/12/03/async-await-åšäº†ä»€ä¹ˆäº‹æƒ…/</id>
    <published>2018-12-03T13:10:02.000Z</published>
    <updated>2018-12-04T04:04:16.000Z</updated>
    
    <content type="html"><![CDATA[<p>ç»„é‡Œçš„ä¸€ä¸ªæœ‰è¶£åˆå¾ˆä¸¥è°¨çš„åŒäº‹ï¼Œä»Šå¤©åœ¨çº ç»“ä¸€ä¸ªä¸çœ‹èµ·æ¥æ˜¯é—®é¢˜çš„é—®é¢˜ï¼Œå…¶å®è¿™ç§æ„Ÿè§‰å°±åƒä½ ç»å¸¸è¿™ä¹ˆç”¨æˆ–è€…è¿™ä¹ˆæƒ³çš„ä¸€ä¸ªä¸œè¥¿ï¼ŒæŸä¸€å¤©æŸä¸ªæ—¶åˆ»ï¼Œä½ çªç„¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆäº†ï¼Œå°±åƒæˆ‘å¶å°”ä¼šå»çº ç»“ä¸ºä»€ä¹ˆæŸä¸ªæ±‰å­—æ˜¯è¿™æ ·å†™ï¼š</p>
<p><img src="testasyncawait.png" alt="é—®é¢˜"></p>
<p>ä»–è®¤ä¸ºæœ€ååº”è¯¥ res === b,è€Œä¸æ˜¯ res === a, æˆ‘è®¤ä¸ºå¾ˆæ˜æ˜¾åº”è¯¥ res === a, å› ä¸ºå¤§å®¶å¹³æ—¶ä¸€ç›´éƒ½æ˜¯è¿™ä¹ˆç”¨çš„, ä½†æ˜¯è·Ÿä»–è®²ç†ç”±çš„æ—¶å€™ï¼Œç«Ÿç„¶è¯­å¡äº†ã€‚</p>
<hr>
<h2 id="å…³äº-async-ğŸš¶"><a href="#å…³äº-async-ğŸš¶" class="headerlink" title="å…³äº async ğŸš¶"></a>å…³äº async ğŸš¶</h2><p>äºæ˜¯æˆ‘å»æ‰¾äº†ä¸€æ®µ MDN ä¸Šçš„è§£é‡Šï¼š</p>
<blockquote>
<p>å½“è°ƒç”¨ä¸€ä¸ª async å‡½æ•°æ—¶ï¼Œ<strong>ä¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡</strong>ã€‚å½“è¿™ä¸ª async å‡½æ•°è¿”å›ä¸€ä¸ªå€¼æ—¶ï¼Œ<strong>Promise çš„ resolve æ–¹æ³•ä¼šè´Ÿè´£ä¼ é€’è¿™ä¸ªå€¼</strong>ï¼›å½“ async å‡½æ•°æŠ›å‡ºå¼‚å¸¸æ—¶ï¼ŒPromise çš„ reject æ–¹æ³•ä¹Ÿä¼šä¼ é€’è¿™ä¸ªå¼‚å¸¸å€¼ã€‚</p>
</blockquote>
<p>ä¸Šé¢è¿™å¥è¯æˆ‘ç”¨ä¸¤ä¸ªç²—ä½“æ ‡æ˜äº†ä¸¤å¥è¯ï¼Œç¬¬ä¸€å¥è¯æ„æ€æ˜æ˜¾ï¼Œæ„ä¸ºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è°ƒç”¨ test() å¾—åˆ°çš„æ˜¯ä¸€ä¸ª Promise, ä¹Ÿå°±æ˜¯æ— è®ºå‡½æ•°å†…è¿”å›ï¼ˆreturnï¼‰çš„æ˜¯ä»€ä¹ˆï¼ˆå¸¸é‡ or å­—ç¬¦ä¸² or Promise or å…¶å®ƒï¼‰ï¼Œ async æ€»ä¼šç”¨ <code>Promise.resolve</code> åŒ…ä¸€å±‚ï¼Œå¦‚è‹¥ async é‡Œé¢æœ‰å¼‚å¸¸ï¼Œ ä¼š <code>throw Error</code>ã€‚</strong></p>
<p><strong>å¦‚æœ test å†…ä»€ä¹ˆéƒ½ä¸è¿”å›ï¼Œä¹Ÿä¼šå¾—åˆ° <code>Promise.resolve(undefined)</code>, æ€»ä¹‹ async æ€»è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚</strong></p>
<p>å†çœ‹åé¢ä¸€å¥è§£é‡Šï¼š Promise çš„ resolve æ–¹æ³•ä¼šè´Ÿè´£ä¼ é€’è¿™ä¸ªå€¼ï¼›</p>
<p>å“‡ï¼Œæ˜¯ä¸æ˜¯çªç„¶é—´è§‰å¾—æˆ‘åŒäº‹ç–‘æƒ‘çš„æ˜¯å¯¹çš„äº†ã€‚å…¶å®ä¸è¦å—è¿™å¥è¯çš„å½±å“ã€‚å®ƒè¯´çš„ä¼ é€’ï¼Œå…¶å®å°±æ˜¯returnè¿‡å»çš„æ—¶å€™æ˜¯ä¼ é€’çš„ã€‚æ€»ç»“ä¸‹ï¼š æˆ‘ä»¬å°±ç†è§£ä¸ºï¼šasync è¿”å›äº†ä¸€ä¸ªåŒ…å«æ”¹å€¼çš„ Promiseã€‚</p>
<p>åˆ†æä¸‹é¢è¿™æ®µä»£ç çš„æ‰§è¡Œï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test()</span><br><span class="line">    .then(<span class="function"><span class="params">res</span> =&gt;</span> res === a)</span><br><span class="line">    <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆ <code>test().then(a =&gt; { a === {} })</code> åˆæ˜¯å¯¹çš„äº†å‘¢ï¼Ÿ ä¸æ˜¯è¯´è¿”å›äº†ä¸€ä¸ª Promise å—ï¼Ÿ æ€ä¹ˆåˆæ˜¯ä¸€ä¸ªå¯¹è±¡å€¼äº†ï¼Ÿ(æ³¨æ„è¿™é‡Œæ˜¯å€¼å¼•ç”¨ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¿™ä¹ˆæ¯”è¾ƒ)</p>
<p><strong>è¿™æ˜¯å› ä¸º <code>Promise.then</code> é‡Œé¢ä¼šåœ¨é‡æ–°æ¥æ”¶è¿™ä¸ªå€¼çš„æ—¶å€™ï¼Œå¾—åˆ°çš„ä¸å†æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ªè¢«è§£æè¿‡äº†çš„å€¼</strong>ã€‚ ä¹Ÿå°±æ˜¯è¯´ä¸‹é¢è¿™æ®µä»£ç çš„å«ä¹‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.then(<span class="function"><span class="params">r</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// è¿”å›ä¸€ä¸ª Promise ï¼Œå†…å®¹ä¸º statusCode 404</span></span><br><span class="line">    <span class="keyword">return</span> getServerStatusCode(r);</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// res ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä¸æ˜¯ä¸€ä¸ª Promise, å› ä¸ºå·²ç»è¢«è§£æè¿‡äº†</span></span><br><span class="line">    <span class="built_in">console</span>.log(res.statusCode);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ—¶å€™ï¼Œä½  then é‡Œé¢çš„å€¼ï¼Œå°±è·Ÿä½ ç”¨ await å¾—åˆ°çš„ä¸€æ ·äº†ã€‚</p>
<hr>
<h2 id="å…³äº-await-ğŸ‘‚"><a href="#å…³äº-await-ğŸ‘‚" class="headerlink" title="å…³äº await ğŸ‘‚"></a>å…³äº await ğŸ‘‚</h2><p>await ç­‰å¾…çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<blockquote>
<p>await  æ“ä½œç¬¦ç”¨äºç­‰å¾…ä¸€ä¸ªPromise å¯¹è±¡ã€‚å®ƒåªèƒ½åœ¨å¼‚æ­¥å‡½æ•° <code>async function</code> ä¸­ä½¿ç”¨ã€‚</p>
</blockquote>
<p>ä¸Šé¢æ˜¯ MDN é‡Œçš„è¯´æ˜ï¼Œæˆ‘è§‰å¾—ä¸å¤ªå¯¹ï¼Œ await ä¸ä¸€å®šæ˜¯ç­‰å¾…ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå®ƒè¦ç­‰å¾…çš„æ˜¯<strong>ä¸€ä¸ª Promise å¯¹è±¡æˆ–è€…ä»»ä½•è¦ç­‰å¾…çš„å€¼ã€‚</strong>ã€‚</p>
<p>å¦‚æœå®ƒç­‰å¾…çš„ä¸æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¦‚ await 3 , é‚£ä¹ˆè¡¨è¾¾å¼çš„è¿ç®—ç»“æœå°±æ˜¯å®ƒç­‰å¾…çš„ä¸œè¥¿ã€‚</p>
<p>å¦‚æœå®ƒç­‰å¾…çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œ å¦‚ <code>await Promise.resolve(3)</code>, é‚£ä¹ˆ await ä¼šé˜»å¡åé¢çš„ä»£ç ï¼Œç­‰å¾… Promise å¯¹è±¡ <code>resolve or reject</code>ã€‚</p>
<p>çœ‹ä¸‹ä¸‹é¢è¿™ç§æƒ…å†µï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="built_in">Promise</span>.reject(&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">abc</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> a &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> obj = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        obj = <span class="keyword">await</span> abc()</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"err"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"main"</span>, obj === a) <span class="comment">// false</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"test"</span>, obj === &#123;&#125;) <span class="comment">// false</span></span><br><span class="line">    <span class="built_in">console</span>.log(obj) <span class="comment">// null</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(obj) === <span class="built_in">JSON</span>.stringify(a))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜æ˜¾ï¼Œ obj æ˜¯ç­‰äº null çš„ï¼Œå› ä¸º await ç­‰å¾…çš„æ˜¯ä¸€ä¸ª reject çš„ç»“æœã€‚å¯¼è‡´äº†å¼‚å¸¸è¢«æŠ›å‡ºæ¥äº†ã€‚æ‰€ä»¥èµ‹å€¼ç­‰å·¥ä½œéƒ½æ²¡æœ‰è¿›è¡Œã€‚</p>
<blockquote>
<p>await è¡¨è¾¾å¼ä¼šæš‚åœå½“å‰ <code>async function</code> çš„æ‰§è¡Œï¼Œç­‰å¾… Promise å¤„ç†å®Œæˆã€‚è‹¥ Promise æ­£å¸¸å¤„ç†(fulfilled)ï¼Œå…¶å›è°ƒçš„resolveå‡½æ•°å‚æ•°ä½œä¸º await è¡¨è¾¾å¼çš„å€¼ï¼Œç»§ç»­æ‰§è¡Œ <code>async function</code>ã€‚</p>
<p>è‹¥ Promise å¤„ç†å¼‚å¸¸(rejected)ï¼Œawait è¡¨è¾¾å¼ä¼šæŠŠ Promise çš„<strong>å¼‚å¸¸åŸå› æŠ›å‡º</strong>ã€‚</p>
<p>å¦å¤–ï¼Œå¦‚æœ await æ“ä½œç¬¦åçš„è¡¨è¾¾å¼çš„å€¼ä¸æ˜¯ä¸€ä¸ª Promiseï¼Œåˆ™è¿”å›è¯¥å€¼æœ¬èº«ã€‚</p>
</blockquote>
<p>MDN çš„è§£é‡Šè·Ÿæˆ‘ä»¬ç†è§£çš„ç›¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´ <strong>await å¦‚æœå¾—åˆ°çš„æ˜¯ä¸€ä¸ª reject çš„ç»“æœï¼Œä¼šç›´æ¥ throw ä¸€ä¸ª Error å‡ºæ¥ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸ºäº†é¿å…æŠ¥é”™ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ <code>async await</code> è¿›è¡Œ <code>try catch</code> çš„åŸå› </strong>ã€‚</p>
<hr>
<h2 id="ä½¿ç”¨-async-await-è¦æ³¨æ„çš„åœ°æ–¹"><a href="#ä½¿ç”¨-async-await-è¦æ³¨æ„çš„åœ°æ–¹" class="headerlink" title="ä½¿ç”¨ async await è¦æ³¨æ„çš„åœ°æ–¹"></a>ä½¿ç”¨ async await è¦æ³¨æ„çš„åœ°æ–¹</h2><p>async await è®¾è®¡æœ¬èº«æ˜¯ä¸ºäº†è®©æˆ‘ä»¬é˜²æ­¢åœ°ç‹±å›è°ƒçš„ï¼Œä½†æ˜¯æ˜¯ä¸èƒ½å¤Ÿæ»¥ç”¨ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªå¾ˆç»å…¸çš„ä¾‹å­ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> pizza = <span class="keyword">await</span> selectPizza()</span><br><span class="line">  <span class="keyword">const</span> drink = <span class="keyword">await</span> selectDrink()</span><br><span class="line"></span><br><span class="line">  order(pizza, drink); <span class="comment">// async call</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢çš„ <code>getPizzaInfo</code> å’Œ <code>getDrinkInfo</code> å®é™…å¹¶æ²¡æœ‰ä»»ä½•ä¾èµ–å…³ç³»ï¼Œè¿™ä¹ˆå†™è¿˜å¢åŠ äº†ç­‰å¾…çš„æ—¶é—´ã€‚æ‰€ä»¥åœ¨ç”¨ async await çš„æ—¶å€™ï¼Œä¸€å®šè¦å……åˆ†ç†è§£ä»–ä»¬çš„å…³ç³»ã€‚å¯ä»¥ä¼˜åŒ–å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> pizzaPromise = selectPizza();</span><br><span class="line">  <span class="keyword">const</span> drinkPromise = selectDrink();</span><br><span class="line">  <span class="keyword">const</span> pizza = <span class="keyword">await</span> pizzaPromise;</span><br><span class="line">  <span class="keyword">const</span> drink = <span class="keyword">await</span> drinkPromise;</span><br><span class="line">  order(pizza, drink); <span class="comment">// async call</span></span><br><span class="line">&#125;)();</span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="built_in">Promise</span>.all([selectPizza(), selectDrink()]).then(order); <span class="comment">// async call</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>å†ä¸¾ä¸ªä¾‹å­ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  b();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">c(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  d();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>æœ€åå†™æˆäº†ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> a();</span><br><span class="line"><span class="keyword">await</span> b();</span><br><span class="line"><span class="keyword">await</span> c();</span><br><span class="line"><span class="keyword">await</span> d();</span><br></pre></td></tr></table></figure></p>
<p>è¿™ç§åŸæœ¬ d åªéœ€è¦ç­‰å¾… c çš„ï¼Œç»“æœå˜æˆè¦ç­‰å¾… a,b,cã€‚ æ—¶é—´æ…¢äº†å¾ˆå¤šã€‚æ€§èƒ½ä¸å¥½ã€‚ç¨æ”¹ä¸€ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> aPromise = a()</span><br><span class="line"><span class="keyword">const</span> cPromise = c()</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> aPromise()</span><br><span class="line">b()</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> cPromise()</span><br><span class="line">d()</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ä¼šç¨å¾®å¥½ç‚¹äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œ dç”±åŸæ¥çš„éœ€è¦ç­‰å¾… c, å˜æˆäº†éœ€è¦ç­‰å¾… a,c(å¦‚æœaçš„è¿”å›æ—¶é—´è¦å¤§äºc)</p>
<p>æ‰€ä»¥å¯ä»¥æ”¹æˆä¸‹é¢è¿™ä¸¤ç§æ–¹å¼ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span>() &#123;</span><br><span class="line">    <span class="keyword">await</span> a()</span><br><span class="line"></span><br><span class="line">    b()</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span>() &#123;</span><br><span class="line">    <span class="keyword">await</span> c()</span><br><span class="line"></span><br><span class="line">    d()</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…æ”¹ä¸º</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all([a(), c()])</span><br><span class="line">    .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Promise</span>.all([b(), d()])</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure></p>
<p>æ€»ä¹‹ç”¨ async, await çš„æ—¶å€™å¾—å¤šæƒ³æƒ³ã€‚</p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ‰å¥½å¥‡å¿ƒå’Œæ¢ç´¢çŸ¥è¯†çš„æ¬²æœ›æ˜¯å¥½äº‹ï¼Œå½“åˆ«äººé—®ä½ çš„é—®é¢˜çš„æ—¶å€™ï¼Œå¦‚æœä½ ä¸èƒ½æŠŠåˆ«äººè§£é‡Šæ¸…æ¥šçš„æ—¶å€™ï¼Œé‚£ä¹ˆå¯èƒ½ä»–çš„é—®é¢˜åŒæ ·å°±æ˜¯ä½ çš„é—®é¢˜~</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»„é‡Œçš„ä¸€ä¸ªæœ‰è¶£åˆå¾ˆä¸¥è°¨çš„åŒäº‹ï¼Œä»Šå¤©åœ¨çº ç»“ä¸€ä¸ªä¸çœ‹èµ·æ¥æ˜¯é—®é¢˜çš„é—®é¢˜ï¼Œå…¶å®è¿™ç§æ„Ÿè§‰å°±åƒä½ ç»å¸¸è¿™ä¹ˆç”¨æˆ–è€…è¿™ä¹ˆæƒ³çš„ä¸€ä¸ªä¸œè¥¿ï¼ŒæŸä¸€å¤©æŸä¸ªæ—¶åˆ»ï¼Œä½ çªç„¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆäº†ï¼Œå°±åƒæˆ‘å¶å°”ä¼šå»çº ç»“ä¸ºä»€ä¹ˆæŸä¸ªæ±‰å­—æ˜¯è¿™æ ·å†™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;testasyncawait.png&quot; a
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>æ€»ç»“å‡ ä¸ªæœ€è¿‘é‡åˆ°çš„é—®é¢˜</title>
    <link href="http://sevencai.github.io/2018/11/27/%E6%80%BB%E7%BB%93%E5%87%A0%E4%B8%AA%E6%9C%80%E8%BF%91%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>http://sevencai.github.io/2018/11/27/æ€»ç»“å‡ ä¸ªæœ€è¿‘é‡åˆ°çš„é—®é¢˜/</id>
    <published>2018-11-27T13:08:19.000Z</published>
    <updated>2018-11-27T13:19:43.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘çœ‹äº†äº›æ–‡ç« ï¼Œé‡åˆ°äº†å†™é—®é¢˜ï¼ŒèŠ±äº†ç‚¹æ—¶é—´æ€»ç»“å¦‚ä¸‹ã€‚</p>
<hr>
<h2 id="localhost-å’Œ-127-0-0-1"><a href="#localhost-å’Œ-127-0-0-1" class="headerlink" title="localhost å’Œ 127.0.0.1"></a>localhost å’Œ 127.0.0.1</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ç”µè„‘å¯èƒ½æœ‰<strong>ä¸‰å—ç½‘å¡</strong>ã€‚åˆ†åˆ«æ˜¯ğŸŒ¹ï¼š</p>
<ol>
<li>ä¸€å—å« loopback çš„è™šæ‹Ÿç½‘å¡</li>
<li>ä¸€å—å« ethernet çš„æœ‰é™ç½‘å¡</li>
<li>ä¸€å—å« wlan çš„æ— é™ç½‘å¡</li>
</ol>
<p>æˆ‘ä»¬ç”µè„‘çš„æœ¬æœº IP ï¼Œå¯ä»¥ç†è§£ä¸ºæ—¶çœŸå®ç½‘å¡çš„ IP, æœ‰é™å’Œæ— é™åˆ†åˆ«æœ‰ä¸€ä¸ªã€‚æ˜¯ç½‘ç»œå‡ºå£IPã€‚</p>
<p>ç°åœ¨ä¸»è¦æ˜¯äº†è§£ä¸‹è¿™ä¸ª è™šæ‹Ÿçš„ç½‘å¡ loopback å®ƒæ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒå’Œ 127.0.0.1 çš„å…³ç³»ã€‚</p>
<p>127.0.0.1 åˆ° 127.255.255.255æ•´ä¸ªéƒ½æ˜¯ç¯å›åœ°å€(loopback)ï¼Œç”¨æ¥æµ‹è¯•æœ¬æœºçš„TCP/IPåè®®æ ˆï¼Œå‘å¾€è¿™æ®µAç±»åœ°å€<strong>æ•°æ®åŒ…ä¸ä¼šå‡ºç½‘å¡ï¼Œç½‘ç»œè®¾å¤‡ä¸ä¼šå¯¹å…¶åšè·¯ç”±</strong>, ä¹Ÿå°±æ˜¯åªåœ¨æœ¬åœ°åšå›ç¯è®¿é—®ï¼Œæ•…åªèƒ½æœ¬æœºè®¿é—®ã€‚</p>
<p><strong>æ‰€ä»¥ç¯å›åœ°å€æ˜¯ä¸»æœºç”¨äºå‘è‡ªèº«å‘é€é€šä¿¡çš„ä¸€ä¸ªç‰¹æ®Šåœ°å€ï¼Œæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç›®çš„åœ°å€ã€‚å› æ­¤å¦‚æœä¸€å°ä¸»æœºä¸Šçš„ä¸¤é¡¹æœåŠ¡å¦‚æœä½¿ç”¨çš„æ˜¯ç¯å›åœ°å€è€Œéåˆ†é…çš„ä¸»æœºåœ°å€ï¼Œå°±å¯ä»¥ç»•å¼€ TCP/IP åè®®æ ˆçš„ä¸‹å±‚ï¼Œä¸ç”¨å†é€šè¿‡é“¾è·¯å±‚ï¼Œç‰©ç†å±‚ï¼Œä»¥å¤ªç½‘ç­‰ä¼ å‡ºå»ã€‚</strong></p>
<p><strong>è€Œlocalhost æ˜¯ä¸€ä¸ª åŸŸåï¼Œä¸€èˆ¬æŒ‡å‘ 127.0.0.1ï¼Œ å®é™…ä¸Šå®ƒä¹Ÿå¯ä»¥æŒ‡å‘ä»»ä½•ä¸€ä¸ªip, å¯ä»¥å»ç³»ç»Ÿæ–‡ä»¶ä¸­ä¿®æ”¹</strong>ã€‚</p>
<p>ä¹‹æ‰€ä»¥å»äº†è§£è¿™ä¸ªï¼Œå…¶å®æ˜¯å› ä¸ºæœ€è¿‘è¸©äº†ä¸‹é¢ä¸ªå‘ï¼Œé¡ºå¸¦ä¹Ÿå»äº†è§£äº†ä¸‹è¿™ä¸ªã€‚</p>
<hr>
<h2 id="whistle-è½¬å‘-header-host-è¢«æ›´æ”¹é—®é¢˜"><a href="#whistle-è½¬å‘-header-host-è¢«æ›´æ”¹é—®é¢˜" class="headerlink" title="whistle è½¬å‘ header host è¢«æ›´æ”¹é—®é¢˜"></a>whistle è½¬å‘ header host è¢«æ›´æ”¹é—®é¢˜</h2><p>âåŒäº‹Bä¸ºäº†åœ¨é¡µé¢å†… include ä¸€ä¸ª php cgi è¿”å›çš„ token, å¸Œæœ›èƒ½å¤Ÿåœ¨ apache é‡Œé¢é…ç½®ä»£ç†è½¬å‘ï¼Œå½“çœ‹åˆ°äº†è¿™ä¸ªincludeçš„ cgi åï¼Œå³è½¬å‘åˆ°å¯¹åº”çš„ æœºå™¨ä¸Šã€‚</p>
<p>å¥¹å‘ç° php çš„æ¥å£å·²ç»æˆåŠŸè½¬å‘åˆ°æµ‹è¯•æœºå™¨ä¸Šï¼Œä½†æ˜¯è¿”å›çš„å†…å®¹ä¸æ­£å¸¸ï¼Œåœ¨å¸®å¥¹è°ƒè¯•æ¥å£åï¼Œå‘ç°åå°æ¥å£éªŒè¯äº† Valid Host, è€Œå¥¹çš„ host è¿˜æ˜¯æœ¬æœºçš„ localhostã€‚</p>
<p>å¥¹ç›¸å…³çš„whistle é…ç½®ä¸ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pay.qq.com  localhost/wechat_h5/dist/h5/store/views/</span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥é€šè¿‡ pay.qq.com/index.shtml ç›´æ¥è®¿é—®åˆ°å¯¹åº”çš„æœ¬åœ°é¡µé¢ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆ header é‡Œé¢çš„ host ç«Ÿç„¶ä¸æ˜¯ pay.qq.com è€Œæ˜¯ localhost å‘¢ï¼ŸâŒ</p>
<p>è¿™é‡Œæ˜¯ç”±äº whistle å¯¼è‡´çš„ã€‚</p>
<p>whistle å¯¹äºä¸Šé¢è¿™ç§é…ç½®ï¼Œ<strong>ä¼šè®¤ä¸ºæ˜¯ä¸€ä¸ª rule</strong>, ç›´æ¥æ•´ä¸ªé“¾æ¥ç±»ä¼¼è¢« 302 è·³è½¬äº†ï¼Œå¯¼è‡´äº† header é‡Œçš„ host ä¹Ÿè¢«ä¿®æ”¹ä¸ºäº† localhost, æ‰€ä»¥ä¸èƒ½é€šè¿‡æ¥å£æ ¡éªŒã€‚</p>
<p>éœ€è¦æ”¹æˆå¦‚ä¸‹é…ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pay.qq.com/wechat_h5/dist/h5/store/views/ localhost</span><br></pre></td></tr></table></figure></p>
<p>è¿™ç§æƒ…å†µï¼Œ<strong>whistle ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ª host ä»£ç†ï¼Œ header é‡Œé¢çš„å†…å®¹ä¸ä¼šå—å½±å“</strong>ã€‚</p>
<p>ä¸¤ç§ç±»ä¼¼ç›¸ä¼¼çš„å†™æ³•ï¼Œè¿˜æ˜¯æœ‰ä¸ä¸€æ ·çš„æ•ˆæœï¼Œå¦‚æœä¸æ˜¯è¿™ç§åå°ä¼šéªŒè¯ valid host çš„æƒ…å†µï¼Œä¸¤ç§éƒ½å¯ä»¥ç”¨ã€‚</p>
<hr>
<h2 id="es6-promise-ä¸æ”¯æŒ-finally"><a href="#es6-promise-ä¸æ”¯æŒ-finally" class="headerlink" title="es6-promise ä¸æ”¯æŒ finally?"></a>es6-promise ä¸æ”¯æŒ finally?</h2><p><code>es6-promise</code> æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„ <code>promise polyfill</code> åº“ ï¼Œä½†æ˜¯é—æ†¾çš„æ˜¯ç›®å‰å®ƒè¿˜ä¸æ”¯æŒ finallyï¼Œå¦‚æœç”¨ <code>es6-promise</code> ï¼Œåˆæƒ³ç”¨ <code>finally</code> ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿå¯ä»¥ç®€å•çš„ç”¨ <code>then</code> æ¥ä»£æ›¿ <code>finally</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">printPersonFullName() &#123;</span><br><span class="line">    <span class="keyword">return</span> fetch(<span class="string">'./data/person.json'</span>)</span><br><span class="line">           .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">return</span> response.json();</span><br><span class="line">           &#125;)</span><br><span class="line">           .then(<span class="function"><span class="params">person</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;person.firstName&#125;</span> <span class="subst">$&#123;person.lastName&#125;</span>`</span>);</span><br><span class="line">           &#125;)</span><br><span class="line">           .catch(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="built_in">console</span>.log(<span class="string">'error'</span>)</span><br><span class="line">           &#125;)</span><br><span class="line">           .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="built_in">console</span>.log(<span class="string">'finally'</span>);</span><br><span class="line">           &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æœ€åä¸€ä¸ª then æ–¹æ³•ä¸€å®šä¼šè¿›å…¥ï¼ŒåŠæ—¶ä¹‹å‰ catch åˆ°äº† errorã€‚å¯ä»¥ç®€å•çš„æ¥æ›¿ä»£ finallyã€‚</p>
<hr>
<h2 id="ç¥å¥‡çš„translate3d"><a href="#ç¥å¥‡çš„translate3d" class="headerlink" title="ç¥å¥‡çš„translate3d"></a>ç¥å¥‡çš„translate3d</h2><p><code>ios safari</code> ä¸‹ï¼Œå¦‚æœä½ ç»å¸¸ç”¨ <code>position: fixed</code>ï¼Œ å¯èƒ½ä¼šé‡åˆ°ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼Œæ¯”å¦‚é¡µé¢å¡ä½ï¼Œé¡µé¢ç™½å±ç­‰é—®é¢˜ã€‚</p>
<p>è¿™æ—¶å€™ä½ å¯ä»¥è¯•è¯•ç¥å¥‡çš„ translate3d, å®ƒä¼šè§¦å‘ GPU çš„é‡æ–°åŠ é€Ÿã€‚<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.Element-header</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(0,0,0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Element-header--fixed</span> &#123;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¸å¤ªäº†è§£ CSS çš„æˆ‘ï¼Œé è¿™ä¸ªè§£å†³äº†å¾ˆå¤šé—®é¢˜ã€‚<a href="https://stanko.github.io/ios-safari-scroll-position-fixed/" target="_blank" rel="noopener">ç›¸å…³å‚è€ƒæ–‡ç« </a>ã€‚</p>
<p>å»ºè®®æ˜¯<code>safari</code>ä¸­èƒ½ä¸ç”¨<code>fixed</code>å°±ä¸ç”¨ <code>fixed</code>ã€‚</p>
<hr>
<h2 id="Promise-Anti-patterns"><a href="#Promise-Anti-patterns" class="headerlink" title="Promise Anti-patterns"></a>Promise Anti-patterns</h2><p>æœ€è¿‘çœ‹äº†ä¸€ç¯‡æ–‡ç« ï¼Œè®²çš„ä¸é”™ï¼Œå¤§æ¦‚è®²çš„å°±æ˜¯è¯´å¸¸è§çš„ä¸€äº›é”™è¯¯çš„ Promise ç”¨æ³•ã€‚åœ¨è¿™é‡Œè®°å½•ä¸‹ï¼Œä¾›è‡ªå·±ç»å¸¸ç¿»çœ‹ã€‚åŸæ–‡ç« åœ°å€åœ¨<a href="http://taoofcode.net/promise-anti-patterns/" target="_blank" rel="noopener">æ­¤ã€‚</a></p>
<h3 id="Nested-Promises"><a href="#Nested-Promises" class="headerlink" title="Nested Promises"></a>Nested Promises</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">loadSomething().then(<span class="function"><span class="keyword">function</span>(<span class="params">something</span>) </span>&#123;</span><br><span class="line">  loadAnotherthing().then(<span class="function"><span class="keyword">function</span>(<span class="params">another</span>) </span>&#123;</span><br><span class="line">    DoSomethingOnThem(something, another);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>To fix:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">q.all([loadSomething(), loadAnotherThing()])</span><br><span class="line">    .spread(<span class="function"><span class="keyword">function</span>(<span class="params">something, another</span>) </span>&#123;</span><br><span class="line">        DoSomethingOnThem(something, another);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="The-Broken-Chain"><a href="#The-Broken-Chain" class="headerlink" title="The Broken Chain"></a>The Broken Chain</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anAsyncCall</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> promise = doSomethingAsync();</span><br><span class="line">    promise.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        somethingComplicated();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> promise;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>To Fixed:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">anAsyncCall</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> promise = doSomethingAsync();</span><br><span class="line">    <span class="keyword">return</span> promise.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        somethingComplicated()</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="The-Collection-Kerfuffle"><a href="#The-Collection-Kerfuffle" class="headerlink" title="The Collection Kerfuffle"></a>The Collection Kerfuffle</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">workMyCollection</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> resultArr = [];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">_recursive</span>(<span class="params">idx</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (idx &gt;= resultArr.length) <span class="keyword">return</span> resultArr;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> doSomethingAsync(arr[idx]).then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">            resultArr.push(res);</span><br><span class="line">            <span class="keyword">return</span> _recursive(idx + <span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> _recursive(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>To fix, use map &amp; reduce:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">workMyCollection</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> q.all(arr.map(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> doSomethingAsync(item);</span><br><span class="line">    &#125;));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// or you want them in series</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">workMyCollection</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> arr.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">promise, item</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> doSomethingAsyncWithResult(item, result);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;, q());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="The-Ghost-Promise"><a href="#The-Ghost-Promise" class="headerlink" title="The Ghost Promise"></a>The Ghost Promise</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> promise;</span><br><span class="line"><span class="keyword">if</span> (asyncCallNeeded)</span><br><span class="line">    promise = doSomethingAsync();</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    promise = Q.resolve(<span class="number">42</span>);</span><br><span class="line"></span><br><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    doSomethingCool();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>To fix:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”¨ Q åŒ…ä¸€å±‚</span></span><br><span class="line">Q(asyncCallNeeded ? doSomethingAsync() : <span class="number">42</span>)</span><br><span class="line">    .then(</span><br><span class="line">        <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">            doSomethingGood();</span><br><span class="line">        &#125;)</span><br><span class="line">    .catch(</span><br><span class="line">        <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">            handleTheError();</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="The-Overly-Keen-Error-Handler"><a href="#The-Overly-Keen-Error-Handler" class="headerlink" title="The Overly Keen Error Handler"></a>The Overly Keen Error Handler</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">somethingAsync.then(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> somethingElseAsync();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">        handleMyError(err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>To fix :<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é¿å…ä¸Šé¢fufilledå†…çš„errorä¸è¢« catch åˆ°</span></span><br><span class="line">somethingAsync</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> somethingElseAsync();</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">        handleMyError(err);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="The-Forgotten-Promise"><a href="#The-Forgotten-Promise" class="headerlink" title="The Forgotten Promise"></a>The Forgotten Promise</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> deferred = Q.defer();</span><br><span class="line">doSomethingAsync().then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    res = manipulateMeInSomeWay(res);</span><br><span class="line">    deferred.resolve(res);</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    deferred.reject(err);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> deferred.promise;</span><br></pre></td></tr></table></figure>
<p>To fix:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é¿å…ä¸Šè¿°æ— æ„ä¹‰çš„åˆ›å»º promise</span></span><br><span class="line"><span class="keyword">return</span> doSomethingAsync().then(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> manipulateMeInSomeWay(res);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>çœ‹äº†ä¸€äº›æ–‡ç« ï¼Œå…¶å®å¤šçœ‹çœ‹è¿™äº›æ€»ç»“ç±»çš„æ–‡ç« ï¼Œç„¶åè‡ªå·±æŠŠè‡ªå·±å·¥ä½œä¸­é‡åˆ°çš„é—®é¢˜æ€»ç»“å‡ºæ¥æ˜¯ä¸ªå¾ˆå¥½çš„äº‹æƒ…ï¼Œæ¢³ç†äº†è‡ªå·±çš„è„‘è¢‹ç“œå“ˆå“ˆã€‚ ä»Šå¤©å¥½ç´¯å•Šï¼Œå¯èƒ½æ˜¯ç”Ÿç—…çš„åŸå› ï¼Œæ—©ç‚¹å›å®¶äº†ã€‚9ç‚¹20ã€‚ç»™è€å¦ˆæ‰“ä¸ªâ˜ï¸ï¼Œå›å»å†çœ‹çœ‹ä¹¦ï¼Œé›é›ç‹—ğŸ©ï¼Œå®Œç¾ğŸ˜Š~</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘çœ‹äº†äº›æ–‡ç« ï¼Œé‡åˆ°äº†å†™é—®é¢˜ï¼ŒèŠ±äº†ç‚¹æ—¶é—´æ€»ç»“å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;localhost-å’Œ-127-0-0-1&quot;&gt;&lt;a href=&quot;#localhost-å’Œ-127-0-0-1&quot; class=&quot;headerlink&quot; title=&quot;localhost å’Œ 
    
    </summary>
    
    
      <category term="Javascript" scheme="http://sevencai.github.io/tags/Javascript/"/>
    
  </entry>
  
  <entry>
    <title>è®°å‡ ä¸ªå°çŸ¥è¯†ç‚¹</title>
    <link href="http://sevencai.github.io/2018/11/20/%E8%AE%B0%E5%87%A0%E4%B8%AA%E5%B0%8F%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
    <id>http://sevencai.github.io/2018/11/20/è®°å‡ ä¸ªå°çŸ¥è¯†ç‚¹/</id>
    <published>2018-11-20T13:14:33.000Z</published>
    <updated>2018-11-20T13:21:50.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>å¥½ä¹…éƒ½æ²¡æœ‰æ›´æ–°åšå®¢äº†ï¼Œä¹‹å‰ç»å†äº†ç–¯ç‹‚çš„ä¸€æ®µåŠ ç­æ—¶é—´ï¼Œæ”¶è·äº†ä¸‹é¢ä¸€å¥è¯ï¼Œå¯¹æˆ‘æ¥è¯´å¾ˆçè´µçš„ç»éªŒã€‚ğŸ“’</p>
<p><strong>å†çŸ­ä¹Ÿè¦è®°å¾—æ€è€ƒï¼Œå†å¿™ä¹Ÿè¦è®°å¾—æ—¶ä¸æ—¶åœä¸‹æ¥ï¼Œä¸æ…Œä¸å¿™ä¸€æ­¥æ­¥èµ°ç¨³</strong>~ğŸ“š</p>
</blockquote>
<hr>
<h2 id="åœ¨-url-ä¸Šå¢åŠ å‚æ•°"><a href="#åœ¨-url-ä¸Šå¢åŠ å‚æ•°" class="headerlink" title="åœ¨ url ä¸Šå¢åŠ å‚æ•°"></a>åœ¨ url ä¸Šå¢åŠ å‚æ•°</h2><p>ä¸‹é¢è¿™æ®µæ˜¯ä¸€æ®µç»™ url å¢åŠ å‚æ•°çš„ä»£ç ç‰‡æ®µï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åœ¨ url ä¸Šæ·»åŠ å‚æ•°</span></span><br><span class="line"><span class="comment"> * @param arr  Array or Object</span></span><br><span class="line"><span class="comment"> * @param url</span></span><br><span class="line"><span class="comment"> * @return &#123;string|*&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addParam</span>(<span class="params">arr, url</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> names = <span class="built_in">Object</span>.keys(arr)</span><br><span class="line">  <span class="keyword">var</span> postfix = serializeParams(arr)</span><br><span class="line"></span><br><span class="line">  url = delParam(names, url)</span><br><span class="line">  url += <span class="regexp">/(\?|&amp;)$/</span>.test(url) ? <span class="string">""</span> + postfix : <span class="regexp">/\?/</span>.test(url) ? <span class="string">"&amp;"</span> + postfix : <span class="string">"?"</span> + postfix</span><br><span class="line">  <span class="keyword">return</span> url</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>é™¤å»å†™æ³•é—®é¢˜ï¼Œé€»è¾‘ä¸Šèƒ½çœ‹å‡ºæœ‰ä»€ä¹ˆé—®é¢˜å—âŒï¼Ÿ</p>
<p>å®ƒåªæ”¯æŒä¸å¸¦ hash çš„å¢åŠ å‚æ•°ï¼Œå¯¹äºå¸¦ hash çš„url, å®ƒåŸºæœ¬ä¸èƒ½ä½¿ç”¨ã€‚å› ä¸ºè¿™ä¸ªæ–¹æ³•å·²ç»è¢«å…¶ä»–äººä½¿ç”¨ï¼Œä¸ºäº†æœ€å°çš„æ”¹åŠ¨æ€§ï¼Œå¯ä»¥åœ¨ä¸Šé¢å†å°è£…ä¸€æ¬¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addHashParam</span>(<span class="params">arr, url</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> [prefix, suffix] = url.split(<span class="string">"#"</span>)</span><br><span class="line">  <span class="keyword">let</span> addedUrl = addParam(arr, prefix)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (suffix) &#123;</span><br><span class="line">    <span class="keyword">return</span> [addedUrl, <span class="string">"#"</span>, suffix].join(<span class="string">""</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> addedUrl</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç®€å•çš„ split ä¸€ä¸‹ï¼Œå†å¯¹ hash ä¹‹å‰çš„è¿›è¡Œ addParam, æœ€åå†æ‹¼æ¥å›å»å³å¯ã€‚</p>
<hr>
<h2 id="chrome-breakpoints"><a href="#chrome-breakpoints" class="headerlink" title="chrome breakpoints"></a>chrome breakpoints</h2><p>ä»Šå¤©åˆæŠŠ chrome çš„ <a href="https://developers.google.com/web/tools/chrome-devtools/javascript/breakpoints?hl=zh-cn" target="_blank" rel="noopener">breakpoints çš„æ–‡æ¡£</a>çŸäº†ä¸€éã€‚å¸Œæœ›è‡ªå·±èƒ½æŠŠä¸‹é¢è¿™ä¸ªå›¾è®°æ¸…æ¥šï¼š</p>
<p><img src="chromebreakpoint.png" alt="Overview of when to use each breakpoint type"></p>
<p>å¹³æ—¶è¿˜æ˜¯å¾—åˆ»æ„æœ‰æ„çš„å»ä½¿ç”¨ä¸åŒçš„ç±»å‹æ–­ç‚¹å½¢å¼ï¼Œè¿™æ ·æ‰ä¸ä¼šå¦‚æœçªç„¶äº‹ä»¶å¾ˆç´§å‘ç°é—®é¢˜æ—¶ï¼Œæ‰‹å¿™è„šä¹±ã€‚</p>
<p>æ¯”å¦‚ä¸Šé¢è¿™äº›æ–­ç‚¹ç±»å‹ä¸­ï¼Œ <code>Line-of-code</code>ï¼Œ<code>Conditional line-of-code</code>ï¼Œ<code>Exception</code> ç”¨çš„æ¯”è¾ƒå¤šï¼Œå…¶ä»–å‡ ä¸ªå¦‚ <code>DOM</code>, <code>Xhr</code>, <code>Function</code> ç”¨çš„æ¯”è¾ƒğŸ“’å°‘ã€‚</p>
<hr>
<h2 id="å…³äºç½‘ç»œçš„å°çŸ¥è¯†"><a href="#å…³äºç½‘ç»œçš„å°çŸ¥è¯†" class="headerlink" title="å…³äºç½‘ç»œçš„å°çŸ¥è¯†"></a>å…³äºç½‘ç»œçš„å°çŸ¥è¯†</h2><p>æœ€è¿‘å…¬å¸çš„ç½‘ç»œéƒ¨åˆ†æ‰“é€šäº†ï¼Œå¯¹äº mac pro è€Œè¨€ï¼Œä»¥å‰éå¸¸ä¸å¥½çœŸæœºè°ƒè¯•ï¼Œç°åœ¨éå¸¸æ–¹ä¾¿äº†æˆ‘ä»¬ã€‚å»äº†è§£äº†ä¸‹è¿™é‡Œé¢çš„å·¥ä½œã€‚</p>
<blockquote>
<p>åŒä¸€ç½‘æ®µï¼šè¦åˆ¤æ–­ä¸¤ä¸ªIPåœ°å€æ˜¯ä¸æ˜¯åœ¨åŒä¸€ä¸ªç½‘æ®µï¼Œå°±å°†å®ƒä»¬çš„IPåœ°å€åˆ†åˆ«ä¸<strong>å­ç½‘æ©ç </strong>åš<strong>ä¸è¿ç®—</strong>ï¼Œå¾—åˆ°çš„ç»“æœä¸€ç½‘ç»œå·ï¼Œå¦‚æœç½‘ç»œå·ç›¸åŒï¼Œå°±åœ¨åŒä¸€å­ç½‘ï¼Œå¦åˆ™ï¼Œä¸åœ¨åŒä¸€å­ç½‘ã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœä¸¤ä¸ªè®¾å¤‡çš„ IP åœ°å€å‰ä¸‰ä½éƒ½æ˜¯ä¸€æ ·çš„è¯ï¼Œå°±ç®—æ˜¯ä½äºåŒä¸€ç½‘æ®µã€‚</p>
</blockquote>
<p>æŠ“åŒ…æˆ–è€…çœŸæœºè°ƒè¯•éœ€è¦ç”µè„‘å’Œæ‰‹æœºåœ¨åŒä¸€ç½‘æ®µä¸‹ã€‚ ç°åœ¨ç”±äºç½‘ç»œæ‰“é€šï¼Œéƒ½åœ¨åŒä¸€å±€åŸŸç½‘å†…ï¼Œç›´æ¥æ‰‹æœºä¸Šé…ç½®ä»£ç†ï¼Œè¿æ¥ç”µè„‘ç›¸åº”çš„ç«¯å£å³å¯ã€‚ä¸€èˆ¬æˆ‘ä»¬ä¸ºäº†æŠ“åŒ…ï¼Œç”µè„‘ä¸Šä¼šè£… fiddler or charles or whistle, æˆ‘è¿™é‡Œä½¿ç”¨ whistle å¼€å¯äº†ä¸€ä¸ªæ–°ç«¯å£ï¼Œæ‰‹æœºå°±è¿è¿™ä¸ªç«¯å£å³å¯æŠ“åŒ…ã€‚</p>
<p>åŸå…ˆç”±äºæˆ‘ä»¬çš„æ‰‹æœºå’Œç”µè„‘ä¸æ˜¯åŒä¸€ä¸ªç½‘ç»œï¼Œæ‰€ä»¥æ‰éœ€è¦è½¯APå¦‚ å°ç±³ WIFI è¿™ç§ä¸œè¥¿å»ä½¿æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€ä¸ªç½‘ç»œé‡Œï¼Œè¿›è¡ŒæŠ“åŒ…ã€‚</p>
<p>è¿™é‡Œå‡ºæ¥äº†ä¸€ä¸ªæ–°è¯ï¼Œå«åš <strong>è½¯AP</strong>ã€‚</p>
<p>è½¯APæŒ‡çš„æ˜¯ï¼š<strong>â€œè½¯APâ€çš„æ— çº¿äº§å“åœ¨å¸‚åœºä¸Šé¢‡ä¸ºå¸¸è§ï¼Œè½¯APå°±æ˜¯Soft-APï¼Œå®ƒçš„ç¡¬ä»¶éƒ¨åˆ†å°±æ˜¯ä¸€å—æ ‡å‡†çš„æ— çº¿ç½‘å¡ï¼Œä½†å…¶é€šè¿‡é©±åŠ¨ç¨‹åºä½¿å…¶æä¾›ä¸APä¸€æ ·çš„ä¿¡å·è½¬æ¥ã€è·¯ç”±ç­‰åŠŸèƒ½</strong>ã€‚ä¸ä¼ ç»ŸAPç›¸æ¯”ï¼Œå®ƒçš„æˆæœ¬å¾ˆä½ï¼ŒåŠŸèƒ½ä¸Šä¹Ÿèƒ½å‡‘åˆã€‚</p>
<p>ç®€å•çš„ç†è§£è¯<strong>AP å°±æ˜¯ AccessPoint ,æ˜¯æ— é™è®¿é—®çƒ­ç‚¹çš„ç®€ç§°ï¼Œæ— é™è·¯ç”±å™¨å¯ä»¥ç§°ä¸º AP, è½¯AP åˆ™æ˜¯ç”¨è½¯ä»¶å’Œæ— çº¿ç‹å¡ç»“åˆæ¨¡æ‹Ÿå‡ºæ¥çš„</strong>ã€‚</p>
<p>æ˜¯å¦éœ€è¦è¿™ä¸ªè½¯APè·Ÿæˆ‘ä»¬çš„ç½‘ç»œæœ‰å…³ç³»ã€‚è‹¥ç”µè„‘å’Œæ‰‹æœºå¤„äºä¸€ä¸ªç½‘æ®µï¼Œå°±ä¸éœ€è¦è½¯APåˆ›å»ºWIFIç½‘ç»œã€‚è‹¥ä¸åœ¨ä¸€ä¸ªç½‘ç»œï¼Œå°±éœ€è¦ç”¨åˆ°è½¯APè½¯ä»¶ã€‚æ¯”å¦‚ä½ çš„ç”µè„‘æ˜¯è¿çš„è‡ªå®¶çš„WIFI,ä½ çš„æ‰‹æœºæ˜¯4Gç½‘ç»œã€‚æˆ–è€…ä½ çš„ç”µè„‘æ˜¯æœ‰é™ç½‘ç»œï¼Œæ‰‹æœºæ˜¯æ— çº¿ç½‘ç»œï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½å°±ä¸åœ¨ä¸€ä¸ªç½‘æ®µä¸Šã€‚</p>
<blockquote>
<p>åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…æ˜¯å¯ä»¥ç›¸äº’è¿æ¥åˆ°å¯¹æ–¹çš„å¹¿æ’­çš„ï¼Œä¹Ÿå¯ä»¥å†’è®¤æ¥æ”¶ç«¯æ¥æˆªå–æ•°æ®ã€‚æˆ–è€…æ··ä¹±arpæ•°æ®åŒ…ï¼Œè¿›è¡Œå…¨éƒ¨æŠ“å–ã€‚é‚£ä¹ˆå¦‚ä½•å°†macå’ŒiPhoneè¿æ¥åˆ°åŒä¸€ä¸ªå±€åŸŸç½‘å‘¢ï¼Ÿæ–¹æ³•ä¸€ï¼Œå°†ä¸¤ä¸ªè®¾å¤‡éƒ½è¿æ¥ä¸€ä¸ªwifiè·¯ç”±å™¨ï¼›æ–¹æ³•äºŒï¼Œå°†macè¿æ¥ä»¥å¤ªç½‘ï¼Œç„¶ååœ¨ ç³»ç»Ÿåå¥½è®¾ç½®â€”â€”å…±äº« ä¸­è®¾ç½®å…±äº«ä»¥å¤ªç½‘æ¥æºçš„è¿æ¥ï¼Œç„¶åç”¨wifiç«¯å£å…±äº«ç»™ç”µè„‘ï¼ˆæ‰‹æœºï¼‰ã€‚ç„¶åå†å°†æ‰‹æœºå»è¿æ¥ç”µè„‘å‘æ•£å‡ºçš„wifiã€‚</p>
</blockquote>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¦å¯¹æœªæ¥æœ‰ä¿¡å¿ƒï¼Œè¦å¯¹è‡ªå·±åšçš„äº‹æƒ…å†™çš„ä»£ç æŠ±æœ‰ä¿¡å¿µï¼Œè¦è·Ÿéšè‡ªå·±çš„å¿ƒã€‚ï¼ˆä¸æ˜¯å¯¹åˆ«äººçš„é¸¡æ±¤ï¼Œæ˜¯å¯¹è‡ªå·±çš„é¼“åŠ±ï¼ŒåŠ æ²¹ï¼‰ğŸŒ¹</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å¥½ä¹…éƒ½æ²¡æœ‰æ›´æ–°åšå®¢äº†ï¼Œä¹‹å‰ç»å†äº†ç–¯ç‹‚çš„ä¸€æ®µåŠ ç­æ—¶é—´ï¼Œæ”¶è·äº†ä¸‹é¢ä¸€å¥è¯ï¼Œå¯¹æˆ‘æ¥è¯´å¾ˆçè´µçš„ç»éªŒã€‚ğŸ“’&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å†çŸ­ä¹Ÿè¦è®°å¾—æ€è€ƒï¼Œå†å¿™ä¹Ÿè¦è®°å¾—æ—¶ä¸æ—¶åœä¸‹æ¥ï¼Œä¸æ…Œä¸å¿™ä¸€æ­¥æ­¥èµ°ç¨³&lt;/strong&gt;~ğŸ“š&lt;/p&gt;
&lt;/blockquote
    
    </summary>
    
    
      <category term="ç¬”è®°" scheme="http://sevencai.github.io/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>è®°å‡ ä¸ªå°é—®é¢˜</title>
    <link href="http://sevencai.github.io/2018/08/31/%E8%AE%B0%E5%87%A0%E4%B8%AA%E5%B0%8F%E9%97%AE%E9%A2%98/"/>
    <id>http://sevencai.github.io/2018/08/31/è®°å‡ ä¸ªå°é—®é¢˜/</id>
    <published>2018-08-31T13:06:47.000Z</published>
    <updated>2018-08-31T13:08:45.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="swiper-v-for-ä¸­-click-ä¸ç”Ÿæ•ˆ"><a href="#swiper-v-for-ä¸­-click-ä¸ç”Ÿæ•ˆ" class="headerlink" title="swiper v-for ä¸­ click ä¸ç”Ÿæ•ˆ"></a>swiper v-for ä¸­ click ä¸ç”Ÿæ•ˆ</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;swiper-slide</span><br><span class="line">	v-<span class="keyword">for</span>=<span class="string">"(item, index) in bannerAds"</span></span><br><span class="line">	v-bind:key=<span class="string">"index"</span></span><br><span class="line">	@click.native=<span class="string">"linkAds(item)"</span></span><br><span class="line">	:style=<span class="string">"'background-image:url('+ item.url +')'"</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/swiper-slide&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ çš„ swiper ä¹Ÿæ˜¯ä½¿ç”¨äº† v-for å¹¶ä¸” click ä½œç”¨åœ¨ v-for æ‰€åœ¨çš„å…ƒç´ ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½ä¼šå¯¼è‡´ click äº‹ä»¶ä¸ä¼šæ‰§è¡Œã€‚è¿™æ—¶å€™è¯•è¯•åœ¨ç”¨ <code>@click.native</code> å¯è§£å†³é—®é¢˜ã€‚</p>
<p>ç±»ä¼¼çš„é—®é¢˜è¿˜æœ‰ <code>router-link</code> ä¸ŠåŠ  click ä¹Ÿä¸ç”Ÿæ•ˆã€‚æ–¹æ³•ç›¸åŒã€‚</p>
<p>ä¸€èˆ¬æ˜¯è‡ªå·±å®šä¹‰çš„ç»„ä»¶ï¼Œæˆ–è€… vue è‡ªå®šä¹‰çš„æ ‡ç­¾ï¼Œå¦‚ä¸Šé¢çš„ <code>router-link</code>ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å¯ä»¥ç†è§£ä¸ºï¼Œ<strong><code>.native</code> ä¿®é¥°ç¬¦å°±æ˜¯ç”¨æ¥æ³¨å†Œå…ƒç´ çš„åŸç”Ÿäº‹ä»¶è€Œä¸æ˜¯ç»„ä»¶è‡ªå®šä¹‰äº‹ä»¶çš„ã€‚æ˜¯æŠŠç»„ä»¶å˜å›åŸç”ŸDOMçš„ä¸€ç§æ–¹å¼ï¼Œç›¸å½“äºç»™ç»„ä»¶ç»‘å®šåŸç”Ÿäº‹ä»¶ã€‚å¯¹åŸç”Ÿhtmlæ ‡ç­¾æ— ç”¨ã€‚</strong>å› ä¸ºæœ¬èº«Vueæ˜¯æœ‰è‡ªå·±çš„ä¸€å¥—è¿›è¡Œä¼ é€’çš„æœºåˆ¶ï¼Œè¿™æ ·å‘Šè¯‰äº†Vue,ç”¨åŸç”Ÿçš„äº‹ä»¶ï¼Œè€Œä¸æ˜¯Vueè‡ªå·±çš„é‚£ä¸€å¥—äº‹ä»¶è§¦å‘æœºåˆ¶ã€‚</p>
<hr>
<h2 id="å¯¹è±¡çš„-filter"><a href="#å¯¹è±¡çš„-filter" class="headerlink" title="å¯¹è±¡çš„ filter"></a>å¯¹è±¡çš„ filter</h2><p>ä¸€èˆ¬æˆ‘ä»¬ä¼šå¾ˆä¹ æƒ¯å»ç”¨ arr.filter å»å¸®æˆ‘ä»¬åšä¸€äº›è¿‡æ»¤çš„äº‹æƒ…ï¼Œé‚£ä¹ˆå¦‚æœæ˜¯æƒ³è¦ç»™ object map åšä¸€äº›è¿‡æ»¤çš„äº‹æƒ…ï¼Œæˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·å°è£…ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * å¯¹è±¡è¿‡æ»¤å™¨</span></span><br><span class="line"><span class="comment"> * @param obj</span></span><br><span class="line"><span class="comment"> * @param filterFunction</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">objectFilter</span>(<span class="params">obj, filterFunction</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.assign(</span><br><span class="line">    ...Object.keys(obj)</span><br><span class="line">      .filter(<span class="function"><span class="params">key</span> =&gt;</span> filterFunction(obj[key]))</span><br><span class="line">      .map(<span class="function"><span class="params">key</span> =&gt;</span> (&#123; [key]: obj[key] &#125;))</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¹è±¡è¿‡æ»¤å™¨</span></span><br><span class="line"><span class="comment"> * arr.reduce(callback[, initialValue])</span></span><br><span class="line"><span class="comment"> * callback(accumulator, currentValue, currentIndex, array)</span></span><br><span class="line"><span class="comment"> * @param obj</span></span><br><span class="line"><span class="comment"> * @param filterFunction</span></span><br><span class="line"><span class="comment"> * @returns &#123;&#123;&#125;&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">filterObject</span>(<span class="params">obj, filterFunction</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.keys(obj)</span><br><span class="line">    .filter(<span class="function"><span class="params">key</span> =&gt;</span> filterFunction(obj[key]))</span><br><span class="line">    .reduce(<span class="function">(<span class="params">res, currKey</span>) =&gt;</span> (res[currKey] = obj[key]), &#123;&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Ravené…ç½®æŸäº›æ—¶å€™ä¸å‘é€é”™è¯¯æ•°æ®"><a href="#Ravené…ç½®æŸäº›æ—¶å€™ä¸å‘é€é”™è¯¯æ•°æ®" class="headerlink" title="Ravené…ç½®æŸäº›æ—¶å€™ä¸å‘é€é”™è¯¯æ•°æ®"></a>Ravené…ç½®æŸäº›æ—¶å€™ä¸å‘é€é”™è¯¯æ•°æ®</h2><p><code>shouldSendCallback</code>è®¾ç½®åªæœ‰ production ç¯å¢ƒæ‰å‘é€é”™è¯¯æ•°æ®ï¼Œæœ¬åœ°çš„é”™è¯¯å†…å®¹ä¸å‘é€åˆ° sentry ä¸Šã€‚</p>
<p><code>dataCallback</code>åœ¨å‘é€æ•°æ®ä¹‹å‰æƒ³è¦åšçš„äº‹æƒ…ï¼Œå¯ä»¥æ”¾è¿™é‡Œé¢ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Raven.config(<span class="string">"xxxx"</span>, &#123;</span><br><span class="line">  environment: process.env.NODE_ENV,</span><br><span class="line">  release: process.env.VERSION,</span><br><span class="line">  sampleRate: <span class="number">0.1</span>,</span><br><span class="line">  dataCallback: <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (process.env.NODE_ENV != <span class="string">"production"</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line">  &#125;,</span><br><span class="line">  shouldSendCallback: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> process.env.NODE_ENV == <span class="string">"production"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">  .addPlugin(RavenVue, Vue)</span><br><span class="line">  .install()</span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;swiper-v-for-ä¸­-click-ä¸ç”Ÿæ•ˆ&quot;&gt;&lt;a href=&quot;#swiper-v-for-ä¸­-click-ä¸ç”Ÿæ•ˆ&quot; class=&quot;headerlink&quot; title=&quot;swiper v-for ä¸­ click ä¸ç”Ÿæ•ˆ&quot;&gt;&lt;/a&gt;swiper v-for ä¸­
    
    </summary>
    
    
      <category term="Javascript" scheme="http://sevencai.github.io/tags/Javascript/"/>
    
  </entry>
  
  <entry>
    <title>The Linux Command Line è¯»ä¹¦ç¬”è®°ï¼ˆä¸‰ï¼‰</title>
    <link href="http://sevencai.github.io/2018/08/23/The-Linux-Command-Line-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/"/>
    <id>http://sevencai.github.io/2018/08/23/The-Linux-Command-Line-è¯»ä¹¦ç¬”è®°ï¼ˆä¸‰ï¼‰/</id>
    <published>2018-08-23T07:27:57.000Z</published>
    <updated>2018-08-23T07:55:37.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¬¬11ç« ï¼šshell-ç¯å¢ƒ-ğŸ¡"><a href="#ç¬¬11ç« ï¼šshell-ç¯å¢ƒ-ğŸ¡" class="headerlink" title="ç¬¬11ç« ï¼šshell ç¯å¢ƒ ğŸ¡"></a>ç¬¬11ç« ï¼šshell ç¯å¢ƒ ğŸ¡</h1><blockquote>
<p>shell åœ¨ shell ä¼šè¯ä¸­ä¿å­˜ç€å¤§é‡ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯è¢«ç§°ä¸º (shell çš„) ç¯å¢ƒã€‚ ç¨‹åºè·å–ç¯å¢ƒä¸­çš„æ•°æ®ï¼ˆå³ç¯å¢ƒå˜é‡ï¼‰æ¥äº†è§£æœ¬æœºçš„é…ç½®ã€‚è™½ç„¶å¤§å¤šæ•°ç¨‹åºç”¨é…ç½®æ–‡ä»¶æ¥å­˜å‚¨ç¨‹åºè®¾ç½®ï¼Œ ä¸€äº›ç¨‹åºä¼šæ ¹æ®ç¯å¢ƒå˜é‡æ¥è°ƒæ•´ä»–ä»¬çš„è¡Œä¸ºã€‚çŸ¥é“äº†è¿™äº›ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ç¯å¢ƒå˜é‡æ¥è‡ªå®šåˆ¶ shell ä½“éªŒã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-   printenv - æ‰“å°éƒ¨åˆ†æˆ–æ‰€æœ‰çš„ç¯å¢ƒå˜é‡</span><br><span class="line">-   <span class="built_in">set</span> - è®¾ç½® shell é€‰é¡¹</span><br><span class="line">-   <span class="built_in">export</span> â€” å¯¼å‡ºç¯å¢ƒå˜é‡ï¼Œè®©éšåæ‰§è¡Œçš„ç¨‹åºçŸ¥é“ã€‚</span><br><span class="line">-   <span class="built_in">alias</span> - åˆ›å»ºå‘½ä»¤åˆ«å</span><br></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h2 id="printenv-amp-set"><a href="#printenv-amp-set" class="headerlink" title="printenv &amp; set"></a>printenv &amp; set</h2><blockquote>
<p>shell åœ¨ç¯å¢ƒä¸­å­˜å‚¨äº†ä¸¤ç§åŸºæœ¬ç±»å‹çš„æ•°æ®ï¼Œè™½ç„¶ bash å‡ ä¹æ— æ³•åˆ†è¾¨è¿™äº›æ•°æ®çš„ç±»å‹ã€‚ å®ƒä»¬æ˜¯<strong>ç¯å¢ƒå˜é‡å’Œ shell å˜é‡</strong>ã€‚Shell å˜é‡æ˜¯ bash å­˜æ”¾çš„å°‘é‡æ•°æ®ã€‚å‰©ä¸‹çš„éƒ½æ˜¯ ç¯å¢ƒå˜é‡ã€‚é™¤äº†å˜é‡ï¼Œshell ä¹Ÿå­˜å‚¨äº†ä¸€äº›å¯ç¼–ç¨‹çš„æ•°æ®ï¼Œå³åˆ«åå’Œ shell å‡½æ•°ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ bash çš„å†…å»ºå‘½ä»¤ setï¼Œæˆ–è€…æ˜¯ printenv ç¨‹åºæ¥æŸ¥çœ‹ç¯å¢ƒå˜é‡ã€‚<strong>set å‘½ä»¤å¯ä»¥ æ˜¾ç¤º shell æˆ–ç¯å¢ƒå˜é‡ï¼Œè€Œ printenv åªæ˜¯æ˜¾ç¤ºç¯å¢ƒå˜é‡ã€‚</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">printenv | less</span><br><span class="line"></span><br><span class="line"><span class="comment">// printenv æ”¯æŒæŸ¥çœ‹æŸä¸ªç¯å¢ƒå˜é‡</span></span><br><span class="line">printenv USER   =&gt; sevencai</span><br></pre></td></tr></table></figure>
<p>å½“ä½¿ç”¨æ²¡æœ‰å¸¦é€‰é¡¹å’Œå‚æ•°çš„ set å‘½ä»¤æ—¶ï¼Œshell å˜é‡ï¼Œç¯å¢ƒå˜é‡ï¼Œå’Œå®šä¹‰çš„ shell å‡½æ•° éƒ½ä¼šè¢«æ˜¾ç¤ºã€‚ä¸åŒäº printenv å‘½ä»¤ï¼Œset å‘½ä»¤çš„è¾“å‡ºå¾ˆå‹å¥½åœ°æŒ‰ç…§é¦–å­—æ¯é¡ºåºæ’åˆ—ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> | less</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$HOME</span></span><br><span class="line"></span><br><span class="line">// åˆ«åæ— æ³•é€šè¿‡ä½¿ç”¨ <span class="built_in">set</span> æˆ– printenv æ¥æŸ¥çœ‹ã€‚ ç”¨ä¸å¸¦å‚æ•°çš„ <span class="built_in">alias</span> æ¥æŸ¥çœ‹åˆ«å:</span><br><span class="line"><span class="built_in">alias</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="å¦‚ä½•å»ºç«‹-shell-ç¯å¢ƒï¼Ÿ"><a href="#å¦‚ä½•å»ºç«‹-shell-ç¯å¢ƒï¼Ÿ" class="headerlink" title="å¦‚ä½•å»ºç«‹ shell ç¯å¢ƒï¼Ÿ"></a>å¦‚ä½•å»ºç«‹ shell ç¯å¢ƒï¼Ÿ</h2><blockquote>
<p>When we log on to the system, the bash program starts, and reads a series of configuration scripts called startup files, which define the default environment shared by all users. This is followed by more startup files in our home directory that define our personal environment. The exact sequence depends on the type of shell session being started. There are two kinds: a login shell session and a non-login shell session.</p>
</blockquote>
<p>ç™»å½•shellæˆ–è€…éç™»å½•shelléƒ½ä¼šå»è¯»å–ç›¸åº”çš„æ–‡ä»¶ï¼Œä½†æ˜¯è¯»å–çš„æ–‡ä»¶å¤šå°‘ä¼šæœ‰åŒºåˆ«ã€‚ä¾‹å¦‚ï¼š</p>
<p>ç™»å½•shellå¯èƒ½ä¼šè¯»å–ï¼š</p>
<p><img src="login.png" alt="login"></p>
<p>éç™»å½•shellå¯èƒ½ä¼šè¯»å–ï¼š</p>
<p><img src="unlogin.png" alt="unlogin.png"></p>
<p>ä¸€ä¸ªå…¸å‹çš„ .bashrc æ–‡ä»¶å¯èƒ½é•¿ä¸‹é¢è¿™æ ·ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .bash_profile</span></span><br><span class="line"><span class="comment"># Get the aliases and functions</span></span><br><span class="line"><span class="keyword">if</span> [ -f ~/.bashrc ]; <span class="keyword">then</span></span><br><span class="line">. ~/.bashrc</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># User specific environment and startup programs</span></span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH</span><br></pre></td></tr></table></figure></p>
<p>ç¿»è¯‘è¿‡æ¥å¯èƒ½æ˜¯ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">If the file ~/.bashrc exists, <span class="keyword">then</span></span><br><span class="line"><span class="built_in">read</span> the ~/.bashrc file.</span><br></pre></td></tr></table></figure></p>
<p><strong>æ˜¯å¦æ›¾ç»å¯¹ shell æ€æ ·çŸ¥é“åœ¨å“ªé‡Œæ‰¾åˆ°æˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥çš„å‘½ä»¤æ„Ÿåˆ°è¿·æƒ‘ï¼Ÿä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬è¾“å…¥ ls åï¼Œ shell ä¸ä¼šæŸ¥æ‰¾æ•´ä¸ªè®¡ç®—æœºç³»ç»Ÿæ¥æ‰¾åˆ° /bin/lsï¼ˆls å‘½ä»¤çš„å…¨è·¯å¾„åï¼‰ï¼Œç›¸åï¼Œå®ƒæŸ¥æ‰¾ä¸€ä¸ªç›®å½•åˆ—è¡¨ï¼Œ è¿™äº›ç›®å½•åŒ…å«åœ¨ PATH å˜é‡ä¸­ã€‚</strong></p>
<p>æˆ‘ä»¬å¯¹äºæ–‡ä»¶ .bashrc çš„ä¿®æ”¹ä¸ä¼šç”Ÿæ•ˆï¼Œç›´åˆ°æˆ‘ä»¬å…³é—­ç»ˆç«¯ä¼šè¯ï¼Œå†é‡æ–°å¯åŠ¨ä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œ å› ä¸º .bashrc æ–‡ä»¶åªæ˜¯åœ¨åˆšå¼€å§‹å¯åŠ¨ç»ˆç«¯ä¼šè¯æ—¶è¯»å–ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥å¼ºè¿« bash é‡æ–°è¯»å–ä¿®æ”¹è¿‡çš„ .bashrc æ–‡ä»¶ï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> l.=<span class="string">'ls -d .* --color=auto'</span></span><br><span class="line"><span class="built_in">alias</span> ll=<span class="string">'ls -l --color=auto'</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> .bashrc</span><br></pre></td></tr></table></figure></p>
<hr>
<h1 id="ç¬¬12ç« ï¼š-viç®€ä»‹ğŸ©"><a href="#ç¬¬12ç« ï¼š-viç®€ä»‹ğŸ©" class="headerlink" title="ç¬¬12ç« ï¼š viç®€ä»‹ğŸ©"></a>ç¬¬12ç« ï¼š viç®€ä»‹ğŸ©</h1><p>è¿™ä¸ªæˆ‘å·²ç»æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œè¿™é‡Œè¿˜æ˜¯åˆ—å‡ºä¸‹ä¹¦é‡Œçš„æ€»ç»“ï¼Œæ•´ä½“çš„æ€»ç»“ä¹¦é‡Œå†™çš„æŒºå¥½ï¼š</p>
<blockquote>
<p>viï¼ˆå‘éŸ³â€œvee eyeâ€ï¼‰ï¼Œå¤§å¤šæ•° Linux å‘è¡Œç‰ˆä¸åŒ…å«çœŸæ­£çš„ viï¼›è€Œæ˜¯è‡ªå¸¦ä¸€æ¬¾é«˜çº§æ›¿ä»£ç‰ˆæœ¬ï¼Œå«åš vimï¼ˆå®ƒæ˜¯â€œvi improvedâ€çš„ç®€å†™ï¼‰ç”± Bram Moolenaar å¼€å‘çš„ã€‚vim ç›¸å¯¹äºä¼ ç»Ÿçš„ Unix vi æ¥è¯´ï¼Œå–å¾—äº†å®è´¨æ€§è¿›æ­¥ã€‚é€šå¸¸ï¼Œvim åœ¨ Linux ç³»ç»Ÿä¸­æ˜¯â€œviâ€çš„ç¬¦å·é“¾æ¥ï¼ˆæˆ–åˆ«åï¼‰ã€‚</p>
</blockquote>
<h2 id="ç§»åŠ¨å…‰æ ‡"><a href="#ç§»åŠ¨å…‰æ ‡" class="headerlink" title="ç§»åŠ¨å…‰æ ‡"></a>ç§»åŠ¨å…‰æ ‡</h2><p><img src="move.png" alt="move"></p>
<p>è¡¥å……ä¸€ä¸ªï¼š<code>0,$,^,g_</code>  çš„åŒºåˆ«å’Œè”ç³»ã€‚<code>0,$</code>æ˜¯åˆ°è¡Œå¤´å’Œè¡Œå°¾ï¼Œ<code>^,g_</code>åˆ°éblankå­—ç¬¦ä½ç½®ã€‚<code>J</code>åˆå¹¶è¡Œã€‚</p>
<h2 id="æ–‡æœ¬åˆ é™¤å‘½ä»¤"><a href="#æ–‡æœ¬åˆ é™¤å‘½ä»¤" class="headerlink" title="æ–‡æœ¬åˆ é™¤å‘½ä»¤"></a>æ–‡æœ¬åˆ é™¤å‘½ä»¤</h2><p><img src="delete.png" alt="delete"></p>
<h2 id="å¤åˆ¶å‘½ä»¤"><a href="#å¤åˆ¶å‘½ä»¤" class="headerlink" title="å¤åˆ¶å‘½ä»¤"></a>å¤åˆ¶å‘½ä»¤</h2><p><img src="copy.png" alt="copy"></p>
<h2 id="å…¨å±€æŸ¥æ‰¾ä¸æ›¿æ¢"><a href="#å…¨å±€æŸ¥æ‰¾ä¸æ›¿æ¢" class="headerlink" title="å…¨å±€æŸ¥æ‰¾ä¸æ›¿æ¢"></a>å…¨å±€æŸ¥æ‰¾ä¸æ›¿æ¢</h2><p>å¦‚<code>:%s/Line/line/g</code></p>
<p>æŸ¥æ‰¾ä¸€è¡Œå†…çš„æ˜¯ç”¨ <code>f</code> å‘½ä»¤ï¼ŒæŸ¥æ‰¾ä¸‹ä¸€ä¸ªå‡ºç°çš„ï¼Œæ˜¯ç”¨ <code>/</code>å‘½ä»¤ã€‚</p>
<p><img src="replace.png" alt="replace"></p>
<h2 id="å¤šè¡Œç¼–è¾‘"><a href="#å¤šè¡Œç¼–è¾‘" class="headerlink" title="å¤šè¡Œç¼–è¾‘"></a>å¤šè¡Œç¼–è¾‘</h2><ol>
<li>vi file1 file2 file3â€¦</li>
<li>:n ä»è¿™ä¸ªæ–‡ä»¶åˆ‡æ¢ä¸‹ä¸€ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨è¿™ä¸ª ex å‘½ä»¤</li>
<li>:N å›åˆ°å…ˆå‰çš„æ–‡ä»¶ä½¿ç”¨:N</li>
<li>:buffers æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æ­£åœ¨ç¼–è¾‘çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä½¿ç”¨:buffers å‘½ä»¤ã€‚è¿è¡Œè¿™ä¸ª å‘½ä»¤åï¼Œå±å¹•é¡¶éƒ¨å°±ä¼šæ˜¾ç¤ºå‡ºä¸€ä¸ªæ–‡ä»¶åˆ—è¡¨, :buffers 2 å°±åˆ‡æ¢åˆ°2å·æ–‡ä»¶äº†ã€‚</li>
</ol>
<hr>
<h1 id="ç¬¬13ç« ï¼šè‡ªå®šåˆ¶-shell-æç¤ºç¬¦-ğŸ’‰"><a href="#ç¬¬13ç« ï¼šè‡ªå®šåˆ¶-shell-æç¤ºç¬¦-ğŸ’‰" class="headerlink" title="ç¬¬13ç« ï¼šè‡ªå®šåˆ¶ shell æç¤ºç¬¦ ğŸ’‰"></a>ç¬¬13ç« ï¼šè‡ªå®šåˆ¶ shell æç¤ºç¬¦ ğŸ’‰</h1><p>å’Œ Linux å†…çš„è®¸å¤šç¨‹åºä¸€æ ·ï¼Œshell æç¤ºç¬¦æ˜¯å¯é«˜åº¦é…ç½®çš„ï¼Œè™½ç„¶æˆ‘ä»¬æŠŠå®ƒç›¸å½“å¤šåœ°çœ‹ä½œæ˜¯ç†æ‰€å½“ç„¶çš„ï¼Œ ä½†æ˜¯æˆ‘ä»¬ä¸€æ—¦å­¦ä¼šäº†æ€æ ·æ§åˆ¶å®ƒï¼Œshell æç¤ºç¬¦æ˜¯ä¸€ä¸ªç›¸å½“æœ‰ç”¨çš„å·¥å…·ã€‚</p>
<p>æˆ‘ä»¬çš„é»˜è®¤æç¤ºç¬¦å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[me@linuxbox ~]$</span><br></pre></td></tr></table></figure></p>
<p>æ³¨æ„å®ƒåŒ…å«æˆ‘ä»¬çš„ç”¨æˆ·åï¼Œä¸»æœºåå’Œå½“å‰å·¥ä½œç›®å½•ï¼Œä½†æ˜¯å®ƒåˆæ˜¯æ€æ ·å¾—åˆ°è¿™äº›ä¸œè¥¿çš„å‘¢ï¼Ÿ ç»“æœè¯æ˜éå¸¸ç®€å•ã€‚æç¤ºç¬¦æ˜¯ç”±ä¸€ä¸ªç¯å¢ƒå˜é‡å®šä¹‰çš„ï¼Œå«åš PS1ï¼ˆæ˜¯â€œprompt string oneâ€ çš„ç®€å†™ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ echo å‘½ä»¤æ¥æŸ¥çœ‹ PS1çš„å†…å®¹ã€‚</p>
<h2 id="è®¤è¯†-PS1"><a href="#è®¤è¯†-PS1" class="headerlink" title="è®¤è¯†$PS1"></a>è®¤è¯†$PS1</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[me@linuxbox ~]$ <span class="built_in">echo</span> <span class="variable">$PS1</span></span><br><span class="line"><span class="variable">$&#123;ret_status&#125;</span> %&#123;<span class="variable">$fg</span>[cyan]%&#125;%c%&#123;<span class="variable">$reset_color</span>%&#125; $(git_prompt_info)</span><br></pre></td></tr></table></figure>
<h2 id="æ›´æ”¹-PS1"><a href="#æ›´æ”¹-PS1" class="headerlink" title="æ›´æ”¹ $PS1"></a>æ›´æ”¹ $PS1</h2><p>æˆ‘ä»¬å¯ä»¥é¦–å…ˆå¤‡ä»½ä¸‹ $PS1, ç„¶åå†éšæ„ä¿®æ”¹ $PS1, æœ€åå†é‡æ–°å˜å›æ¥å°±å¯ä»¥äº†ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// å¤‡ä»½ PS1</span><br><span class="line">ps1_old=<span class="string">"<span class="variable">$PS1</span>"</span></span><br><span class="line"></span><br><span class="line">// éšæ„ä¿®æ”¹ PS1</span><br><span class="line">$ PS1=<span class="string">"\a\$ "</span></span><br><span class="line"></span><br><span class="line">// æœ€åæ”¹å›æ¥</span><br><span class="line">PS1=<span class="variable">$ps1_old</span></span><br></pre></td></tr></table></figure></p>
<p>å…¶å®è¿™ä¸ªæˆ‘å¹³æ—¶è‚¯å®šä¸ä¼šç”¨ï¼Œä½†æ˜¯çœ‹ç€çœ‹ç€è¿˜æŒºæœ‰æ„æ€çš„ï¼Œå°±éšæ„è®°å½•äº†ä¸‹ã€‚</p>
<hr>
<h1 id="æ€»ç»“-ğŸŒº"><a href="#æ€»ç»“-ğŸŒº" class="headerlink" title="æ€»ç»“ ğŸŒº"></a>æ€»ç»“ ğŸŒº</h1><p>è¿™å‡ ä¸ªç« èŠ‚ä¸»è¦æ˜¯æ€»ç»“äº†<code>é…ç½®æ–‡ä»¶å’Œ shell ç¯å¢ƒ</code>è¿™ ä¸€å¼ ã€‚è¿™ç« å†…å®¹å°‘ç”¨ï¼Œä½†æ˜¯å¯¹äºç†è§£æ•´ä½“ shell æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚</p>
<p>æ—¶é—´éƒ½æ˜¯æŒ¤å‡ºæ¥çš„ï¼Œäº‹å®è¯æ˜åˆ©ç”¨å¥½ä¸­åˆå’Œæ™šä¸Šå›å®¶ä¹‹å‰çš„æ—¶é—´ï¼Œä¹Ÿæ˜¯èƒ½æœ‰æ‰€æ”¶è·ã€‚ğŸ“š</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ç¬¬11ç« ï¼šshell-ç¯å¢ƒ-ğŸ¡&quot;&gt;&lt;a href=&quot;#ç¬¬11ç« ï¼šshell-ç¯å¢ƒ-ğŸ¡&quot; class=&quot;headerlink&quot; title=&quot;ç¬¬11ç« ï¼šshell ç¯å¢ƒ ğŸ¡&quot;&gt;&lt;/a&gt;ç¬¬11ç« ï¼šshell ç¯å¢ƒ ğŸ¡&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;s
    
    </summary>
    
    
      <category term="è¯»ä¹¦ç¬”è®°" scheme="http://sevencai.github.io/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>The Linux Command Line è¯»ä¹¦ç¬”è®°ï¼ˆäºŒï¼‰</title>
    <link href="http://sevencai.github.io/2018/08/17/The-Linux-Command-Line-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <id>http://sevencai.github.io/2018/08/17/The-Linux-Command-Line-è¯»ä¹¦ç¬”è®°ï¼ˆäºŒï¼‰/</id>
    <published>2018-08-17T09:11:25.000Z</published>
    <updated>2018-08-17T09:29:08.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«"><a href="#ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«" class="headerlink" title="ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«"></a>ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«</h1><blockquote>
<p>Unix ä¼ ç»Ÿä¸­çš„æ“ä½œç³»ç»Ÿä¸åŒäºé‚£äº› MS-DOS ä¼ ç»Ÿä¸­çš„ç³»ç»Ÿï¼ŒåŒºåˆ«åœ¨äºå®ƒä»¬ä¸ä»…æ˜¯å¤šä»»åŠ¡ç³»ç»Ÿï¼Œè€Œä¸”ä¹Ÿæ˜¯ å¤šç”¨æˆ·ç³»ç»Ÿã€‚è¿™åˆ°åº•æ„å‘³ç€ä»€ä¹ˆï¼Ÿå®ƒæ„å‘³ç€å¤šä¸ªç”¨æˆ·å¯ä»¥åœ¨åŒä¸€æ—¶é—´ä½¿ç”¨åŒä¸€å°è®¡ç®—æœºã€‚<br>ä¸ºäº†ä½¿å¤šç”¨æˆ·ç‰¹æ€§ä»˜è¯¸å®è·µï¼Œé‚£ä¹ˆå¿…é¡»å‘æ˜ä¸€ç§æ–¹æ³•æ¥<strong>é˜»æ­¢ç”¨æˆ·å½¼æ­¤ä¹‹é—´å—åˆ°å½±å“</strong>ã€‚æ¯•ç«Ÿï¼Œä¸€ä¸ª ç”¨æˆ·çš„è¡Œä¸ºä¸èƒ½å¯¼è‡´è®¡ç®—æœºå´©æºƒï¼Œä¹Ÿä¸èƒ½ä¹±åŠ¨å±äºå¦ä¸€ä¸ªç”¨æˆ·çš„æ–‡ä»¶ã€‚</p>
</blockquote>
<p>ä¸»è¦çš„å‘½ä»¤æœ‰ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">id â€“ æ˜¾ç¤ºç”¨æˆ·èº«ä»½å·ï¼ˆæ¯ä¸ªç”¨æˆ·éƒ½ä¼šæœ‰ä¸ª idï¼‰</span><br><span class="line">chmod â€“ æ›´æ”¹æ–‡ä»¶æ¨¡å¼</span><br><span class="line"><span class="built_in">umask</span> â€“ è®¾ç½®é»˜è®¤çš„æ–‡ä»¶æƒé™ (è¿™ä¸ªæˆ‘åŸºæœ¬ä¸ä¼šç”¨åˆ°ï¼Œæš‚æ—¶å¿½ç•¥)</span><br><span class="line">su â€“ ä»¥å¦ä¸€ä¸ªç”¨æˆ·çš„èº«ä»½æ¥è¿è¡Œ shell</span><br><span class="line">sudo â€“ ä»¥å¦ä¸€ä¸ªç”¨æˆ·çš„èº«ä»½æ¥æ‰§è¡Œå‘½ä»¤</span><br><span class="line">chown â€“ æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…</span><br><span class="line">chgrp â€“ æ›´æ”¹æ–‡ä»¶ç»„æ‰€æœ‰æƒ</span><br><span class="line">passwd â€“ æ›´æ”¹ç”¨æˆ·å¯†ç </span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="chmod-æ›´æ”¹æ–‡ä»¶æ¨¡å¼"><a href="#chmod-æ›´æ”¹æ–‡ä»¶æ¨¡å¼" class="headerlink" title="chmod-æ›´æ”¹æ–‡ä»¶æ¨¡å¼"></a>chmod-æ›´æ”¹æ–‡ä»¶æ¨¡å¼</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-rw-r--r--    1 sevencai  TENCENT\Domain Users     523  8 15 15:36 README.md</span><br></pre></td></tr></table></figure>
<p><strong>åˆ—è¡¨çš„å‰åä¸ªå­—ç¬¦æ˜¯æ–‡ä»¶çš„å±æ€§ã€‚è¿™åä¸ªå­—ç¬¦çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è¡¨æ˜æ–‡ä»¶ç±»å‹ã€‚</strong></p>
<p>å…·ä½“å¯èƒ½æœ‰çš„å€¼æœ‰ï¼š</p>
<p><img src="firstletter.png" alt="first letter"></p>
<p><strong>å‰©ä¸‹çš„ä¹ä¸ªå­—ç¬¦å«åšæ–‡ä»¶æ¨¡å¼ï¼Œä»£è¡¨ç€æ–‡ä»¶æ‰€æœ‰è€…ã€æ–‡ä»¶ç»„æ‰€æœ‰è€…å’Œå…¶ä»–äººçš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ã€‚</strong></p>
<p><img src="filemode.png" alt="filemode"></p>
<p><img src="attribute.png" alt="attribute"></p>
<p>å¦‚<code>-rwxr-xr-x</code>æ ‡è¯†çš„å«ä¹‰æ˜¯ï¼šä¸€ä¸ªæ™®é€šæ–‡ä»¶ï¼Œå¯¹æ–‡ä»¶æ‰€æœ‰è€…æ¥è¯´å¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œã€‚ä¹Ÿå¯ä»¥è¢«å…¶ä»–çš„æ‰€æœ‰äººè¯»å–å’Œæ‰§è¡Œã€‚</p>
<p><strong>æˆ‘ä»¬ä½¿ç”¨å…«è¿›åˆ¶æ•°å­—æ¥è®¾ç½®æ‰€æœŸæœ›çš„æƒé™æ¨¡å¼ã€‚å› ä¸ºæ¯ä¸ªå…«è¿›åˆ¶æ•°å­—ä»£è¡¨äº† 3ä¸ªäºŒè¿›åˆ¶æ•°å­—ï¼Œè¿™ç§å¯¹åº”å…³ç³»ï¼Œæ­£å¥½æ˜ å°„åˆ°ç”¨æ¥å­˜å‚¨æ–‡ä»¶æ¨¡å¼æ‰€ä½¿ç”¨çš„æ–¹æ¡ˆä¸Šã€‚</strong></p>
<p>å¯¹åº”çš„å€¼ä¸ºï¼š</p>
<p><img src="otcal.png" alt="octal"></p>
<p>é€šè¿‡ä½¿ç”¨3ä¸ªå…«è¿›åˆ¶æ•°å­—ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè®¾ç½®æ–‡ä»¶æ‰€æœ‰è€…ã€ç”¨æˆ·ç»„å’Œå…¶ä»–äººçš„æƒé™ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 600 foo.txt</span><br><span class="line">chmod 755 shell.sh</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡ä¼ é€’å‚æ•° â€œ600â€ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè®¾ç½®æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™ä¸ºè¯»å†™æƒé™ï¼Œè€Œåˆ é™¤ç”¨æˆ·ç»„å’Œå…¶ä»–äººçš„æ‰€æœ‰ æƒé™ã€‚è™½ç„¶å…«è¿›åˆ¶åˆ°äºŒè¿›åˆ¶çš„æ˜ å°„çœ‹èµ·æ¥ä¸æ–¹ä¾¿ï¼Œä½†é€šå¸¸åªä¼šç”¨åˆ°ä¸€äº›å¸¸è§çš„æ˜ å°„å…³ç³»ï¼š 7 (rwx)ï¼Œ6 (rw-)ï¼Œ5 (r-x)ï¼Œ4 (râ€“)ï¼Œå’Œ 0 (â€”)ã€‚</p>
<p>chmod å‘½ä»¤è¿˜æ”¯æŒä¸€ç§ç¬¦å·è¡¨ç¤ºæ³•ï¼Œæ¥æŒ‡å®šæ–‡ä»¶æ¨¡å¼ã€‚ç¬¦å·è¡¨ç¤ºæ³•åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šæ›´æ”¹ä¼šå½±å“è°ï¼Œ è¦æ‰§è¡Œå“ªä¸ªæ“ä½œï¼Œè¦è®¾ç½®å“ªç§æƒé™ã€‚é€šè¿‡å­—ç¬¦ â€œuâ€ã€â€œgâ€ã€â€œoâ€å’Œ â€œaâ€ çš„ç»„åˆæ¥æŒ‡å®š è¦å½±å“çš„å¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="ugoa.png" alt="ugoa"></p>
<p><strong>å¦‚æœæ²¡æœ‰æŒ‡å®šå­—ç¬¦ï¼Œåˆ™å‡å®šä½¿ç”¨â€allâ€ã€‚æ‰§è¡Œçš„æ“ä½œå¯èƒ½æ˜¯ä¸€ä¸ªâ€œï¼‹â€å­—ç¬¦ï¼Œè¡¨ç¤ºåŠ ä¸Šä¸€ä¸ªæƒé™ï¼Œ ä¸€ä¸ªâ€œï¼â€ï¼Œè¡¨ç¤ºåˆ æ‰ä¸€ä¸ªæƒé™ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªâ€œï¼â€ï¼Œè¡¨ç¤ºåªæœ‰æŒ‡å®šçš„æƒé™å¯ç”¨ï¼Œå…¶å®ƒæ‰€æœ‰çš„æƒé™è¢«åˆ é™¤ã€‚</strong></p>
<p>æœ‰ä¸‹é¢è¿™äº›ä¾‹å­ï¼ˆæˆ‘æ„Ÿè§‰è¿™ç§æˆ‘åº”è¯¥ä¸ä¼šç»å¸¸ç”¨ï¼Œå…ˆå‰ä¸€ç›´ç”¨ä¸Šé¢çš„äºŒè¿›åˆ¶æ¨¡å¼æ¯”è¾ƒå¤šï¼‰ï¼š</p>
<p><img src="other.png" alt="ugoa+-"></p>
<hr>
<h2 id="su-åŠ-sudo"><a href="#su-åŠ-sudo" class="headerlink" title="su åŠ sudo"></a>su åŠ sudo</h2><blockquote>
<p>su ï¼ ä»¥å…¶ä»–ç”¨æˆ·èº«ä»½å’Œç»„ ID è¿è¡Œä¸€ä¸ª shell<br>è¯­æ³•ç±»ä¼¼ï¼š su [-[l]] [user]</p>
</blockquote>
<p>å¦‚æœåŒ…å«â€-lâ€é€‰é¡¹ï¼Œé‚£ä¹ˆä¼šä¸ºæŒ‡å®šç”¨æˆ·å¯åŠ¨ä¸€ä¸ªéœ€è¦ç™»å½•çš„ shellã€‚è¿™æ„å‘³ç€ä¼šåŠ è½½æ­¤ç”¨æˆ·çš„ shell ç¯å¢ƒï¼Œ å¹¶ä¸”å·¥ä½œç›®å½•ä¼šæ›´æ”¹åˆ°è¿™ä¸ªç”¨æˆ·çš„å®¶ç›®å½•ã€‚è¿™é€šå¸¸æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚å¦‚æœä¸æŒ‡å®šç”¨æˆ·ï¼Œé‚£ä¹ˆå°±å‡å®šæ˜¯ è¶…çº§ç”¨æˆ·ã€‚æ³¨æ„ï¼ˆä¸å¯æ€è®®åœ°ï¼‰ï¼Œé€‰é¡¹â€-lâ€å¯ä»¥ç¼©å†™ä¸ºâ€-â€œï¼Œè¿™æ˜¯ç»å¸¸ç”¨åˆ°çš„å½¢å¼ã€‚</p>
<p>å› æ­¤ä¸ºäº†å¯åŠ¨è¶…çº§ç”¨æˆ·æˆ‘ä»¬å¯èƒ½ä¼šè¿™æ ·æ‰§è¡Œ<code>su -</code>ã€‚</p>
<p>å¦‚æœä»¥<code>su -c &#39;command&#39;</code>è¿™æ ·çš„æ–¹å¼å¯åŠ¨ä¸€ä¸ª shell, æ˜¯å¯ä»¥æ‰§è¡Œå•ä¸ªçš„<code>command</code>å‘½ä»¤ï¼Œè€Œä¸æ˜¯é‡æ–°å¯åŠ¨äº†ä¸€ä¸ªå¯ä»¥äº¤äº’çš„shellã€‚æ³¨æ„ command è¦ç”¨ å¼•å·å¼•èµ·æ¥ã€‚å¦‚<code>su -c &#39;ls -l /root/*&#39;</code>ã€‚</p>
<p><strong>sudo å‘½ä»¤åœ¨å¾ˆå¤šæ–¹é¢éƒ½ç›¸ä¼¼äº su å‘½ä»¤ï¼Œä½†æ˜¯ sudo è¿˜æœ‰ä¸€äº›éå¸¸é‡è¦çš„åŠŸèƒ½ã€‚ç®¡ç†å‘˜èƒ½å¤Ÿé…ç½® sudo å‘½ä»¤ï¼Œä»è€Œå…è®¸ä¸€ä¸ªæ™®é€šç”¨æˆ·ä»¥ä¸åŒçš„èº«ä»½ï¼ˆé€šå¸¸æ˜¯è¶…çº§ç”¨æˆ·ï¼‰ï¼Œé€šè¿‡ä¸€ç§éå¸¸å¯æ§çš„æ–¹å¼ æ¥æ‰§è¡Œå‘½ä»¤ã€‚å°¤å…¶æ˜¯ï¼Œåªæœ‰ä¸€ä¸ªç”¨æˆ·å¯ä»¥æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªç‰¹æ®Šå‘½ä»¤æ—¶ï¼Œï¼ˆæ›´ä½“ç°äº† sudo å‘½ä»¤çš„æ–¹ä¾¿æ€§ï¼‰ã€‚</strong></p>
<p>æ‰§è¡Œ <code>sudo -l</code>å¯ä»¥çœ‹å½“å‰è¢«èµ‹äºˆäº†å“ªäº›æƒé™å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">âœ  midas-welfare git:(master) sudo -l</span><br><span class="line">Password:</span><br><span class="line">Matching Defaults entries for sevencai on SEVENCAI-MB2:</span><br><span class="line">    env_reset ......</span><br><span class="line">User sevencai may run the following commands on SEVENCAI-MB2:</span><br><span class="line">    (ALL) ALL</span><br></pre></td></tr></table></figure></p>
<p>æ‰€ä»¥è¿™é‡Œæ€»ç»“ä¸‹ su å’Œ sudo çš„åŒºåˆ«å’Œè”ç³»ï¼š</p>
<ol>
<li><code>sudo</code> å‘½ä»¤éœ€è¦è¾“å…¥å½“å‰ç”¨æˆ·çš„å¯†ç ï¼Œ<code>su</code> å‘½ä»¤éœ€è¦è¾“å…¥ root ç”¨æˆ·çš„å¯†ç ã€‚</li>
<li><code>sudo</code> å‘½ä»¤åªå…è®¸ä½¿ç”¨æå‡çš„æƒé™è¿è¡Œå•ä¸ªå‘½ä»¤ï¼Œè€Œ <code>su</code> å‘½ä»¤ä¼šå¯åŠ¨ä¸€ä¸ªæ–°çš„ shellï¼ŒåŒæ—¶å…è®¸ä½¿ç”¨ root æƒé™è¿è¡Œå°½å¯èƒ½å¤šçš„å‘½ä»¤ï¼Œç›´åˆ°æ˜ç¡®é€€å‡ºç™»å½•</li>
</ol>
<p><strong>æ‰€ä»¥æ ¹æ®ç¬¬ä¸€æ¡ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å°±å®‰å…¨æ€§è€Œè¨€ï¼Œ<code>sudo</code> æ¯” <code>su</code> æ›´å¥½ã€‚<code>su</code>æ„å‘³ç€è¦ä¸å…¶ä»–ç”¨æˆ·å…±äº« root å¯†ç ï¼Œè¿™æ˜¯ä¸€ä»¶æ¯”è¾ƒå±é™©çš„äº‹æƒ…ã€‚å¹¶ä¸”å¯¹äº <code>su</code> è€Œè¨€å¦‚æœè¦æ’¤é”€ç‰¹å®šç”¨æˆ·çš„è¶…çº§ï¼ˆrootï¼‰æƒé™ï¼Œå”¯ä¸€çš„åŠæ³•å°±æ˜¯æ›´æ”¹ root å¯†ç ï¼Œç„¶åå†å‘ŠçŸ¥å…¶ä»–ç”¨æˆ·ã€‚å¾ˆéº»çƒ¦ã€‚ä½†æ˜¯ <code>sudo</code> å°±ä¸ä¸€æ ·äº†,å¦‚æœæƒ³è¦é˜»æ­¢æŸä¸ªç”¨æˆ·è®¿é—® root æƒé™ï¼Œåªéœ€è¦è°ƒæ•´ <code>sudoers</code> è¿™ä¸ªæ–‡ä»¶ä¸­çš„é…ç½®å³å¯ã€‚</strong></p>
<p>The key difference between <code>sudo</code> and <code>su</code> is <code>sudo</code> runs a command as root, whereas <code>su</code> makes you root.</p>
<hr>
<h2 id="chown-ï¼-æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„"><a href="#chown-ï¼-æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„" class="headerlink" title="chown ï¼ æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„"></a>chown ï¼ æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„</h2><p><strong>chown å‘½ä»¤è¢«ç”¨æ¥æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„ã€‚ä½¿ç”¨è¿™ä¸ªå‘½ä»¤éœ€è¦è¶…çº§ç”¨æˆ·æƒé™ã€‚</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown [owner][:[group]] file...</span><br></pre></td></tr></table></figure>
<p><img src="chown.png" alt="chown"></p>
<p>ä¸‹é¢è¿™ä¸ªä¾‹å­æ¯”è¾ƒå®ç”¨ï¼Œæœ‰ä¸¤ä¸ªç”¨æˆ·ï¼Œjanetæ‹¥æœ‰è¶…çº§ç”¨æˆ·è®¿é—®æƒé™ï¼Œè€Œ tony æ²¡æœ‰ã€‚ç”¨æˆ· janet æƒ³è¦ä» å¥¹çš„å®¶ç›®å½•å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶åˆ°ç”¨æˆ· tony çš„å®¶ç›®å½•ã€‚å› ä¸ºç”¨æˆ· janet æƒ³è¦ tony èƒ½å¤Ÿç¼–è¾‘è¿™ä¸ªæ–‡ä»¶ï¼Œ janet æŠŠè¿™ä¸ªæ–‡ä»¶çš„æ‰€æœ‰è€…æ›´æ”¹ä¸º tony:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[janet@linuxbox ~]$ sudo cp myfile.txt ~tony</span><br><span class="line">Password:</span><br><span class="line">[janet@linuxbox ~]$ sudo ls -l ~tony/myfile.txt</span><br><span class="line">-rw-r--r-- <span class="number">1</span> root  root <span class="number">8031</span> <span class="number">2008</span><span class="number">-03</span><span class="number">-20</span> <span class="number">14</span>:<span class="number">30</span> /home/tony/myfile.txt</span><br><span class="line">[janet@linuxbox ~]$ sudo chown tony: ~tony/myfile.txt</span><br><span class="line">[janet@linuxbox ~]$ sudo ls -l ~tony/myfile.txt</span><br><span class="line">-rw-r--r-- <span class="number">1</span> tony  tony <span class="number">8031</span> <span class="number">2008</span><span class="number">-03</span><span class="number">-20</span> <span class="number">14</span>:<span class="number">30</span> /home/tony/myfile.txt</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="æ›´æ”¹ç”¨æˆ·å¯†ç "><a href="#æ›´æ”¹ç”¨æˆ·å¯†ç " class="headerlink" title="æ›´æ”¹ç”¨æˆ·å¯†ç "></a>æ›´æ”¹ç”¨æˆ·å¯†ç </h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">passwd [user]</span><br><span class="line">sudo passwd root æ›´æ”¹ root ç”¨æˆ·çš„å¯†ç </span><br></pre></td></tr></table></figure>
<p>passwd å‘½ä»¤å°†ä¼šè¯•ç€å¼ºè¿«ä½ ä½¿ç”¨â€œå¼ºâ€å¯†ç ã€‚è¿™æ„å‘³ç€å®ƒä¼šæ‹’ç»æ¥å—å¤ªçŸ­çš„å¯†ç ã€ä¸å…ˆå‰ç›¸ä¼¼çš„å¯†ç ã€ å­—å…¸ä¸­çš„å•è¯ä½œä¸ºå¯†ç æˆ–è€…æ˜¯å¤ªå®¹æ˜“çŒœåˆ°çš„å¯†ç ã€‚</p>
<hr>
<h1 id="ç¬¬åç« ï¼šè¿›ç¨‹ğŸš“"><a href="#ç¬¬åç« ï¼šè¿›ç¨‹ğŸš“" class="headerlink" title="ç¬¬åç« ï¼šè¿›ç¨‹ğŸš“"></a>ç¬¬åç« ï¼šè¿›ç¨‹ğŸš“</h1><p>å†…æ ¸ç»´æŠ¤æ¯ä¸ªè¿›ç¨‹çš„ä¿¡æ¯ï¼Œä»¥æ­¤æ¥ä¿æŒäº‹æƒ…æœ‰åºã€‚ä¾‹å¦‚ï¼Œç³»ç»Ÿåˆ†é…ç»™æ¯ä¸ªè¿›ç¨‹ä¸€ä¸ªæ•°å­—ï¼Œè¿™ä¸ªæ•°å­—å«åš è¿›ç¨‹(process) ID æˆ– PIDã€‚PID å·æŒ‰å‡åºåˆ†é…ï¼Œinit è¿›ç¨‹çš„ PID æ€»æ˜¯1ã€‚å†…æ ¸ä¹Ÿå¯¹åˆ†é…ç»™æ¯ä¸ªè¿›ç¨‹çš„å†…å­˜å’Œå°±ç»ªçŠ¶æ€è¿›è¡Œè·Ÿè¸ªä»¥ä¾¿ç»§ç»­æ‰§è¡Œè¿™ä¸ªè¿›ç¨‹ã€‚ åƒæ–‡ä»¶ä¸€æ ·ï¼Œè¿›ç¨‹ä¹Ÿæœ‰æ‰€æœ‰è€…å’Œç”¨æˆ· IDï¼Œæœ‰æ•ˆç”¨æˆ· IDï¼Œç­‰ç­‰ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-   ps â€“ æŠ¥å‘Šå½“å‰è¿›ç¨‹å¿«ç…§</span><br><span class="line">-   top â€“ æ˜¾ç¤ºä»»åŠ¡</span><br><span class="line">-   <span class="built_in">jobs</span> â€“ åˆ—å‡ºæ´»è·ƒçš„ä»»åŠ¡</span><br><span class="line">-   <span class="built_in">bg</span> â€“ æŠŠä¸€ä¸ªä»»åŠ¡æ”¾åˆ°åå°æ‰§è¡Œ</span><br><span class="line">-   <span class="built_in">fg</span> â€“ æŠŠä¸€ä¸ªä»»åŠ¡æ”¾åˆ°å‰å°æ‰§è¡Œ</span><br><span class="line">-   <span class="built_in">kill</span> â€“ ç»™ä¸€ä¸ªè¿›ç¨‹å‘é€ä¿¡å·</span><br><span class="line">-   killall â€“ æ€æ­»æŒ‡å®šåå­—çš„è¿›ç¨‹</span><br><span class="line">-   shutdown â€“ å…³æœºæˆ–é‡å¯ç³»ç»Ÿ</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="æŸ¥çœ‹è¿›ç¨‹"><a href="#æŸ¥çœ‹è¿›ç¨‹" class="headerlink" title="æŸ¥çœ‹è¿›ç¨‹"></a>æŸ¥çœ‹è¿›ç¨‹</h2><p>æŸ¥çœ‹è¿›ç¨‹ï¼Œæœ€å¸¸ä½¿ç”¨åœ°å‘½ä»¤ï¼ˆæœ‰å‡ ä¸ªå‘½ä»¤ï¼‰æ˜¯ ps(process)ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ps</span><br><span class="line"></span><br><span class="line">  PID TTY           TIME CMD</span><br><span class="line">54944 ttys000    0:00.14 /Applications/iTerm.app/Contents/MacOS/iTerm2 --server login -fp sevencai</span><br><span class="line">55003 ttys000    0:00.61 -zsh</span><br><span class="line">10488 ttys001    0:00.27 /Applications/iTerm.app/Contents/MacOS/iTerm2 --server login -fp sevencai</span><br><span class="line">10492 ttys001    0:02.66 -zsh</span><br></pre></td></tr></table></figure></p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œps ä¸ä¼šæ˜¾ç¤ºå¾ˆå¤šè¿›ç¨‹ä¿¡æ¯ï¼Œåªæ˜¯åˆ—å‡ºä¸å½“å‰ç»ˆç«¯ä¼šè¯ç›¸å…³çš„è¿›ç¨‹ã€‚ä¸ºäº†å¾—åˆ°æ›´å¤šä¿¡æ¯ï¼Œ æˆ‘ä»¬éœ€è¦åŠ ä¸Šä¸€äº›é€‰é¡¹ã€‚TTY æ˜¯ â€œTeletypeâ€(ç›´è¯‘ç”µä¼ æ‰“å­—æœº) çš„ç®€å†™ï¼Œæ˜¯æŒ‡è¿›ç¨‹çš„æ§åˆ¶ç»ˆç«¯ã€‚TIME å­—æ®µè¡¨ç¤º è¿›ç¨‹æ‰€æ¶ˆè€—çš„ CPU æ—¶é—´æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŠ ä¸Š â€œxâ€ é€‰é¡¹ï¼ˆæ³¨æ„æ²¡æœ‰å¼€å¤´çš„ â€œ-â€œ å­—ç¬¦ï¼‰ï¼Œå‘Šè¯‰ ps å‘½ä»¤ï¼Œå±•ç¤ºæ‰€æœ‰è¿›ç¨‹ï¼Œä¸ç®¡å®ƒä»¬ç”±ä»€ä¹ˆ ç»ˆç«¯ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰æ§åˆ¶ã€‚åœ¨ TTY ä¸€æ ä¸­å‡ºç°çš„ â€œ?â€ ï¼Œè¡¨ç¤ºæ²¡æœ‰æ§åˆ¶ç»ˆç«¯ã€‚ä½¿ç”¨è¿™ä¸ª â€œxâ€ é€‰é¡¹ï¼Œå¯ä»¥ çœ‹åˆ°æˆ‘ä»¬æ‰€æ‹¥æœ‰çš„æ¯ä¸ªè¿›ç¨‹çš„ä¿¡æ¯ã€‚</span></span><br><span class="line">ps x</span><br><span class="line">ps x | less</span><br><span class="line"></span><br><span class="line"><span class="comment">// èƒ½å¤Ÿæ˜¾ç¤ºå±äºæ¯ä¸ªç”¨æˆ·çš„è¿›ç¨‹ä¿¡æ¯ã€‚ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ï¼Œå¯ä»¥å”¤é†’ â€œBSD é£æ ¼â€ çš„è¾“å‡ºç»“æœã€‚</span></span><br><span class="line">ps aux</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ç”¨-top-å‘½ä»¤åŠ¨æ€æŸ¥çœ‹è¿›ç¨‹"><a href="#ç”¨-top-å‘½ä»¤åŠ¨æ€æŸ¥çœ‹è¿›ç¨‹" class="headerlink" title="ç”¨ top å‘½ä»¤åŠ¨æ€æŸ¥çœ‹è¿›ç¨‹"></a>ç”¨ top å‘½ä»¤åŠ¨æ€æŸ¥çœ‹è¿›ç¨‹</h2><p><strong>è™½ç„¶ ps å‘½ä»¤èƒ½å¤Ÿå±•ç¤ºè®¸å¤šè®¡ç®—æœºè¿è¡ŒçŠ¶æ€çš„ä¿¡æ¯ï¼Œä½†æ˜¯å®ƒåªæ˜¯æä¾› ps å‘½ä»¤æ‰§è¡Œæ—¶åˆ»çš„æœºå™¨çŠ¶æ€å¿«ç…§ã€‚ ä¸ºäº†çœ‹åˆ°æ›´å¤šåŠ¨æ€çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>top</code> å‘½ä»¤ã€‚</strong></p>
<p>top ç¨‹åºæ¥å—ä¸€ç³»åˆ—ä»é”®ç›˜è¾“å…¥çš„å‘½ä»¤ã€‚ä¸¤ä¸ªæœ€æœ‰è¶£çš„å‘½ä»¤æ˜¯ h å’Œ qã€‚hï¼Œæ˜¾ç¤ºç¨‹åºçš„å¸®åŠ©å±å¹•ï¼Œqï¼Œ é€€å‡º top ç¨‹åºã€‚</p>
<hr>
<h2 id="é€šè¿‡-kill-å‘½ä»¤ç»™è¿›ç¨‹å‘é€ä¿¡å·"><a href="#é€šè¿‡-kill-å‘½ä»¤ç»™è¿›ç¨‹å‘é€ä¿¡å·" class="headerlink" title="é€šè¿‡ kill å‘½ä»¤ç»™è¿›ç¨‹å‘é€ä¿¡å·"></a>é€šè¿‡ kill å‘½ä»¤ç»™è¿›ç¨‹å‘é€ä¿¡å·</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> [-signal] PID...</span><br><span class="line"></span><br><span class="line"><span class="built_in">kill</span> -1 13546</span><br><span class="line"><span class="built_in">kill</span> -9 pid (æˆ‘ç»å¸¸ç”¨)</span><br></pre></td></tr></table></figure>
<p>å…·ä½“çš„ <code>-signal</code> çš„å¯é€‰å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="kill.png" alt="kill"></p>
<hr>
<h1 id="æ€»ç»“ğŸŒ¹"><a href="#æ€»ç»“ğŸŒ¹" class="headerlink" title="æ€»ç»“ğŸŒ¹"></a>æ€»ç»“ğŸŒ¹</h1><p>åŠ ä¸Šè¿™ç¯‡æ–‡ç« ï¼Œ<code>The Linux Command Line</code> çš„ç¬¬ä¸€ç« å°±ç»“æŸäº†ã€‚æˆ‘é›¶é›¶æ•£æ•£çš„èŠ±çš„æ—¶é—´å»æ•´ç†çš„ï¼Œä¸­é—´ä¹Ÿå»é™¤äº†ä¸€äº›æˆ‘åŸºæœ¬ä¸Šä¸æ€ä¹ˆç”¨åˆ°çš„ï¼Œç€é‡åŠ å¼ºäº†ä¸‹æˆ‘ç»å¸¸ç”¨åˆ°çš„ä¸€äº›å‘½ä»¤ã€‚</p>
<p>æ¯”å¦‚ kill ï¼Œæˆ‘ä»¥å‰ç»å¸¸ç”¨åˆ° kill -9, ä½†æ˜¯å…¶å®ä¸€ç›´ä¸çŸ¥é“è¿™ä¸ª -9 æ˜¯ä»€ä¹ˆä¸œè¥¿ã€‚ç°åœ¨è¿›è¡Œç¨å¾®ç³»ç»Ÿä¸€ç‚¹çš„å­¦ä¹ ï¼Œæ‰“å‘½ä»¤ä¸å†ä¾é ç†Ÿæ‚‰å’Œæ›¾ç»ç”¨è¿‡ï¼Œè€Œæ˜¯æœ‰ç†è§£çš„ã€‚ğŸ“šâ„ï¸</p>
<p>åŒ…æ‹¬è¿˜æœ‰  sudo åŠ su, ä»¥å‰ä¸€ç›´æœ‰ç”¨è¿‡ï¼Œä½†æ˜¯æ¨¡æ‹Ÿä¸¤å¯ï¼Œå¹¶ä¸çŸ¥é“ä¸¤è€…çš„åŒºåˆ«ã€‚ç°åœ¨éƒ½å¤§è‡´çš„æœ‰äº†è§£ã€‚ä»¥åçœ‹è¿ç»´åŒå­¦æ•²å‘½ä»¤ï¼Œæˆ‘çœ‹å®ƒæ•² su or sudo å°±çŸ¥é“å®ƒæ˜¯å¤§æ¦‚çš„åŒºåˆ«æ˜¯ä»€ä¹ˆäº†ã€‚æƒ³è¦åšä»€ä¹ˆäº‹æƒ…ã€‚ğŸ¶</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«&quot;&gt;&lt;a href=&quot;#ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«&quot; class=&quot;headerlink&quot; title=&quot;ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«&quot;&gt;&lt;/a&gt;ç¬¬ä¹ç« -æƒé™ç®¡ç†ğŸ«&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;Unix ä¼ ç»Ÿä¸­çš„æ“ä½œç³»ç»Ÿä¸åŒäºé‚£äº› MS-DOS
    
    </summary>
    
    
      <category term="è¯»ä¹¦ç¬”è®°" scheme="http://sevencai.github.io/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>The Linux Command Line è¯»ä¹¦ç¬”è®°ï¼ˆä¸€ï¼‰</title>
    <link href="http://sevencai.github.io/2018/08/10/The-Linux-Command-Line-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <id>http://sevencai.github.io/2018/08/10/The-Linux-Command-Line-è¯»ä¹¦ç¬”è®°ï¼ˆä¸€ï¼‰/</id>
    <published>2018-08-10T12:54:15.000Z</published>
    <updated>2018-08-10T13:18:59.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘è¯» <em>The Linux Command Line</em> çš„è¯»ä¹¦ç¬”è®°ã€‚ç”µå­ç‰ˆçš„ä¹¦çš„åœ°å€æ˜¯ï¼š<a href="http://billie66.github.io/TLCL/book/index.html" target="_blank" rel="noopener">TLCL</a>ã€‚ç›¸æ¯”äºé¸Ÿå”ï¼Œè¿™æœ¬ä¹¦å¥½åœ¨æ¯”è¾ƒå°‘ï¼Œé‡ç‚¹æ¯”è¾ƒçªå‡ºï¼Œå¤§éƒ¨åˆ†é‡Œé¢çš„å‘½ä»¤éƒ½æ˜¯æˆ‘ä¼šç»å¸¸ç”¨åˆ°çš„ã€‚ç¼ºç‚¹æ˜¯ä¹Ÿå­˜åœ¨å°‘é‡å†—ä½™çš„å†…å®¹ã€‚ä¸ä¾¿äºæˆ‘æŸ¥æ‰¾å’Œå­¦ä¹ ã€‚å› æ­¤æˆ‘æŠŠæˆ‘éœ€è¦çš„ä¸œè¥¿ä»ä¸­æŠ½å–å‡ºæ¥ï¼Œæ€»ç»“å¹¶ä¸”æç‚¼ï¼Œä»¥ä¾¿æ—¥åçš„æŸ¥æ‰¾å’Œå­¦ä¹ ã€‚æ­¤ç¯‡ç¬”è®°ğŸ“’æ˜¯ä¹¦çš„ç¬¬ä¸€ç« åˆ°ç¬¬ä¹ç« ã€‚</p>
</blockquote>
<h2 id="ç¬¬ä¸€ç« ï¼šä»€ä¹ˆæ˜¯-shellğŸ "><a href="#ç¬¬ä¸€ç« ï¼šä»€ä¹ˆæ˜¯-shellğŸ " class="headerlink" title="ç¬¬ä¸€ç« ï¼šä»€ä¹ˆæ˜¯ shellğŸ "></a>ç¬¬ä¸€ç« ï¼šä»€ä¹ˆæ˜¯ shellğŸ </h2><p>shell å°±æ˜¯ä¸€ä¸ªç¨‹åºï¼Œå®ƒæ¥å—ä»é”®ç›˜è¾“å…¥çš„å‘½ä»¤ï¼Œ ç„¶åæŠŠå‘½ä»¤ä¼ é€’ç»™æ“ä½œç³»ç»Ÿå»æ‰§è¡Œã€‚å‡ ä¹æ‰€æœ‰çš„ Linux å‘è¡Œç‰ˆéƒ½æä¾›ä¸€ä¸ªåä¸º bash çš„ æ¥è‡ª GNU é¡¹ç›®çš„ shell ç¨‹åºã€‚â€œbashâ€ æ˜¯ â€œBourne Again SHellâ€ çš„é¦–å­—æ¯ç¼©å†™ï¼Œ æ‰€æŒ‡çš„æ˜¯è¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œbash æ˜¯æœ€åˆ Unix ä¸Šç”± Steve Bourne å†™æˆ shell ç¨‹åº sh çš„å¢å¼ºç‰ˆã€‚</p>
<blockquote>
<p>[me@linuxbox ~]$</p>
</blockquote>
<ol>
<li>ä»£è¡¨ username@machinename ï¼Œåé¢å¯èƒ½æ˜¯ $ or #ï¼Œå…¶ä¸­ # ä»£è¡¨äº†ä½ æœ‰ root æƒé™ï¼Œ å¯¹åº”çš„ $ å¯èƒ½ä»£è¡¨çš„å°±æ˜¯æ™®é€šçš„ç”¨æˆ·ã€‚</li>
<li>ä¸€äº›ç®€å•çš„å‘½ä»¤å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">date  å½“å‰æ—¶é—´</span><br><span class="line">cal  æ—¥æœŸ</span><br><span class="line">df  æŸ¥çœ‹ç£ç›˜å‰©ä½™ç©ºé—´çš„æ•°é‡</span><br><span class="line"><span class="built_in">exit</span>  ç»ˆæ­¢ä¼šè¯</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ç¬¬äºŒç« ï¼šæ–‡ä»¶ç³»ç»Ÿä¸­è·³è½¬"><a href="#ç¬¬äºŒç« ï¼šæ–‡ä»¶ç³»ç»Ÿä¸­è·³è½¬" class="headerlink" title="ç¬¬äºŒç« ï¼šæ–‡ä»¶ç³»ç»Ÿä¸­è·³è½¬"></a>ç¬¬äºŒç« ï¼šæ–‡ä»¶ç³»ç»Ÿä¸­è·³è½¬</h2><p>ç›¸å…³å‘½ä»¤ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pwd</span> æ‰“å°å‡ºå½“å‰å·¥ä½œç›®å½•å</span><br><span class="line"><span class="built_in">cd</span>  dir æ›´æ”¹ç›®å½•</span><br><span class="line">ls  åˆ—å‡ºç›®å½•å†…å®¹ï¼Œä¸åŒ…æ‹¬å¸¦ . çš„éšè—ç›®å½•</span><br><span class="line">ls  -a å¯ä»¥åˆ—å‡ºå¸¦ . éšè—çš„ç›®å½•</span><br><span class="line"><span class="built_in">cd</span>  æ›´æ”¹å·¥ä½œç›®å½•åˆ°ä½ çš„å®¶ç›®å½•</span><br><span class="line"><span class="built_in">cd</span>  - æ›´æ”¹å·¥ä½œç›®å½•åˆ°å…ˆå‰çš„å·¥ä½œç›®å½•</span><br><span class="line"><span class="built_in">cd</span>  ~user_name æ›´æ”¹å·¥ä½œç›®å½•åˆ°ç”¨æˆ·å®¶ç›®å½•</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="ç¬¬ä¸‰ç« ï¼šæ¢ç©¶æ“ä½œç³»ç»Ÿ"><a href="#ç¬¬ä¸‰ç« ï¼šæ¢ç©¶æ“ä½œç³»ç»Ÿ" class="headerlink" title="ç¬¬ä¸‰ç« ï¼šæ¢ç©¶æ“ä½œç³»ç»Ÿ"></a>ç¬¬ä¸‰ç« ï¼šæ¢ç©¶æ“ä½œç³»ç»Ÿ</h2><p>ç›¸å…³å‘½ä»¤ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ls    åˆ—å‡ºç›®å½•å†…å®¹</span><br><span class="line">file   ç¡®å®šæ–‡ä»¶ç±»å‹</span><br><span class="line">less   æµè§ˆæ–‡ä»¶å†…å®¹</span><br><span class="line"></span><br><span class="line">ls -l    ä½¿ç”¨ ls å‘½ä»¤çš„â€œ-lâ€é€‰é¡¹ï¼Œåˆ™ç»“æœä»¥é•¿æ¨¡å¼è¾“å‡º === ll</span><br><span class="line">ls -lt   <span class="string">"t"</span>é€‰é¡¹æŒ‰æ–‡ä»¶ä¿®æ”¹æ—¶é—´çš„å…ˆåæ¥æ’åº</span><br><span class="line">file filename   æŸ¥çœ‹æ–‡ä»¶çš„ç±»å‹</span><br></pre></td></tr></table></figure></p>
<h3 id="å‘½ä»¤æ ¼å¼"><a href="#å‘½ä»¤æ ¼å¼" class="headerlink" title="å‘½ä»¤æ ¼å¼"></a>å‘½ä»¤æ ¼å¼</h3><blockquote>
<p>å‘½ä»¤åç»å¸¸ä¼šå¸¦æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æ¥æ›´æ­£å‘½ä»¤è¡Œä¸ºçš„é€‰é¡¹ï¼Œ æ›´è¿›ä¸€æ­¥ï¼Œé€‰é¡¹åé¢ä¼šå¸¦æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼Œè¿™äº›å‚æ•°æ˜¯å‘½ä»¤ä½œç”¨çš„å¯¹è±¡ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> -options arguments</span><br><span class="line">ls -lt --reverse</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><code>options</code> : é€‰é¡¹, ä¸€èˆ¬æ˜¯ -l  è¿™ç§å½¢å¼ï¼Œä¹Ÿæ”¯æŒé•¿é€‰é¡¹ï¼Œé•¿é€‰é¡¹ç”±ä¸¤ä¸ªä¸­åˆ’çº¿åŠ ä¸Šä¸€ä¸ªå­—ç»„æˆã€‚å¦‚ <code>--reverse</code>ã€‚ å½“ç„¶ä¹Ÿæœ‰ä¸¤ç§åˆå¹¶çš„ã€‚å¦‚ä¸Šã€‚</p>
<p>ä¸‹é¢è¿™å¼ å›¾æ¥æºäºä¹¦é‡Œçš„å¯¹lsçš„å‘½ä»¤çš„ä¸€éƒ¨åˆ†åˆ—ä¸¾ï¼Œçº¢è‰²çš„æ¡†æ˜¯æˆ‘ç»å¸¸ç”¨çš„ï¼š</p>
<p><img src="ls.png" alt="ls"></p>
<h3 id="less"><a href="#less" class="headerlink" title="less"></a>less</h3><p>less å‘½ä»¤æ˜¯ä¸€ä¸ªç”¨æ¥æµè§ˆæ–‡æœ¬æ–‡ä»¶çš„ç¨‹åº,less ç¨‹åºå…è®¸ä½ å‰åæ»šåŠ¨æ–‡ä»¶ã€‚</p>
<blockquote>
<p>æ ¼å¼ä¸ºï¼š less filename<br>å¦‚ less a.log<br>å¦‚ ps -ef | less ä»¥åˆ†é¡µçš„å½¢å¼æŸ¥çœ‹å½“å‰è¿›ç¨‹ (è¿™ä¸ªå¥½ç”¨)</p>
</blockquote>
<p><img src="less.png" alt="less"></p>
<p>ä¸Šé¢è¿™ä¸ªå›¾é‡Œæ˜¯ä¸æ˜¯æ„Ÿè§‰è·Ÿ vim å‘½ä»¤å¾ˆåƒï¼Œæˆ‘å†è¡¥å……å‡ ä¸ªï¼Œæ˜¯æˆ‘ç»å¸¸ç”¨åˆ°çš„ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-   /å­—ç¬¦ä¸²ï¼šå‘ä¸‹æœç´¢<span class="string">"å­—ç¬¦ä¸²"</span>çš„åŠŸèƒ½</span><br><span class="line">-   ?å­—ç¬¦ä¸²ï¼šå‘ä¸Šæœç´¢<span class="string">"å­—ç¬¦ä¸²"</span>çš„åŠŸèƒ½</span><br><span class="line">-   nï¼šé‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰</span><br><span class="line">-   Nï¼šåå‘é‡å¤å‰ä¸€ä¸ªæœç´¢ï¼ˆä¸ / æˆ– ? æœ‰å…³ï¼‰</span><br><span class="line">-   b å‘åç¿»ä¸€é¡µ</span><br><span class="line">-   d å‘åç¿»åŠé¡µ</span><br><span class="line">-   ç©ºæ ¼é”® æ»šåŠ¨ä¸€é¡µ</span><br><span class="line">-   å›è½¦é”® æ»šåŠ¨ä¸€è¡Œ</span><br><span class="line">-   u å‘å‰æ»šåŠ¨åŠé¡µ</span><br><span class="line">-   y å‘å‰æ»šåŠ¨ä¸€è¡Œ</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ç¬¬å››ç« ï¼šæ“ä½œæ–‡ä»¶å’Œç›®å½•"><a href="#ç¬¬å››ç« ï¼šæ“ä½œæ–‡ä»¶å’Œç›®å½•" class="headerlink" title="ç¬¬å››ç« ï¼šæ“ä½œæ–‡ä»¶å’Œç›®å½•"></a>ç¬¬å››ç« ï¼šæ“ä½œæ–‡ä»¶å’Œç›®å½•</h2><p>ä¸»è¦å‘½ä»¤æœ‰ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-   cp â€” å¤åˆ¶æ–‡ä»¶å’Œç›®å½•</span><br><span class="line">-   mv â€” ç§»åŠ¨/é‡å‘½åæ–‡ä»¶å’Œç›®å½•</span><br><span class="line">-   mkdir â€” åˆ›å»ºç›®å½•</span><br><span class="line">-   rm â€” åˆ é™¤æ–‡ä»¶å’Œç›®å½•</span><br><span class="line">-   ln â€” åˆ›å»ºç¡¬é“¾æ¥å’Œç¬¦å·é“¾æ¥</span><br></pre></td></tr></table></figure></p>
<p>è¿™å‡ ä¸ªå‘½ä»¤æˆ‘ä»¬æœ€ç†Ÿæ‚‰ä¸è¿‡äº†ã€‚ä¸‹é¢ç®€å•çš„åˆ—ä¸¾äº†è¿™å‡ ä¸ªçš„ä¸€äº›åŸºæœ¬ç”¨æ³•ã€‚</p>
<h3 id="cp-å¤åˆ¶æ–‡ä»¶å’Œç›®å½•"><a href="#cp-å¤åˆ¶æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="cp å¤åˆ¶æ–‡ä»¶å’Œç›®å½•"></a>cp å¤åˆ¶æ–‡ä»¶å’Œç›®å½•</h3><p><img src="cp.png" alt="cp"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è‹¥ file2 å­˜åœ¨ï¼Œåˆ™è¦†ç›–oré‡å†™ï¼Œè‹¥ä¸å­˜åœ¨åˆ™åˆ›å»º</span></span><br><span class="line">cp file1 file2</span><br><span class="line"></span><br><span class="line"><span class="comment">// -i ä»£è¡¨ info, æ‰€ä»¥è·Ÿä¸Šé¢ç›¸åŒï¼Œåªæ˜¯è¦†ç›–oré‡å†™ä¼šæœ‰æç¤º</span></span><br><span class="line">cp -i file1 file2</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤åˆ¶æ–‡ä»¶ file1 å’Œæ–‡ä»¶ file2 åˆ°ç›®å½• dir1ã€‚ç›®å½• dir1 å¿…é¡»å­˜åœ¨</span></span><br><span class="line">cp file1 file2 dir1</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ä¸€ä¸ªé€šé…ç¬¦ï¼Œåœ¨ç›®å½• dir1 ä¸­çš„æ‰€æœ‰æ–‡ä»¶éƒ½è¢«å¤åˆ¶åˆ°ç›®å½• dir2 ä¸­ã€‚ dir2 å¿…é¡»å·²ç»å­˜åœ¨</span></span><br><span class="line">cp dir1<span class="comment">/* dir2</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">// å¤åˆ¶ç›®å½• dir1 ä¸­çš„å†…å®¹åˆ°ç›®å½• dir2ã€‚</span></span><br><span class="line"><span class="comment">// å¦‚æœç›®å½• dir2 ä¸å­˜åœ¨ï¼Œ åˆ›å»ºç›®å½• dir2ï¼Œæ“ä½œå®Œæˆåï¼Œç›®å½• dir2 ä¸­çš„å†…å®¹å’Œ dir1 ä¸­çš„ä¸€æ ·</span></span><br><span class="line"><span class="comment">cp -r dir1 dir2</span></span><br></pre></td></tr></table></figure>
<h3 id="mv-ç§»åŠ¨å’Œé‡å‘½åæ–‡ä»¶"><a href="#mv-ç§»åŠ¨å’Œé‡å‘½åæ–‡ä»¶" class="headerlink" title="mv ç§»åŠ¨å’Œé‡å‘½åæ–‡ä»¶"></a>mv ç§»åŠ¨å’Œé‡å‘½åæ–‡ä»¶</h3><p><img src="mv.png" alt="mv"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœ file2 å­˜åœ¨ï¼Œå®ƒçš„å†…å®¹ä¼šè¢« file1 çš„å†…å®¹é‡å†™ã€‚</span></span><br><span class="line"><span class="comment">// å¦‚æœ file2 ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º file2ã€‚ è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œfile1 éƒ½ä¸å†å­˜åœ¨</span></span><br><span class="line">mv file1 file2</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡å†™æ—¶ä¼šæç¤ºç”¨æˆ·</span></span><br><span class="line">mv -i file1 file2</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç§»åŠ¨ file1 å’Œ file2 åˆ°ç›®å½• dir1 ä¸­ã€‚dir1 å¿…é¡»å·²ç»å­˜åœ¨</span></span><br><span class="line">mv file1 file2 dir1</span><br></pre></td></tr></table></figure>
<h3 id="rm-åˆ é™¤æ–‡ä»¶å’Œç›®å½•"><a href="#rm-åˆ é™¤æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="rm - åˆ é™¤æ–‡ä»¶å’Œç›®å½•"></a>rm - åˆ é™¤æ–‡ä»¶å’Œç›®å½•</h3><p><img src="rm.png" alt="rm"><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é»˜é»˜åœ°åˆ é™¤æ–‡ä»¶</span></span><br><span class="line">rm file1</span><br><span class="line"></span><br><span class="line"><span class="comment">// é™¤äº†åœ¨åˆ é™¤æ–‡ä»¶ä¹‹å‰ï¼Œæç¤ºç”¨æˆ·ç¡®è®¤ä¿¡æ¯ä¹‹å¤–ï¼Œå’Œä¸Šé¢çš„å‘½ä»¤ä½œç”¨ä¸€æ ·</span></span><br><span class="line">rm -i file1</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤æ–‡ä»¶ file1, ç›®å½• dir1ï¼ŒåŠ dir1 ä¸­çš„å†…å®¹</span></span><br><span class="line">rm -r file1 dir1</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒä¸Šï¼Œé™¤äº†å¦‚æœæ–‡ä»¶ file1ï¼Œæˆ–ç›®å½• dir1 ä¸å­˜åœ¨çš„è¯ï¼Œrm ä»ä¼šç»§ç»­æ‰§è¡Œã€‚</span></span><br><span class="line">rm -rf file1 dir1</span><br></pre></td></tr></table></figure></p>
<p><strong>ä¸è¦ç”¨ <code>rm -rf</code>, ç”¨ <code>rm -ri</code> å§ï¼Œç»™è‡ªå·±ä¸€ç‚¹åæ‚”çš„ä½™åœ°ã€‚</strong></p>
<h3 id="ln-â€”-åˆ›å»ºé“¾æ¥"><a href="#ln-â€”-åˆ›å»ºé“¾æ¥" class="headerlink" title="ln â€” åˆ›å»ºé“¾æ¥"></a>ln â€” åˆ›å»ºé“¾æ¥</h3><blockquote>
<p>å»ºç«‹ç¬¦å·é“¾æ¥çš„ç›®çš„æ˜¯ä¸ºäº†å…‹æœç¡¬é“¾æ¥çš„ä¸¤ä¸ªç¼ºç‚¹ï¼šç¡¬é“¾æ¥ä¸èƒ½è·¨è¶Šç‰©ç†è®¾å¤‡ï¼Œ ç¡¬é“¾æ¥ä¸èƒ½å…³è”ç›®å½•ï¼Œåªèƒ½æ˜¯æ–‡ä»¶ã€‚ç¬¦å·é“¾æ¥æ˜¯æ–‡ä»¶çš„ç‰¹æ®Šç±»å‹ï¼Œå®ƒåŒ…å«ä¸€ä¸ªæŒ‡å‘ ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•çš„æ–‡æœ¬æŒ‡é’ˆã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºç¡¬é“¾æ¥</span></span><br><span class="line">ln file link</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºç¬¦å·é“¾æ¥ï¼ˆsoftï¼‰</span></span><br><span class="line">ln -s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶</span><br><span class="line">ln -s item link</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>å…³äºè¿™é‡Œæˆ‘æœ‰ä¸€äº›å®é™…å¯ä»¥ç”¨åˆ°è½¯ç¡¬é“¾æ¥çš„åœºæ™¯ã€‚ç¨åå†è¡¥å……ã€‚</p>
<h3 id="é€šé…ç¬¦"><a href="#é€šé…ç¬¦" class="headerlink" title="é€šé…ç¬¦"></a>é€šé…ç¬¦</h3><p>ä¹¦é‡Œå…ˆç®€å•çš„è®²äº†ä¸‹é€šé…ç¬¦ï¼Œæˆ‘è§‰å¾—åªçœ‹ä¾‹å­å°±å¥½äº†ã€‚<br><img src="tongpei.png" alt="é€šé…ç¬¦"></p>
<hr>
<h2 id="ç¬¬äº”ç« ï¼šä½¿ç”¨å‘½ä»¤"><a href="#ç¬¬äº”ç« ï¼šä½¿ç”¨å‘½ä»¤" class="headerlink" title="ç¬¬äº”ç« ï¼šä½¿ç”¨å‘½ä»¤"></a>ç¬¬äº”ç« ï¼šä½¿ç”¨å‘½ä»¤</h2><p>ä¸»è¦çš„å‡ ä¸ªæœ‰ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-   <span class="built_in">type</span> â€“ æ˜¾ç¤ºå‘½ä»¤çš„ç±»å‹</span><br><span class="line">-   <span class="built_in">which</span> â€“ æ˜¾ç¤ºä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºçš„ä½ç½®</span><br><span class="line">-   man â€“ æ˜¾ç¤ºå‘½ä»¤æ‰‹å†Œé¡µ</span><br><span class="line">-   apropos â€“ æ˜¾ç¤ºä¸€ç³»åˆ—é€‚åˆçš„å‘½ä»¤</span><br><span class="line">-   info â€“ æ˜¾ç¤ºå‘½ä»¤ info</span><br><span class="line">-   whatis â€“ æ˜¾ç¤ºä¸€ä¸ªå‘½ä»¤çš„ç®€æ´æè¿°</span><br><span class="line">-   <span class="built_in">alias</span> â€“ åˆ›å»ºå‘½ä»¤åˆ«å</span><br></pre></td></tr></table></figure></p>
<p>ä¸‹é¢ä¸¾ä¸€äº›ä¾‹å­ï¼Œè¿™ä¸ªæ›´å¥½ç†è§£ä¸€äº›ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// <span class="built_in">type</span> å‘½ä»¤æ˜¯ shell å†…éƒ¨å‘½ä»¤ï¼Œå®ƒä¼šæ˜¾ç¤ºå‘½ä»¤çš„ç±»åˆ«ï¼Œç»™å‡ºä¸€ä¸ªç‰¹å®šçš„å‘½ä»¤åï¼ˆåšä¸ºå‚æ•°ï¼‰</span><br><span class="line"><span class="built_in">type</span> ls     =&gt; ls is an <span class="built_in">alias</span> <span class="keyword">for</span> ls -G</span><br><span class="line"><span class="built_in">type</span> <span class="built_in">cd</span>     =&gt; <span class="built_in">cd</span> is a shell <span class="built_in">builtin</span></span><br><span class="line"><span class="built_in">type</span> <span class="built_in">type</span>   =&gt; <span class="built_in">type</span> is a shell builtins</span><br><span class="line"></span><br><span class="line">// è¿™ä¸ªå‘½ä»¤åªå¯¹å¯æ‰§è¡Œç¨‹åºæœ‰æ•ˆï¼Œä¸åŒ…æ‹¬å†…å»ºå‘½ä»¤å’Œå‘½ä»¤åˆ«å</span><br><span class="line"><span class="built_in">which</span> node  =&gt; /usr/<span class="built_in">local</span>/bin/node</span><br><span class="line"><span class="built_in">which</span> npm   =&gt; /usr/<span class="built_in">local</span>/bin/npm</span><br><span class="line"></span><br><span class="line">// è¾“å…¥â€œ<span class="built_in">help</span>â€ï¼Œæ¥ç€æ˜¯ shell å†…éƒ¨å‘½ä»¤å, æ³¨æ„åé¢è·Ÿçš„ä¸€å®šè¦æ˜¯ <span class="built_in">builtin</span> commands</span><br><span class="line"><span class="built_in">help</span> <span class="built_in">cd</span></span><br><span class="line"><span class="built_in">help</span> <span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">// --<span class="built_in">help</span> - æ˜¾ç¤ºç”¨æ³•ä¿¡æ¯,å®ƒä¸è¦æ±‚æ˜¯ <span class="built_in">builtin</span> commands, æ˜¯å¯æ‰§è¡Œç¨‹åºå³å¯</span><br><span class="line">mkdir --<span class="built_in">help</span> | less</span><br><span class="line">tar --<span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">// è®¸å¤šå¸Œæœ›è¢«å‘½ä»¤è¡Œä½¿ç”¨çš„å¯æ‰§è¡Œç¨‹åº</span><br><span class="line">// æä¾›äº†ä¸€ä¸ªæ­£å¼çš„æ–‡æ¡£ï¼Œå«åšæ‰‹å†Œæˆ–æ‰‹å†Œé¡µ(man page)ã€‚</span><br><span class="line">// ä¸€ä¸ªç‰¹æ®Šçš„å«åš man çš„åˆ†é¡µç¨‹åºï¼Œå¯ç”¨æ¥æµè§ˆä»–ä»¬ã€‚</span><br><span class="line">man <span class="built_in">which</span></span><br><span class="line">man ls</span><br></pre></td></tr></table></figure></p>
<p>å…³äº alias æˆ‘è§‰å¾—å¾ˆå¥½ç”¨ï¼Œå•ç‹¬æ‹¿å‡ºæ¥ï¼š</p>
<p><strong>è¯­æ³•æ˜¯ï¼š <code>alias name=&#39;string&#39;</code>å®é™…ä¸Šæˆ‘ä»¬å¹³æ—¶å†™ å‘½ä»¤ æ—¶ï¼Œæ˜¯å¯ä»¥å‡ ä¸ªä¸€èµ·å†™çš„ï¼Œæ¯”å¦‚ <code>cd /usr; ls; cd -</code>ã€‚å¦‚æœè¿™ä¸ªå‘½ä»¤ä½ ç»å¸¸ç”¨ï¼Œè€Œä¸”ä¸æƒ³è¦æ¯æ¬¡éƒ½æ‰“æŠ˜ä¸‰ä¸ªå‘½ä»¤ï¼Œé‚£ä¹ˆä½ å¯ä»¥æŠŠå®ƒåšæˆä¸€ä¸ªåˆ«åã€‚è¿™æ ·æ¯æ¬¡å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ‡æ¢äº†ã€‚å¦‚æˆ‘ä»¬ç»™ä¸Šé¢ä¸€ä¸ªå‘½ä»¤èµ·åå« test, åœ¨æ¯æ¬¡èµ·åˆ«åå‰ï¼Œè®°å¾—ç”¨ type è¯•ä¸‹ï¼Œçœ‹è¿™ä¸ªåˆ«åæ˜¯å¦è¢«å ç”¨äº†ã€‚</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// bash: <span class="built_in">type</span>: foo: not found  å¯ä»¥åˆ›å»ºä¸ºåˆ«å</span><br><span class="line"><span class="built_in">type</span> <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">// <span class="built_in">test</span> is a shell <span class="built_in">builtin</span> å·²ç»è¢«ä½¿ç”¨äº†ï¼Œä¸èƒ½åˆ›å»ºäº†</span><br><span class="line"><span class="built_in">type</span> <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">// <span class="built_in">test</span> ä¸ºæˆ‘ä»¬çš„å‘½ä»¤äº†</span><br><span class="line"><span class="built_in">alias</span> <span class="built_in">test</span>=<span class="string">'cd /usr; ls; cd -'</span></span><br><span class="line"></span><br><span class="line">// æ­¤æ—¶æˆ‘ä»¬æŸ¥çœ‹å°±ä¼šæ˜¾ç¤ºï¼š foo is aliased to `<span class="built_in">cd</span> /usr; ls ; <span class="built_in">cd</span> -<span class="string">'</span></span><br><span class="line"><span class="string">type test</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="ç¬¬å…­ç« ï¼šé‡å®šå‘"><a href="#ç¬¬å…­ç« ï¼šé‡å®šå‘" class="headerlink" title="ç¬¬å…­ç« ï¼šé‡å®šå‘"></a>ç¬¬å…­ç« ï¼šé‡å®šå‘</h2><blockquote>
<p>â€I/Oâ€ä»£è¡¨è¾“å…¥/è¾“å‡ºï¼Œ é€šè¿‡è¿™ä¸ªå·¥å…·ï¼Œä½ å¯ä»¥é‡å®šå‘å‘½ä»¤çš„è¾“å…¥è¾“å‡ºï¼Œå‘½ä»¤çš„è¾“å…¥æ¥è‡ªæ–‡ä»¶ï¼Œè€Œè¾“å‡ºä¹Ÿå­˜åˆ°æ–‡ä»¶ã€‚ ä¹Ÿå¯ä»¥æŠŠå¤šä¸ªå‘½ä»¤è¿æ¥èµ·æ¥ç»„æˆä¸€ä¸ªå¼ºå¤§çš„å‘½ä»¤ç®¡é“ã€‚</p>
</blockquote>
<p>ä¸»è¦çš„å‘½ä»¤æœ‰ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-   cat ï¼ è¿æ¥æ–‡ä»¶</span><br><span class="line">-   sort ï¼ æ’åºæ–‡æœ¬è¡Œ</span><br><span class="line">-   uniq ï¼ æŠ¥é“æˆ–çœç•¥é‡å¤è¡Œ</span><br><span class="line">-   grep ï¼ æ‰“å°åŒ¹é…è¡Œ</span><br><span class="line">-   wc ï¼ æ‰“å°æ–‡ä»¶ä¸­æ¢è¡Œç¬¦ï¼Œå­—ï¼Œå’Œå­—èŠ‚ä¸ªæ•°</span><br><span class="line">-   head ï¼ è¾“å‡ºæ–‡ä»¶ç¬¬ä¸€éƒ¨åˆ†</span><br><span class="line">-   tail - è¾“å‡ºæ–‡ä»¶æœ€åä¸€éƒ¨åˆ†</span><br><span class="line">-   tee - ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ï¼Œå¹¶åŒæ—¶å†™åˆ°æ ‡å‡†è¾“å‡ºå’Œæ–‡ä»¶</span><br></pre></td></tr></table></figure></p>
<h3 id="æ ‡å‡†è¾“å‡ºé‡å®šå‘"><a href="#æ ‡å‡†è¾“å‡ºé‡å®šå‘" class="headerlink" title="æ ‡å‡†è¾“å‡ºé‡å®šå‘"></a>æ ‡å‡†è¾“å‡ºé‡å®šå‘</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ls -l ls-output.txt</span><br><span class="line">ls -l /bin/usr &gt; ls-output.txt  ä¸è¿½åŠ ï¼Œæ¯æ¬¡éƒ½è¢«ä»å¤´è¦†ç›–</span><br><span class="line">ls -l /usr/bin &gt;&gt; ls-output.txt   è¿½åŠ åˆ°æ–‡ä»¶ä¸­</span><br><span class="line">&gt; ls-output.txt  æ¸…ç©ºæŸä¸ªæ–‡ä»¶</span><br></pre></td></tr></table></figure>
<h3 id="æ ‡å‡†é”™è¯¯é‡å®šå‘"><a href="#æ ‡å‡†é”™è¯¯é‡å®šå‘" class="headerlink" title="æ ‡å‡†é”™è¯¯é‡å®šå‘"></a>æ ‡å‡†é”™è¯¯é‡å®šå‘</h3><blockquote>
<p>æ ‡å‡†é”™è¯¯é‡å®šå‘æ²¡æœ‰ä¸“ç”¨çš„é‡å®šå‘æ“ä½œç¬¦ã€‚ä¸ºäº†é‡å®šå‘æ ‡å‡†é”™è¯¯ï¼Œæˆ‘ä»¬å¿…é¡»å‚è€ƒå…¶æ–‡ä»¶æè¿°ç¬¦ã€‚ ä¸€ä¸ªç¨‹åºå¯ä»¥åœ¨å‡ ä¸ªç¼–å·çš„æ–‡ä»¶æµä¸­çš„ä»»ä¸€ä¸ªä¸Šäº§ç”Ÿè¾“å‡ºã€‚è™½ç„¶æˆ‘ä»¬å·²ç»å°†è¿™äº›æ–‡ä»¶æµçš„å‰ ä¸‰ä¸ªç§°ä½œæ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯ï¼Œshell å†…éƒ¨åˆ†åˆ«å°†å…¶ç§°ä¸ºæ–‡ä»¶æè¿°ç¬¦0ã€1å’Œ2ã€‚shell ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦æä¾› äº†ä¸€ç§è¡¨ç¤ºæ³•æ¥é‡å®šå‘æ–‡ä»¶ã€‚å› ä¸ºæ ‡å‡†é”™è¯¯å’Œæ–‡ä»¶æè¿°ç¬¦2ä¸€æ ·ï¼Œæˆ‘ä»¬ç”¨è¿™ç§ è¡¨ç¤ºæ³•æ¥é‡å®šå‘æ ‡å‡†é”™è¯¯ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å½“ /bin/usr ä¸å­˜åœ¨æ—¶æŠ¥é”™å°†è¾“å‡ºåˆ° ls-error.txt ä¸­</span></span><br><span class="line">ls -l /bin/usr <span class="number">2</span>&gt; ls-error.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ‰çš„æ—¶å€™å¯èƒ½æˆ‘ä»¬éœ€è¦é‡å®šå‘æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯åˆ°åŒä¸€ä¸ªæ–‡ä»¶</span></span><br><span class="line">ls -l /bin/usr &gt; ls-output.txt <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç°åœ¨çš„ bash ç‰ˆæœ¬æä¾›äº†ç¬¬äºŒç§æ–¹æ³•ï¼Œæ›´ç²¾ç®€åˆç†çš„æ–¹æ³•æ¥æ‰§è¡Œè¿™ç§è”åˆçš„é‡å®šå‘</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨å•å•ä¸€ä¸ªè¡¨ç¤ºæ³• &amp;&gt; æ¥é‡å®šå‘æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯åˆ°æ–‡ä»¶</span></span><br><span class="line">ls -l /bin/usr &amp;&gt; ls-output.txt</span><br></pre></td></tr></table></figure>
<h3 id="å¤„ç†ä¸éœ€è¦çš„è¾“å‡º"><a href="#å¤„ç†ä¸éœ€è¦çš„è¾“å‡º" class="headerlink" title="å¤„ç†ä¸éœ€è¦çš„è¾“å‡º"></a>å¤„ç†ä¸éœ€è¦çš„è¾“å‡º</h3><p>æœ‰æ—¶å€™â€œæ²‰é»˜æ˜¯é‡‘â€ï¼Œæˆ‘ä»¬ä¸æƒ³è¦ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºç»“æœï¼Œåªæƒ³æŠŠå®ƒä»¬æ‰”æ‰ã€‚è¿™ç§æƒ…å†µ å°¤å…¶é€‚ç”¨äºé”™è¯¯å’ŒçŠ¶æ€ä¿¡æ¯ã€‚ç³»ç»Ÿé€šè¿‡é‡å®šå‘è¾“å‡ºç»“æœåˆ°ä¸€ä¸ªå«åšâ€/dev/nullâ€çš„ç‰¹æ®Šæ–‡ä»¶ï¼Œ ä¸ºæˆ‘ä»¬æä¾›äº†è§£å†³é—®é¢˜çš„æ–¹æ³•ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯ç³»ç»Ÿè®¾å¤‡ï¼Œå«åšä½å­˜å‚¨æ¡¶ï¼Œå®ƒå¯ä»¥ æ¥å—è¾“å…¥ï¼Œå¹¶ä¸”å¯¹è¾“å…¥ä¸åšä»»ä½•å¤„ç†ã€‚ä¸ºäº†éšç’å‘½ä»¤é”™è¯¯ä¿¡æ¯ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·åšã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// å¤„ç†ä¸éœ€è¦çš„è¾“å‡º</span><br><span class="line">ls -l /bin/usr 2&gt; /dev/null</span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢çš„æ¯”è¾ƒå°‘ç”¨åˆ°ï¼ŒåŸºæœ¬ä¸Šæˆ‘ä¹‹å‰æ²¡æœ‰ç”¨åˆ°è¿‡ã€‚</p>
<h3 id="æ ‡å‡†è¾“å…¥é‡å®šå‘"><a href="#æ ‡å‡†è¾“å…¥é‡å®šå‘" class="headerlink" title="æ ‡å‡†è¾“å…¥é‡å®šå‘"></a>æ ‡å‡†è¾“å…¥é‡å®šå‘</h3><h4 id="cat-å‘½ä»¤"><a href="#cat-å‘½ä»¤" class="headerlink" title="cat å‘½ä»¤"></a>cat å‘½ä»¤</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// cat å‘½ä»¤è¯»å–ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶</span><br><span class="line">// cat ç»å¸¸è¢«ç”¨æ¥æ˜¾ç¤ºç®€çŸ­çš„æ–‡æœ¬æ–‡ä»¶ä¸åˆ†é¡µ</span><br><span class="line">cat [file]</span><br><span class="line">cat z.txt</span><br><span class="line">cat &lt; lazy_dog.txt  å°†æ ‡å‡†è¾“å…¥ï¼Œè¾“å‡ºåˆ° æ–‡ä»¶ä¸­</span><br></pre></td></tr></table></figure>
<h4 id="ç®¡é“çº¿"><a href="#ç®¡é“çº¿" class="headerlink" title="ç®¡é“çº¿"></a>ç®¡é“çº¿</h4><blockquote>
<p>å‘½ä»¤ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®å¹¶è¾“é€åˆ°æ ‡å‡†è¾“å‡ºçš„èƒ½åŠ›è¢«ä¸€ä¸ªç§°ä¸ºç®¡é“çº¿çš„ shell ç‰¹æ€§æ‰€åˆ©ç”¨ã€‚ ä½¿ç”¨ç®¡é“æ“ä½œç¬¦â€|â€ï¼ˆç«–æ ï¼‰ï¼Œä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å‡ºå¯ä»¥é€šè¿‡ç®¡é“é€è‡³å¦ä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å…¥ï¼š</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">command1 | command2</span><br><span class="line">ls -l /usr/bin | less</span><br></pre></td></tr></table></figure>
<p><strong>ç®¡é“çº¿ç»å¸¸ç”¨æ¥å¯¹æ•°æ®å®Œæˆå¤æ‚çš„æ“ä½œã€‚æœ‰å¯èƒ½ä¼šæŠŠå‡ ä¸ªå‘½ä»¤æ”¾åœ¨ä¸€èµ·ç»„æˆä¸€ä¸ªç®¡é“çº¿ã€‚ é€šå¸¸ï¼Œä»¥è¿™ç§æ–¹å¼ä½¿ç”¨çš„å‘½ä»¤è¢«ç§°ä¸ºè¿‡æ»¤å™¨ã€‚è¿‡æ»¤å™¨æ¥å—è¾“å…¥ï¼Œä»¥æŸç§æ–¹å¼æ”¹å˜å®ƒï¼Œç„¶å è¾“å‡ºå®ƒã€‚</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /bin /usr/bin | sort | less</span><br></pre></td></tr></table></figure>
<h4 id="uniq-æŠ¥é“æˆ–å¿½ç•¥é‡å¤è¡Œ"><a href="#uniq-æŠ¥é“æˆ–å¿½ç•¥é‡å¤è¡Œ" class="headerlink" title="uniq - æŠ¥é“æˆ–å¿½ç•¥é‡å¤è¡Œ"></a>uniq - æŠ¥é“æˆ–å¿½ç•¥é‡å¤è¡Œ</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ—è¡¨ä¸­ä¸åŒ…å«é‡å¤å¥å­</span></span><br><span class="line">ls /bin /usr/bin | sort | uniq | less</span><br></pre></td></tr></table></figure>
<h4 id="wc-ï¼-æ‰“å°è¡Œæ•°ã€å­—æ•°å’Œå­—èŠ‚æ•°"><a href="#wc-ï¼-æ‰“å°è¡Œæ•°ã€å­—æ•°å’Œå­—èŠ‚æ•°" class="headerlink" title="wc ï¼ æ‰“å°è¡Œæ•°ã€å­—æ•°å’Œå­—èŠ‚æ•°"></a>wc ï¼ æ‰“å°è¡Œæ•°ã€å­—æ•°å’Œå­—èŠ‚æ•°</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// wcï¼ˆå­—è®¡æ•°ï¼‰å‘½ä»¤æ˜¯ç”¨æ¥æ˜¾ç¤ºæ–‡ä»¶æ‰€åŒ…å«çš„è¡Œæ•°ã€å­—æ•°å’Œå­—èŠ‚æ•°</span></span><br><span class="line">wc ls-output.txt</span><br><span class="line"><span class="number">7902</span> <span class="number">64566</span> <span class="number">503634</span> ls-output.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">// â€-lâ€é€‰é¡¹é™åˆ¶å‘½ä»¤è¾“å‡ºåªèƒ½ æŠ¥é“è¡Œæ•°ã€‚æ·»åŠ  wc åˆ°ç®¡é“çº¿æ¥ç»Ÿè®¡æ•°æ®ï¼Œæ˜¯ä¸ªå¾ˆä¾¿åˆ©çš„æ–¹æ³•</span></span><br><span class="line">ls /bin /usr/bin | sort | uniq | wc -l</span><br></pre></td></tr></table></figure>
<h4 id="grep-ï¼-æ‰“å°åŒ¹é…è¡Œ"><a href="#grep-ï¼-æ‰“å°åŒ¹é…è¡Œ" class="headerlink" title="grep ï¼ æ‰“å°åŒ¹é…è¡Œ"></a>grep ï¼ æ‰“å°åŒ¹é…è¡Œ</h4><p>grep æ˜¯ä¸ªå¾ˆå¼ºå¤§çš„ç¨‹åºï¼Œç”¨æ¥æ‰¾åˆ°æ–‡ä»¶ä¸­çš„åŒ¹é…æ–‡æœ¬ã€‚è¿™æ ·ä½¿ç”¨ grep å‘½ä»¤ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â€-iâ€ä½¿å¾— grep åœ¨æ‰§è¡Œæœç´¢æ—¶å¿½ç•¥å¤§å°å†™ï¼ˆé€šå¸¸ï¼Œæœç´¢æ˜¯å¤§å°å†™ æ•æ„Ÿçš„ï¼‰ï¼Œâ€-vâ€é€‰é¡¹ä¼šå‘Šè¯‰ grep åªæ‰“å°ä¸åŒ¹é…çš„è¡Œã€‚</span><br><span class="line">ls /bin /usr/bin | sort | uniq | grep zip</span><br></pre></td></tr></table></figure></p>
<h4 id="head-tail-ï¼-æ‰“å°æ–‡ä»¶å¼€å¤´éƒ¨åˆ†-ç»“å°¾éƒ¨åˆ†"><a href="#head-tail-ï¼-æ‰“å°æ–‡ä»¶å¼€å¤´éƒ¨åˆ†-ç»“å°¾éƒ¨åˆ†" class="headerlink" title="head / tail ï¼ æ‰“å°æ–‡ä»¶å¼€å¤´éƒ¨åˆ†/ç»“å°¾éƒ¨åˆ†"></a>head / tail ï¼ æ‰“å°æ–‡ä»¶å¼€å¤´éƒ¨åˆ†/ç»“å°¾éƒ¨åˆ†</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// head å‘½ä»¤æ‰“å°æ–‡ä»¶çš„å‰åè¡Œï¼Œè€Œ tail å‘½ä»¤æ‰“å°æ–‡ä»¶çš„ååè¡Œã€‚ -n ç”¨æ¥æŒ‡å®š</span></span><br><span class="line">head -n <span class="number">5</span> ls-output.txt</span><br><span class="line">total <span class="number">343496</span></span><br><span class="line">tail -n <span class="number">5</span> ls-output.txt</span><br><span class="line">ls /usr/bin | tail -n <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// tail æœ‰ä¸€ä¸ªé€‰é¡¹å…è®¸ä½ å®æ—¶åœ°æµè§ˆæ–‡ä»¶ã€‚å½“è§‚å¯Ÿæ—¥å¿—æ–‡ä»¶çš„è¿›å±•æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬åŒæ—¶åœ¨è¢«å†™å…¥ã€‚</span></span><br><span class="line">tail -f /<span class="keyword">var</span>/log/messages</span><br></pre></td></tr></table></figure>
<p><strong>ä½¿ç”¨â€-fâ€é€‰é¡¹ï¼Œtail å‘½ä»¤ç»§ç»­ç›‘æµ‹è¿™ä¸ªæ–‡ä»¶ï¼Œå½“æ–°çš„å†…å®¹æ·»åŠ åˆ°æ–‡ä»¶åï¼Œå®ƒä»¬ä¼šç«‹å³ å‡ºç°åœ¨å±å¹•ä¸Šã€‚è¿™ä¼šä¸€ç›´ç»§ç»­ä¸‹å»ç›´åˆ°ä½ è¾“å…¥ Ctrl-cã€‚</strong></p>
<h4 id="tee-ï¼-ä»-Stdin-è¯»å–æ•°æ®ï¼Œå¹¶åŒæ—¶è¾“å‡ºåˆ°-Stdout-å’Œæ–‡ä»¶"><a href="#tee-ï¼-ä»-Stdin-è¯»å–æ•°æ®ï¼Œå¹¶åŒæ—¶è¾“å‡ºåˆ°-Stdout-å’Œæ–‡ä»¶" class="headerlink" title="tee ï¼ ä» Stdin è¯»å–æ•°æ®ï¼Œå¹¶åŒæ—¶è¾“å‡ºåˆ° Stdout å’Œæ–‡ä»¶"></a>tee ï¼ ä» Stdin è¯»å–æ•°æ®ï¼Œå¹¶åŒæ—¶è¾“å‡ºåˆ° Stdout å’Œæ–‡ä»¶</h4><p>ä¸ºäº†å’Œæˆ‘ä»¬çš„ç®¡é“éšå–»ä¿æŒä¸€è‡´ï¼ŒLinux æä¾›äº†ä¸€ä¸ªå«åš tee çš„å‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤åˆ¶é€ äº† ä¸€ä¸ªâ€teeâ€ï¼Œå®‰è£…åˆ°æˆ‘ä»¬çš„ç®¡é“ä¸Šã€‚tee ç¨‹åºä»æ ‡å‡†è¾“å…¥è¯»å…¥æ•°æ®ï¼Œå¹¶ä¸”åŒæ—¶å¤åˆ¶æ•°æ® åˆ°æ ‡å‡†è¾“å‡ºï¼ˆå…è®¸æ•°æ®ç»§ç»­éšç€ç®¡é“çº¿æµåŠ¨ï¼‰å’Œä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ã€‚å½“åœ¨æŸä¸ªä¸­é—´å¤„ç† é˜¶æ®µæ¥æ•æ‰ä¸€ä¸ªç®¡é“çº¿çš„å†…å®¹æ—¶ï¼Œè¿™å¾ˆæœ‰å¸®åŠ©ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬é‡å¤æ‰§è¡Œä¸€ä¸ªå…ˆå‰çš„ä¾‹å­ï¼Œ è¿™æ¬¡åŒ…å« tee å‘½ä»¤ï¼Œåœ¨ grep è¿‡æ»¤ç®¡é“çº¿çš„å†…å®¹ä¹‹å‰ï¼Œæ¥æ•æ‰æ•´ä¸ªç›®å½•åˆ—è¡¨åˆ°æ–‡ä»¶ ls.txtï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /usr/bin | tee ls.txt | grep zip</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="ä»-shell-çœ¼ä¸­çœ‹ä¸–ç•Œ-Echo"><a href="#ä»-shell-çœ¼ä¸­çœ‹ä¸–ç•Œ-Echo" class="headerlink" title="ä» shell çœ¼ä¸­çœ‹ä¸–ç•Œ- Echo"></a>ä» shell çœ¼ä¸­çœ‹ä¸–ç•Œ- Echo</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-   <span class="built_in">echo</span> ï¼ æ˜¾ç¤ºä¸€è¡Œæ–‡æœ¬</span><br></pre></td></tr></table></figure>
<p>åˆ©ç”¨ echo ä½ å¯ä»¥åšä¸‹é¢è¿™äº›äº‹æƒ…ã€‚è¿™ä¸ª echo è·Ÿ php é‡Œçš„ echo éå¸¸çš„åƒã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> this is a <span class="built_in">test</span></span><br><span class="line">// this is a <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> *</span><br><span class="line">// Applications Desktop Documents Downloads Library Movies Music Pictures Public</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> D*</span><br><span class="line">// Desktop Documents Downloads</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> *s</span><br><span class="line">// Documents Pictures Templates Videos</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> [[:upper:]]*</span><br><span class="line">// Desktop Documents Music Pictures Public Templates Videos</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> /usr/*/share</span><br><span class="line">// /usr/a/share  /user/b/share</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> ~</span><br><span class="line">// /Users/sevencai</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> $((2 + 2))</span><br><span class="line">// 4</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> $(($((5**2)) * 3))</span><br><span class="line">// 5*5 *3 = 75</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Front-&#123;A,B,C&#125;-Back</span><br><span class="line">// Front-A-Back Front-B-Back Front-C-Back</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> Number_&#123;1,5&#125;</span><br><span class="line">// Number_1 Number_2 Number_3 Number_4 Number_5</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$USER</span></span><br><span class="line">// sevencai</span><br><span class="line"></span><br><span class="line">// æŸ¥çœ‹æœ‰æ•ˆå˜é‡</span><br><span class="line">printenv | less</span><br><span class="line"></span><br><span class="line">// å‘½ä»¤æ›¿æ¢</span><br><span class="line"><span class="built_in">echo</span> $(ls)</span><br><span class="line">ls -l $(<span class="built_in">which</span> cp)</span><br><span class="line"></span><br><span class="line"> // åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå•è¯åˆ†å‰²æœºåˆ¶ä¼šåœ¨å•è¯ä¸­å¯»æ‰¾ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦ï¼Œå’Œæ¢è¡Œç¬¦ï¼Œå¹¶æŠŠå®ƒä»¬çœ‹ä½œ å•è¯ä¹‹é—´çš„ç•Œå®šç¬¦ã€‚è¿™æ„å‘³ç€æ— å¼•ç”¨çš„ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦éƒ½ä¸æ˜¯æ–‡æœ¬çš„ä¸€éƒ¨åˆ†ï¼Œ å®ƒä»¬åªä½œä¸ºåˆ†éš”ç¬¦ä½¿ç”¨ã€‚ç”±äºå®ƒä»¬æŠŠå•è¯åˆ†ä¸ºä¸åŒçš„å‚æ•°ï¼Œæ‰€ä»¥åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ å‘½ä»¤è¡ŒåŒ…å«ä¸€ä¸ªå¸¦æœ‰å››ä¸ªä¸åŒå‚æ•°çš„å‘½ä»¤ã€‚</span><br><span class="line"><span class="built_in">echo</span> this is a    <span class="built_in">test</span></span><br><span class="line">// this is a <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">// <span class="variable">$1</span> å½“åšç¬¬ä¸€ä¸ªå˜é‡ï¼Œå› ä¸º `1` æ˜¯æ²¡æœ‰å®šä¹‰çš„å˜é‡ï¼Œæ‰€ä»¥ä¸ºç©º</span><br><span class="line"><span class="built_in">echo</span> The total is <span class="variable">$100</span>.00</span><br><span class="line">// The total is 00.00</span><br><span class="line"></span><br><span class="line">// åœ¨åŒå¼•å·ä¸­ï¼Œå‚æ•°å±•å¼€ã€ç®—æœ¯è¡¨è¾¾å¼å±•å¼€å’Œå‘½ä»¤æ›¿æ¢ä»ç„¶æœ‰æ•ˆ</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$USER</span> <span class="variable">$((2+2)</span>) <span class="variable">$(cal)</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"this is a    test"</span></span><br><span class="line">// this is a    <span class="built_in">test</span></span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œæˆ‘è§‰å¾—å¤§è‡´çš„äº†è§£ä¸‹å°±è¡Œã€‚å› ä¸ºçœŸå®æƒ…å†µä¸‹ï¼Œæˆ‘ç”¨åˆ°çš„éå¸¸éå¸¸å°‘ã€‚</p>
<hr>
<h2 id="é”®ç›˜é«˜çº§æŠ€å·§"><a href="#é”®ç›˜é«˜çº§æŠ€å·§" class="headerlink" title="é”®ç›˜é«˜çº§æŠ€å·§"></a>é”®ç›˜é«˜çº§æŠ€å·§</h2><h3 id="ç§»åŠ¨å…‰æ ‡"><a href="#ç§»åŠ¨å…‰æ ‡" class="headerlink" title="ç§»åŠ¨å…‰æ ‡"></a>ç§»åŠ¨å…‰æ ‡</h3><p><img src="jiqiao.png" alt="å¤åˆ¶"></p>
<h3 id="å‰ªåˆ‡å¤åˆ¶"><a href="#å‰ªåˆ‡å¤åˆ¶" class="headerlink" title="å‰ªåˆ‡å¤åˆ¶"></a>å‰ªåˆ‡å¤åˆ¶</h3><p><img src="copy.png" alt="å‰ªåˆ‡"></p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»Šå¤©å°±åˆ°è¿™é‡Œå§ï¼Œæˆ‘æ‹…å¿ƒå› ä¸ºä»Šå¤©å·²ç»çœ‹äº†å¾ˆå¤šäº†ï¼Œå°±åé¢æŠŠè¿™ä¸ªçœ‹å®Œè¿™æœ¬ä¹¦è®°å½•ä¸‹æ¥å½“åšä»»åŠ¡å»å®Œæˆäº†ï¼Œè¿™æ ·è¿èƒŒäº†æˆ‘çš„åˆè¡·ã€‚æ‰€ä»¥æœ‰æ•ˆçš„æ—¶é—´ï¼Œåšæ­£ç¡®çš„äº‹æƒ…ã€‚æ”¹å¤©æˆ‘å†æ¥æ€»ç»“åé¢å‡ ç« èŠ‚ã€‚</p>
<p>å›å®¶ğŸŒ¶å•¦ï¼Œâœˆï¸æ˜å¤©å»æ¥æˆ‘çš„å°ç‹—ç‹—ï¼Œå¯ä¹ï¼ï¼ï¼ å˜»å˜»ã€‚å¼€å¿ƒã€‚å¼€å¿ƒã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘è¯» &lt;em&gt;The Linux Command Line&lt;/em&gt; çš„è¯»ä¹¦ç¬”è®°ã€‚ç”µå­ç‰ˆçš„ä¹¦çš„åœ°å€æ˜¯ï¼š&lt;a href=&quot;http://billie66.github.io/TLCL/book/index.html&quot; target=&quot;_bl
    
    </summary>
    
    
      <category term="è¯»ä¹¦ç¬”è®°" scheme="http://sevencai.github.io/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>é¡¹ç›®æ€»ç»“</title>
    <link href="http://sevencai.github.io/2018/08/09/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/"/>
    <id>http://sevencai.github.io/2018/08/09/é¡¹ç›®æ€»ç»“/</id>
    <published>2018-08-09T13:23:13.000Z</published>
    <updated>2018-08-09T14:03:48.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æœ€è¿‘ä¸€ä¸ªå¤šæœˆåŠ äº†å¾ˆå¤šç­ï¼Œåšäº†ä¸€ä¸ªæ¯”è¾ƒç´§æ€¥çš„é¡¹ç›® Nodejs + Vueå…¨å®¶æ¡¶ï¼Œæ„Ÿè§‰è‡ªå·±æ”¶è·å¤šå¤šã€‚ä»Šå¤©å·²ç»å‘å¸ƒäº†ç°ç½‘ç‰ˆæœ¬ï¼Œè¶çƒ­æ€»ç»“å’Œæ¢³ç†ä¸‹ã€‚</p>
</blockquote>
<hr>
<h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><ol>
<li><code>Nodejs koa2</code>,  <code>async await</code>ç”¨çš„å¾ˆèˆ’é€‚ã€‚</li>
<li><code>Vue å…¨å®¶æ¡¶</code>,<code>vue webpack vuex</code>å¯å¿«é€Ÿå¼€å‘ã€‚</li>
<li>å‰åç«¯åˆ†ç¦»ï¼Œ<code>Nodejs</code> ç«¯çº¯åš <code>Api</code> å±‚ã€‚</li>
<li><code>pm2</code> è¿›ç¨‹ç®¡ç†å·¥å…·ã€‚åˆç†Ÿæ‚‰äº†å¾ˆå¤šå‘½ä»¤å’Œè¸©äº†ä¸€äº›å‘ã€‚</li>
<li><code>log4js</code>æ—¥å¿—æ‰“å°å·¥å…·ã€‚äº†è§£äº†éƒ¨é—¨çš„æ—¥å¿—è§„èŒƒï¼Œç”¨äºæŸ¥è¯¢é—®é¢˜ã€‚</li>
<li>æ•°æ®åº“ç”¨çš„ <code>sequelize</code>ã€‚</li>
<li>ç™»å½•ç”¨çš„ <code>koa-generic-session</code>ã€‚</li>
<li>äº†è§£äº† ToB çš„ä¸€äº›æ¦‚å¿µåŠæ€æƒ³ã€‚</li>
</ol>
<p>ä»¥åå°±æŠ›å¼ƒ PHP è¿™ä¸ªä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€å§ã€‚ä»¥ä¸‹ä¸»è¦æ˜¯è‡ªå·±å¯¹è‡ªå·±é—®é¢˜çš„ä¸€äº›æ¢³ç†ã€‚å¹¶ä¸æ¶‰åŠåˆ°ä»»ä½•çš„çœŸå®é¡¹ç›®ä»£ç âŒ¨ï¸ğŸ ã€‚</p>
<hr>
<h2 id="è·å–ç”¨æˆ·çš„IPä¿¡æ¯"><a href="#è·å–ç”¨æˆ·çš„IPä¿¡æ¯" class="headerlink" title="è·å–ç”¨æˆ·çš„IPä¿¡æ¯"></a>è·å–ç”¨æˆ·çš„IPä¿¡æ¯</h2><p>åœ¨å¾ˆå¤šç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬Nodejså±‚éœ€è¦æŠŠç”¨æˆ·çš„ ip ä¼ ç»™åå°çš„ cgi, cgi ä¼šæ ¹æ®è¿™ä¸ª ip åšä¸€äº›ç­–ç•¥ï¼Œå¦‚é£æ§ï¼Œè¥é”€ç­‰ç­‰ã€‚è¿™å°±æ¶‰åŠåˆ° ip æ€ä¹ˆå–çš„æ¦‚å¿µï¼Œä½ å¯èƒ½ä¼šæ¥è§¦åˆ°è¿™å‡ ä¸ª ip:</p>
<ol>
<li>ctx.request.ip</li>
<li>ctx.headers[â€˜x-forwarded-forâ€™]</li>
<li>ctx.headers[â€˜x-real-ipâ€™]</li>
</ol>
<p>å…ˆæ¥æ™®åŠä¸‹ <code>x-forwarded-for</code>åŠ <code>x-real-ip</code>ã€‚</p>
<p><code>x-forwarded-for</code>çš„æ ¼å¼ä¸€èˆ¬ä¸ºï¼š<code>X-Forwarded-For: client1, proxy1, proxy2</code>  å¦‚ï¼š<code>X-Forwarded-For: 1.1.1.1, 2.2.2.2, 3.3.3.3</code></p>
<blockquote>
<p>æœ€å·¦è¾¹ï¼ˆclient1ï¼‰æ˜¯æœ€åŸå§‹å®¢æˆ·ç«¯çš„IPåœ°å€, ä»£ç†æœåŠ¡å™¨æ¯æˆåŠŸæ”¶åˆ°ä¸€ä¸ªè¯·æ±‚ï¼Œå°±æŠŠ<strong>è¯·æ±‚æ¥æºIPåœ°å€</strong>æ·»åŠ åˆ°å³è¾¹ã€‚ åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™ä¸ªè¯·æ±‚æˆåŠŸé€šè¿‡äº†ä¸‰å°ä»£ç†æœåŠ¡å™¨ï¼šproxy1, proxy2 åŠ proxy3ã€‚è¯·æ±‚ç”±client1å‘å‡ºï¼Œåˆ°è¾¾äº†proxy3ï¼ˆproxy3å¯èƒ½æ˜¯è¯·æ±‚çš„ç»ˆç‚¹ï¼‰ã€‚è¯·æ±‚åˆšä»client1ä¸­å‘å‡ºæ—¶ï¼ŒXFFæ˜¯ç©ºçš„ï¼Œè¯·æ±‚è¢«å‘å¾€proxy1ï¼›é€šè¿‡proxy1çš„æ—¶å€™ï¼Œclient1è¢«æ·»åŠ åˆ°XFFä¸­ï¼Œä¹‹åè¯·æ±‚è¢«å‘å¾€proxy2;é€šè¿‡proxy2çš„æ—¶å€™ï¼Œproxy1è¢«æ·»åŠ åˆ°XFFä¸­ï¼Œä¹‹åè¯·æ±‚è¢«å‘å¾€proxy3ï¼›é€šè¿‡proxy3æ—¶ï¼Œproxy2è¢«æ·»åŠ åˆ°XFFä¸­ï¼Œä¹‹åè¯·æ±‚çš„çš„å»å‘ä¸æ˜ï¼Œå¦‚æœproxy3ä¸æ˜¯è¯·æ±‚ç»ˆç‚¹ï¼Œè¯·æ±‚ä¼šè¢«ç»§ç»­è½¬å‘ã€‚<strong>é‰´äºä¼ªé€ è¿™ä¸€å­—æ®µéå¸¸å®¹æ˜“ï¼Œåº”è¯¥è°¨æ…ä½¿ç”¨X-Forwarded-Forå­—æ®µã€‚æ­£å¸¸æƒ…å†µä¸‹XFFä¸­æœ€åä¸€ä¸ªIPåœ°å€æ˜¯æœ€åä¸€ä¸ªä»£ç†æœåŠ¡å™¨çš„IPåœ°å€, è¿™é€šå¸¸æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¯é çš„ä¿¡æ¯æ¥æºã€‚</strong> â€“ç»´åŸºç™¾ç§‘</p>
</blockquote>
<p>è€Œ <code>x-real-ip</code>æ²¡æœ‰ç›¸å…³æ ‡å‡†ï¼Œä½†æ˜¯åœ¨åå‘ä»£ç†å’Œæ­£å‘ä»£ç†ä¸‹ï¼Œå®ƒçš„å€¼å¯èƒ½ä¸åŒã€‚<strong>æ­£å‘ä»£ç†æ—¶ï¼Œè®°å½•çš„æ˜¯å®¢æˆ·ç«¯çš„çœŸå®ipã€‚ åå‘ä»£ç†æ—¶ï¼Œè®°å½•çš„æ˜¯æœ€åä¸€çº§çš„ä»£ç†ipã€‚</strong></p>
<p>æ‰€ä»¥ï¼š<code>x-real-ip</code> åŠ <code>x-forwarded-for</code>è¿™ä¸¤ä¸ª ip å°±æ˜¯å¾ˆæ™®é€šçš„è¯·æ±‚å¤´ï¼Œå®ƒä»¬æ˜¯å¯ä»¥è¢«ç¯¡æ”¹çš„ã€‚æ¯”å¦‚ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://www.my.com:8089 -H <span class="string">'X-Forwarded-For: 1.1.1.1'</span> -H <span class="string">'X-Real-IP: 2.2.2.2'</span></span><br></pre></td></tr></table></figure></p>
<p>é‚£ä¹ˆè¿™ä¸¤ä¸ªå€¼éƒ½å®¹æ˜“è¢«ç¯¡æ”¹ï¼Œä¸å¯ä¿¡ï¼Œæˆ‘ä»¬è¦æ‹¿åˆ°ç”¨æˆ·çœŸå®çš„ ip æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>ä¸€èˆ¬åœ¨å»ºç«‹  TCP è¿æ¥æ—¶ï¼Œä¼šäº§ç”ŸçœŸå®çš„ IP, å«åš <code>Remote Address</code>ã€‚å› ä¸ºæ˜¯å»ºç«‹åœ¨ TCP ä¸­ï¼Œæ‰€ä»¥è¿™ä¸ª ip ä¸èƒ½è¢«ç¯¡æ”¹ã€‚ä¸€æ—¦ç¯¡æ”¹ï¼Œæ¡æ‰‹ä¸æˆåŠŸï¼Œé‚£ä¹ˆåé¢è‡ªç„¶å°±æ²¡æœ‰äº†ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬è¦å–çœŸå®çš„ ip,åº”è¯¥ä»è¿™ä¸ªå­—æ®µé‡Œå–ã€‚</p>
<p>å®é™…ä¸Šåº”è¯¥å–é‚£ä¸ªå€¼ï¼Œè·Ÿä½  nginx çš„é…ç½®æœ‰å…³ç³»ã€‚æ¯”å¦‚ä¸€èˆ¬é…ç½® nginx åå‘ä»£ç†çš„æ—¶å€™å¯èƒ½è¿™æ ·é…ç½®ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line"></span><br><span class="line">// è‹¥ XFF æœ‰å€¼ï¼Œåˆ™ <span class="variable">$proxy_add_x_forwarded_for</span> = <span class="variable">$XFF</span>, <span class="variable">$remote_addr</span>  (<span class="variable">$XFF</span>ä¸<span class="variable">$remote_addr</span>é€—å·åˆ†å‰²ï¼Œ<span class="variable">$remote_addr</span>åœ¨å…¶å)</span><br><span class="line">// è‹¥ XFF æ²¡æœ‰å€¼ï¼Œåˆ™ <span class="variable">$proxy_add_x_forwarded_for</span> = <span class="variable">$remote_addr</span></span><br></pre></td></tr></table></figure></p>
<p>åƒè¿™æ ·èµ‹å€¼åï¼Œå¦‚æœä½ æ˜¯é€šè¿‡ nginx åå‘ä»£ç†æ¥çš„ï¼Œnginx ä¼šæŠŠç”¨æˆ·å®é™… ip ï¼ˆ$remote_addrï¼‰èµ‹å€¼ç»™ <code>X-Real-IP</code>,è¿™æ—¶å€™å®ƒä¹Ÿæ˜¯çœŸå®çš„ç”¨æˆ·IPäº†ã€‚è€Œ XFF ä¹Ÿæ˜¯æœ‰äº†ç”¨æˆ·çš„çœŸå®IPã€‚</p>
<p>é€šè¿‡è¿™æ ·çš„ nginx é…ç½®ã€‚æ•´ä¸ªå†…å®¹å°±æ— æ³•è¢«ç¯¡æ”¹å’Œæ„é€ ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä» <code>X-Real-IP</code> å’Œ <code>XFF</code>çš„æœ€åä¸€æˆª è·å¾—ç”¨æˆ·çœŸå®çš„ IP äº†ã€‚</p>
<p>æ‰€ä»¥æˆ‘æœ€åæ˜¯æ€ä¹ˆä¼ ä»€ä¹ˆå­—æ®µç»™åå°çš„å‘¢ï¼Ÿ<strong>æˆ‘æœ€åä¼ çš„æ˜¯ <code>x-forwarded-ip</code>ï¼Œ æ‹¿åˆ°è¿™ä¸€ç³»åˆ—çš„ ip list åï¼Œåå°ä¼šå»é€šè¿‡ç½‘æ®µæ ¡éªŒï¼Œåˆ¤æ–­å‡ºå“ªä¸ªæ˜¯å¤–ç½‘ ip, ç„¶åæŠŠè¿™ä¸ª ip å½“æˆæ˜¯ç”¨æˆ·çœŸå®çš„ ipã€‚</strong> cgi è¿˜æ˜¯å¾ˆä¸¥è°¨çš„ã€‚</p>
<p>æœ€å¼€å§‹è°ˆåˆ°çš„ <code>ctx.request.ip</code> æ˜¯æœ€åä¸€æ¬¡çš„ ip, æ‰€ä»¥æœ‰å¯èƒ½æ˜¯ä»£ç†æœºå™¨çš„ ipã€‚</p>
<p>é‡åˆ°ä¸€ç¯‡å¥½æ–‡ç« ï¼š<a href="https://imququ.com/post/x-forwarded-for-header-in-http.html" target="_blank" rel="noopener">x-forwarded-for-header-in-http</a></p>
<p>ä¸€ä¸ªå®ä¾‹ï¼Œåˆ¤æ–­ç”¨æˆ·IPæ˜¯å¦æ­£å¸¸ï¼š<a href="https://pay.weixin.qq.com/wiki/doc/api/H5.php?chapter=15_5" target="_blank" rel="noopener">å¾®ä¿¡H5æ”¯ä»˜éœ€åˆ¤æ–­ä¸‹å•IPå’Œæ”¯ä»˜IPæ˜¯å¦ä¸€è‡´</a></p>
<hr>
<h2 id="å…³äº-PM2-çš„-cluster-æ¨¡å¼"><a href="#å…³äº-PM2-çš„-cluster-æ¨¡å¼" class="headerlink" title="å…³äº PM2 çš„ cluster æ¨¡å¼"></a>å…³äº PM2 çš„ cluster æ¨¡å¼</h2><p>pm2 æ˜¯å¾ˆå¥½çš„è¿›ç¨‹ç®¡ç†å™¨ï¼Œæœ‰è‡ªåŠ¨é‡å¯ç­‰åŠŸèƒ½ï¼Œå¹¶ä¸”è¿˜è‡ªå¸¦è´Ÿè½½å‡è¡¡ã€‚æˆ‘è¿™é‡Œå°±ä¸è®²å…·ä½“çš„ cluster æ¨¡å¼å’Œ pm2 äº†ã€‚å°±åªè®²ä¸‹æˆ‘é‡åˆ°çš„å‘ã€‚</p>
<p>cluster æ¨¡å¼ä¸‹ï¼Œlog4js æ—¥å¿—ï¼Œæ— æ³•æ­£å¸¸æ‰“å°ã€‚è¿™ä¸ªå·²ç»æœ‰ç›¸å…³çš„ issue,åœ°å€åœ¨<a href="https://github.com/log4js-node/log4js-node/issues/265" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚å¤§æ¦‚çš„æ„æ€æ˜¯ cluster æ¨¡å¼ä¸‹ï¼Œå¹¶æ²¡æœ‰ master è¿›ç¨‹ï¼Œè€Œæ˜¯åªæœ‰å¤šä¸ª worker å­è¿›ç¨‹ã€‚è€Œ log4js åªåœ¨ master è¿›ç¨‹ä¸‹ï¼Œæ‰ä¼šè¿›è¡Œæ‰“å°æ—¥å¿—çš„æ“ä½œã€‚ä¹‹æ‰€ä»¥è¿™æ ·æ˜¯å› ä¸ºå¤šä¸ª worker æ“ä½œåŒä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼ˆä¸€èˆ¬æˆ‘ä»¬æ—¥å¿—æ–‡ä»¶åªæœ‰ä¸€å¥—é…ç½®ï¼‰å¯èƒ½ä¼šå¯¼è‡´æœ‰é”™ä¹±ç­‰é—®é¢˜ã€‚æœ‰è§£å†³é—®é¢˜çš„æ–¹æ³•ï¼Œéƒ½åœ¨é‚£ä¸ª issue é‡Œï¼Œä½†æ˜¯æˆ‘æ€»è§‰å¾—ä¸å¤ªå¥½ã€‚</p>
<p>å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œåœ¨ cluster æ¨¡å¼ä¸‹ï¼Œåˆ©ç”¨ restart å‘½ä»¤æ— æ³•å®Œå…¨é‡å¯è¿›ç¨‹ï¼Œfork æ¨¡å¼ä¸‹å°±ä¸ä¼šï¼ŒçŒœæµ‹æ˜¯ cluster æ¨¡å¼æœ‰å¤šä¸ª worker, é‡å¯æ˜¯å¦éœ€è¦ restart æŒ‡å®šæ˜¯å“ªä¸ªå­è¿›ç¨‹æ‰å¯ä»¥ï¼Ÿè¿˜å‘ç°ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªå­è¿›ç¨‹ï¼Œä¸æŒ‡å®šä¹Ÿä¼šä¸èƒ½é‡å¯ã€‚æˆ‘æ˜å¤©ä¼šå»éªŒè¯ä¸‹ã€‚</p>
<p>é‡åˆ°äº†ä¸€ç¯‡å¥½æ–‡ç« ï¼š <a href="http://www.acuriousanimal.com/2017/08/20/using-pm2-to-manage-cluster.html" target="_blank" rel="noopener">using-pm2-to-manage-cluster</a></p>
<hr>
<h2 id="ç™»å½•æ€éªŒè¯"><a href="#ç™»å½•æ€éªŒè¯" class="headerlink" title="ç™»å½•æ€éªŒè¯"></a>ç™»å½•æ€éªŒè¯</h2><p>æˆ‘ä»¬åˆ©ç”¨äº†<code>koa session</code>, <code>cookie session</code> è¿™ç§å½¢å¼ã€‚å¼€å§‹çš„æ—¶å€™æˆ‘æŠŠè¿™é‡Œæƒ³å¤æ‚äº†ï¼Œæƒ³è¦ç»“åˆå¾®ä¿¡çš„ç™»å½•æ€ã€‚ä½†å®é™…ä¸Šçº¯ session cookie è¿™ç§åè€Œæ›´å¥½ã€‚</p>
<blockquote>
<p>å¤§æ¦‚æµç¨‹æ˜¯ï¼šç”¨æˆ·ç™»å½•ç½‘ç«™ï¼Œè°ƒç”¨å¾®ä¿¡ç™»å½•ï¼Œæ‹‰èµ·æˆæƒï¼Œæˆæƒçš„åœ°å€è°ƒç”¨ Nodejs åå°çš„ä¸€ä¸ªè‡ªå·±å°è£…çš„æ¥å£ã€‚åœ¨è¿™ä¸ªæ¥å£é‡Œè·å¾—ç”¨æˆ·çš„ openid ï¼Œæ ¡éªŒç”¨æˆ·çš„æƒé™å¹¶ä¸”è®¾ç½® <code>ctx.session.sessionId</code>ï¼Œç„¶åè¿”å›åˆ°å‰ç«¯ï¼Œå‰ç«¯è°ƒç”¨åå°çš„æ¥å£ï¼Œé€šè¿‡å·²ç»ç§ä¸‹çš„ <code>sessionId</code> å³å¯åˆ¤æ–­å‡ºç”¨æˆ·çš„æƒé™ï¼Œç„¶åå†è¿”å›ç»™å‰ç«¯ã€‚å‰ç«¯å†é’ˆå¯¹èº«ä»½åˆ°å¯¹åº”çš„è·¯ç”±ã€‚</p>
</blockquote>
<p>é‚£ä¹ˆä½ è‚¯å®šä¼šé—®ï¼Œä¸ºä»€ä¹ˆä¸åœ¨ç›´æ¥è®¾ç½® sessionId çš„æ—¶å€™æŠŠç”¨æˆ·ä¿¡æ¯è¿”å›äº†å‘¢ï¼Ÿè¿™æ ·ä¹Ÿå¯ä»¥çš„ï¼Œé‚£ä¹ˆç›¸å½“äºä½ å¾®ä¿¡æˆæƒçš„å›è°ƒåœ°å€è¦å†™ä¸€ä¸ªå‰ç«¯çš„é¡µé¢ï¼Œ ç„¶ååœ¨è¿™ä¸ªé¡µé¢ä¸­å†æ¥åˆ¤æ–­ç”¨æˆ·æ ¹æ®èº«ä»½åˆ°å“ªä¸ªé¡µé¢ã€‚è¿™ä¸ªå‰ç«¯é¡µé¢ä½ éœ€è¦å•ç‹¬çš„ä¹Ÿå»ç»´æŠ¤ã€‚è¿™æ ·ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä½ ä¹Ÿè®¸ä¼šé—®ï¼Œæˆ‘ä¸ç”¨å•ç‹¬å†å†™ä¸ªé¡µé¢ï¼Œç”¨é¦–é¡µå°±å¥½äº†ã€‚ä½†æ˜¯ç”¨é¦–é¡µä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æœ€ç»ˆç”±äºæˆæƒï¼Œä½ çš„é¦–é¡µå°±å¸¦ä¸Šäº† code, è¿˜è¦ç”¨ replaceState ä»€ä¹ˆçš„å»æ‰ï¼Œæˆ‘è§‰å¾—å¾ˆä¸æ•´æ´ã€‚ä½†æ˜¯ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚è¿™ä¸¤ç§æ–¹å¼æœ¬è´¨ä¸Šéƒ½å¯ä»¥ã€‚åªä¸è¿‡ç¬¬ä¸€ç§å·æ‡’äº†ï¼Œç›´æ¥redirectåˆ°é¦–é¡µï¼Œé¦–é¡µå†å‘ä¸€æ¬¡è¯·æ±‚ã€‚</p>
<p>æˆ‘ç”¨çš„ç™»å½•ä¸­é—´ä»¶æ˜¯ï¼š <code>koa-generic-session</code>ã€‚<code>app.use</code>ä¸‹é¢è¿™ä¸ªä¸­é—´ä»¶å³å¯ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sequelizeObj = connectDb.db[dbName]</span><br><span class="line"></span><br><span class="line">sessionConfig.options.store = <span class="keyword">new</span> SequelizeStore(sequelizeObj, &#123;</span><br><span class="line">  sync: <span class="literal">false</span>,</span><br><span class="line">  tableName: <span class="string">'t_session'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> session(sessionConfig.options)</span><br></pre></td></tr></table></figure></p>
<p>å­˜å‚¨å¹¶æ²¡æœ‰å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œæ˜¯å­˜åœ¨äº†æ•°æ®åº“é‡Œï¼Œè¿™é‡Œç”¨çš„<code>koa-generic-session-sequelize</code>ã€‚<strong>ä¸æ”¾åœ¨å†…å­˜é‡Œçš„åŸå› æ˜¯æœ‰å¤šå°æœºå™¨ï¼Œå­˜åœ¨å†…å­˜ä¸­ä¸èƒ½å…±äº«åº”è¯¥ä¼šæœ‰é—®é¢˜ã€‚</strong></p>
<p>è®¾ç½® session cookie çš„æ—¶å€™ï¼Œåœ¨å‰ç«¯ cookie é‡Œï¼Œå°±ä¼šæœ‰å¯¹åº”çš„å€¼ï¼Œç„¶åæ¯æ¬¡è¯·æ±‚é¡µé¢ï¼Œéƒ½ä¼šæŠŠè¿™ä¸ª cookie å¸¦ä¸Šï¼Œå»æ•°æ®åº“é‡Œæ‰¾å¯¹åº”çš„ session æ˜¯å¦å¤±æ•ˆã€‚å¦‚æœæ²¡æœ‰å¤±æ•ˆï¼Œè®¤ä¸ºok,é‚£ä¹ˆå°±å¯ä»¥è·³è¿‡éªŒè¯çš„è¿‡ç§°äº†ã€‚</p>
<p>è¿˜å¯ä»¥åŠ ä¸Š app.keys ï¼Œç„¶åå†å¯¹åº”çš„ options é‡ŒåŠ ä¸Š  signkeysã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.keys = [<span class="string">'im a newer secret'</span>, <span class="string">'i like turtle'</span>];</span><br><span class="line">app.keys = <span class="keyword">new</span> KeyGrip([<span class="string">'im a newer secret'</span>, <span class="string">'i like turtle'</span>], <span class="string">'sha256'</span>);</span><br><span class="line"></span><br><span class="line">ctx.cookies.set(<span class="string">'name'</span>, <span class="string">'tobi'</span>, &#123; <span class="attr">signed</span>: <span class="literal">true</span> &#125;);</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œä½ çš„ cookie çš„å€¼ï¼Œå°±ä¼šè¢«åŠ å¯†äº†ã€‚å‰ç«¯çœ‹åˆ°çš„ cookie å¯èƒ½æ˜¯ä¸€ä¸ªåŠ å¯†è¿‡çš„ä¸²ã€‚ç„¶åä½ åˆ°æœåŠ¡å™¨ç«¯ get cookie çš„æ—¶å€™ï¼Œå®ƒä¼šè‡ªåŠ¨å¸®ä½ è§£å¯†ã€‚å¾—åˆ°å¯¹åº”çš„å€¼å»å’Œæ•°æ®åº“é‡Œçš„sessionè¿›è¡Œæ¯”å¯¹ã€‚</p>
<p>é‚£å¦‚æœå‰ç«¯çš„å¾®ä¿¡ç™»å½•æ€è¿‡æœŸäº†æ€ä¹ˆåŠå‘¢ï¼Ÿæ¯”è¾ƒç®€å•ï¼Œå‰ç«¯å‘ç°ç™»å½•æ€å¤±è´¥ï¼Œæ¯”å¦‚ç™»å½•æ€å¤±è´¥çš„è¿”å›ç æ˜¯1111ï¼Œé‚£ä¹ˆ1111æ—¶é‡æ–°æ‹‰èµ·å¾®ä¿¡ç™»å½•å³å¯ã€‚</p>
<hr>
<h2 id="æ—¥å¿—ç®¡ç†"><a href="#æ—¥å¿—ç®¡ç†" class="headerlink" title="æ—¥å¿—ç®¡ç†"></a>æ—¥å¿—ç®¡ç†</h2><p>æ—¥å¿—ç®¡ç†å¯¹äºä¸€ä¸ªå¤§å‹çš„é¡¹ç›®æ¥è¯´ï¼Œå°¤å…¶æ˜¯æ¶‰åŠåˆ°æ”¯ä»˜çš„éå¸¸é‡è¦ï¼Œä»–ç”¨äºå¸®ä½ æŸ¥çœ‹ç”¨æˆ·åšäº†ä»€ä¹ˆäº‹æƒ…ï¼Œæˆ–è€…ç³»ç»Ÿå‡ºäº†ä»€ä¹ˆâŒã€‚éå¸¸çš„é‡è¦ã€‚</p>
<p><strong>æ—¥å¿—æˆ‘è¿™é‡Œç”¨çš„ log4js, åˆ†ä¸ºäº†å››ç§ category, åˆ†åˆ«ç”¨æ¥è®°å½• db æ“ä½œï¼Œè®¿é—®æ—¥å¿—ï¼Œå¼€å‘è€… debug ä¿¡æ¯ï¼Œcgi ä¿¡æ¯æ—¥å¿—ï¼Œé”™è¯¯æ—¥å¿—ã€‚è¿™äº›éœ€è¦æ”¾åœ¨ä¸åŒçš„æ–‡ä»¶é‡Œï¼Œä¾¿äºå¼€å‘è€…æ‰¾é—®é¢˜ã€‚</strong></p>
<p>ä½ å¯ä»¥è®¾ç½®ä¸åŒçš„ categories, æ¯ä¸ª categories é‡Œè®¾ç½® level å’Œä¸åŒçš„ appendersã€‚ æ¯ä¸€ä¸ª appenders éƒ½å¯ä»¥è®¾ç½®ä¸åŒ filename ç­‰ç­‰ã€‚</p>
<p>é‚£ä¹ˆè¿™ä¸ª db çš„æ“ä½œæ—¥å¿—ï¼Œæ€ä¹ˆæ‰“å°å‘¢ï¼Ÿ sequelize å»ºç«‹è·Ÿ db é“¾æ¥æ—¶ï¼Œå¯ä»¥ä¼ å…¥ logging è¿™ä¸ª option, åœ¨è¿™ä¸ª logging é‡Œè®¾ç½® sequelize çš„æ‰“å°æ–¹æ³•ã€‚å¦‚ä¸‹é¢æˆ‘å°±æ˜¯æŠŠæ‰“å°dbçš„æ“ä½œæ—¥å¿—é€šè¿‡ log4js æ‰“å…¥äº†æ—¥å¿—ä¸­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.options.logging = <span class="function"><span class="params">msg</span> =&gt;</span> &#123;</span><br><span class="line">  dbLogger.debug(msg)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="koa2-çš„é”™è¯¯å¤„ç†"><a href="#koa2-çš„é”™è¯¯å¤„ç†" class="headerlink" title="koa2 çš„é”™è¯¯å¤„ç†"></a>koa2 çš„é”™è¯¯å¤„ç†</h2><p>è¿™ä¸ªé”™è¯¯å¤„ç†çš„æ–¹æ³•ï¼Œç½‘ä¸Šåˆ°å¤„éƒ½æ˜¯çš„äº†ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é”™è¯¯å¤„ç†ä¸­é—´ä»¶</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> next()</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    ctx.response.status = err.statusCode || err.status || <span class="number">500</span></span><br><span class="line"></span><br><span class="line">    ctx.response.body = &#123;</span><br><span class="line">      message: <span class="string">'ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•!'</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ctx.app.emit(<span class="string">'error'</span>, err, ctx)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// app.js ä¸­æ¥æ”¶ error äº‹ä»¶ï¼Œå¹¶ä¸”ä¸ŠæŠ¥åˆ°é”™è¯¯æ—¥å¿—ä¸­</span></span><br><span class="line">app.on(<span class="string">'error'</span>, (err, ctx) =&gt; &#123;</span><br><span class="line"> ctx.errorLogger(<span class="string">`name=<span class="subst">$&#123;err.name&#125;</span>&amp;msg=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(err.message)&#125;</span>&amp;stack=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(err.stack)&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œæ³¨æ„å¦‚æœä½ ç›´æ¥æ‰“å°çš„æ˜¯ err å¯¹è±¡ï¼Œä¸€èˆ¬åªæœ‰å®ƒçš„ msg ä¼šè¢«æ‰“å°å‡ºæ¥ï¼Œå¦‚æœä½ æƒ³è¦æ›´å¤šä¿¡æ¯ï¼Œä¸€å®šè¦æŠŠ stack æ‰“å‡ºæ¥ã€‚è¿™ä¸ªæˆ‘ç–å¿½äº†ï¼ŒåŒäº‹å¸®æˆ‘æå‡ºæ¥äº†ï¼Œå¾ˆæ£’å¾ˆä¼˜ç§€ã€‚</p>
<p>æˆ‘å»ç½‘ä¸ŠæŸ¥äº†ä¸‹ï¼Œè¿™ä¸ªé”™è¯¯å¤„ç†å…¶å®æ˜¯ koa2 é‡Œçš„é»˜è®¤æ–¹å¼ï¼Œåªä¸è¿‡æˆ‘ä»¬åˆè‡ªå·±å»é‡å†™äº†ï¼Œä»–æœ¬èº«çš„æ˜¯è¿™æ ·çš„ï¼š</p>
<p>å¯ä»¥çœ‹ä¸‹è¿™ç¯‡æ–‡æ¡£ï¼š<a href="https://github.com/koajs/koa/blob/master/docs/error-handling.md#default-error-handler" target="_blank" rel="noopener">error-handling.md#default-error-handler</a></p>
<p>ä»–é‡Œé¢æ¨èäº†ä¸€ç§å†™æ³•ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> next();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="comment">// will only respond with JSON</span></span><br><span class="line">    ctx.status = err.statusCode || err.status || <span class="number">500</span>;</span><br><span class="line">    ctx.body = &#123;</span><br><span class="line">      message: err.message</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p><strong>æˆ‘è§‰å¾—è¿™ç§å†™æ³•å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œå› ä¸ºå¦‚æœä½ è¿™ä¸ªæ˜¯æ•°æ®åº“çš„æŸäº›åœ°æ–¹å‡ºé”™äº†ï¼Œå¯èƒ½ä¼šåœ¨ err.message é‡Œæš´éœ²ä¸€äº›ä½ æœºå™¨ ip åŠä¸€äº›å…¶ä»–çš„ä¿¡æ¯ï¼Œè¿™ä¸ªæ˜¯ä¸å®‰å…¨çš„ã€‚ç»Ÿä¸€ç»™ç”¨æˆ·ä¸€ä¸ªå›å¤ï¼Œç„¶åæ‰“åˆ°ç³»ç»Ÿé”™è¯¯æ—¥å¿—ä¸­ï¼Œæ˜¯æ¯”è¾ƒå¥½çš„åšæ³•ã€‚</strong></p>
<p>è¿™é‡Œé€”ä¸­çœ‹åˆ°äº†ä¸€ç¯‡æ–‡ç« ï¼š <a href="http://www.52cik.com/2018/05/27/koa-error.html" target="_blank" rel="noopener">å¤§æ¦‚è®²çš„æ˜¯koaé”™è¯¯å¤„ç†çš„å†™æ³•</a></p>
<p>æ³¨æ„é”™è¯¯å¤„ç†æœ€å¥½è¢«å½“åšæœ€å‰é¢çš„ä¸€ä¸ªä¸­é—´ä»¶ã€‚</p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…ˆå†™è¿™ä¹ˆå¤šï¼Œå…¶å®è¿˜æœ‰å¾ˆå¤šå¾ˆå°çš„ç»†èŠ‚ã€‚ä¸‹æ¬¡å†æ•´ç†æ•´ç†ï¼Œå½“ç„¶ä¸Šé¢åªæ˜¯æˆ‘è‡ªå·±çš„ç†è§£ï¼Œå¯èƒ½ä¹Ÿæœ‰æˆ‘ç†è§£é”™äº†çš„ã€‚æˆ‘ä¼šç»å¸¸çœ‹å®ƒï¼Œç„¶åçœ‹è‡ªå·±æ˜¯å¦åé¢åˆæ–°çš„è®¤è¯†æ¥æ¨ç¿»ç°åœ¨çš„æƒ³æ³•ã€‚è¿™ä¸ªé¡¹ç›®æ˜¯æˆ‘è·Ÿç€ç»„é‡Œå¦å¤–ä¸€ä¸ªå¾ˆå¤šå¹´ç»éªŒçš„è€å¸æœºä¸€èµ·åšçš„ï¼Œåœ¨ä»–èº«ä¸Šï¼Œæˆ‘å­¦ä¹ åˆ°äº†ä¸¥è°¨çš„æ€åº¦ã€‚æœ‰å¾ˆå¤šåœ°æ–¹ä»–éƒ½æ¯”æˆ‘æœ‰ç»éªŒï¼Œä¹Ÿç»™æˆ‘æŒ‡å‡ºäº†ä¸€äº›é—®é¢˜ã€‚æ‰€ä»¥è¯´å…¬å¸å’Œè€æ¿ç»™ä»–é‚£ä¹ˆå¤šå·¥èµ„æ˜¯åº”è¯¥çš„å•Šã€‚ä¼˜ç§€å“ˆå“ˆã€‚ğŸ‘ğŸ“š</p>
<p>ğŸŒ²å¸Œæœ›ä¸‹æ¬¡æœ‰æœºä¼šè¯•ä¸‹ Vue SSRã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœ€è¿‘ä¸€ä¸ªå¤šæœˆåŠ äº†å¾ˆå¤šç­ï¼Œåšäº†ä¸€ä¸ªæ¯”è¾ƒç´§æ€¥çš„é¡¹ç›® Nodejs + Vueå…¨å®¶æ¡¶ï¼Œæ„Ÿè§‰è‡ªå·±æ”¶è·å¤šå¤šã€‚ä»Šå¤©å·²ç»å‘å¸ƒäº†ç°ç½‘ç‰ˆæœ¬ï¼Œè¶çƒ­æ€»ç»“å’Œæ¢³ç†ä¸‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id=&quot;å†™åœ¨å‰é¢&quot;&gt;&lt;a href=&quot;#å†™åœ¨å‰é¢&quot; 
    
    </summary>
    
    
      <category term="Nodejs" scheme="http://sevencai.github.io/tags/Nodejs/"/>
    
  </entry>
  
  <entry>
    <title>Ajax è¯·æ±‚åå°æ¥å£ã€ä¸‹è½½æ–‡ä»¶ã€‘æ–¹æ³•</title>
    <link href="http://sevencai.github.io/2018/07/11/Ajax-%E8%AF%B7%E6%B1%82%E5%90%8E%E5%8F%B0%E6%8E%A5%E5%8F%A3%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E6%96%B9%E6%B3%95/"/>
    <id>http://sevencai.github.io/2018/07/11/Ajax-è¯·æ±‚åå°æ¥å£ä¸‹è½½æ–‡ä»¶æ–¹æ³•/</id>
    <published>2018-07-11T14:03:14.000Z</published>
    <updated>2018-07-12T12:29:40.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä½ çš„ç®¡ç†å°æœ‰ä¸€ä¸ªåŠŸèƒ½æ˜¯ç‚¹å‡»<strong>[æŸ¥çœ‹æ–‡ä»¶]</strong>ï¼Œä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°çš„åŠŸèƒ½ã€‚ä½ å¯èƒ½è‡ªç„¶çš„å‘åå°æ¥å£ï¼ˆå¯èƒ½æ˜¯ Nodejs çš„ä¸€ä¸ª Restful Apiï¼‰è¯·æ±‚ä¸‹è½½ã€‚ä½†æ˜¯ä½ å‘ç°ä½ åå°çš„ Nodejs è™½ç„¶è®¾ç½®äº†æ­£ç¡®çš„å“åº”å¤´ï¼ˆContent-position, Content-typeï¼‰å´è¿˜æ˜¯æ²¡æœ‰å¼¹å‡ºä¿å­˜æ–‡ä»¶çš„æ¡†ã€‚</p>
</blockquote>
<p>åŸå› æ˜¯æœªç»è¿‡å¤„ç†çš„ ajaxï¼ˆå¦‚jquery ajaxè¯·æ±‚ï¼‰ è¯·æ±‚ä¸èƒ½å¤„ç†æ­£ç¡®çš„äºŒè¿›åˆ¶ï¼ˆæµï¼‰ç±»å‹çš„æ–‡ä»¶ã€‚</p>
<p>ä¸‹é¢æˆ‘æ€»ç»“äº†å‡ ç§æ–¹å¼å¯ä»¥è§£å†³æ­¤é—®é¢˜-&gt; ğŸ“šğŸŒ²</p>
<hr>
<h2 id="åˆ©ç”¨iframe"><a href="#åˆ©ç”¨iframe" class="headerlink" title="åˆ©ç”¨iframe"></a>åˆ©ç”¨iframe</h2><p>Nodejs ç«¯æ­£å¸¸çš„è®¾ç½®ç›¸åº”å¤´ï¼Œ<code>Content-disposition: attachment, filename=</code>ã€‚ç„¶åè¯»åˆ°æœåŠ¡å™¨ä¸Šå¯¹åº”çš„æ–‡ä»¶èµ‹å€¼ç»™ <code>ctx.body</code> å³å¯ã€‚ä¸‹é¢æ˜¯ä¸€ç§å‚è€ƒçš„ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> filePath = path.join(path.resolve(__dirname, <span class="string">'../uploads'</span>), $&#123;fileStamp&#125;)</span><br><span class="line"></span><br><span class="line">ctx.set(&#123;</span><br><span class="line">  <span class="string">'Content-disposition'</span>: <span class="string">`attachment; filename=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(fileStamp)&#125;</span>`</span>,</span><br><span class="line">  <span class="string">'Content-type'</span>: <span class="string">'application/octet-stream'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">ctx.body = fs.createReadStream(filePath)</span><br></pre></td></tr></table></figure>
<p>å‰ç«¯åˆ©ç”¨ iframe çš„ src å±æ€§ï¼Œè¿›è¡Œé‡æ–°èµ‹å€¼ã€‚æ³¨æ„ iframe è®¾ä¸º <code>display: none</code> å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe ref=<span class="string">"downloadIframe"</span> src=<span class="string">""</span> frameborder=<span class="string">"0"</span> style=<span class="string">"display: none;"</span>&gt;&lt;/iframe&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç‚¹å‡»æŸ¥çœ‹æ—¶æ‰§è¡Œ downloadFile</span></span><br><span class="line">downloadFile(fileStamp) &#123;</span><br><span class="line"> <span class="keyword">this</span>.$refs.downloadIframe.src = <span class="string">`/download/<span class="subst">$&#123;fileStamp&#125;</span>`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="åˆ©ç”¨URL-createObjectURL"><a href="#åˆ©ç”¨URL-createObjectURL" class="headerlink" title="åˆ©ç”¨URL.createObjectURL"></a>åˆ©ç”¨URL.createObjectURL</h2><blockquote>
<p>URL.createObjectURL() é™æ€æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ª DOMStringï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªè¡¨ç¤ºå‚æ•°ä¸­ç»™å‡ºçš„å¯¹è±¡çš„URLã€‚è¿™ä¸ª URL çš„ç”Ÿå‘½å‘¨æœŸå’Œåˆ›å»ºå®ƒçš„çª—å£ä¸­çš„ document ç»‘å®šã€‚è¿™ä¸ªæ–°çš„URL å¯¹è±¡è¡¨ç¤ºæŒ‡å®šçš„ File å¯¹è±¡æˆ– Blob å¯¹è±¡ã€‚</p>
<p>ä¸€ä¸ª Blobå¯¹è±¡è¡¨ç¤ºä¸€ä¸ªä¸å¯å˜çš„, åŸå§‹æ•°æ®çš„ç±»ä¼¼æ–‡ä»¶å¯¹è±¡ã€‚Blobè¡¨ç¤ºçš„æ•°æ®ä¸ä¸€å®šæ˜¯ä¸€ä¸ªJavaScriptåŸç”Ÿæ ¼å¼ã€‚ File æ¥å£åŸºäºBlobï¼Œç»§æ‰¿ blobåŠŸèƒ½å¹¶å°†å…¶æ‰©å±•ä¸ºæ”¯æŒç”¨æˆ·ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ã€‚ï¼ˆHTML5æ–°å¢ç‰¹æ€§ï¼‰</p>
</blockquote>
<p>è¿™ç§æ–¹æ³•æˆ‘å·²ç»åœ¨ä¸Šç¯‡æ–‡ç« åˆšå¥½æœ‰ç”¨åˆ°ï¼Œå¯ä»¥åˆ©ç”¨æµè§ˆå™¨åŸç”Ÿ fetch æ–¹æ³•ï¼Œç„¶åè§£æä¸º blob ç±»å‹ã€‚å†åˆ©ç”¨aæ ‡ç­¾çš„ download å±æ€§å³å¯ã€‚å‚è€ƒä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchApi</span> (<span class="params">url, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> fetch(url, &#123;</span><br><span class="line">    body: <span class="built_in">JSON</span>.stringify(data),</span><br><span class="line">    headers: &#123;</span><br><span class="line">      <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    cache: <span class="string">'no-cache'</span>,</span><br><span class="line">    method: <span class="string">'POST'</span>,</span><br><span class="line">    mode: <span class="string">'cors'</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„è¿™é‡Œè¦æ˜¯ response.blob()</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getImageData</span>(<span class="params">url, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> fetchApi(url, data)</span><br><span class="line">    .then(<span class="function"><span class="params">response</span> =&gt;</span> response.blob())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getImage</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  getImageData(<span class="string">'/downloadImage'</span>, data)</span><br><span class="line">    .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>)</span><br><span class="line">      <span class="keyword">let</span> url = <span class="built_in">window</span>.URL.createObjectURL(response)</span><br><span class="line">      <span class="keyword">let</span> filename = <span class="string">`<span class="subst">$&#123;data.scene&#125;</span>-<span class="subst">$&#123;+<span class="keyword">new</span> <span class="built_in">Date</span>()&#125;</span>.png`</span></span><br><span class="line"></span><br><span class="line">      a.href = url</span><br><span class="line">      a.download = filename</span><br><span class="line"></span><br><span class="line">      a.click()</span><br><span class="line">      <span class="built_in">window</span>.URL.revokeObjectURL(url)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶ä½ å¯ä»¥ä¸ç”¨ fetch çš„è¿™ä¸ªæ–¹æ³•ï¼Œç›´æ¥åœ¨ xhr é‡Œè¿›è¡Œå°è£…ã€‚æˆ‘çœ‹åˆ° stackoverflow ä¸Šæœ‰ä¸ªå¾ˆå¥½çš„æ–‡ç« ï¼Œåœ°å€<a href="https://stackoverflow.com/questions/16086162/handle-file-download-from-ajax-post" target="_blank" rel="noopener">æˆ³è¿™é‡Œ</a>ï¼Œæˆ‘è§‰çš„æœ€é«˜å›ç­”è€…å·²ç»è§£é‡Šçš„å¾ˆå¥½äº†ï¼Œä¸‹é¢å¼•ç”¨å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.open(<span class="string">'POST'</span>, url, <span class="literal">true</span>);</span><br><span class="line">xhr.responseType = <span class="string">'arraybuffer'</span>;</span><br><span class="line">xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.status === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> filename = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">var</span> disposition = xhr.getResponseHeader(<span class="string">'Content-Disposition'</span>);</span><br><span class="line">        <span class="keyword">if</span> (disposition &amp;&amp; disposition.indexOf(<span class="string">'attachment'</span>) !== <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> filenameRegex = <span class="regexp">/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/</span>;</span><br><span class="line">            <span class="keyword">var</span> matches = filenameRegex.exec(disposition);</span><br><span class="line">            <span class="keyword">if</span> (matches != <span class="literal">null</span> &amp;&amp; matches[<span class="number">1</span>]) filename = matches[<span class="number">1</span>].replace(<span class="regexp">/['"]/g</span>, <span class="string">''</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> type = xhr.getResponseHeader(<span class="string">'Content-Type'</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> blob = <span class="keyword">typeof</span> File === <span class="string">'function'</span></span><br><span class="line">            ? <span class="keyword">new</span> File([<span class="keyword">this</span>.response], filename, &#123; <span class="attr">type</span>: type &#125;)</span><br><span class="line">            : <span class="keyword">new</span> Blob([<span class="keyword">this</span>.response], &#123; <span class="attr">type</span>: type &#125;);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">window</span>.navigator.msSaveBlob !== <span class="string">'undefined'</span>) &#123;</span><br><span class="line">            <span class="comment">// IE workaround for "HTML7007: One or more blob URLs were revoked by closing the blob for which they were created. These URLs will no longer resolve as the data backing the URL has been freed."</span></span><br><span class="line">            <span class="built_in">window</span>.navigator.msSaveBlob(blob, filename);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> URL = <span class="built_in">window</span>.URL || <span class="built_in">window</span>.webkitURL;</span><br><span class="line">            <span class="keyword">var</span> downloadUrl = URL.createObjectURL(blob);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (filename) &#123;</span><br><span class="line">                <span class="comment">// use HTML5 a[download] attribute to specify filename</span></span><br><span class="line">                <span class="keyword">var</span> a = <span class="built_in">document</span>.createElement(<span class="string">"a"</span>);</span><br><span class="line">                <span class="comment">// safari doesn't support this yet</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">typeof</span> a.download === <span class="string">'undefined'</span>) &#123;</span><br><span class="line">                    <span class="built_in">window</span>.location = downloadUrl;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    a.href = downloadUrl;</span><br><span class="line">                    a.download = filename;</span><br><span class="line">                    <span class="built_in">document</span>.body.appendChild(a);</span><br><span class="line">                    a.click();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">window</span>.location = downloadUrl;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; URL.revokeObjectURL(downloadUrl); &#125;, <span class="number">100</span>); <span class="comment">// cleanup</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">xhr.setRequestHeader(<span class="string">'Content-type'</span>, <span class="string">'application/x-www-form-urlencoded'</span>);</span><br><span class="line">xhr.send($.param(params));</span><br></pre></td></tr></table></figure>
<p>å¤§æ¦‚çš„æ€è·¯æ˜¯åˆ©ç”¨ <code>xhr</code> åŸç”Ÿå¯¹è±¡çš„ <code>onload</code> åï¼Œè¿›è¡Œ<code>new blob()</code>å¯¹è±¡ã€‚</p>
<p>å†æ‰§è¡Œ<code>URL.createObjectURL(blob)</code>çš„æ“ä½œã€‚</p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…¶å®è¿˜æœ‰åˆ«çš„æ–¹æ³•ï¼Œå¦‚ <code>POST</code> ä¸€ä¸ªè¯·æ±‚ï¼Œä½†æ˜¯è¿™ä¸ªä¼šåˆ·æ–°å½“å‰çš„ <code>Url</code>ã€‚ä¸Šé¢ä¸¤ç§æƒ…å†µå…¶å®æ˜¯ä¸¤ç§æ€è·¯ã€‚</p>
<p><code>POST</code> è¯·æ±‚è·Ÿ <code>Iframe</code> ç±»ä¼¼,åŒæ ·è¿˜å¯ä»¥ <code>window.open</code> æˆ–è€… <code>window.location</code> æ¥åšè¿™ä»¶äº‹æƒ…ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä½ çš„ç®¡ç†å°æœ‰ä¸€ä¸ªåŠŸèƒ½æ˜¯ç‚¹å‡»&lt;strong&gt;[æŸ¥çœ‹æ–‡ä»¶]&lt;/strong&gt;ï¼Œä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°çš„åŠŸèƒ½ã€‚ä½ å¯èƒ½è‡ªç„¶çš„å‘åå°æ¥å£ï¼ˆå¯èƒ½æ˜¯ Nodejs çš„ä¸€ä¸ª Restful Apiï¼‰è¯·æ±‚ä¸‹è½½ã€‚ä½†æ˜¯ä½ å‘ç°ä½ åå°çš„ Nodejs è™½ç„¶è®¾ç½®äº†æ­£ç¡®çš„å“åº”å¤´ï¼ˆCon
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>koa2 ç”Ÿæˆå¸¦åœºæ™¯å€¼å‚æ•°çš„å¸¦LogoäºŒç»´ç </title>
    <link href="http://sevencai.github.io/2018/06/21/koa2-%E7%94%9F%E6%88%90%E5%B8%A6%E5%9C%BA%E6%99%AF%E5%80%BC%E5%8F%82%E6%95%B0%E7%9A%84%E5%B8%A6Logo%E4%BA%8C%E7%BB%B4%E7%A0%81/"/>
    <id>http://sevencai.github.io/2018/06/21/koa2-ç”Ÿæˆå¸¦åœºæ™¯å€¼å‚æ•°çš„å¸¦LogoäºŒç»´ç /</id>
    <published>2018-06-21T12:14:37.000Z</published>
    <updated>2018-06-21T13:13:21.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ä¸Šæ¬¡å†™ Koa è¿˜æ˜¯2016å¹´åˆšæ¥å…¬å¸å®ä¹ çš„æ—¶å€™ï¼Œé‚£æ—¶å€™æˆ‘è¿˜åœ¨ä¸Šå¤§ä¸‰ã€‚è½¬çœ¼è§2å¹´è¿‡å»äº†ï¼Œæˆ‘ä¹Ÿæ­£å¼å·¥ä½œå¿«ä¸€å¹´äº†ã€‚ Koa ä¹Ÿä»åŸæ¥æ¯”è¾ƒéš¾ç”¨çš„ generator ï¼Œyield å˜æˆäº†ç°åœ¨çš„ async await ã€‚çœŸå¥½ã€‚</p>
</blockquote>
<p>è¿™æ¬¡æ–‡ç« çš„èƒŒæ™¯æ˜¯ï¼Œäº§å“éœ€è¦ç»™å…¬ä¼—å·æ‹‰æ–°ã€‚éœ€è¦ç”Ÿæˆå„ç§å¸¦å‚æ•°çš„äºŒç»´ç ã€‚è¿™ä¸ªå¸¦å‚æ•°çš„äºŒç»´ç å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚ç»Ÿè®¡æ–°æ‹‰çš„å…³æ³¨æ˜¯ä»å“ªä¸ªåœºæ™¯å€¼ä¸‹æ¥çš„ã€‚æ¯”å¦‚å…³æ³¨æ—¶ï¼Œä¸åŒåœºæ™¯å€¼æœ‰ä¸åŒçš„å…¬ä¼—å·å›å¤å†…å®¹ã€‚</p>
<p>åœ¨ç»å†äº†å¥½å‡ æ¬¡æ¯æ¬¡æ‰‹åŠ¨è·Ÿå¥¹ç”Ÿæˆåï¼Œæˆ‘ä¸‹å®šäº†å†³å¿ƒï¼Œè·Ÿäº§å“è¦äº†2å¤©æ’æœŸï¼Œç»™å¥¹åšä¸€ä¸ªå·¥å…·ã€‚è‡ªåŠ¨ç”Ÿæˆå¸¦ Logo çš„äºŒç»´ç ã€‚<strong>ä¸»è¦æ˜¯æ‰‹å·¥å»æ“ä½œæ¯”è¾ƒç¹çï¼Œéœ€è¦ç»å†ä¸‹é¢å‡ æ­¥</strong>ï¼š</p>
<ol>
<li>å…ˆå»è·å¾— access_token</li>
<li>å†è°ƒç”¨å¾®ä¿¡åˆ›å»ºå¸¦å‚æ•°å€¼äºŒç»´ç çš„æ¥å£qrcode/createï¼Œè·å¾— ticket</li>
<li>å†æ‹¿ ticket æ¢äºŒç»´ç </li>
</ol>
<p>è¿™å…¶ä¸­ï¼Œå¸¦å‚æ•°çš„äºŒç»´ç åˆåˆ†ä¸ºäº†ä¸¤ç§ï¼Œæ°¸ä¹…å’Œä¸´æ—¶äºŒç»´ç ã€‚å…·ä½“æ¥å£å¯ä»¥<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1443433542" target="_blank" rel="noopener">å‚è€ƒå…¬ä¼—å·çš„æ–‡æ¡£</a>ï¼Œ å¹¶ä¸”æ¯æ¬¡äº§å“è‡ªå·±æ‹¿åˆ° ticket æ¢çš„äºŒç»´ç åï¼Œè¿˜éœ€è¦è‡ªå·±å» P logo, å¤§å°ä¹Ÿè¦è‡ªå·±å»è°ƒã€‚æ€»ä¹‹æ¯”è¾ƒéº»çƒ¦ã€‚</p>
<p><strong>æ‰€ä»¥è¿™ç¯‡æ–‡ç« ï¼Œä¸»è¦å°±æ˜¯ç”¨ Koa2 ç”Ÿæˆå¸¦åœºæ™¯å€¼å‚æ•°çš„å…¬ä¼—å·äºŒç»´ç </strong>ã€‚ğŸ’—ğŸŒ¹</p>
<hr>
<h2 id="è®¾è®¡"><a href="#è®¾è®¡" class="headerlink" title="è®¾è®¡"></a>è®¾è®¡</h2><p>é¦–å…ˆæˆ‘ç¡®å®šäº† koa server ç«¯ï¼Œåªåšæ¥å£å±‚ã€‚æ„æ€æ˜¯åªç”¨æ¥å¤„ç†å‰ç«¯çš„è¯·æ±‚ã€‚ GET or POSTã€‚</p>
<p>å‰ç«¯ä¸»è¦åšè¡¨å•éªŒè¯ï¼Œè·å–äº§å“æƒ³è¦çš„äºŒç»´ç ç±»å‹ä¿¡æ¯ç­‰ã€‚ç„¶åä¼ ç»™åå°ã€‚åå°æ ¹æ®ä¿¡æ¯ï¼Œå»æ‹¿ access_token, ç„¶åè°ƒç”¨å¾®ä¿¡äºŒç»´ç ï¼Œå†æ·»åŠ  logo ç­‰ã€‚ç„¶åè¿”å›ç»™å‰ç«¯ã€‚æœ€åçš„æ•ˆæœæ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="qrcode.png" alt="ç»“æœå›¾"></p>
<p>äº§å“å¯ä»¥é€‰æ‹©ï¼Œæ˜¯ä¸´æ—¶è¿˜æ˜¯æ°¸ä¹…ï¼Œé€‰æ‹©æ˜¯åªè¦é“¾æ¥è¿˜æ˜¯ä¸‹è½½å›¾ç‰‡ï¼Œæ˜¯å¦æ·»åŠ  Logo ï¼Œå›¾ç‰‡çš„å¤§å°ç­‰ç­‰ã€‚</p>
<p>æœ€åå¦‚æœå›¾ç‰‡ç±»å‹é€‰çš„æ˜¯ã€æˆ‘è¦ç”Ÿæˆå›¾ç‰‡ã€‘å°±å¯ä»¥ç”Ÿæˆç±»ä¼¼ä¸‹é¢äºŒç»´ç å•¦ï¼Œ å¦‚æœæ˜¯ç‚¹å‡»çš„ ã€æˆ‘åªè¦é“¾æ¥ã€‘ï¼Œé‚£ä¹ˆæˆ‘åªä¼šè¿”å›ä¸€ä¸ªå¸¦ticketçš„é“¾æ¥ã€‚</p>
<p><img src="exampletest.png" alt="ç”Ÿæˆç»“æœå›¾ç‰‡"></p>
<p>çº¢è‰²çš„ç¬”éƒ¨åˆ†æ˜¯ä¸ºäº†é®ä½äºŒç»´ç ä¿¡æ¯ï¼Œå› ä¸ºæ˜¯è‡ªå·±çš„æµ‹è¯•å·ã€‚ä¸»è¦ç”¨åˆ°äº†ä¸‹é¢è¿™äº› npm åº“ï¼š <code>koa-router, koa-static, qr-image, request-promise, stream-to-promise, image-size</code></p>
<hr>
<h2 id="æµç¨‹æ§åˆ¶"><a href="#æµç¨‹æ§åˆ¶" class="headerlink" title="æµç¨‹æ§åˆ¶"></a>æµç¨‹æ§åˆ¶</h2><p>å†™èµ·æ¥ä»£ç æ²¡æœ‰ç‰¹åˆ«çš„åœ°æ–¹ï¼Œç”¨ koa-router åšè·¯ç”±ï¼Œæ¯”å¦‚äº§å“é€‰æ‹©ç”Ÿæˆé“¾æ¥ï¼Œè¿˜æ˜¯ç”Ÿæˆå›¾ç‰‡ï¼Œæˆ‘é€‰æ‹©äº†è·¯ç”±åˆ°ä¸¤ä¸ªæ¥å£ã€‚</p>
<p>åœ¨é…ç½®æ–‡ä»¶ï¼Œ route.js ä¸­ï¼Œé…ç½®ç›¸åº”è·¯ç”±çš„è¯·æ±‚ä»¥åŠå¯¹åº”çš„ controller</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  &apos;post /getLink&apos;: &apos;controllers/createLink&apos;,</span><br><span class="line">  &apos;post /downloadImage&apos;: &apos;controllers/createImage&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™è¡¨æ˜ï¼š</p>
<p>å½“å‰ç«¯ post getLink è¿™ä¸ªæ¥å£æ—¶ï¼Œ ç”¨ controllers ä¸‹çš„ createLink æ¥å¤„ç†ã€‚<br>å½“å‰ç«¯ post downloadImage è¿™ä¸ªæ¥å£æ—¶ï¼Œç”¨ controllers ä¸‹çš„ downloadImage æ¥å¤„ç†ã€‚</p>
<p>ç„¶åå†åœ¨è‡ªå·±å†™ä¸ªæ³¨å†Œè·¯ç”±çš„ middleware<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">app, router</span>) =&gt;</span> (</span><br><span class="line">  <span class="built_in">Object</span>.keys(routesConfig).forEach(<span class="function"><span class="params">route</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [method, path] = route.split(<span class="string">' '</span>)</span><br><span class="line">    <span class="keyword">const</span> controller = <span class="built_in">require</span>(<span class="string">'../'</span> + routesConfig[route])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> controller !== <span class="string">'function'</span> || <span class="keyword">typeof</span> router[method] !== <span class="string">'function'</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (method === <span class="string">'post'</span>) &#123;</span><br><span class="line">      app.use(bodyParser())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    router.post(path, controller)</span><br><span class="line">  &#125;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>ç„¶ååœ¨ å…¥å£æ–‡ä»¶ä¸­ä½¿ç”¨è¿™ä¸ª middleware å¹¶ä¸”æ³¨å†Œåˆ° koa-router ä¸Šå³å¯ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">routeMiddleware(App, router)</span><br><span class="line"></span><br><span class="line">App.use(router.routes()).use(router.allowedMethods())</span><br></pre></td></tr></table></figure></p>
<p>æœ€åæ˜¯å¯¹åº”çš„ controller é‡Œå¤„ç†æ–‡ä»¶, æ¯”å¦‚å¦‚ä¸‹æ˜¯ downloadImage çš„ controller, æŠŠ data ä¼ ç»™äº†æ ¸å¿ƒå¤„ç†ä¸šåŠ¡æµç¨‹çš„ç±»æ–‡ä»¶ã€‚ç„¶åå†è¿”å›ç›¸åº”çš„å›¾ç‰‡å³å¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºäºŒç»´ç </span></span><br><span class="line"><span class="comment"> * @param ctx</span></span><br><span class="line"><span class="comment"> * @returns &#123;Promise&lt;void&gt;&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> Core = <span class="built_in">require</span>(<span class="string">'../server/core'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">async</span> (ctx) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> data = ctx.request.body</span><br><span class="line">  <span class="keyword">const</span> core = <span class="keyword">new</span> Core(data)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> core.downloadQrCodeImage()</span><br><span class="line"></span><br><span class="line">  ctx.type = <span class="string">'png'</span></span><br><span class="line">  ctx.set(<span class="string">'Content-type'</span>, <span class="string">'image/png'</span>)</span><br><span class="line">  ctx.body = result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‰ç«¯æ¥å—åˆ°è¿™ä¸ª image åï¼Œå†åˆ©ç”¨ createObjectURL, revokeObjectURL ç«‹å³ä¸‹è½½å›¾ç‰‡å³å¯ã€‚ä¸‹é¢å±•ç¤ºçš„æ˜¯å‰ç«¯è¿™ä¸€éƒ¨åˆ†å¤„ç†çš„é€»è¾‘ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchApi</span> (<span class="params">url, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> fetch(url, &#123;</span><br><span class="line">    body: <span class="built_in">JSON</span>.stringify(data),</span><br><span class="line">    headers: &#123;</span><br><span class="line">      <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    cache: <span class="string">'no-cache'</span>,</span><br><span class="line">    method: <span class="string">'POST'</span>,</span><br><span class="line">    mode: <span class="string">'cors'</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getImageData</span>(<span class="params">url, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> fetchApi(url, data)</span><br><span class="line">    .then(<span class="function"><span class="params">response</span> =&gt;</span> response.blob())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getImage</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  getImageData(<span class="string">'/downloadImage'</span>, data)</span><br><span class="line">    .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>)</span><br><span class="line">      <span class="keyword">let</span> url = <span class="built_in">window</span>.URL.createObjectURL(response)</span><br><span class="line">      <span class="keyword">let</span> filename = <span class="string">`<span class="subst">$&#123;data.scene&#125;</span>-<span class="subst">$&#123;+<span class="keyword">new</span> <span class="built_in">Date</span>()&#125;</span>.png`</span></span><br><span class="line"></span><br><span class="line">      a.href = url</span><br><span class="line">      a.download = filename</span><br><span class="line"></span><br><span class="line">      a.click()</span><br><span class="line">      <span class="built_in">window</span>.URL.revokeObjectURL(url)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æˆ‘ç”¨çš„æµè§ˆå™¨åŸç”Ÿçš„ Fetch Apiï¼Œ å› ä¸ºä¸æƒ³åœ¨å‰ç«¯è¿˜å¼•å…¥åˆ«çš„åº“ã€‚æ³¨æ„ fetchApi è¿”å›ä¸åŒçš„å†…å®¹ï¼Œè¦ç”¨ä¸åŒçš„å†…å®¹å¤„ç†ã€‚æ¯”å¦‚ä¸Šé¢çš„å›¾ç‰‡æ˜¯ç”¨çš„ response.blob() å¤„ç†ï¼Œå¦‚æœæ˜¯è¿”å›çš„jsonï¼Œ éœ€è¦ç”¨ response.json() å¤„ç†ã€‚</p>
<hr>
<h2 id="è·å–-AccessToken"><a href="#è·å–-AccessToken" class="headerlink" title="è·å– AccessToken"></a>è·å– AccessToken</h2><p>æ³¨æ„å¦‚æœæ²¡æœ‰è‡ªå·±çš„è·å– AccessToken çš„ä¸­æ§æœåŠ¡å™¨ï¼Œä¸€å®šè¦ç¼“å­˜ accessToken, accessToken æœ‰è¿‡æœŸæ—¶é—´ï¼Œå¹¶ä¸”ä¸€å¤©æœ‰è°ƒç”¨ä¸Šé™ã€‚éƒ¨é—¨å†…æœ‰ä¸“é—¨çš„ä¸­æ§æœåŠ¡å™¨ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯è‡ªå·±è¯•äº†ä¸‹è‡ªå·±åšç¼“å­˜çš„æµç¨‹ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">const</span> rp = <span class="built_in">require</span>(<span class="string">'request-promise'</span>)</span><br><span class="line"> <span class="keyword">const</span> cachePath = <span class="string">'./cache/token.txt'</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å¾— access_token</span></span><br><span class="line"><span class="comment"> * è‹¥ç¼“å­˜æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™ä»ç¼“å­˜ä¸­è¯»å–</span></span><br><span class="line"><span class="comment"> * è‹¥ç¼“å­˜æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè°ƒç”¨ update æ¥å£æ›´æ–°</span></span><br><span class="line"><span class="comment"> * @returns &#123;Promise&lt;*&gt;&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> getAccessToken () &#123;</span><br><span class="line">  <span class="keyword">let</span> token = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (fs.existsSync(cachePath)) &#123;</span><br><span class="line">    token = <span class="built_in">JSON</span>.parse(fs.readFileSync(cachePath))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!token || token.timeout &lt; <span class="built_in">Date</span>.now()) &#123;</span><br><span class="line">    <span class="keyword">let</span> res = <span class="built_in">JSON</span>.parse(<span class="keyword">await</span> <span class="keyword">this</span>.updateAccessToken())</span><br><span class="line"></span><br><span class="line">    res.timeout = <span class="built_in">Date</span>.now() + (res.expires_in - <span class="number">200</span>) * <span class="number">1000</span></span><br><span class="line">    fs.writeFileSync(cachePath, <span class="built_in">JSON</span>.stringify(res))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> token</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ›´æ–°å¾®ä¿¡ Access_token</span></span><br><span class="line"><span class="comment"> * æ­¤å¤„æœ‰æ¯å¤©è°ƒç”¨ 2000 æ¬¡é™åˆ¶</span></span><br><span class="line"><span class="comment"> * 2h å³å¤±æ•ˆ</span></span><br><span class="line"><span class="comment"> * @returns &#123;Promise&lt;*&gt;&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> updateAccessToken () &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; appid, appkey &#125; = serverConfig</span><br><span class="line">  <span class="keyword">const</span> url = <span class="string">`https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid=<span class="subst">$&#123;appid&#125;</span>&amp;secret=<span class="subst">$&#123;appkey&#125;</span>`</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> rp.get(url)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›¸å½“äºæ¯æ¬¡è°ƒç”¨åï¼Œè¦é‡æ–°å†™å…¥æ–‡ä»¶è¿‡æœŸæ—¶é—´ï¼Œå¦‚æœè¿‡æœŸæ—¶é—´åˆ°äº†ï¼Œé‚£ä¹ˆé‡æ–°å»æ›´æ–°ã€‚ä¹‹æ‰€ä»¥æ‹¿ re.expires_in - 200, æ˜¯ä¸ºäº†ç•™ç‚¹ buffer, è¿™ä¸ªå€¼å½“ç„¶å¯ä»¥è‡ªå·±å»è®¾ç½®ã€‚</p>
<hr>
<h2 id="ç”ŸæˆäºŒç»´ç "><a href="#ç”ŸæˆäºŒç»´ç " class="headerlink" title="ç”ŸæˆäºŒç»´ç "></a>ç”ŸæˆäºŒç»´ç </h2><p>è¿™é‡Œçš„ logo, å› ä¸ºæˆ‘ä»¬å…¬ä¼—å·åªæœ‰ä¸€ä¸ª logo, æ•…ç›´æ¥æ˜¯ä»æ–‡ä»¶ä¸­è¯»å–äº†ã€‚ä»¥åè€ƒè™‘æŠŠè¿™ä¸ªæ”¾åœ¨ github çš„è¯ï¼Œå¯èƒ½ä¼šæ”¯æŒç”¨æˆ·å¯ä»¥è‡ªå·±ä¸Šä¼  Logoã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªåœ°æ–¹è¦æ³¨æ„ï¼Œå°±æ˜¯è®¡ç®— logo çš„ä½ç½®ã€‚ç›´æ¥é™¤ä»¥äºŒç»´ç çš„é«˜å®½ä¸€åŠæ˜¯ä¸è¡Œçš„ï¼Œè¿˜è¦å‡å» logo çš„ä¸€åŠå“¦ã€‚</p>
<p>æˆ‘è¿™è¾¹åœ¨è¿”å›ç»™å‰ç«¯ä¸‹è½½çš„æ—¶å€™ï¼Œä¹Ÿ save åˆ°æœ¬åœ°äº†ï¼Œæ‹…å¿ƒäº§å“ä¸¢å¤±ä¿¡æ¯ã€‚save çš„æ—¶å€™ï¼Œæˆ‘ä»¥åœºæ™¯å€¼å’Œæ—¶é—´ä¸ºåå­—ï¼Œä¼šæ–¹ä¾¿æ—¥åå¥½æ‰¾ä¸€äº›ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ·»åŠ  logo</span></span><br><span class="line"><span class="comment"> * @param imageStream</span></span><br><span class="line"><span class="comment"> * @returns &#123;Promise&lt;*&gt;&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> getLogo (imageStream) &#123;</span><br><span class="line">  <span class="keyword">const</span> imgBuffer = <span class="keyword">await</span> streamToPromise(imageStream)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; <span class="attr">width</span>: imgWidth, <span class="attr">height</span>: imgHeight &#125; = imgSize(imgBuffer)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> logoWrapper = images(<span class="string">"./static/assets/logo.png"</span>).size(imgWidth / <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> x = (imgWidth - logoWrapper.width()) / <span class="number">2</span></span><br><span class="line">  <span class="keyword">const</span> y = (imgHeight - logoWrapper.height()) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="keyword">this</span>.drawImage(imgBuffer, logoWrapper, x, y)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”»å›¾</span></span><br><span class="line"><span class="comment"> * @param imgBuffer</span></span><br><span class="line"><span class="comment"> * @param logoWrapper</span></span><br><span class="line"><span class="comment"> * @param x</span></span><br><span class="line"><span class="comment"> * @param y</span></span><br><span class="line"><span class="comment"> * @returns &#123;Promise&lt;any&gt;&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> drawImage (imgBuffer, logoWrapper, x, y) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> image = images(imgBuffer)</span><br><span class="line">      .draw(logoWrapper, x, y)</span><br><span class="line">      .save(<span class="string">`./static/image/<span class="subst">$&#123;<span class="keyword">this</span>.scene&#125;</span>-<span class="subst">$&#123;+<span class="keyword">new</span> <span class="built_in">Date</span>()&#125;</span>.png`</span>, &#123;</span><br><span class="line">        quality : <span class="number">50</span></span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!image) &#123;</span><br><span class="line">      reject()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    resolve(image)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="å…¥å£æ–‡ä»¶"><a href="#å…¥å£æ–‡ä»¶" class="headerlink" title="å…¥å£æ–‡ä»¶"></a>å…¥å£æ–‡ä»¶</h2><p>å…¥å£æ–‡ä»¶è·Ÿå¹³å¸¸çš„å…¥å£æ–‡ä»¶åŸºæœ¬ä¸Šæ²¡æœ‰ä»€ä¹ˆå¤§åŒºåˆ«ã€‚æ¯”è¾ƒç®€å•ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> Router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>)</span><br><span class="line"><span class="keyword">const</span> StaticServer = <span class="built_in">require</span>(<span class="string">'koa-static'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">'./config'</span>)</span><br><span class="line"><span class="keyword">const</span> routeMiddleware = <span class="built_in">require</span>(<span class="string">'./middleware/route'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> App = <span class="keyword">new</span> Koa()</span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> staticPath = <span class="string">'./static'</span></span><br><span class="line"></span><br><span class="line">App.use(StaticServer(path.join(__dirname, staticPath)))</span><br><span class="line"></span><br><span class="line">routeMiddleware(App, router)</span><br><span class="line"></span><br><span class="line">App.use(router.routes()).use(router.allowedMethods())</span><br><span class="line"></span><br><span class="line">App.listen(config.port, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`App listening on port <span class="subst">$&#123;config.port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æƒ³å½“ä¸€ä¸ªä¼˜ç§€çš„ Nodejs å·¥ç¨‹å¸ˆï¼Œä½†æ˜¯å‘ç°è‡ªå·±è¿˜è¿œè¿œä¸å¤Ÿï¼Œæ¯”å¦‚ fs çš„å‡½æ•°ä¸ç†Ÿã€‚æ¯”å¦‚å¯¹ Buffer, Stream ç†è§£çš„ä¸å¤Ÿæ·±å…¥ã€‚è¿˜æ˜¯å†™çš„å¤ªå°‘äº†ã€‚ä¸è¿‡æ€»ç®—æ˜¯æŒ‰æ—¶å®Œæˆäº†ã€‚è§£æ”¾äº†åŠ³åŠ¨åŠ›ã€‚ğŸš«</p>
<p>ä¸‹ä¸€æ­¥æ‰“ç®—ä¼˜åŒ–ä¸‹ä»£ç ï¼Œçœ‹èƒ½ä¸èƒ½æ”¯æŒ upload logo, æ”¯æŒä¼  appid, appkey, è¿™æ ·åˆ«äººä¹Ÿå¯ä»¥ç”¨äº†ã€‚è¿˜æœ‰å¾ˆå¤šåŸºç¡€å·¥ä½œæ²¡æœ‰åšï¼Œæ¯”å¦‚ async, await çš„é”™è¯¯å¤„ç†ï¼Œæ¯”å¦‚ logger, pm2 ç­‰ã€‚è¿™ä¸ªä¼šæ…¢æ…¢å®Œå–„ï¼ŒåŸºç¡€åŠŸèƒ½å·² OKã€‚ ğŸ“šğŸ </p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ä¸Šæ¬¡å†™ Koa è¿˜æ˜¯2016å¹´åˆšæ¥å…¬å¸å®ä¹ çš„æ—¶å€™ï¼Œé‚£æ—¶å€™æˆ‘è¿˜åœ¨ä¸Šå¤§ä¸‰ã€‚è½¬çœ¼è§2å¹´è¿‡å»äº†ï¼Œæˆ‘ä¹Ÿæ­£å¼å·¥ä½œå¿«ä¸€å¹´äº†ã€‚ Koa ä¹Ÿä»åŸæ¥æ¯”è¾ƒéš¾ç”¨çš„ generator ï¼Œyield å˜æˆäº†ç°åœ¨çš„ async await ã€‚çœŸå¥½ã€‚&lt;/p&gt;
&lt;/blockqu
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>å°ç¨‹åºå†…åµŒå¤ç”¨H5å¹¶æ‹‰èµ·å¾®ä¿¡æ”¯ä»˜è§£å†³ï¼ˆæ›¿ä»£ï¼‰æ–¹æ¡ˆ</title>
    <link href="http://sevencai.github.io/2018/06/13/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%86%85%E5%B5%8C%E5%A4%8D%E7%94%A8H5%E5%B9%B6%E6%8B%89%E8%B5%B7%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E8%A7%A3%E5%86%B3%EF%BC%88%E6%9B%BF%E4%BB%A3%EF%BC%89%E6%96%B9%E6%A1%88/"/>
    <id>http://sevencai.github.io/2018/06/13/å°ç¨‹åºå†…åµŒå¤ç”¨H5å¹¶æ‹‰èµ·å¾®ä¿¡æ”¯ä»˜è§£å†³ï¼ˆæ›¿ä»£ï¼‰æ–¹æ¡ˆ/</id>
    <published>2018-06-13T12:45:56.000Z</published>
    <updated>2018-06-13T13:45:39.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>è‡ªä»å°ç¨‹åºå‡ºæ¥åï¼Œä½ è‚¯å®šæœ‰è¿™æ ·çš„æƒ³æ³•ã€‚å°ç¨‹åºå†…éƒ¨åˆ†é¡µé¢å¥½æƒ³å¤ç”¨ä»¥å‰çš„H5ï¼Œé‡å¤çš„å»å¼€å‘æµªè´¹äº†å¤§é‡çš„æ—¶é—´å’Œç²¾åŠ›ã€‚ ä½†æ˜¯å†…åµŒåœ¨å°ç¨‹åºä¸­çš„H5ä¸æ”¯æŒæ‹‰èµ·å¾®ä¿¡æ”¯ä»˜ã€‚ä¹Ÿå°±æ˜¯è¯´å°ç¨‹åºå†…ï¼Œå°ç¨‹åºåµŒå…¥çš„H5å†…åªèƒ½è°ƒç”¨å°ç¨‹åºæ”¯ä»˜ã€‚</p>
</blockquote>
<p>äºæ˜¯å‘¢ï¼Œæˆ‘å°±æƒ³åˆ°äº†è¿™ä¹ˆä¸€ä¸ªåŠæ³•ã€‚æœ‰äº›å±±å¯¨ï¼Œå¹¶ä¸”ä¸å®˜æ–¹ï¼ˆå®˜æ–¹å½“ç„¶æ˜¯å¸Œæœ›ä½ ç›´æ¥åœ¨å°ç¨‹åºå†…å®Œæˆä¸€åˆ‡ï¼Œä¸‹å•åˆ°æ”¯ä»˜ï¼‰ï¼Œä½†æ˜¯å´å¯ä»¥è§£å†³é—®é¢˜ã€‚O(âˆ©_âˆ©)O~~â˜ï¸â¤ï¸</p>
<hr>
<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p><strong>æˆ‘ä»¬å¯ä»¥ç”¨å°ç¨‹åºçš„ <code>web view</code> èƒ½åŠ›åµŒå…¥ H5, åµŒå…¥åï¼Œåœ¨ H5 ä¸­è¿›è¡Œæ”¯ä»˜ä¸‹å•ï¼Œå¾—åˆ°å‚æ•°å¦‚ ï¼š <code>timeStamp</code>, <code>nouncestr</code>, <code>signType</code>,<code>paySign</code> ç­‰ç­‰å‚æ•°ã€‚ç„¶åå†é€šè¿‡ <code>wx.miniProgram.navigateTo</code> è·³è½¬åˆ°ä¸€ä¸ªå°ç¨‹åºé¡µé¢ï¼Œåœ¨è¿™ä¸ªé¡µé¢è¿›è¡Œè°ƒç”¨ <code>wx.requestPayment</code> è¿›è¡Œæ‹‰èµ·æ”¯ä»˜ã€‚æ‹‰èµ·æ”¯ä»˜åï¼Œå¯ä»¥å†è·³åˆ°å°ç¨‹åºç»“æœé¡µã€‚</strong></p>
<p>å¦‚æœä½ æ‹…å¿ƒé€šè¿‡ <code>navigateTo</code> çš„ url ä¼ å‚æœ‰ä¸å®‰å…¨çš„é—®é¢˜ï¼Œå¯ä»¥è‡ªå·±å¯¹å‚æ•°è¿›è¡ŒåŠ è§£å¯†ã€‚</p>
<p>äº²æµ‹æ˜¯å¯ä»¥è¡Œå¾—é€šçš„ã€‚ä¸‹å›¾ä¸ºåœ¨ ã€H5 é¡µé¢ä¸‹çš„å•ã€‘è·å¾—æ”¯ä»˜å‚æ•°çš„é¡µé¢ã€‚</p>
<p><img src="xiaochengxu1.png" alt="ä¸‹å•æ¥å£"></p>
<p>ä¸‹å›¾ä¸ºå›¾äºŒï¼Œã€åœ¨å°ç¨‹åºå†…æ‹‰èµ·çš„å¾®ä¿¡æ”¯ä»˜ã€‘ã€‚å¯ä»¥é€šè¿‡å³ä¸Šè§’çš„è½¬å‘é€€å‡ºæŒ‰é’®çœ‹å‡ºæ˜¯å°ç¨‹åºæ‹‰èµ·çš„æ”¯ä»˜ã€‚è¿™æ ·æ”¯ä»˜å®Œæˆåï¼Œç”¨æˆ·å¯ä»¥ç‚¹å‡»åé€€é€€åˆ°åˆšåˆšçš„H5é¡µé¢ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥ç›´æ¥æ”¯ä»˜å®Œæˆï¼Œè°ƒåˆ°ä½ è‡ªå·±çš„å°ç¨‹åºçš„æ”¯ä»˜ç»“æœé¡µç­‰å·¥ä½œã€‚åœ¨å°ç¨‹åºçš„æ”¯ä»˜ç»“æœé¡µä¸­ï¼Œä½ è¿˜å¯ä»¥è®¾ç½®æŒ‰é’®ï¼Œå†æ¥å¼•å¯¼ç”¨æˆ·æ˜¯è¿›å…¥å°ç¨‹åºé¦–é¡µï¼Œè¿˜æ˜¯åˆšåˆšä½ è·³è½¬çš„H5çš„é¡µé¢ç­‰ç­‰ã€‚</p>
<p><img src="xiaochegnxu2.png" alt="æ”¯ä»˜æ¥å£"></p>
<hr>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æˆ‘æƒ³æŠŠä¸‹å•çš„å‚æ•°ä»¥ JSON.stringfy(obj) çš„å½¢å¼ä¼ è¿‡å»ï¼Œå‘ç°å‚æ•°ä¸€ç›´å¾ˆå¥‡æ€ªçš„è¢«æˆªæ–­ã€‚çœ‹åˆ°å…¶ä»–æœ‰çš„å¼€å‘è€…ä¹Ÿé‡åˆ°äº†ç±»ä¼¼çš„é—®é¢˜ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ä¸‹é¢è¿™ç§æ–¹å¼æ˜¯æœ‰é—®é¢˜çš„ï¼Œä»¥ä¸ºæ˜¯ç‰¹æ®Šå­—ç¬¦å¯¼è‡´çš„ï¼Œä½†æ˜¯å‘ç° encode ä»¥åè¿˜æ˜¯è¢«æˆªæ–­ã€‚æˆ‘è§‰å¾—æœ‰å¯èƒ½æ˜¯å°ç¨‹åºæœ¬èº«çš„é—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// H5 å†…</span></span><br><span class="line">wx.miniProgram.navigateTo(&#123;</span><br><span class="line">  url: <span class="string">`/pages/wxpay/wxpay?info=<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(obj)&#125;</span>`</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°ç¨‹åºå†…</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  onLoad(options) &#123;</span><br><span class="line">    <span class="comment">// å› ä¸ºè¢«æˆªæ–­äº†ï¼Œæ‰€ä»¥è¿™é‡Œ JSON.parse æŠ¥é”™</span></span><br><span class="line">    <span class="keyword">const</span> data = <span class="built_in">JSON</span>.parse(options.info)</span><br><span class="line">    <span class="keyword">const</span> obj = &#123;</span><br><span class="line">      <span class="string">'timeStamp'</span>: data.time,</span><br><span class="line">      <span class="string">'nonceStr'</span>: data.nounce,</span><br><span class="line">      <span class="string">'package'</span>: data.package,</span><br><span class="line">      <span class="string">'signType'</span>: <span class="string">'MD5'</span>,</span><br><span class="line">      <span class="string">'paySign'</span>: data.sign,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    wx.requestPayment(&#123;</span><br><span class="line">      ...obj,</span><br><span class="line">      success(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'success'</span>, res)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'fail'</span>, res)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åæ¥è€è€å®å®çš„ç”¨å¤šä¸ªå‚æ•°ç©¿å‚<code>sign=xxx&amp;signature=xxx&amp;noncestr=xxx</code>ï¼Œå‘ç° package ä¸­çš„=åé¢çš„éƒ¨åˆ†ä¹Ÿè¢«æˆªæ–­äº†ã€‚ <code>encodeURI, encodeURIComponent</code> éƒ½æ²¡ç”¨ã€‚</p>
<p>è¿™é‡Œæ²¡æœ‰æƒ³æ¸…æ¥šã€‚çœ‹äº†æ–‡æ¡£å’ŒæŸ¥äº†èµ„æ–™ä¹Ÿæ²¡å¼„æ¸…æ¥šå°ç¨‹åºåœ¨è¿™é‡Œé¢åšäº†ä»€ä¹ˆäº‹æƒ…ã€‚å…ˆæ”¾æ”¾ï¼ŒæŠŠæ–¹æ¡ˆè·‘ä¸è·‘çš„é€šè§£å†³ã€‚</p>
<p>æ‰€ä»¥å¹²è„†å°±æŠŠ <code>prepay_id= xxx</code> åé¢çš„ <code>xxx</code> å•ç‹¬å–å‡ºæ¥ã€‚åé¢è°ƒç”¨ <code>requestPayment</code> å†æ‹¼ä¸Šã€‚</p>
<hr>
<h2 id="æœ€ç»ˆä»£ç "><a href="#æœ€ç»ˆä»£ç " class="headerlink" title="æœ€ç»ˆä»£ç "></a>æœ€ç»ˆä»£ç </h2><p>æœ€åæˆ‘æµ‹è¯•é€šè¿‡çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// H5 å†…</span></span><br><span class="line">wx.miniProgram.navigateTo(&#123;</span><br><span class="line">  url: <span class="string">"/pages/wxpay/wxpay?time="</span> + info.wx_time + <span class="string">"&amp;nounce="</span> + info.wx_noncenum + <span class="string">"&amp;package="</span>+info.wx_package.split(<span class="string">"="</span>)[<span class="number">1</span>] + <span class="string">"&amp;sign="</span> + info.wx_sign</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°ç¨‹åºå†…</span></span><br><span class="line">Page(&#123;</span><br><span class="line">  onLoad(options) &#123;</span><br><span class="line">    <span class="keyword">const</span> obj = &#123;</span><br><span class="line">      <span class="string">'timeStamp'</span>: options.time,</span><br><span class="line">      <span class="string">'nonceStr'</span>: options.nounce,</span><br><span class="line">      <span class="string">'package'</span>: <span class="string">"prepay_id="</span> + options.package,</span><br><span class="line">      <span class="string">'signType'</span>: <span class="string">'MD5'</span>,</span><br><span class="line">      <span class="string">'paySign'</span>: options.sign,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    wx.requestPayment(&#123;</span><br><span class="line">      ...obj,</span><br><span class="line">      success(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'success'</span>, res)</span><br><span class="line">      &#125;,</span><br><span class="line">      fail(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'fail'</span>, res)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç›¸è¾ƒäºæ­£å¸¸çš„ç›´æ¥åœ¨è®¢å•é¡µä¸‹è®¢å•ï¼Œè¿™é‡Œå¤šäº†ä¸€æ­¥ï¼Œå°±æ˜¯ä»H5è·³è¿‡æ¥åï¼Œè¿˜è¦æ‹‰èµ·å°ç¨‹åºçš„ä¸€ä¸ªæ”¯ä»˜é¡µï¼Œå•ç‹¬æ‹‰èµ·æ”¯ä»˜æ¡†ã€‚</p>
<p>ä½“éªŒå½“ç„¶æ˜¯æ²¡æœ‰å®Œå…¨åœ¨å°ç¨‹åºä¸­ï¼Œä¸åµŒå…¥H5å¥½çš„ã€‚å¦‚æœæ˜¯è¦å¿«é€Ÿè¿­ä»£å¼€å‘çš„è¯ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§æ–¹æ³•ã€‚</p>
<p>æ€»ä¹‹çŸ¥é“äº†è¿™æ˜¯ä¸€ç§æ›¿ä»£çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ–è€…è¯´ä¸€ç§æ²¡æœ‰åŠæ³•çš„åŠæ³•ã€‚ğŸ“šğŸŒ²è¿˜æ˜¯å¾ˆå¼€å¿ƒçš„ã€‚</p>
<p>æœ€åæ¬¢è¿æ¥åˆ°å¾®ä¿¡-&gt;é’±åŒ…å…¥å£çš„Qbå……å€¼å…¥å£æ¥å……å„ç§æ¸¸æˆå¸ï¼ŒQb, åŒ…æœˆæœåŠ¡å“¦ã€‚æœ‰çš„æ—¶å€™è¿˜æœ‰ä¼˜æƒ ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;è‡ªä»å°ç¨‹åºå‡ºæ¥åï¼Œä½ è‚¯å®šæœ‰è¿™æ ·çš„æƒ³æ³•ã€‚å°ç¨‹åºå†…éƒ¨åˆ†é¡µé¢å¥½æƒ³å¤ç”¨ä»¥å‰çš„H5ï¼Œé‡å¤çš„å»å¼€å‘æµªè´¹äº†å¤§é‡çš„æ—¶é—´å’Œç²¾åŠ›ã€‚ ä½†æ˜¯å†…åµŒåœ¨å°ç¨‹åºä¸­çš„H5ä¸æ”¯æŒæ‹‰èµ·å¾®ä¿¡æ”¯ä»˜ã€‚ä¹Ÿå°±æ˜¯è¯´å°ç¨‹åºå†…ï¼Œå°ç¨‹åºåµŒå…¥çš„H5å†…åªèƒ½è°ƒç”¨å°ç¨‹åºæ”¯ä»˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="å°ç¨‹åº" scheme="http://sevencai.github.io/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>æ™šæ¥çš„æ—¥æœ¬ä¹‹è¡Œ</title>
    <link href="http://sevencai.github.io/2018/06/02/%E6%99%9A%E6%9D%A5%E7%9A%84%E6%97%A5%E6%9C%AC%E4%B9%8B%E8%A1%8C/"/>
    <id>http://sevencai.github.io/2018/06/02/æ™šæ¥çš„æ—¥æœ¬ä¹‹è¡Œ/</id>
    <published>2018-06-02T06:48:05.000Z</published>
    <updated>2018-06-02T08:18:17.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>å…¶å®å•Šï¼Œæ—…è¡Œçš„æ„ä¹‰ï¼Œä¸ä¸€å®šè¦æ˜¯è·¯ä¸Šçš„é£æ™¯ï¼Œæ›´æ˜¯ä½ è·¯ä¸Šçš„åŒè¡Œäººã€‚ 2018å¹´5æœˆ23 åˆ° 27 æˆ‘åœ¨æ—¥æœ¬ã€‚</p>
</blockquote>
<h2 id="TOP-10"><a href="#TOP-10" class="headerlink" title="TOP 10"></a>TOP 10</h2><ol>
<li>å¹²å‡€æ•´æ´çš„æ—¥æœ¬è¡—é“</li>
<li>æš–å¿ƒè´Ÿè´£çš„é¢†é˜Ÿå°å“¥å“¥  ğŸ’–</li>
<li>æœ‰è¶£æœ‰çˆ±çš„åŒä¼´  ğŸšš</li>
<li>æ¢…ç”°çš„è´­ç‰©ä¸­å¿ƒ  â„ï¸</li>
<li>250 çš„ç‰›è‚‰è‡ªåŠ©é¤</li>
<li>å¤§é˜ªå¤§å­¦çš„ç‹è€…è£è€€</li>
<li>å¸…æ°”çš„æ—¥æœ¬å°å“¥å“¥</li>
<li>è€é¾„åŒ–çš„æ—¥æœ¬  ğŸ’³</li>
<li>å¥½ï¼ˆç¬¬å››å£°ï¼‰åƒå¯çˆ±çš„å°é¹¿</li>
<li>æœ€çˆ±çš„è®¸åŠ äºŒå’Œæ¶›å“¥  ğŸ’</li>
</ol>
<hr>
<h2 id="æœ€çˆ±çš„å›¾ç‰‡"><a href="#æœ€çˆ±çš„å›¾ç‰‡" class="headerlink" title="æœ€çˆ±çš„å›¾ç‰‡"></a>æœ€çˆ±çš„å›¾ç‰‡</h2><p><img src="jp4.jpg" alt="å¥ˆè‰¯çš„å°é¹¿"><br>æˆ–è®¸æ˜¯å¤ªä¹…æ²¡æœ‰æœºä¼šè·ŸåŠ¨ç‰©æ¥è§¦äº†ã€‚çœ‹åˆ°å¥¹ä»¬ç®€ç›´ä¸èƒ½è‡ªæ‹”ï¼Œå¥½æƒ³ä¸€ç›´å–‚å¥¹ä»¬ä¸œè¥¿åƒã€‚ä¸Šç½‘æŸ¥äº†ä¸‹ï¼Œå¥¹ä»¬çš„ç‚¹å¤´è¦åƒçš„ï¼Œå®é™…åœ¨åŠ¨ç‰©ç•Œå¹¶ä¸æ˜¯è¡¨ç¤ºå‹å¥½çš„è¡Œä¸ºï¼Œè¶Šçˆ±é èº¬çš„å°é¹¿ï¼Œå…¶å®æ”»å‡»æ€§å°±è¶Šå¼ºã€‚ä½†æ˜¯å•Šï¼Œå¥¹ä¸€ç‚¹å¤´ï¼Œä½ å°±ä¸èˆå¾—ä¸ç»™å¥¹åƒä¸œè¥¿ã€‚</p>
<p><img src="jp1.jpg" alt="å¹²å‡€æ¼‚äº®çš„æˆ¿å­"></p>
<p>ä¸Šé¢è¿™å¼ å›¾ç‰‡ï¼Œæ˜¯ç¬¬ä¸€å¤©é…’åº—èµ·æ¥åï¼Œæˆ‘è·Ÿå®¤å‹å»å¤–è¾¹é€›çš„æ—¶å€™æ‹çš„ã€‚å°æ²³ç‰¹åˆ«å¹²å‡€ï¼Œæˆ¿å­é¢œè‰²ç‰¹åˆ«ç¾ã€‚</p>
<p><img src="jp2.jpg" alt="é›¨ä¸­çš„å°æˆ¿å­"></p>
<p>è¿™å¼ å›¾ç‰‡æ˜¯ç¬¬ä¸€å¤©èµ¶åˆ°é…’åº—çš„æ—¶å€™ï¼Œå¤©ä¸‹èµ·äº†å°é›¨ï¼Œå¤–è¾¹æœ‰åƒå¤§ç†Šå®¶ä¸€æ ·çš„æˆ¿å­ğŸ¡ã€‚è§‰å¾—ç‰¹åˆ«çš„èˆ’æœã€‚</p>
<p><img src="jp6.jpg" alt="è¯å¦†åº—é—¨å£çš„å°ç‹—"><br>å°ç‹—è¿‡å¾—ä¸å¼€å¿ƒå—ï¼Ÿä¸ºä»€ä¹ˆçœ¼é‡Œä¼šæœ‰æ‚²ä¼¤å’Œéš¾è¿‡ã€‚</p>
<p><img src="jp5.jpg" alt="å¯çˆ±çš„å°æœ‹å‹"><br>çŒœçŒœæˆ‘æƒ³æ‹çš„å°æœ‹å‹æ˜¯ï¼Ÿ</p>
<p><img src="jp3.jpg" alt="é…’åº—çš„å¤–æ™¯"><br>ç™½è‰²çš„èˆ¹ï¼Œè“è“çš„æµ·ï¼Œé«˜é«˜çš„æ ‘ï¼Œç™½è‰²çš„æ¡Œå­å’Œæ¤…å­ï¼Œç»¿è‰²çš„å±±ã€‚ï¼ˆåŸè°…æˆ‘çš„è¯­æ–‡æ°´å¹³ï¼Œåªèƒ½æè¿°æˆè¿™ç§æ°´å¹³äº†ï¼‰</p>
<p><img src="jp7.jpg" alt="nuonuonuoyasuolong"><br>åƒç›¸æ‰‘é¤çš„æ—¶å€™ï¼Œä¸å¥½åƒã€‚ä¹Ÿæ²¡æœ‰åƒé¥±ğŸ˜ã€‚ä½†æ˜¯çœ‹åœ¨é€äº†æˆ‘ ç´¢éš† çš„ä»½ä¸Šï¼Œ5æ˜Ÿå¥½è¯„ã€‚</p>
<p><img src="jp10.jpg" alt="å°ç‹—"><br>å…¶å®ï¼Œå°è±¡æœ€æ·±çš„ä¸ä»…ä»…è¿™ä¸ªå°ç‹—ï¼Œè¿˜æœ‰ä»–çš„ä¸»äººã€‚ä¸»äººå¤§æ¦‚60å²ï¼Œæˆ‘çœ‹ç‹—ç‹—çš„æ—¶å€™ï¼Œä»–å†²æˆ‘ç¬‘äº†ä¸‹ï¼Œç„¶åè¯´äº†ä¸€ä¸²æˆ‘å¬ä¸æ‡‚çš„æ—¥è¯­ã€‚å¯èƒ½æ˜¯åœ¨è¯´ï¼Œæ²¡å…³ç³»ï¼Œä½ å¯ä»¥æ‘¸æ‘¸å®ƒï¼Œä»–ä¸å’¬äººã€‚</p>
<hr>
<h2 id="æœ€å€¼å¾—çš„äº‹æƒ…"><a href="#æœ€å€¼å¾—çš„äº‹æƒ…" class="headerlink" title="æœ€å€¼å¾—çš„äº‹æƒ…"></a>æœ€å€¼å¾—çš„äº‹æƒ…</h2><p>æœ€å€¼å¾—çš„äº‹æƒ…ï¼Œå½“ç„¶å°±æ˜¯è§åˆ°å¾ä½³2å•¦ã€‚çœ‹ç€å¥¹é‚£ä¸ªä¹±çš„è·ŸçŒªåœˆä¸€æ ·çš„å®¿èˆï¼Œæˆ‘è§‰å¾—æ˜¯æ—¶å€™è¦ç»™å¥¹çˆ¸çˆ¸æ‰“æŠ¥å‘Šäº†ï¼Œæ€ä¹ˆè¶Šé•¿å¤§è¶Šä¹±äº†å‘¢ï¼Ÿ ä»¥å‰æˆ‘ä»¬å®¿èˆ4ä¸ªï¼Œå¥¹è¿˜ç®—æ’å€’æ•°ç¬¬2çš„ï¼Œç°åœ¨è‚¯å®šæ˜¯å€’æ•°ç¬¬1äº†ã€‚</p>
<p>è§å¾—æ—¶é—´å¤ªå°‘äº†ï¼Œå·²ç»å°½æˆ‘æœ€å¤§çš„èƒ½åŠ›å»æŒ¤æ—¶é—´ã€‚ä»¥åè¦æ˜¯è¿˜å»æ—¥æœ¬ï¼Œæˆ‘ä¸€å®šè‡ªç”±è¡Œï¼Œç„¶åæ¯å¤©éƒ½è·Ÿå¥¹ç¡ã€‚ç™½å¤©ä¸€èµ·é€›åƒé€›åƒï¼Œå°±åƒæˆ‘ä»¬ä¸€èµ·å¤§å­¦çš„æ—¶å€™é‚£æ ·ã€‚</p>
<p>ä¸€ä¸ªäººåœ¨å¤–ï¼Œé‚£ç§æ— åŠ©çš„æ—¶å€™ï¼Œè‚¯å®šå¾ˆå¤šã€‚èµ¶ç´§å›å›½ï¼Œå¸¦ä½ åƒå°é¾™è™¾ã€‚ğŸ’—</p>
<p>åœ¨æˆ‘å»æ—¥æœ¬çš„æ—¶å€™ï¼Œæ¶›å“¥ä»–ä»¬éƒ¨é—¨çš„å›¢ï¼Œä¹Ÿæ­£å¥½åœ¨æ—¥æœ¬äº†ï¼Œæ‰€ä»¥å¾ˆä¸å®¹æ˜“çš„ï¼Œæˆ‘ä»¬åœ¨æ—¥æœ¬ä¹Ÿè§åˆ°äº†ï¼Œä»–ä»¬ä¸ºäº†é¡ºåº”æˆ‘çš„æ—¶é—´ï¼Œæ—¶é—´å¾ˆç´§å¼ ã€‚æˆ‘ä»¬çš„ç¼˜åˆ†ï¼Œè‚¯å®šè¿˜è¦æŒç»­å¾ˆä¹…ï¼Œå¾ˆä¹…ğŸŒ²ã€‚</p>
<hr>
<h2 id="è·¯ç—´çš„æˆ‘"><a href="#è·¯ç—´çš„æˆ‘" class="headerlink" title="è·¯ç—´çš„æˆ‘"></a>è·¯ç—´çš„æˆ‘</h2><p>å¦‚æœæ˜¯ä¸èµ¶çš„è·¯ç¨‹ï¼Œæˆ‘è‚¯å®šæ˜¯ä¸€ä¸ªäººæ…¢æ…¢æ‚ æ‚ çš„æ‰¾åœ°æ–¹ç©äº†ã€‚å°±ç®—è¿·è·¯äº†ä¹Ÿä¸è¦ç´§ï¼Œåæ­£æ€»èƒ½æ‰¾åˆ°å›å®¶çš„è·¯ã€‚ä½†æ˜¯è·Ÿå›¢ä¸ä¸€æ ·ï¼Œä¸€å®šè¦ä¿è¯å¤§å®¶ä¸ä¼šå› ä¸ºæˆ‘è€½è¯¯æ—¶é—´ã€‚æ‰€ä»¥æ•´ä¸ªè·¯ç¨‹æˆ‘å°±æ˜¯æ ¹æœ¬æ‘¸ä¸æ¸…ä¸œå—è¥¿åŒ—ã€‚è¿˜å¥½æœ‰å¾ä½³2ï¼Œå°æ™ºå’Œyunhuiã€‚</p>
<p>è®¤è·¯è¿™ä»¶äº‹ï¼Œæœ‰æ—¶å€™çœŸçš„æ„Ÿè§‰æ— èƒ½ä¸ºåŠ›ã€‚â˜¹ï¸</p>
<hr>
<h2 id="è´­ç‰©"><a href="#è´­ç‰©" class="headerlink" title="è´­ç‰©"></a>è´­ç‰©</h2><p>ç»™å¦ˆå¦ˆä»–ä»¬ä¹°äº†ä¸¤åŒé‹å­ï¼Œè¿˜ç»™å«‚å­ä¹°äº†å¾ˆå¤šæŠ¤è‚¤å“ï¼Œè¿˜ç»™åŒäº‹å¸¦äº†å¾ˆå¤šæŠ¤è‚¤å“ã€‚ç»™çˆ¸çˆ¸ä¹°äº†ä¸ªè¡¨ï¼Œå“¥å“¥å•¥éƒ½æ²¡ç»™ä¹°ã€‚å“ˆå“ˆï¼Œä»–è‚¯å®šæ€€ç–‘æˆ‘ä¸æ˜¯äº²å¦¹å¦¹ã€‚ä¸è¿‡ï¼Œæˆ‘ç»™ä»–å³å°†å‡ºç”Ÿçš„å°å®å®ï¼Œä¹°äº†è¡£æœã€‚ç»™è‡ªå·±è¿˜ä¹°äº†å¾ˆå¤šé¢è†œã€‚<br>é€šè¿‡ä¹°ä¸œè¥¿è¿™ä»¶äº‹æƒ…ï¼Œå‘Šè¯‰äº†æˆ‘ä¸€å®šè¦åŠªåŠ›å·¥ä½œï¼Œç„¶åèµšå¾ˆå¤šé’±ã€‚</p>
<p>ç¬¬ä¸€å¤©æ™šä¸Šï¼Œåƒäº†å¾ˆå¥½åƒçš„å†°æ·‡æ·‹ğŸ¨ã€‚è¶…çº§å¼€å¿ƒã€‚è¿˜å–äº†å¾ˆä¾¿å®œå¾ˆå¥½å–çš„é…¸å¥¶ï¼Œæ—¥æœ¬çš„ä¾¿åˆ©åº—ğŸªæ˜¯ä¸ªå¥½åœ°æ–¹ã€‚</p>
<hr>
<h2 id="è·¯ä¸Šçš„äººå„¿"><a href="#è·¯ä¸Šçš„äººå„¿" class="headerlink" title="è·¯ä¸Šçš„äººå„¿"></a>è·¯ä¸Šçš„äººå„¿</h2><p>æˆ‘è¿™æ¬¡çš„å®¤å‹ä¸æ˜¯è·Ÿæˆ‘ä¸€ä¸ªéƒ¨é—¨çš„ã€‚å½“æˆ‘æå‡ºï¼Œèƒ½ä¸èƒ½å¾ä½³2è·Ÿæˆ‘ä¸€èµ·ä½ä¸€æ™šä¸Šçš„æ—¶å€™ï¼Œå¥¹é©¬ä¸Šå°±ç­”åº”äº†ã€‚çœŸçš„å¥½è°¢è°¢ã€‚å·²ç»æ˜¯ä¸¤ä¸ªå­©å­çš„å¦ˆå¦ˆäº†ï¼Œç„¶è€Œä¸€ç‚¹éƒ½çœ‹ä¸å‡ºæ¥ã€‚ğŸ‘</p>
<p>æˆ‘çš„é¢†é˜Ÿï¼Œæ˜¯è·Ÿæˆ‘ä¸€ä¸ªéƒ¨é—¨çš„ï¼Œä½†æ˜¯ä»¥å‰ä»æ¥æ²¡æœ‰è§è¿‡ï¼Œå¯èƒ½æ˜¯æ²¡æœ‰å·¥ä½œä¸Šçš„äº¤é›†ï¼Œæˆ‘ä»¬é€šå¸¸ç§°å‘¼ä»–ä¸ºå°æ™ºã€‚å°æ™ºéå¸¸çš„é è°±ï¼Œä¹Ÿæ˜¯ä¸ªè¶…çº§æš–å¿ƒçš„å°å“¥å“¥ï¼Œæ¯æ¬¡éƒ½å¸®å¤§å®¶æŠŠäº‹æƒ…å®‰æ’çš„å¾ˆå¥½ã€‚ä¸çŸ¥é“ä»–è‡ªå·±æœ‰æ²¡æœ‰ç©å¥½ã€‚æ¯æ¬¡æ‰¾ä¸åˆ°åœ°æ–¹äº†ï¼Œå°±è·Ÿä»–æ‰“ç”µè¯ã€‚ä»–è¿˜æ¯æ¬¡éƒ½å¸®æˆ‘æè¡Œæã€‚è§‰å¾—å¥½æ¸©æš–ã€‚ç¬”èŠ¯ã€‚ğŸ’–</p>
<p>yunhui, æ˜¯è·Ÿæˆ‘ä¸€ä¸ªéƒ¨é—¨çš„ï¼Œä»¥å‰æ²¡æœ‰è§è¿‡ï¼Œä½†æ˜¯æœ‰é—®è¿‡ä»–é—®é¢˜ã€‚ä»–éå¸¸çš„çˆ±ç¬‘ï¼Œæ„Ÿè§‰ä¸€ç¬‘èµ·æ¥ï¼Œè®©åˆ«äººä¹Ÿä¼šå¼€å¿ƒã€‚yunhui ç»å¯¹æ˜¯ä¸ªæ—…è¡Œçš„å¥½ä¼™ä¼´ï¼Œæœ‰è¶³å¤Ÿçš„å¥½å¥‡å¿ƒï¼Œä¹Ÿæœ‰è¶³å¤Ÿçš„è€åŠ›ã€‚æ”»ç•¥ä¹Ÿåšçš„å¾ˆæ£’ï¼Œå…³é”®æ˜¯ä¹Ÿè®¤è·¯ã€‚ğŸ“š</p>
<p>æˆ‘å¸ˆçˆ¶ï¼Œjiaqian, é£å“¥ï¼Œèµµå®£ï¼Œå’¸é±¼, amyï¼Œ tinaå°±ä¸è¯´äº†ï¼Œä»¥å‰éƒ½å¾ˆç†Ÿäº†,å› ä¸ºä»–ä»¬åœ¨ï¼Œè®©æˆ‘è§‰å¾—è¿™æ¬¡æ—…è¡Œï¼Œä¸€ç‚¹éƒ½ä¸é™Œç”Ÿï¼Œä¹Ÿä¸æ‹˜è°¨ã€‚</p>
<p>æ‘é•¿ï¼Œç¬¬ä¸€æ¬¡è·Ÿä»–è¯´äº†è¯ï¼Œæ„Ÿè§‰å¥½å¼€å¿ƒï¼Œè¿˜è®°å¾—ä»–é‚£æ¬¡è¯¸è‘›äº®æŠŠæˆ‘ä»¬æ•´ä¸ªç»„è™çš„è¶…çº§éš¾å—ã€‚æ€»ç®—æ˜¯è®¤è¯†çœŸäººäº†ã€‚</p>
<p>æ—¥æœ¬çš„å°å§å§éƒ½è¯´è¯å¾ˆå°å£°ï¼Œå¾ˆæœ‰ç¤¼è²Œã€‚æ—¥æœ¬çš„å­¦ç”Ÿéƒ½ç©¿åˆ¶æœï¼Œæ„Ÿè§‰å¾ˆå¥½ã€‚å¾ˆå¸…æ°”ã€‚ğŸ˜Š</p>
<p>æ—¥æœ¬è€å¥¶å¥¶è·Ÿæˆ‘è¯´è°¢è°¢çš„æ—¶å€™ï¼Œæˆ‘å¥½æƒ³å›å¥¹ä¸ç”¨è°¢ã€‚ä½†æ˜¯æ†‹äº†åŠå¤©ï¼Œæ»¡è„¸é€šçº¢ï¼Œè¿˜æ˜¯ä¸€ä¸ªå­—éƒ½æ²¡æŒ¤å‡ºæ¥ã€‚</p>
<p>ç¬¬ä¸€å¤©æ™šä¸Šçš„é…’åº—çš„å°å§å§ï¼Œæƒ³æŠŠä¼è¿˜ç»™å¥¹ï¼Œä¸€è·¯ä¸Šï¼Œæƒ³äº†åŠå¤©æ€ä¹ˆè¿˜ç»™å¥¹ï¼Œç»“æœåˆ°äº†é‚£é‡Œï¼Œä¸€ä¸ªå­—éƒ½æ²¡æœ‰è¯´å‡ºæ¥ã€‚â˜¹ï¸</p>
<p>æˆ‘ä»¬çš„å¯¼æ¸¸ï¼Œæœ´å²›å¾ˆæ¸©å’Œï¼Œå·²ç»åŠ äº†ä»–å¾®ä¿¡ï¼ŒåŠ äº†åï¼Œæ•´ä¸ªæœ‹å‹åœˆï¼Œéƒ½æ˜¯ä»£è´­çš„æ¶ˆæ¯äº†ï¼Œå“ˆå“ˆã€‚æœ´å¯¼èŒèŒå“’ã€‚âœˆï¸</p>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¾ˆå¼€å¿ƒçš„ä¸€æ¬¡æ—…è¡Œï¼Œè™½ç„¶ä¿¡ç”¨å¡ğŸ’³éƒ½æ²¡çŸ¥è§‰äº†ã€‚ä¸€ç”Ÿä¼šæœ‰å¾ˆå¤šæ—…è¡Œï¼Œä½†æ˜¯è¿™æ¬¡è‚¯å®šæ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚ä½ é‡åˆ°çš„é£æ™¯ï¼Œä½ é‡åˆ°çš„äººï¼Œä½ æ‹çš„ç…§ç‰‡ï¼Œä½ è„‘æµ·é‡Œé‚£ä¸ªçˆ·çˆ·çš„å¾®ç¬‘ï¼Œä½ å¯¹æŸäº›äººçš„æ„Ÿæƒ…ï¼Œåˆæˆ–è€…æ˜¯æ—…è¡Œä¸­ä¸é‚£ä¹ˆé¡ºåˆ©å¼€å¿ƒçš„åœ°æ–¹ï¼Œéƒ½æ˜¯æ—…è¡Œçš„å®è´µæ‰€åœ¨ã€‚</p>
<p>æˆ‘æœ‰çš„æ—¶å€™æƒ³ï¼Œäººç”Ÿé‚£ä¹ˆä¸å¯é¢„æµ‹ï¼Œä¹Ÿè®¸æ˜å¤©ä½ å°±æ²¡æœ‰æœºä¼šå»ä½“éªŒå¾ˆå¤šäº‹æƒ…ã€‚æ‰€ä»¥ä½ ä»Šå¤©åšçš„äº‹æƒ…ï¼Œä¼šä¸ä¼šæ˜¯æœ€åä¸€å¤©ä½ æƒ³åšçš„äº‹æƒ…ã€‚ä¸è¦åæ‚”ã€‚ä¹Ÿä¸è¦é—æ†¾ã€‚å› ä¸ºä¸Šå¸ç»™ä½ ç•™ä¸‹çš„è·¯ï¼Œéƒ½æ˜¯æœ‰ä»–çš„é“ç†ã€‚å¼€å¿ƒçš„ï¼Œä¸å¼€å¿ƒçš„ï¼Œå®ƒéƒ½æ˜¯ä½ ç”Ÿæ´»ä¸­ï¼Œæˆ–è€…è¯´å‘½è¿ä¸­çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>æˆ‘ç›¸ä¿¡ connecting the dotsã€‚ â¤ï¸ ğŸšš ğŸ“š ä»¥åæœ‰æœºä¼šè·Ÿå®¶äººä¸€èµ·å»ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å…¶å®å•Šï¼Œæ—…è¡Œçš„æ„ä¹‰ï¼Œä¸ä¸€å®šè¦æ˜¯è·¯ä¸Šçš„é£æ™¯ï¼Œæ›´æ˜¯ä½ è·¯ä¸Šçš„åŒè¡Œäººã€‚ 2018å¹´5æœˆ23 åˆ° 27 æˆ‘åœ¨æ—¥æœ¬ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;TOP-10&quot;&gt;&lt;a href=&quot;#TOP-10&quot; class=&quot;headerlink&quot; 
    
    </summary>
    
    
      <category term="ç”Ÿæ´»æ—¥å¿—" scheme="http://sevencai.github.io/tags/%E7%94%9F%E6%B4%BB%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>ä¼˜åŒ–ä»£ç ä¹‹throttle &amp; debounce</title>
    <link href="http://sevencai.github.io/2018/06/02/%E4%BC%98%E5%8C%96%E4%BB%A3%E7%A0%81%E4%B9%8B-throttle-debounce/"/>
    <id>http://sevencai.github.io/2018/06/02/ä¼˜åŒ–ä»£ç ä¹‹-throttle-debounce/</id>
    <published>2018-06-02T06:09:15.000Z</published>
    <updated>2018-06-02T06:39:56.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>è¿™å‡ å¤©ç¿»äº†ä¸‹ä»¥å‰å†™çš„ä»£ç ï¼Œå‘ç°è‡ªå·±ä»¥å‰è™½ç„¶æœ‰ç”¨ debounce æˆ–è€… throttle çš„æ„è¯†ï¼Œä½†æ˜¯ç¡®æ²¡æœ‰æŠŠä»£ç å°è£…çš„å¾ˆå¥½ã€‚æ¯”å¦‚æ²¡æœ‰ç”¨åˆ°é—­åŒ…å»å°è£… timer, è€Œæ˜¯æŠŠ timer æ”¾åœ¨äº† vue data çš„å˜é‡é‡Œã€‚å› æ­¤å°±å‡ºç°äº†è¿™ç¯‡æ–‡ç« ï¼Œæ€»ç»“ä¸‹ debounce å’Œ throttle è¿ç”¨åœºæ™¯ä»¥åŠå¯¹åº”çš„è‡ªå·±çš„å®ç°ã€‚å¹¶ä¸”é‡æ„äº†ä»¥å‰çš„ä»£ç ã€‚</p>
</blockquote>
<hr>
<h2 id="è¿ç”¨åœºæ™¯"><a href="#è¿ç”¨åœºæ™¯" class="headerlink" title="è¿ç”¨åœºæ™¯"></a>è¿ç”¨åœºæ™¯</h2><p>æ¯”å¦‚æˆ‘æ›¾ç»åœ¨ä¸€ä¸ªé¡¹ç›®é‡Œï¼Œå°±ä¸¤ç§åœºæ™¯éƒ½ç”¨åˆ°äº†ã€‚</p>
<p>ç¬¬ä¸€ç§æ¯”å¦‚å½“ç”¨æˆ·åœ¨æœç´¢æ¡†é‡Œè¾“å…¥äº†æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä¼šå»å‘åå°è¯·æ±‚ï¼Œæœç´¢å‡ºæ¥çš„å¯¹åº”ç»“æœã€‚ ä½†æ˜¯ç”¨æˆ·çš„è¾“å…¥å¯èƒ½æ˜¯ä¸æ–­çš„è¿›è¡Œçš„ï¼Œå¦‚æœæˆ‘æ¯æ¬¡éƒ½å»è¯·æ±‚ï¼Œé‚£ä¹ˆå…¶å®æ˜¯æ— æ•ˆå¹¶ä¸”æµªè´¹çš„ã€‚<strong>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ç”¨æˆ·è¾“å…¥æœ€åä¸€ä¸ªå­—çš„æ—¶å€™ï¼Œå†å»å‘è¯·æ±‚ã€‚ ç”¨åˆ°çš„å°±æ˜¯ debounce çš„åŸç†ï¼Œæ¯æ¬¡çš„è¯·æ±‚éƒ½å»¶è¿Ÿä¸€æ®µæ—¶é—´å»å‘å‡ºï¼Œå½“æœ‰æ–°çš„è¯·æ±‚æ¥çš„æ—¶å€™ï¼Œæ¸…ç©ºä¸Šæ¬¡çš„è¯·æ±‚ï¼Œç„¶åé‡æ–°æ‰§è¡Œå»¶è¿Ÿä¸€æ®µæ—¶é—´å»è¯·æ±‚ï¼Œç›´åˆ°ç”¨æˆ·æ²¡æœ‰å†è¯·æ±‚çš„æ—¶å€™ï¼Œæ‰§è¡Œçš„å°±æ˜¯æœ€åä¸€æ¬¡å»¶è¿Ÿè¯·æ±‚</strong>ã€‚</p>
<p>è¿™ç§åªå»æ‰§è¡Œæœ€åä¸€æ¬¡çš„å°±æ˜¯æˆ‘ä»¬è¯´çš„ debounceã€‚å¯ä»¥æŠŠå®ƒç†è§£ä¸º<code>ç‹¬å å‹çš„å‡½æ•°</code>ã€‚</p>
<p>ç¬¬äºŒç§æ¯”å¦‚å½“ç”¨æˆ·æ»šåŠ¨çš„æ—¶å€™ï¼Œå½“æ»‘åˆ°äº†è¿™ä¸ªå­—æ¯å¼€å¤´çš„æ—¶å€™ï¼Œæç¤ºç»™ç”¨æˆ·ï¼Œä½ å·²ç»åˆ°äº† H å¼€å¤´çš„åˆ—è¡¨å†…å®¹äº†ã€‚æ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„åšæ³•æ˜¯ä¸€ç›´ç›‘å¬ scroll äº‹ä»¶ï¼Œç„¶åè®¡ç®—å½“å‰çš„ li æ˜¯ä¸æ˜¯åˆ°äº†å¯¹åº” H å­—æ¯å¼€å¤´äº†ï¼Œåˆ°äº†åˆ™è®¾ç½®ç›¸åº”çš„æç¤ºã€‚</p>
<p><strong>ä½†æ˜¯è¦çŸ¥é“ scroll äº‹ä»¶ï¼Œæ¯æ¬¡éƒ½ä¼šè§¦å‘å¾ˆå¤šæ¬¡ï¼Œå¦‚æœæ¯æ¬¡è¿›è¡Œç›¸åº”çš„è®¡ç®—ï¼Œå°±ä¼šå¾ˆå¡é¡¿ï¼Œå°¤å…¶åœ¨ä¸€äº›è€çš„æœºå™¨ä¸Šã€‚ é‚£ä¹ˆè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ç”¨ throttle äº†ï¼Œæ¯ä¸€æ®µäº‹ä»¶ï¼Œæ¯”å¦‚ 500 ms å»æ‰§è¡Œä¸€æ¬¡è®¡ç®—ï¼Œè€Œä¸æ˜¯æ¯æ¬¡ scroll éƒ½æ‰§è¡Œã€‚</strong></p>
<p>å¯ä»¥æŠŠ throttle ç†è§£ä¸º<code>èŠ‚åˆ¶å‹</code>çš„å‡½æ•°ã€‚</p>
<p>ä¸Šé¢ä¸¤ä¸ªæ˜¯æˆ‘é‡åˆ°è¿‡çš„ä¸¤ä¸ªåœºæ™¯ï¼Œå…·ä½“å…¶ä»–åœºæ™¯è¿˜å¯ä»¥å‚è€ƒï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å½“ onresize çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªæƒ³çŸ¥é“æœ€åä¸€æ¬¡çš„å¤§å°</span></span><br><span class="line"><span class="built_in">window</span>.onresize = debounce(caculate, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“ç”¨æˆ·ä¸€æ®µæ—¶é—´é¢‘ç¹ç‚¹å‡»æ—¶ï¼Œåªä»¥æœ€åä¸€æ¬¡ä¸ºæ ‡å‡†</span></span><br><span class="line">button.onclick = debounce(sendMail, <span class="number">300</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// onscroll æ—¶å®šä½å…ƒç´ </span></span><br><span class="line"><span class="built_in">window</span>.onscroll = throttle(caculatePosition, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// é¼ æ ‡ç§»åŠ¨ï¼Œmousemove äº‹ä»¶</span></span><br><span class="line"><span class="built_in">window</span>.onmousemove = throttle(getElement, <span class="number">100</span>)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="å®ç°ä»£ç "><a href="#å®ç°ä»£ç " class="headerlink" title="å®ç°ä»£ç "></a>å®ç°ä»£ç </h2><p>åœ¨ underscore lodash é‡Œï¼Œéƒ½æœ‰ç›¸åº”çš„å®ç°äº†ã€‚ä½†æ˜¯æˆ‘æ„Ÿè§‰ä¸å¤ªå¥½ç†è§£é¢ï¼Œæ‰€ä»¥æŒ‰ç…§è‡ªå·±çš„ç†è§£ï¼Œå†™å‡ºäº†é€‚åº”è‡ªå·±çš„ debounce å’Œ throttleã€‚ å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * debounce</span><br><span class="line"> * @param fn</span><br><span class="line"> * @param wait</span><br><span class="line"> * @param leading</span><br><span class="line"> * @returns &#123;Function&#125;</span><br><span class="line"> */</span><br><span class="line">function debounce(fn, wait, &#123; leading = false &#125;) &#123;</span><br><span class="line">    let context,</span><br><span class="line">      args = arguments,</span><br><span class="line">      timer = null,</span><br><span class="line">      firstInvoke = true</span><br><span class="line"></span><br><span class="line">    function excute() &#123;</span><br><span class="line">      fn.apply(context, args)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return function () &#123;</span><br><span class="line">      context = this</span><br><span class="line"></span><br><span class="line">      if (firstInvoke &amp;&amp; leading) &#123;</span><br><span class="line">        excute()</span><br><span class="line">        firstInvoke = false</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (timer) &#123;</span><br><span class="line">        clearTimeout(timer)</span><br><span class="line">        timer = null</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      timer = setTimeout(excute, wait)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>leading å‚æ•°ç”¨äºæ§åˆ¶ç¬¬ä¸€æ¬¡æ˜¯å¦éœ€è¦åœ¨æœ€å¼€å§‹å°±è§¦å‘ä¸€æ¬¡ã€‚ä¸»è¦çš„æ€æƒ³å°±æ˜¯åªè¦é‡æ–°æœ‰è°ƒç”¨ï¼Œå°±æŠŠåŸæ¥çš„é‚£ä¸ªè¢«å»¶è¿Ÿæ‰§è¡Œäº†çš„æ–¹æ³•å–æ¶ˆã€‚ å–æ¶ˆçš„æ–¹æ³•æ˜¯è®¾ç½® timer ä¸º nullã€‚firstInvoke ç”¨äºæ ‡è¯†æ–¹æ³•çŸ¥å¦è¢«æ‰§è¡Œäº†ä¸€æ¬¡äº†ã€‚</p>
<p>ä¸‹é¢æ˜¯ throttle çš„å®ç°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">* throttle</span><br><span class="line">* @param fn</span><br><span class="line">* @param wait</span><br><span class="line">* @param leading</span><br><span class="line">* @param trailing</span><br><span class="line">* @returns &#123;Function&#125;</span><br><span class="line">*/</span><br><span class="line">function throttle(fn, wait, &#123; leading = true, trailing = true &#125;) &#123;</span><br><span class="line">    let context, lastExec = 0, timer, args, firstInvoke = true</span><br><span class="line"></span><br><span class="line">    function excute() &#123;</span><br><span class="line">      fn.apply(context, args)</span><br><span class="line"></span><br><span class="line">      lastExec = +new Date()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return function (...arg) &#123;</span><br><span class="line">      let now = +new Date()</span><br><span class="line"></span><br><span class="line">      args = arg</span><br><span class="line"></span><br><span class="line">      context = this</span><br><span class="line">      clearTimeout(timer)</span><br><span class="line"></span><br><span class="line">      if (firstInvoke &amp;&amp; leading) &#123;</span><br><span class="line">        excute()</span><br><span class="line">        firstInvoke = false</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (!lastExec) &#123;</span><br><span class="line">        lastExec = now</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (!!wait &amp;&amp; (now - lastExec) &gt;= wait) &#123;</span><br><span class="line">        excute()</span><br><span class="line">      &#125; else if (trailing) &#123;</span><br><span class="line">        timer = setTimeout(excute, wait)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>throttle å› ä¸ºæ˜¯æŒ‰é¢‘ç‡è§¦å‘ï¼Œæ‰€ä»¥æ¯æ¬¡çš„æ—¶é—´é—´éš”æ˜¯ç›¸åŒçš„ã€‚æ‰€ä»¥å½“æ²¡åˆ°è¯¥æ‰§è¡Œçš„æ—¶é—´ç‚¹çš„æ—¶å€™ï¼Œå°±æŠŠå‰©ä½™çš„æ—¶é—´é‡æ–°è®¾ç½®ç»™ setTimeout ã€‚wait å³ä¸ºå¤šå°‘ç§’æ‰§è¡Œä¸€æ¬¡çš„æ—¶é—´ã€‚çœ‹äº† underscroll é‡Œçš„æºç ï¼Œå®ƒè¿˜è®¾ç½®äº† trailing è¿™äº›å‚æ•°ã€‚trailing è¡¨ç¤ºå½“æœ€åä¸€æ¬¡æ²¡åˆ°æ‰§è¡Œæ—¶é—´æ—¶ï¼Œä½ ä¸æƒ³è¦å»¶è¿Ÿæ‰§è¡Œè¿™ä¸ªå‡½æ•°äº†ã€‚ä¹Ÿå°±æ˜¯æœ€åä¸€æ¬¡è°ƒç”¨å°†è¢«å¿½ç•¥ã€‚</p>
<p>ä¸‹é¢è´´ä¸€ä¸‹ underscroll çš„å®ç°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">// Returns a function, that, when invoked, will only be triggered at most once</span><br><span class="line">// during a given window of time. Normally, the throttled function will run</span><br><span class="line">// as much as it can, without ever going more than once per `wait` duration;</span><br><span class="line">// but if you&apos;d like to disable the execution on the leading edge, pass</span><br><span class="line">// `&#123;leading: false&#125;`. To disable execution on the trailing edge, ditto.</span><br><span class="line">_.throttle = function(func, wait, options) &#123;</span><br><span class="line">  var timeout, context, args, result;</span><br><span class="line">  var previous = 0;</span><br><span class="line">  if (!options) options = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  var later = function() &#123;</span><br><span class="line">    previous = options.leading === false ? 0 : _.now();</span><br><span class="line">    timeout = null;</span><br><span class="line">    result = func.apply(context, args);</span><br><span class="line">    if (!timeout) context = args = null;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  var throttled = function() &#123;</span><br><span class="line">    var now = _.now();</span><br><span class="line">    if (!previous &amp;&amp; options.leading === false) previous = now;</span><br><span class="line">    var remaining = wait - (now - previous);</span><br><span class="line">    context = this;</span><br><span class="line">    args = arguments;</span><br><span class="line">    if (remaining &lt;= 0 || remaining &gt; wait) &#123;</span><br><span class="line">      if (timeout) &#123;</span><br><span class="line">        clearTimeout(timeout);</span><br><span class="line">        timeout = null;</span><br><span class="line">      &#125;</span><br><span class="line">      previous = now;</span><br><span class="line">      result = func.apply(context, args);</span><br><span class="line">      if (!timeout) context = args = null;</span><br><span class="line">    &#125; else if (!timeout &amp;&amp; options.trailing !== false) &#123;</span><br><span class="line">      timeout = setTimeout(later, remaining);</span><br><span class="line">    &#125;</span><br><span class="line">    return result;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  throttled.cancel = function() &#123;</span><br><span class="line">    clearTimeout(timeout);</span><br><span class="line">    previous = 0;</span><br><span class="line">    timeout = context = args = null;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  return throttled;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>underscore æŠŠ throttle å’Œ debounce åˆ†å¼€æ¥å®ç°äº†ï¼Œä½†æ˜¯æœ‰äº›åˆ«çš„å°è£…çš„åº“åˆ™æ˜¯ç”¨ä¸€ä¸ªå‡½æ•°å®ç°ã€‚ä¸‹é¢æ˜¯ underscore debounce çš„å®ç°</p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">// Returns a function, that, as long as it continues to be invoked, will not</span><br><span class="line">  // be triggered. The function will be called after it stops being called for</span><br><span class="line">  // N milliseconds. If `immediate` is passed, trigger the function on the</span><br><span class="line">  // leading edge, instead of the trailing.</span><br><span class="line">  _.debounce = function(func, wait, immediate) &#123;</span><br><span class="line">    var timeout, result;</span><br><span class="line"></span><br><span class="line">    var later = function(context, args) &#123;</span><br><span class="line">      timeout = null;</span><br><span class="line">      if (args) result = func.apply(context, args);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    var debounced = restArguments(function(args) &#123;</span><br><span class="line">      if (timeout) clearTimeout(timeout);</span><br><span class="line">      if (immediate) &#123;</span><br><span class="line">        var callNow = !timeout;</span><br><span class="line">        timeout = setTimeout(later, wait);</span><br><span class="line">        if (callNow) result = func.apply(this, args);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        timeout = _.delay(later, wait, this, args);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      return result;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    debounced.cancel = function() &#123;</span><br><span class="line">      clearTimeout(timeout);</span><br><span class="line">      timeout = null;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    return debounced;</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>
</code></pre><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å‰©ä¸‹çš„æ—¶é—´å°±æ˜¯å»ä¼˜åŒ–ä»£ç å•¦ã€‚çœ‹äº†ä¸‹åˆ«äººçš„æºç ï¼Œç„¶åè‡ªå·±åˆæŒ‰ç…§è‡ªå·±çš„æ–¹å¼å®ç°äº†ä¸‹ï¼Œè¿˜æ˜¯å¾ˆæœ‰æ”¶è·çš„ã€‚</p>
<p>ä¸è¿‡ï¼Œå¦‚æœ underscore å·²ç»æœ‰è¿™ä¹ˆæˆç†Ÿçš„ä¸œè¥¿ï¼Œå®é™…ä¸Šï¼Œæˆ‘è§‰å¾—å¯ä»¥ä¸ç”¨é‡å¤çš„å»åšè¿™ä¸ªå·¥ä½œã€‚ç”¨åˆ«äººæˆç†Ÿçš„å†…å®¹å°±å¥½äº†ã€‚è‡ªå·±äº†è§£äº†åŸç†ï¼Œè‡ªå·±å¯ä»¥å®ç°ï¼Œæœ‰é—®é¢˜çŸ¥é“æ€ä¹ˆå»æŸ¥å°±å¥½ã€‚</p>
<p><img src="xixi.jpg" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;è¿™å‡ å¤©ç¿»äº†ä¸‹ä»¥å‰å†™çš„ä»£ç ï¼Œå‘ç°è‡ªå·±ä»¥å‰è™½ç„¶æœ‰ç”¨ debounce æˆ–è€… throttle çš„æ„è¯†ï¼Œä½†æ˜¯ç¡®æ²¡æœ‰æŠŠä»£ç å°è£…çš„å¾ˆå¥½ã€‚æ¯”å¦‚æ²¡æœ‰ç”¨åˆ°é—­åŒ…å»å°è£… timer, è€Œæ˜¯æŠŠ timer æ”¾åœ¨äº† vue data çš„å˜é‡é‡Œã€‚å› æ­¤å°±å‡ºç°äº†è¿™ç¯‡æ–‡ç« ï¼Œæ€»ç»“ä¸‹
    
    </summary>
    
    
      <category term="Javascript" scheme="http://sevencai.github.io/tags/Javascript/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³webpackç¼–è¯‘åå¯¼è‡´-webkit-boxè¢«å¼ºåˆ¶å»é™¤äº†çš„é—®é¢˜</title>
    <link href="http://sevencai.github.io/2018/05/11/%E8%A7%A3%E5%86%B3webpack%E7%BC%96%E8%AF%91%E5%90%8E%E5%AF%BC%E8%87%B4-webkit-box%E8%A2%AB%E5%BC%BA%E5%88%B6%E5%8E%BB%E9%99%A4%E4%BA%86%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>http://sevencai.github.io/2018/05/11/è§£å†³webpackç¼–è¯‘åå¯¼è‡´-webkit-boxè¢«å¼ºåˆ¶å»é™¤äº†çš„é—®é¢˜/</id>
    <published>2018-05-11T12:12:36.000Z</published>
    <updated>2018-05-11T12:29:35.000Z</updated>
    
    <content type="html"><![CDATA[<hr>
<h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><p>ä»Šå¤©é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå‘ç°é‡æ„åŒäº‹çš„ dist css åœ¨æˆ‘è¿™é‡Œæœ‰å…¼å®¹æ€§é—®é¢˜ã€‚æˆ‘åªå¼•ç”¨äº†ä»–çš„æºæ–‡ä»¶ï¼Œæœªç»è¿‡ä»»ä½•æ›´æ”¹ã€‚æ’å¤„äº†ç”±äº Dom ç»“æ„ä¸åŒçš„åŸå› ä¹‹å¤–ï¼Œå”¯ä¸€çš„ä¸ä¸€æ ·çš„åœ°æ–¹ï¼Œå°±æ˜¯æˆ‘å¼•å…¥ä»–çš„æ–‡ä»¶åï¼Œåœ¨æœ¬åœ°è¿˜è¿›è¡Œäº†webpack ç¼–è¯‘ã€‚é‚£ä¹ˆé—®é¢˜åªèƒ½å‡ºåœ¨äº†è¿™é‡Œäº†ã€‚</p>
<p>ç»è¿‡å¯¹æ¯”ä¸¤ä»½æ–‡ä»¶å‘ç°ï¼Œå¯¹æ¯”å¦‚ä¸‹<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// é‡æ„åŒäº‹çš„css</span><br><span class="line"><span class="selector-class">.detail-title</span>&#123;</span><br><span class="line">	<span class="attribute">-ms-flex</span>:<span class="number">1</span>;</span><br><span class="line">	<span class="attribute">flex</span>:<span class="number">1</span>;</span><br><span class="line">	<span class="attribute">-webkit-box-flex</span>:<span class="number">1</span>;</span><br><span class="line">	<span class="attribute">box-flex</span>:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">// æˆ‘ç¼–è¯‘åçš„æ–‡ä»¶</span><br><span class="line"><span class="selector-class">.detail-title</span>&#123;</span><br><span class="line">	<span class="attribute">-ms-flex</span>:<span class="number">1</span>;</span><br><span class="line">	<span class="attribute">flex</span>:<span class="number">1</span>;</span><br><span class="line">	<span class="attribute">box-flex</span>:<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å’¦ï¼Œ <code>-webkit-box-flex</code> ç«Ÿç„¶è¢«è‡ªåŠ¨å»é™¤äº†ã€‚éš¾é“è¯´åœ¨æŸç§ webpack æ’ä»¶ä¸‹ï¼Œ <code>-webkit-box</code> ä¼šè‡ªåŠ¨è¢«å»é™¤å—ï¼Ÿ</p>
<p>åœ¨ç½‘ä¸Šæœäº†ä¸‹ï¼Œå‘ç°ç¡®å®æ˜¯æœ‰è¿™ç§æƒ…å†µã€‚æœ‰äº›æ’ä»¶çš„æœºåˆ¶åˆ¤æ–­è¿™ä¸ªå†…å®¹æ˜¯ä¸éœ€è¦çš„ï¼Œå¼ºè¡Œè¢«å»é™¤äº†ã€‚å¯ä»¥çœ‹è¿™ä¸ª <a href="https://github.com/webpack/webpack/issues/2543" target="_blank" rel="noopener">issue</a>ã€‚</p>
<p>å³ä½¿ä½ æ˜¯ä½¿ç”¨äº† postCss, autoprefix å»æ·»åŠ äº†å‰ç¼€ï¼Œä½†æ˜¯ä½ ç”¨äº†å»é™¤çš„æ’ä»¶ä¹Ÿä¼šè¢«å»é™¤ã€‚</p>
<hr>
<h1 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h1><p>é¦–å…ˆçœ‹ä¸‹æ˜¯ä»€ä¹ˆæ’ä»¶å¯¼è‡´äº†ä½ çš„ä»£ç è¢«å¼ºåˆ¶çš„å»é™¤äº†ã€‚</p>
<p>å¤§æ¦‚çš„åŸå› å¯èƒ½æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<p><strong>æœ€å¼€å§‹å¯èƒ½æ˜¯ç”±äº <code>UglifyJsPlugin</code> ä¸­é»˜è®¤æŠŠ <code>minimize = true</code> å¼€å¯äº†ï¼Œ è€Œè¿™ä¸ªå­—æ®µåœ¨<code>css-loader</code>å’Œ<code>postcss-loader</code>ä¸­è®¾ç½®æˆ <code>true</code> ä¼šå¼€å¯ä¼˜åŒ–æ¨¡å¼ï¼Œæ‰€ä»¥ä¼šå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–å‹ç¼©ã€‚<br>ä½† <code>css-loader</code> ä¸­åˆä¼šä½¿ç”¨ <code>cssnano</code> è¿›è¡Œå‹ç¼©ï¼Œ è€Œ <code>cssnano</code>ä¸­åˆä¼šè¿›è¡Œæ— å…³å‰ç¼€çš„æ¸…ç†ã€‚</strong></p>
<p>ä¸ºä»€ä¹ˆæ’ä»¶ç«Ÿç„¶ä¼šå½±å“åˆ°loader ? å¯ä»¥å…³æ³¨ä¸‹è¿™ä¸ª <a href="https://github.com/ShowJoy-com/showjoy-blog/issues/31" target="_blank" rel="noopener">issue</a>ã€‚</p>
<p>è¿™ä¸ªæ’ä»¶(UglifyJsPlugin) åœ¨ webpack2.x è²Œä¼¼å·²ç»ä¿®å¤äº†ã€‚ <code>css-loader</code>åŠ<code>autoprefixer</code>ä¹Ÿå·²ç»åšäº†ç›¸åº”çš„ä¼˜åŒ–å¤„ç†ã€‚å¦‚æœä½ æ²¡æœ‰å‡çº§ï¼Œä½ å¯ä»¥è®¾ç½®ä¸‹é¢çš„æ–¹å¼è¯•è¯•ï¼š</p>
<ol>
<li><p>css-loader ä¼ é€’å‚æ•°ï¼š<code>?minimize&amp;-autoprefixer</code></p>
</li>
<li><p>å‘ <code>autoprefixer</code> ä¼ é€’å‚æ•°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">postcss: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [autoprefixer, cssnano(&#123; <span class="attr">safe</span>: <span class="literal">true</span> &#125;)];</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>å¦‚æœè¿˜æœ‰é—®é¢˜ï¼Œå†æ£€æŸ¥ä¸‹ï¼Œä»£ç é‡Œæœ‰æ²¡æœ‰ç”¨åˆ°å…¶ä»–çš„å»é™¤ä¼˜åŒ–å·¥å…·ã€‚</p>
<p>æˆ‘è¿™è¾¹å‡ºçš„é—®é¢˜å°±æ˜¯åœ¨è¿™é‡Œã€‚ç”¨äº†<code>OptimizeCSSPlugin</code>,  å®ƒé»˜è®¤æŠŠå‰ç¼€ç»™å»æ‰äº†ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ç›´æ¥æŠŠè¿™ä¸ª plugin åˆ é™¤äº†ã€‚ä¹‹æ‰€ä»¥æˆ‘è¿™é‡Œå¯ä»¥ç›´æ¥åˆ é™¤ï¼Œæ˜¯å› ä¸ºé‡æ„åŒäº‹ç»™åˆ°çš„å°±æ˜¯å»é™¤å‹ç¼©å¥½äº†çš„ã€‚æ²¡æœ‰å¿…è¦å†å»å‹ç¼©å»é™¤ä¸€æ¬¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// Compress extracted CSS. We are using this plugin so that possible</span><br><span class="line">// duplicated CSS from different components can be deduped.</span><br><span class="line"></span><br><span class="line">new OptimizeCSSPlugin(&#123;</span><br><span class="line">  cssProcessorOptions: config.build.productionSourceMap</span><br><span class="line">    ? &#123; safe: true, map: &#123; inline: false &#125; &#125;</span><br><span class="line">    : &#123; safe: true &#125;</span><br><span class="line">&#125;),</span><br></pre></td></tr></table></figure>
<p>å†æ¥çœ‹ä¸‹ä¸ºä»€ä¹ˆç”¨äº†<code>OptimizeCSSPlugin</code>å»é™¤äº†prefixå‘¢ï¼Ÿçœ‹äº†ä¸‹æºç ï¼Œä¹Ÿæ˜¯åˆå¼•å…¥äº†<code>cssnano</code>ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.options.cssProcessor === <span class="literal">undefined</span>) &#123;</span><br><span class="line">  <span class="keyword">this</span>.options.cssProcessor = <span class="built_in">require</span>(<span class="string">'cssnano'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h1 id="å¼•ç”³é—®é¢˜-ssi-æ‰¾ä¸åˆ°å®šä¹‰çš„å˜é‡"><a href="#å¼•ç”³é—®é¢˜-ssi-æ‰¾ä¸åˆ°å®šä¹‰çš„å˜é‡" class="headerlink" title="å¼•ç”³é—®é¢˜ - ssi æ‰¾ä¸åˆ°å®šä¹‰çš„å˜é‡"></a>å¼•ç”³é—®é¢˜ - ssi æ‰¾ä¸åˆ°å®šä¹‰çš„å˜é‡</h1><p><strong>ç”±è¿™ä¸ªæ‰“åŒ…çš„é—®é¢˜ï¼Œæƒ³åˆ°äº†å‰å‡ å¤©çš„å¦ä¸€ä¸ª webpack çš„é—®é¢˜ï¼Œ index.shtml æ–‡ä»¶ä¸­å¼•å…¥çš„ ssi, å¦‚æœå˜é‡ç”¨ ${variable} è¯»å–ï¼Œè€Œä¸æ˜¯$variable è¯»å–ï¼Œwebpack ç¼–è¯‘æ—¶å°±ä¼šæŠ¥é”™ã€‚</strong>ä½†å®é™…ä¸Šï¼Œè¿™ä¸¤ç§è¯­æ³•éƒ½æ˜¯å¯ä»¥è¢« server ç«¯è§£æçš„ã€‚æ¢ç©¶äº†ä¸‹ä¼šè¢«æŠ¥é”™çš„åŸå› ï¼š</p>
<p>webpack çš„ HtmlWebpackPlugin åœ¨ç¼–è¯‘æ¨¡æ¿çš„æ—¶å€™ï¼Œç”¨çš„æ˜¯ lodash çš„ template æ–¹å¼, ä¹Ÿå°±æ˜¯ <code>${variable}</code> çš„å½¢å¼ã€‚</p>
<p>æ‰€ä»¥ä½ ç”¨äº† ${variable} çš„å½¢å¼çš„è¯ï¼Œä»–å°±ä¼šå»ç¼–è¯‘è¿™ä¸ªå˜é‡ï¼Œä½†æ˜¯å‘¢ï¼Œè¿™ä¸ª variable ä½ æ˜¯ä» ssi ä¸Šè¯»çš„ï¼Œåˆæ²¡æœ‰å®šä¹‰ï¼Œå®ƒæ‰¾ä¸åˆ°ï¼Œæ‰€ä»¥å°±ä¼šæŠ¥é”™äº†ã€‚</p>
<p>æ‰€ä»¥å°±è€è€å®å®çš„ï¼Œå¦‚æœä½ ç”¨çš„ htmlWebpackPlugin å°±ç”¨ <code>$varialbe</code> çš„å½¢å¼å§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// correct</span><br><span class="line">&lt;!--#include virtual=&quot;xxx.cgi?refresh_token=$wxRefreshToken&amp;appid=$wxAppid&quot; --&gt;&apos;;</span><br><span class="line"></span><br><span class="line">// wrong: wxAppid is not defined</span><br><span class="line">&lt;!--#include virtual=&quot;xxx.cgi?refresh_token=$wxRefreshToken&amp;appid=$&#123;wxAppid&#125;&quot; --&gt;&apos;;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><h2 id="ç›¸å…³å‚è€ƒ"><a href="#ç›¸å…³å‚è€ƒ" class="headerlink" title="ç›¸å…³å‚è€ƒ"></a>ç›¸å…³å‚è€ƒ</h2><ol>
<li><a href="https://github.com/webpack/webpack/issues/283" target="_blank" rel="noopener">issue1: # Why does the UglifyJsPlugin affect other loaders?</a></li>
<li><a href="https://github.com/ShowJoy-com/showjoy-blog/issues/31" target="_blank" rel="noopener">issue2: # ã€Œå‰ç«¯ã€ä»UglifyJSPluginå¼ºåˆ¶å¼€å¯csså‹ç¼©æ¢ç©¶webpackæ’ä»¶è¿è¡Œæœºåˆ¶</a></li>
<li><a href="https://github.com/webpack/webpack/issues/2543" target="_blank" rel="noopener">issue3: # Using plugin â€œwebpack.optimize.UglifyJsPluginâ€ led to remove the style â€œdisplay: -webkit-flex;</a></li>
</ol>
<p>è§‰å¾—ç•¥å‘ã€‚è¿˜æ˜¯èŠ±äº†å¤§æ¦‚ä¸€ä¸‹åˆçœ‹è¿™ä¸ªé—®é¢˜ï¼Œå‘œå‘œå‘œ(à²¥ _ à²¥)!</p>
]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
&lt;h1 id=&quot;é—®é¢˜&quot;&gt;&lt;a href=&quot;#é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜&quot;&gt;&lt;/a&gt;é—®é¢˜&lt;/h1&gt;&lt;p&gt;ä»Šå¤©é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå‘ç°é‡æ„åŒäº‹çš„ dist css åœ¨æˆ‘è¿™é‡Œæœ‰å…¼å®¹æ€§é—®é¢˜ã€‚æˆ‘åªå¼•ç”¨äº†ä»–çš„æºæ–‡ä»¶ï¼Œæœªç»è¿‡ä»»ä½•æ›´æ”¹ã€‚æ’å¤„äº†ç”±äº Do
    
    </summary>
    
    
      <category term="å·¥å…·" scheme="http://sevencai.github.io/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>å°ç¨‹åºæ”¯æŒåˆ†åŒ…åŠ è½½å’Œæ— éœ€ç”¨æˆ·æˆæƒè·å¾—å¤´åƒ</title>
    <link href="http://sevencai.github.io/2018/04/23/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%94%AF%E6%8C%81%E5%88%86%E5%8C%85%E5%8A%A0%E8%BD%BD%E5%92%8C%E6%97%A0%E9%9C%80%E7%94%A8%E6%88%B7%E6%8E%88%E6%9D%83%E8%8E%B7%E5%BE%97%E5%A4%B4%E5%83%8F/"/>
    <id>http://sevencai.github.io/2018/04/23/å°ç¨‹åºæ”¯æŒåˆ†åŒ…åŠ è½½å’Œæ— éœ€ç”¨æˆ·æˆæƒè·å¾—å¤´åƒ/</id>
    <published>2018-04-23T06:56:06.000Z</published>
    <updated>2018-04-23T07:06:23.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>ç»“è®ºï¼šå¢åŠ äº†åˆ†åŒ…åŠ è½½ç‰¹æ€§ï¼Œé€Ÿåº¦å¿«äº†å¾ˆå¤šã€‚ä¿®æ”¹äº†ç”¨æˆ·æˆæƒé€»è¾‘ï¼Œä½¿ç”¨ open-data èƒ½åŠ›æ”¹ä¸ºäº†å®Œå…¨ä¸ç”¨ç”¨æˆ·æˆæƒå³å¯è·å¾—æ˜µç§°å¤´åƒç¾¤åç§°ç­‰ã€‚</p>
</blockquote>
<hr>
<h1 id="æ”¹ç‰ˆæ•ˆæœ"><a href="#æ”¹ç‰ˆæ•ˆæœ" class="headerlink" title="æ”¹ç‰ˆæ•ˆæœ"></a>æ”¹ç‰ˆæ•ˆæœ</h1><p>æ˜ŸæœŸå…­çš„æ—¶å€™æŠŠæ‰‹è¾¹çš„å°ç¨‹åºæ”¹ä¸ºäº†åˆ†åŒ…åŠ è½½ã€‚äº§å“æ˜¯æ²¡æœ‰æè¿™ä¸ªéœ€æ±‚çš„ï¼Œä½†æ˜¯å¿ƒæƒ³ä¸‹æ¬¡åšå°ç¨‹åºçš„éœ€æ±‚ä¼°è®¡è¦å¾ˆä¹…ä»¥åäº†ï¼Œå°±æ˜ŸæœŸå…­åŠ äº†ä¸‹ç­ã€‚æ•ˆæœè¿˜æ˜¯å¾ˆå¥½çš„ã€‚</p>
<blockquote>
<p>é¦–å±åŠ è½½æ—¶é—´ç”±ï¼š 7.95s å‡å°‘åˆ°äº† 5.00s<br>å¹³å‡ cpu å æ¯”å³ï¼š19.19% å‡å°‘åˆ°äº† 4.77%</p>
</blockquote>
<p>æˆ‘å¹¶ä¸çŸ¥é“å¾ˆæ¸…æ¥šè¿™ä¸ªå¹³å‡ cpu å æ¯”æ˜¯æ€ä¹ˆè¢«ç®—å‡ºæ¥çš„ã€‚å¦‚æœè¿™ä¸ªæ•°æ®çš„å˜åŒ–èƒ½å¤Ÿå¾®ä¿¡å›¢é˜Ÿèƒ½å¤Ÿè§£é‡Šçš„æ›´è¯¦ç»†äº›å°±å¥½äº†ã€‚</p>
<p>åœ¨åˆ†åŒ…çš„åŠ è½½è¿‡ç¨‹ä¸­ï¼Œæ¯”å¦‚é¦–é¡µæ˜¯ä¸€ä¸ª packageAï¼Œ åˆ°åˆ—è¡¨é¡µæ˜¯ä¸€ä¸ª packageB, è¿™ä¸ªè¿‡ç¨‹åœ¨ç¬¬ä¸€æ¬¡è®¿é—®åˆ—è¡¨é¡µçš„æ—¶å€™ï¼Œä¼šå†å»ä¸‹è½½ä»£ç ã€‚å¾®ä¿¡åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¸®åŠ©äº†å¼€å‘è€…æ˜¾ç¤ºäº†æç¤ºï¼š ç±»ä¼¼äºé¡µé¢åŠ è½½ä¸­ã€‚ è¿™ä¸ªè¿˜æ˜¯å¾ˆå‹å¥½çš„ã€‚</p>
<p>ä½†æ˜¯ä½¿ç”¨åˆ†åŒ…åŠ è½½ç»™å¼€å‘è€…å¸¦æ¥çš„æˆæœ¬ä¹Ÿå¾ˆå¤§ï¼ŒåŸºæœ¬ä¸Šç›®å½•éƒ½è¢«æ›´æ”¹äº†ã€‚ç»“æ„ä¹Ÿè¢«æ›´æ”¹äº†ã€‚å…¶å®æˆ‘æ˜¯è§‰å¾—å¦‚æœèƒ½å¤Ÿä¸æ›´æ”¹ç›®å½•ï¼Œåªåœ¨ json é‡Œé¢é…ç½®å¥½æ‰“åŒ…çš„æ–¹æ¡ˆæ˜¯æœ€å¥½çš„ã€‚å…¶å®ä»”ç»†æƒ³æƒ³ä¸æ›´æ”¹ç›®å½•ä¹Ÿæ˜¯è¡Œçš„å§ï¼Ÿ</p>
<blockquote>
<p>å°ç¨‹åºç»å†è¿‡å‡ æ¬¡çš„â€œæ”¹ç‰ˆâ€ï¼Œæœ€å¼€å§‹çš„ pages, åæ¥çš„ component, å…ˆåœ¨çš„ subPackage, è™½ç„¶ä¸€ç›´å†å˜å¾—æ›´å¥½ï¼Œä½†æ˜¯å¯¹äºä¸€å¼€å§‹å°±å¼€å‘å°ç¨‹åºçš„å¼€å‘è€…æ¥è¯´ï¼Œæˆ–è€…è‡³å°‘å¯¹æˆ‘æ¥è¯´ï¼Œæ˜¯ä¸é‚£ä¹ˆå‹å¥½çš„ã€‚ä»¥åç­‰è¿™é‡Œé€æ¸æ›´åŠ æˆç†Ÿäº†ï¼Œåº”è¯¥ä¼šå¥½çš„ã€‚</p>
</blockquote>
<hr>
<h1 id="æ€ä¹ˆå¼€å‘åˆ†åŒ…åŠ è½½"><a href="#æ€ä¹ˆå¼€å‘åˆ†åŒ…åŠ è½½" class="headerlink" title="æ€ä¹ˆå¼€å‘åˆ†åŒ…åŠ è½½?"></a>æ€ä¹ˆå¼€å‘åˆ†åŒ…åŠ è½½?</h1><p>é¦–å…ˆå¼€å§‹æŠŠç›®å½•ç»“æ„å®šå¥½ï¼Œé…ç½®åœ¨ app.json é‡Œï¼Œè¿™ä¸ªé…ç½®å®é™…å°±æ˜¯å°ç¨‹åºä¼šæ€ä¹ˆåˆ†åŒ…åŠ è½½ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"pages"</span>: [</span><br><span class="line">    <span class="string">"pages/index/index"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"window"</span>: &#123;</span><br><span class="line">    <span class="string">"backgroundTextStyle"</span>: <span class="string">"light"</span>,</span><br><span class="line">    <span class="string">"navigationBarBackgroundColor"</span>: <span class="string">"#3b8cff"</span>,</span><br><span class="line">    <span class="string">"backgroundColor"</span>: <span class="string">"#3b8cff"</span>,</span><br><span class="line">    <span class="string">"navigationBarTitleText"</span>: <span class="string">"è…¾è®¯å……å€¼"</span>,</span><br><span class="line">    <span class="string">"navigationBarTextStyle"</span>: <span class="string">"light"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"subPackages"</span>: [</span><br><span class="line">	&#123;</span><br><span class="line">      <span class="string">"root"</span>: <span class="string">"result"</span>,</span><br><span class="line">	  <span class="string">"pages"</span>: [</span><br><span class="line">        <span class="string">"pages/result/result"</span></span><br><span class="line">	  ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"root"</span>: <span class="string">"userCenter"</span>,</span><br><span class="line">	  <span class="string">"pages"</span>: [</span><br><span class="line">        <span class="string">"pages/user_center/user_center"</span></span><br><span class="line">	  ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šé¢çš„ç›®å½•ç»“æ„ï¼Œé™¤äº†ä¸ªäººä¸­å¿ƒä»¥åŠç»“æœé¡µä»¥å¤–çš„å†…å®¹éƒ½æ˜¯ä¼šåœ¨ç¬¬ä¸€æ¬¡ä¸‹è½½äº†ã€‚ å¾…é¡µé¢è·³è½¬åˆ° result ç»“æœé¡µï¼Œç›¸å…³ä»£ç æ‰ä¼šè¢«ä¸‹è½½å¹¶åŠ è½½ã€‚</p>
<p>æ³¨æ„ç”±äºé¡µé¢çš„ç›®å½•å‘ç”Ÿäº†å˜åŒ–ï¼Œä»¥å‰å¦‚æœæ˜¯é€šè¿‡ç›¸å¯¹è·¯å¾„å¼•ç”¨å¦‚ util é‡Œçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆè·¯å¾„éƒ½æ˜¯è¦æ›´æ”¹çš„ã€‚å»ºè®®è¿™é‡Œéƒ½ä½¿ç”¨ <code>/images/a.png</code> or <code>/utils/a.js</code>è¿™ç§ç»å¯¹è·¯å¾„æ¯”è¾ƒå¥½ã€‚</p>
<hr>
<h1 id="æ€ä¹ˆè·å¾—æ˜µç§°è¿˜ä¸éœ€è¦ç”¨æˆ·æˆæƒï¼Ÿ"><a href="#æ€ä¹ˆè·å¾—æ˜µç§°è¿˜ä¸éœ€è¦ç”¨æˆ·æˆæƒï¼Ÿ" class="headerlink" title="æ€ä¹ˆè·å¾—æ˜µç§°è¿˜ä¸éœ€è¦ç”¨æˆ·æˆæƒï¼Ÿ"></a>æ€ä¹ˆè·å¾—æ˜µç§°è¿˜ä¸éœ€è¦ç”¨æˆ·æˆæƒï¼Ÿ</h1><p>å‰å¤©å¾®ä¿¡å‘å¸ƒäº†æ–°çš„æ–‡ç« ï¼Œåœ°å€<a href="https://mp.weixin.qq.com/s/FTVGVXHSWPlYN1oQTzj-mA" target="_blank" rel="noopener">æˆ³è¿™é‡Œ</a>,é‡Œé¢è®²åˆ°äº†ï¼š</p>
<blockquote>
<p> ç”¨æˆ·åœ¨æ²¡æœ‰ä»»ä½•æ“ä½œçš„æƒ…å†µç›´æ¥å¼¹å‡ºæˆæƒçš„ç™»å½•æ–¹å¼å°†é€æ¸ä¸å†æ”¯æŒï¼Œå—å½±å“çš„æœ‰ wx.getUserInfo æ¥å£ï¼Œä»¥åŠ wx.authorize æ¥å£ä¼ å…¥ scope=â€scope.userInfoâ€ çš„æƒ…å†µã€‚</p>
</blockquote>
<p>å®ƒæ¨èäº†ä¸¤ç§åšæ³•ï¼š</p>
<blockquote>
<p>1ã€æŒ‰é’®ç»„ä»¶çš„ç™»å½•æ–¹å¼ï¼Œç”¨æˆ·ä¸»åŠ¨ç‚¹å‡»æŒ‰é’®å¯ä»¥æ‹‰èµ·ç”¨æˆ·æˆæƒå¼¹æ¡†ï¼Œè·å–ç”¨æˆ·å¤´åƒã€æ˜µç§°ç­‰ä¿¡æ¯ï¼›<br>2ã€åœ¨ä¸è·å–ç”¨æˆ·ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œå¯å±•ç¤ºç”¨æˆ·å¤´åƒæ˜µç§°ã€‚</p>
</blockquote>
<p>ç¬¬ä¸€ç§ç”¨äºä½ çœŸçš„æ˜¯éœ€è¦è·å¾—åˆ°æ˜µç§°å’Œå›¾æ ‡ï¼Œåšä¸€äº›å…¶ä»–çš„å·¥ä½œï¼Œæ¯”å¦‚å­˜å‚¨çš„å·¥ä½œã€‚è¿™ç§æƒ…å†µï¼Œå¼€å‘è€…æ˜¯å¯ä»¥å¾—åˆ°æ˜µç§°å’Œå›¾æ ‡çš„å€¼çš„ã€‚ä½†æ˜¯å®ƒä¹Ÿéœ€è¦ç”¨æˆ·å»è§¦å‘ï¼Œæ¯”å¦‚ä½ ç‚¹å‡»ä¸ªäººä¸­å¿ƒçš„æ—¶å€™ï¼Œæ˜¯ä¸€ä¸ª btn, è¿™ä¸ª button, ä¼šè°ƒç”¨ getUserInfo è¿™ç§æ“ä½œã€‚</p>
<p><code>&lt;button open-type=&quot;getUserInfo&quot; bindgetuserinfo=&quot;userInfoHandler&quot;&gt;å¾®ä¿¡ç™»å½•&lt;/button&gt;</code></p>
<p>æ³¨æ„æ—¢ç„¶è¿˜æ˜¯è°ƒç”¨äº†æˆæƒï¼Œé‚£ä¹ˆä¸€å®šè¿˜æ˜¯ä¼šå¼¹æ¡†æç¤ºç”¨æˆ·æ˜¯å¦å…è®¸æˆæƒï¼Œå¦‚æœç”¨æˆ·æ‹’ç»äº†ä¹Ÿæ˜¯å¾—ä¸åˆ°çš„ã€‚</p>
<p>ç¬¬äºŒç§ï¼Œå¦‚æœä½ åªæ˜¯éœ€è¦ç”¨æˆ·çš„æ˜µç§°å’Œå¤´åƒå±•ç¤ºåœ¨é¡µé¢é‡Œï¼Œè€Œä¸æ˜¯çœŸæ­£çš„éœ€è¦è·å¾—è¿™äº›æ•°æ®å­˜å‚¨åœ¨æŸä¸ªåœ°æ–¹æˆ–è€…å‘åå°æ¥å£ä¼ é€’è¿™äº›å€¼ã€‚é‚£ä¹ˆå°±å‘Šåˆ«<code>wx.authorize</code>å’Œ<code>wx.getUserInfo</code>å§ã€‚</p>
<p>æˆ‘ä»”ç»†æƒ³äº†ä¸‹æˆ‘ä»¬çš„å……å€¼é¡µé¢ï¼Œå­˜å‚¨çš„éƒ½æ˜¯ openidï¼Œæ²¡æœ‰éœ€è¦å»çœŸæ­£çš„ç”¨åˆ° nickName å’Œ avatar è¿™äº›ã€‚åªæ˜¯ä¸ºäº†å†é¡µé¢å±•ç¤ºè€Œå·²ï¼Œæ‰€ä»¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;open-data type=&quot;groupName&quot; open-gid=&quot;xxxxxx&quot;&gt;&lt;/open-data&gt;</span><br><span class="line">&lt;open-data type=&quot;userAvatarUrl&quot;&gt;&lt;/open-data&gt;</span><br><span class="line">&lt;open-data type=&quot;userGender&quot; lang=&quot;zh_CN&quot;&gt;&lt;/open-data&gt;</span><br></pre></td></tr></table></figure>
<p>åˆ©ç”¨ open-data æ—¢å¯ä»¥å®Œç¾çš„è§£å†³å•¦ã€‚ ä¹Ÿå¯ä»¥ç»™å®ƒåŠ å…¥ class, è·Ÿæ­£å¸¸çš„ view æ˜¯ç±»ä¼¼çš„ã€‚</p>
<p>è¿™æ ·å°±å®Œç¾å•¦ï¼Œä»¥åå†ä¹Ÿä¸éœ€è¦ç”¨æˆ·æˆæƒå•¦ã€‚å˜¿å˜¿å˜¿ã€‚ï¼ˆäº§å“å¼€å¿ƒï¼Œæˆ‘ä¹Ÿå¼€å¿ƒï¼‰</p>
<p>å¯¹äº†è¿™é‡Œæ³¨æ„ï¼Œopen-data åªèƒ½åœ¨çœŸæœºä¸Šè¯•å‡ºæ¥ï¼Œæˆ‘çš„ç›®å‰ç‰ˆæœ¬çš„å¼€å‘è€…å·¥å…·æ˜¯å±•ç¤ºä¸å‡ºæ¥çš„ã€‚å¦‚æœä½ å¼€å‘è€…å·¥å…·ä¸Šå‡ºä¸æ¥ï¼Œå°±è¯•è¯•çœŸæœºã€‚å¯èƒ½æ˜¯ç‰ˆæœ¬åŸå› ã€‚</p>
<hr>
<h1 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h1><blockquote>
<p>å¾®ä¿¡ 6.6 å®¢æˆ·ç«¯ï¼Œ1.7.3 åŠä»¥ä¸ŠåŸºç¡€åº“å¼€å§‹æ”¯æŒï¼Œè¯·æ›´æ–°è‡³æœ€æ–°å®¢æˆ·ç«¯ç‰ˆæœ¬ï¼Œå¼€å‘è€…å·¥å…·è¯·ä½¿ç”¨ 1.01.1712150 åŠä»¥ä¸Šç‰ˆæœ¬</p>
</blockquote>
<p>æ³¨æ„è¿™é‡Œçš„åˆ†åŒ…åŠ è½½å¿…é¡»åœ¨1.7.3åŠä»¥ä¸Šå¼€å§‹æ”¯æŒã€‚ä¸ºäº†èƒ½å¤Ÿåœ¨ 1.7.3 ä»¥ä¸‹è‡³å°‘é¡µé¢æ­£å¸¸ã€‚ä½ å¯ä»¥å…¼å®¹ã€‚æˆ–è€…å†å¾®ä¿¡å…¬ä¼—å¹³å°åé¢æ¥è®¾ç½®ï¼Œæœ€ä½ç‰ˆæœ¬ä¸º 1.7.3,è¿™ç§æƒ…å†µä¸‹ï¼š</p>
<blockquote>
<p>è‹¥ç”¨æˆ·ä½¿ç”¨çš„åŸºç¡€åº“ç‰ˆæœ¬ä½äºè®¾ç½®çš„æœ€ä½ç‰ˆæœ¬è¦æ±‚ï¼Œåˆ™æ— æ³•æ­£å¸¸ä½¿ç”¨å°ç¨‹åºï¼Œå¹¶æç¤ºæ›´æ–°å¾®ä¿¡ç‰ˆæœ¬ã€‚</p>
</blockquote>
<p>open-data æ˜¯åœ¨ 1.4.4 ä»¥ä¸Šï¼Œå¥½åƒï¼Œæ‰€ä»¥å¦‚æœä½ è®¾ç½®äº†åˆ†åŒ…åŠ è½½çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªè‚¯å®šä¹Ÿæ²¡é—®é¢˜å•¦ã€‚</p>
<hr>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä¸»è¦æ˜¯ä»£ç ç›®å½•ç»“æ„æ”¹å˜äº†ï¼Œå¯¼è‡´æ¯”å¦‚ä»¥å‰ä»£ç é‡Œçš„ <code>navigateTo({url: &#39;../../result/result&#39;})</code>è·¯å¾„éƒ½éœ€è¦æ”¹å˜ï¼Œè¿™äº›è¯è´¹äº†æ—¶é—´é‡æ„ã€‚ä½†æ˜¯çœ‹åˆ°ç»“æœä¸Šæ˜¯å¿«äº†è¿™ä¹ˆå¤šçš„å°±å¥½ã€‚</p>
<p>è¿˜æœ‰å°±æ˜¯ä¸ºä»€ä¹ˆ page é‡Œä¸èƒ½ç”¨ behavior? åªæœ‰ component é‡Œé¢èƒ½ç”¨ï¼Ÿ è¿™ä¸ªæˆ‘æ„Ÿè§‰ä¸å¤ªåˆç†ã€‚vue é‡Œé¢ æ¯ä¸ª page ä¹Ÿæ˜¯ä¸€ä¸ª component æ¥ç€ã€‚</p>
<p>å…¶å®æ’ä»¶çš„åŠŸèƒ½æˆ‘ä¹Ÿæƒ³è¯•è¯•ï¼Œä½†æ˜¯ç°åœ¨è¿˜æ²¡æœ‰æƒ³åˆ°å¯ä»¥ä½¿ç”¨çš„åœºæ™¯ã€‚ä¹Ÿè®¸æ˜¯ä»¥åå¯ä»¥åƒäº¤æ˜“è®°å½•è¿™ç§åšæˆå°ç¨‹åºï¼Œåˆ«çš„å¤–éƒ¨ä¸šåŠ¡å°±å¯åŠ äº†å§ï¼Ÿ</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç»“è®ºï¼šå¢åŠ äº†åˆ†åŒ…åŠ è½½ç‰¹æ€§ï¼Œé€Ÿåº¦å¿«äº†å¾ˆå¤šã€‚ä¿®æ”¹äº†ç”¨æˆ·æˆæƒé€»è¾‘ï¼Œä½¿ç”¨ open-data èƒ½åŠ›æ”¹ä¸ºäº†å®Œå…¨ä¸ç”¨ç”¨æˆ·æˆæƒå³å¯è·å¾—æ˜µç§°å¤´åƒç¾¤åç§°ç­‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h1 id=&quot;æ”¹ç‰ˆæ•ˆæœ&quot;&gt;&lt;a href=&quot;#æ”¹ç‰ˆæ•ˆæœ&quot; c
    
    </summary>
    
    
      <category term="å°ç¨‹åº" scheme="http://sevencai.github.io/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>é•¿åˆ—è¡¨å›¾ç‰‡ä¼˜åŒ–æ–¹å¼</title>
    <link href="http://sevencai.github.io/2018/03/22/%E9%95%BF%E5%88%97%E8%A1%A8%E5%9B%BE%E7%89%87%E4%BC%98%E5%8C%96%E6%96%B9%E5%BC%8F/"/>
    <id>http://sevencai.github.io/2018/03/22/é•¿åˆ—è¡¨å›¾ç‰‡ä¼˜åŒ–æ–¹å¼/</id>
    <published>2018-03-22T09:57:50.000Z</published>
    <updated>2018-03-22T11:17:39.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æœ€è¿‘åœ¨çš„ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œæœ¬æ¥ä¸é•¿çš„åˆ—è¡¨é¡µå˜å¾—å¾ˆé•¿å¾ˆé•¿ã€‚å¹¶ä¸”æ¯ä¸ª<code>li</code>éƒ½ä¼šæœ‰ä¸€ä¸ªå›¾ç‰‡ã€‚è¿™å°±è¿«ä½¿æˆ‘å¿…é¡»è¦æƒ³åŠæ³•ä¼˜åŒ–è¿™ä¸ªé•¿åˆ—è¡¨äº†ã€‚ä»¥å‰æ€»ä»¥ä¸ºæ˜¯ä¸æ˜¯å¯¹äºé•¿åˆ—è¡¨è€Œè¨€æ€§èƒ½çš„ç“¶é¢ˆæ›´å¤šåœ¨ä¸ dom å’Œjs, ä½†æ˜¯å®é™…ä¸Šå›¾ç‰‡ä»ç„¶ä¹Ÿå å¾ˆå¤§ä¸€éƒ¨åˆ†ã€‚ä¸ºäº†ç”¨æˆ·è€ƒè™‘ï¼Œæ€ä¹ˆæ ·å‡å°‘å›¾ç‰‡å¸¦æ¥çš„æµé‡ï¼Œå¯¹äºèŠ‚çœå¸¦å®½åŠç”¨æˆ·çš„ç”µæ± ååˆ†é‡è¦ã€‚</p>
</blockquote>
<p>é•¿åˆ—è¡¨å¯ä»¥ä»ä»¥ä¸‹è¿™å‡ ä¸ªæ–¹é¢å»ä¼˜åŒ–ï¼š</p>
<hr>
<h1 id="å›¾ç‰‡æ‡’åŠ è½½"><a href="#å›¾ç‰‡æ‡’åŠ è½½" class="headerlink" title="å›¾ç‰‡æ‡’åŠ è½½"></a>å›¾ç‰‡æ‡’åŠ è½½</h1><p>å›¾ç‰‡æ‡’åŠ è½½ï¼Œé•¿åˆ—è¡¨æœ€å¤§çš„é—®é¢˜å°±æ˜¯å›¾ç‰‡å¤ªå¤šï¼Œå¦‚æœä¸€æ¬¡æ€§æŠŠå›¾ç‰‡å…¨éƒ¨è¯·æ±‚äº†ï¼Œé‚£ä¹ˆé¡µé¢æ¸²æŸ“é€Ÿåº¦ä¼šå¾ˆæ…¢ï¼Œå¦‚æœç”¨æˆ·ç‚¹ä¸åˆ°ï¼Œè¿˜ä¼šé€ æˆå¾ˆå¤§çš„æµªè´¹ï¼Œç”šè‡³ä¼šæœ‰æ€§èƒ½ç“¶é¢ˆã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ‡’åŠ è½½å‘¢ï¼Ÿä¸ºäº†åŠ é€Ÿé¡µé¢çš„åŠ è½½é€Ÿåº¦ï¼Œå‡å°‘ä¸å¿…è¦çš„è¯·æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†æœªå‡ºç°åœ¨å¯è§†åŒºåŸŸçš„å›¾ç‰‡å…ˆä¸åšåŠ è½½ï¼Œç­‰åˆ°æ»šåŠ¨åˆ°å¯è§†åŒºåŸŸä»¥åå†å»åŠ è½½ã€‚è¿™æ ·æå‡äº†æ€§èƒ½å’Œæé«˜äº†ç”¨æˆ·ä½“éªŒã€‚</p>
<p>é‚£ä¹ˆåŸç†å°±å¾ˆç®€å•äº†ï¼š<strong>ä¸€å¼€å§‹æ—¶ï¼Œæ‰€æœ‰å›¾ç‰‡éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„ src, æŒ‡å‘æœ¬åœ°çš„ä¸€ä¸ª <code>default.png</code> ,å¹¶ä¸”æŠŠimgçš„çœŸå®çš„åœ°å€æ”¾åœ¨ <code>data-src</code>ä¸Šã€‚å½“æ»šåŠ¨æ—¶ï¼Œåˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨å¯è§†åŒºåŸŸï¼Œå¦‚æœåœ¨å¯è§†åŒºåŸŸ,é‚£ä¹ˆå†æŠŠ <code>data-src</code> ä¸Šçš„å€¼å†™å…¥çœŸæ­£çš„ src ä¸­ã€‚</strong></p>
<hr>
<h1 id="ä»å›¾ç‰‡æœ¬èº«ä¼˜åŒ–"><a href="#ä»å›¾ç‰‡æœ¬èº«ä¼˜åŒ–" class="headerlink" title="ä»å›¾ç‰‡æœ¬èº«ä¼˜åŒ–"></a>ä»å›¾ç‰‡æœ¬èº«ä¼˜åŒ–</h1><p>ç¬¬äºŒç§æ€è·¯å°±æ˜¯ä»å›¾ç‰‡çš„æœ¬èº«å»ä¼˜åŒ–ï¼Œæ¯”å¦‚æ›´æ¢å›¾ç‰‡æ ¼å¼ã€‚ç”± png,jpg,jpeg,gif è½¬æ¢ä¸ºæ›´å¥½çš„ webpã€‚</p>
<blockquote>
<p><strong>WebP çš„ä¼˜åŠ¿åœ¨ä¸å®ƒæ›´å¥½çš„å›¾åƒæ•°æ®å‹ç¼©ç®—æ³•ï¼Œèƒ½å¤Ÿå°†å›¾ç‰‡è½¬æ¢ä¸ºæ›´å°çš„ä½“ç§¯ï¼Œå…·æœ‰æ— æŸå’Œæœ‰æŸçš„å‹ç¼©æ¨¡å¼ã€‚å¦‚æœæ˜¯é€‰æ‹©äº†æœ‰æŸå‹ç¼©ï¼Œä¹Ÿæ‹¥æœ‰è‚‰çœ¼æ— æ³•è¯†åˆ«å·®å¼‚çš„å›¾åƒè´¨é‡ã€‚è™½ç„¶å®ƒåœ¨é¡µé¢æ¸²æŸ“çš„æ—¶å€™æµè§ˆå™¨æ¯”jpgä¼šèŠ±ç¨é•¿çš„æ—¶é—´è§£æå®ƒçš„ç®—æ³•ï¼Œä½†æ˜¯æƒè¡¡å®ƒæ‰€å¸¦æ¥çš„ä½“ç§¯çš„å‡å°‘æ¥çœ‹ï¼ŒWebP è¿˜æ˜¯æœ€ä¼˜ç§€çš„ã€‚</strong></p>
</blockquote>
<p>å…³äºå®ƒçš„æœ‰æŸå’Œæ— æŸæ¥è¯´ï¼Œæ— æŸçš„ä½“ç§¯å‡å°‘ä¼šç¨å¾®å°ä¸€äº›ï¼Œè€Œæœ‰æŸçš„ä½“ç§¯ä¼šå‡å°‘çš„éå¸¸å¤šã€‚å¦‚æœä¸æ˜¯å¯¹å›¾ç‰‡è´¨é‡è¦æ±‚å¾ˆå¤šï¼Œå¯¹äºä¸€èˆ¬çš„å›¾ç‰‡ï¼Œç”¨æœ‰æŸå°±å¾ˆå¥½äº†ã€‚<strong>webpæ— æŸå‹ç¼©å¯ä»¥å‡å°‘å›¾ç‰‡ä¸€åŠçš„å¤§å°è€Œè¾¾åˆ°åŒæ ·æ— æŸçš„æ•ˆæœã€‚</strong>å¯ä»¥çœ‹ä¸‹é¢ä¸€ä»½æ•°æ®ï¼š</p>
<blockquote>
<p>YouTubeçš„è§†é¢‘ç¼©ç•¥å›¾é‡‡ç”¨WebPåï¼Œç½‘é¡µåŠ è½½é€Ÿåº¦æå‡äº†10%ï¼›è°·æ­Œç½‘ä¸Šåº”ç”¨å•†åº—é‡‡ç”¨WebPåï¼Œæ¯å¤©å¯èŠ‚çœå‡ TBçš„å¸¦å®½ï¼Œé¡µé¢å¹³å‡åŠ è½½æ—¶é—´å¤§çº¦å‡å°‘1/3ï¼›è°·æ­Œç§»åŠ¨åº”ç”¨å¸‚åœºé‡‡ç”¨WebPå›¾ç‰‡æ ¼å¼åï¼Œæ¯å¤©èŠ‚çœäº†50TBçš„å­˜å‚¨ç©ºé—´ï¼›2014å¹´è…¾è®¯æ–°é—»å®¢æˆ·ç«¯åº”ç”¨äº†WebPåï¼Œæµé‡å³°å€¼å¸¦å®½é™ä½9GBï¼Œç½‘ç»œè¿æ¥å»¶æ—¶ä¸å˜çš„å‰æä¸‹ï¼Œå¹³å‡å›¾ç‰‡å»¶æ—¶å’Œæ•°æ®ä¸‹è½½å»¶æ—¶é™ä½äº†100msï¼›2014å¹´ç©ºé—´è£…æ‰®ä¹Ÿå…¨é‡è½¬æ¢æˆWebPï¼Œå¸¦å®½ä¸Šä¹Ÿæœ‰æ˜¾è‘—é™ä½ã€‚</p>
</blockquote>
<p>ä½†æ˜¯ WebP ä¸æ˜¯æ¯ä¸ªæµè§ˆå™¨éƒ½æ”¯æŒã€‚æ‰€ä»¥è¦å®è·µçš„è¯å¯ä»¥ä»ä¸‹é¢ä¸¤ä¸ªæ–¹é¢è€ƒè™‘ï¼š</p>
<p>ä»æœåŠ¡ç«¯è€ƒè™‘ï¼š<br>å¦‚æœæµè§ˆå™¨æ”¯æŒ WebP ,é‚£ä¹ˆä¼šåœ¨ request header  accepté‡Œï¼Œå‘é€<code>image/webp</code>, æœåŠ¡å™¨æ”¶åˆ°ä»¥åæ ¹æ®è¿™ä¸ªæ¥å»è¿”å›ç»™å®¢æˆ·ç«¯å›¾ç‰‡ã€‚è¯·æ±‚å¤´é‡Œæœ‰ï¼Œåˆ™å‘é€webpçš„ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±å‘é€æ™®é€šjpgçš„ã€‚</p>
<p>ä¸è¿‡è¿™ä¸ªå¯¹æœåŠ¡å™¨è¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¹¶ä¸”ç°åœ¨å›¾ç‰‡å¤§å¤šæ”¾åœ¨ <code>CDN</code> ä¸Šï¼Œ<code>CDN</code>å»åšè¿™ç§ç­–ç•¥å¯èƒ½ä¼šç¨å¾®éº»çƒ¦ç‚¹ã€‚</p>
<p>ä»å‰ç«¯è€ƒè™‘ï¼š<br>å‰ç«¯å»æ£€æµ‹æµè§ˆå™¨æ˜¯å¦æ”¯æŒ WebP, æ”¯æŒå°±å‘é€ WebP çš„å›¾ç‰‡è¯·æ±‚ï¼Œä¸æ”¯æŒå°±å‘é€ JPG,PNG ç­‰çš„ã€‚ä¸‹é¢æ˜¯ä¸€è¡Œä»£ç åˆ¤æ–­æ˜¯å¦æ”¯æŒWebPã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var isSupportWebp = !!\[\].map &amp;&amp; document.createElement(&apos;canvas&apos;).toDataURL(&apos;image/webp&apos;).indexOf(&apos;data:image/webp&apos;) == 0;</span><br></pre></td></tr></table></figure>
<p><code>!!\[\].map</code>ä¸»è¦æ˜¯åˆ¤æ–­æ˜¯å¦æ˜¯IE9+ï¼Œä»¥å…<code>toDataURL</code>æ–¹æ³•ä¼šæŒ‚æ‰ã€‚å¦‚æœä½ ç›´æ¥å¯¹æ•°ç»„åŸå‹æ‰©å±•äº†mapæ–¹æ³•ï¼Œåˆ™éœ€è¦ä½¿ç”¨<code>!!\[\].map</code>ä»¥å¤–çš„æ–¹æ³•è¿›è¡Œåˆ¤æ–­ï¼Œä¾‹å¦‚<code>!!window.addEventListener</code>ç­‰ã€‚</p>
<p>å“ˆå“ˆï¼Œè¿™ä¸ªæˆ‘æ˜¯å¶ç„¶åœ¨zhangxinxuçš„åšå®¢ä¸Šçœ‹åˆ°çš„ï¼Œæ„Ÿè§‰è¿™ä¸ªè¦æ¯”å…¶ä»–çš„æ–¹æ³•æ›´åŠ ç®€æ´å’Œå¥½ã€‚<a href="http://www.zhangxinxu.com/php/microCodeDetail.php?id=3" target="_blank" rel="noopener">åœ°å€åœ¨è¿™é‡Œã€‚</a></p>
<p>æœ€åæˆ‘æ²¡æœ‰åšè¿™ä¸€å±‚ä¼˜åŒ–ï¼Œå› ä¸ºå›¾ç‰‡å¤ªå¤šï¼Œå·²ç»è¢«å‘åˆ°äº†CDN ä¸Šï¼Œå›¾ç‰‡æºå¯èƒ½éƒ½ä¸åœ¨äº†ï¼Œæ²¡æœ‰è®©ä»–ä»¬å»æŠŠå›¾ç‰‡å˜æˆ WebPã€‚ å¦‚æœä¸€å¼€å§‹å°±é—® CDC çš„åŒäº‹è¦ä¸¤ç§å›¾ç‰‡æ ¼å¼å°±å¥½äº†ã€‚sadã€‚</p>
<hr>
<h1 id="ä»£ç å®ç°1"><a href="#ä»£ç å®ç°1" class="headerlink" title="ä»£ç å®ç°1"></a>ä»£ç å®ç°1</h1><p>é¦–å…ˆæœ‰ä¸¤ç§åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨å¯è§†åŒºåŸŸçš„æ–¹æ³•ï¼š</p>
<ol>
<li>offsetTop - scrollTop &lt; clientHeight ï¼Œä»£è¡¨åœ¨å¯è§†åŒºã€‚</li>
<li>IntersectionObserverï¼Œè¿™ä¸ª Api å¯ä»¥ç›´æ¥æ¥åˆ¤æ–­ã€‚</li>
</ol>
<p>æ³¨æ„å¯ä»¥ç”¨ throttle é˜²æ­¢è¯·æ±‚æ¬¡æ•°è¿‡é«˜ï¼Œåœ¨ä¸€å®šçš„æ—¶é—´èŒƒå›´å†…åªè¯·æ±‚1æ¬¡ã€‚ä¸‹é¢çš„ä»£ç æ˜¯éšæ„å†™çš„ï¼Œæ²¡æœ‰è·‘è¿‡ã€‚å¯ä»¥å½“åšä¼ªç æ¥çœ‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">const checkVisible = (ele) =&gt; &#123;</span><br><span class="line">  let scrollTop = document.documentElement.scrollTop || document.body.scrollTop</span><br><span class="line">  let clientHeight = document.documentElement.clientHeight</span><br><span class="line"></span><br><span class="line">  return ele.offsetTop - scrollTop &lt; clientHeight</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let imgs = document.getElementsByTagName(&quot;img&quot;), nums = imgs.length</span><br><span class="line"></span><br><span class="line">const lazyLoad = () =&gt; &#123;</span><br><span class="line">  for (let i = 0; i &lt; nums; i++) &#123;</span><br><span class="line">    if (checkVisible(imgs[i]) &amp;&amp; imgs[i].getAttribute(&quot;src&quot;) === &quot;default.png&quot;) &#123;</span><br><span class="line">      imgs[i].src = imgs[i].getAttribute(&quot;data-src&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const throttle = (action, delay) =&gt; &#123;</span><br><span class="line">  let timeout = null</span><br><span class="line">  let lastRun = 0</span><br><span class="line">  return function () &#123;</span><br><span class="line">    if (timeout) &#123;</span><br><span class="line">      return</span><br><span class="line">    &#125;</span><br><span class="line">    let elapsed = Date.now() - lastRun</span><br><span class="line">    let context = this</span><br><span class="line">    let args = arguments</span><br><span class="line">    let runCallback = function () &#123;</span><br><span class="line">      lastRun = Date.now()</span><br><span class="line">      timeout = false</span><br><span class="line">      action.apply(context, args)</span><br><span class="line">    &#125;</span><br><span class="line">    if (elapsed &gt;= delay) &#123;</span><br><span class="line">      runCallback()</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      timeout = setTimeout(runCallback, delay)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">document.addEventListener(&quot;scroll&quot;, throttle(lazyLoad, 1000))</span><br></pre></td></tr></table></figure></p>
<hr>
<h1 id="ä»£ç å®ç°2"><a href="#ä»£ç å®ç°2" class="headerlink" title="ä»£ç å®ç°2"></a>ä»£ç å®ç°2</h1><p>å› ä¸ºé¡¹ç›®æœ¬èº«æ˜¯Vueå†™çš„ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿå»åœ¨ç½‘ä¸Šæ‰¾äº†ç›¸åº”çš„<code>directives</code>, å·²ç»æœ‰äº†å¾ˆå¥½çš„ä¸€äº›å®ç°ã€‚ä»–ä»¬çš„æ¯”è¾ƒå®Œæ•´ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªï¼š<a href="https://github.com/hilongjw/vue-lazyload" target="_blank" rel="noopener">https://github.com/hilongjw/vue-lazyload</a>ï¼Œç”¨æ³•å¾ˆç®€å•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Vue.use(VueLazyload, &#123;</span><br><span class="line">  preLoad: 1.3,</span><br><span class="line">  attempt: 2,</span><br><span class="line">  listenEvents: [&quot;scroll&quot;]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ç„¶åå† img æ ‡ç­¾ä¸Šï¼Œä½¿ç”¨è¿™ä¸ª <code>directive</code>ï¼Œ <code>v-lazy</code> å³å¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img class=&quot;mod-service__pic&quot; v-lazy=&quot;list.icon&quot; aria-hidden=&quot;true&quot; v-bind:alt=&quot;list.name&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<hr>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>åœ¨åšè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘è¿˜çœ‹äº†ä¸€äº›å…¶ä»–çš„å†…å®¹ï¼Œæ¯”å¦‚ png8, png24, svg,è¿™äº›ã€‚ä¹Ÿå»çœ‹äº†ä¸‹vue-lazyloadè¿™ä¸ªåº“çš„æºç ã€‚æ”¶è´§å¤šå¤šã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æœ€è¿‘åœ¨çš„ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œæœ¬æ¥ä¸é•¿çš„åˆ—è¡¨é¡µå˜å¾—å¾ˆé•¿å¾ˆé•¿ã€‚å¹¶ä¸”æ¯ä¸ª&lt;code&gt;li&lt;/code&gt;éƒ½ä¼šæœ‰ä¸€ä¸ªå›¾ç‰‡ã€‚è¿™å°±è¿«ä½¿æˆ‘å¿…é¡»è¦æƒ³åŠæ³•ä¼˜åŒ–è¿™ä¸ªé•¿åˆ—è¡¨äº†ã€‚ä»¥å‰æ€»ä»¥ä¸ºæ˜¯ä¸æ˜¯å¯¹äºé•¿åˆ—è¡¨è€Œè¨€æ€§èƒ½çš„ç“¶é¢ˆæ›´å¤šåœ¨ä¸ dom å’Œjs, ä½†æ˜¯å®é™…ä¸Šå›¾ç‰‡ä»ç„¶ä¹Ÿå å¾ˆå¤§ä¸€éƒ¨åˆ†ã€‚ä¸º
    
    </summary>
    
    
      <category term="Javascript" scheme="http://sevencai.github.io/tags/Javascript/"/>
    
  </entry>
  
  <entry>
    <title>isObjEmpty/once function/template rendering/cdnçš„å®ç°å’Œè§£é‡Š</title>
    <link href="http://sevencai.github.io/2018/03/21/isObjEmpty-once-function-template-rendering-cdn%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%92%8C%E8%A7%A3%E9%87%8A/"/>
    <id>http://sevencai.github.io/2018/03/21/isObjEmpty-once-function-template-rendering-cdnçš„å®ç°å’Œè§£é‡Š/</id>
    <published>2018-03-21T03:03:57.000Z</published>
    <updated>2018-03-21T03:18:23.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æ€»ç»“äº†å‡ ç§åˆ¤æ–­ Object æ˜¯å¦ä¸ºç©ºçš„æ–¹æ³•<br>æ€»ç»“ once function (åªæ‰§è¡Œä¸€æ¬¡å‡½æ•°ä»£ç )<br>å®ç°ä¸¤ç§ç®€å•çš„å­—ç¬¦ä¸²æ¨¡æ¿æ›¿æ¢æ–¹æ³•<br>é‡æ–°å½’çº³æ€»ç»“äº†ä¸‹CDNå’ŒDNSçš„åè¯è§£é‡Š</p>
</blockquote>
<hr>
<h1 id="once-function-è®©å‡½æ•°åªæ‰§è¡Œä¸€æ¬¡"><a href="#once-function-è®©å‡½æ•°åªæ‰§è¡Œä¸€æ¬¡" class="headerlink" title="once function è®©å‡½æ•°åªæ‰§è¡Œä¸€æ¬¡"></a>once function è®©å‡½æ•°åªæ‰§è¡Œä¸€æ¬¡</h1><p>è¿™é‡Œåˆ©ç”¨äº†é—­åŒ…å¾ˆå¥½çš„ä¿å­˜äº†å†…å±‚å‡½æ•°çš„è¿”å›å€¼å†…å®¹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰</span><br><span class="line">const once = (fn, context) =&gt; &#123;</span><br><span class="line"> var result</span><br><span class="line"></span><br><span class="line"> return function () &#123;</span><br><span class="line">  if (fn) &#123;</span><br><span class="line">   result = fn.apply(context || this, arguments)</span><br><span class="line">   fn = null</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return result</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨</span><br><span class="line">let logOnce = once(function () &#123;</span><br><span class="line"> return Array.prototype.slice.call(arguments)[0]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">logOnce(4,5)  // get 4</span><br><span class="line">logOnce(6,7)  // get 4</span><br></pre></td></tr></table></figure></p>
<hr>
<h1 id="å®ç°ç®€å•çš„æ¨¡æ¿å­—ç¬¦ä¸²æ›¿æ¢"><a href="#å®ç°ç®€å•çš„æ¨¡æ¿å­—ç¬¦ä¸²æ›¿æ¢" class="headerlink" title="å®ç°ç®€å•çš„æ¨¡æ¿å­—ç¬¦ä¸²æ›¿æ¢"></a>å®ç°ç®€å•çš„æ¨¡æ¿å­—ç¬¦ä¸²æ›¿æ¢</h1><p>ç»å¸¸ä¼šæœ‰ä¸‹é¢çš„éœ€æ±‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let template = `æˆ‘å«&#123;&#123;name&#125;&#125;, æˆ‘çš„æ€§åˆ«æ˜¯&#123;&#123;sex&#125;&#125;`</span><br><span class="line">let person = &#123;</span><br><span class="line"> name: &apos;Seven&apos;,</span><br><span class="line"> sex: &apos;female&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(&apos;æˆ‘å«Seven, æˆ‘çš„æ€§åˆ«æ˜¯female&apos;)</span><br></pre></td></tr></table></figure></p>
<p>ä¸‹é¢æ˜¯ä¸€ç§ç®€å•çš„å®ç°ï¼ŒæŠŠæ¨¡æ¿å’Œå¯¹è±¡ï¼Œç»“åˆä¸ºç›®æ ‡å­—ç¬¦ä¸²ï¼Œæ–¹æ³•1å¦‚ä¸‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const parseTemplateByRegFunc = (obj, template) =&gt; &#123;</span><br><span class="line"> return template.replace(/\&#123;\&#123;(.*?)\&#125;\&#125;/g, (match, key) =&gt; obj[key.trim()])</span><br><span class="line">&#125;</span><br><span class="line">parseTemplateByRegFunc(&#123;name: &apos;seven&apos;&#125;, &apos;æˆ‘å«&#123;&#123; name&#125;&#125;&apos;) // æˆ‘å«seven</span><br></pre></td></tr></table></figure></p>
<p>æ–¹æ³•2æ¯”è¾ƒå®¹æ˜“æƒ³åˆ°ï¼Œå®ç°å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const parseTemplateByObjectKeys = (obj, template) =&gt; &#123;</span><br><span class="line"> Object.keys(obj).forEach(key =&gt; &#123;</span><br><span class="line">  template = template.replace(new RegExp(`&#123;&#123;\\s*$&#123;key&#125;\\s*&#125;&#125;`, &apos;g&apos;), obj[key])</span><br><span class="line"> &#125;)</span><br><span class="line"></span><br><span class="line"> return template</span><br><span class="line">&#125;</span><br><span class="line">parseTemplateByObjectKeys(&#123;name: &apos;seven&apos;&#125;, &apos;æˆ‘å«&#123;&#123; name&#125;&#125;&apos;) // æˆ‘å«seven</span><br></pre></td></tr></table></figure></p>
<p>ç®€å•çš„æŠŠ obj é‡Œé¢æ¯ä¸ªkey éƒ½æ›¿æ¢ä¸€æ¬¡ã€‚æ–¹æ³•1ç”¨åˆ°çš„æ˜¯replaceçš„ç‰¹æ€§ã€‚</p>
<hr>
<h1 id="å…³äº-CDN"><a href="#å…³äº-CDN" class="headerlink" title="å…³äº CDN"></a>å…³äº CDN</h1><p>DNS æ˜¯åŸŸåè§£æç³»ç»Ÿï¼Œå®ƒä½œä¸ºå°†åŸŸåå’ŒIPåœ°å€ç›¸äº’æ˜ å°„çš„ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œèƒ½å¤Ÿä½¿äººæ›´æ–¹ä¾¿åœ°è®¿é—®äº’è”ç½‘ã€‚å…¶ä¸­æœ‰ä¸€é¡¹æŠ€æœ¯æ˜¯ä¼šæ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„IPç»™ç”¨æˆ·ã€‚è¿™ç§æ ¹æ®æ¯å°æœºå™¨çš„è´Ÿè½½é‡ï¼Œè¯¥æœºå™¨ç¦»ç”¨æˆ·åœ°ç†ä½ç½®çš„è·ç¦»ç­‰ç­‰ï¼Œè¿”å›åˆé€‚çš„IPçš„æŠ€æœ¯ç§°ä¹‹ä¸º DNS é‡å®šå‘ã€‚CDNå°±æ˜¯åˆ©ç”¨çš„DNSé‡å®šå‘æŠ€æœ¯ã€‚</p>
<blockquote>
<p>CDNçš„å…¨ç§°æ˜¯Content Delivery Networkï¼Œå³å†…å®¹åˆ†å‘ç½‘ç»œã€‚å…¶åŸºæœ¬æ€è·¯æ˜¯å°½å¯èƒ½é¿å¼€äº’è”ç½‘ä¸Šæœ‰å¯èƒ½å½±å“æ•°æ®ä¼ è¾“é€Ÿåº¦å’Œç¨³å®šæ€§çš„ç“¶é¢ˆå’Œç¯èŠ‚ï¼Œä½¿å†…å®¹ä¼ è¾“çš„æ›´å¿«ã€æ›´ç¨³å®šã€‚é€šè¿‡åœ¨ç½‘ç»œå„å¤„æ”¾ç½®èŠ‚ç‚¹æœåŠ¡å™¨æ‰€æ„æˆçš„åœ¨ç°æœ‰çš„äº’è”ç½‘åŸºç¡€ä¹‹ä¸Šçš„ä¸€å±‚æ™ºèƒ½è™šæ‹Ÿç½‘ç»œï¼Œ<strong>CDNç³»ç»Ÿèƒ½å¤Ÿå®æ—¶åœ°æ ¹æ®ç½‘ç»œæµé‡å’Œå„èŠ‚ç‚¹çš„è¿æ¥ã€è´Ÿè½½çŠ¶å†µä»¥åŠåˆ°ç”¨æˆ·çš„è·ç¦»å’Œå“åº”æ—¶é—´ç­‰ç»¼åˆä¿¡æ¯å°†ç”¨æˆ·çš„è¯·æ±‚é‡æ–°å¯¼å‘ç¦»ç”¨æˆ·æœ€è¿‘çš„æœåŠ¡èŠ‚ç‚¹ä¸Šã€‚å…¶ç›®çš„æ˜¯ä½¿ç”¨æˆ·å¯å°±è¿‘å–å¾—æ‰€éœ€å†…å®¹ï¼Œè§£å†³ Internetç½‘ç»œæ‹¥æŒ¤çš„çŠ¶å†µï¼Œæé«˜ç”¨æˆ·è®¿é—®ç½‘ç«™çš„å“åº”é€Ÿåº¦</strong>ã€‚</p>
</blockquote>
<p>ä¸Šé¢çš„å†…å®¹ä»¥å‰æ˜¯çŸ¥é“çš„ï¼Œè¿™é‡Œé‡æ–°å½’çº³äº†ä¸‹ã€‚</p>
<hr>
<h1 id="isObjEmpty-çš„å®ç°ï¼ˆåˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºç©ºï¼‰"><a href="#isObjEmpty-çš„å®ç°ï¼ˆåˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºç©ºï¼‰" class="headerlink" title="isObjEmpty çš„å®ç°ï¼ˆåˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºç©ºï¼‰"></a>isObjEmpty çš„å®ç°ï¼ˆåˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºç©ºï¼‰</h1><p>ä½¿ç”¨ for â€¦ inï¼Œå¦‚æœè¿›å…¥äº†å¾ªåï¼Œä»£è¡¨å¯¹è±¡ä¸ä¸ºç©ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for (let key in obj) &#123;</span><br><span class="line"> if (obj.hasOwnProperty(key)) &#123;</span><br><span class="line">  return false</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">return true</span><br></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨ Object keysï¼Œ å¾—åˆ°ç©ºæ•°ç»„ï¼Œåˆ™ä»£è¡¨å¯¹è±¡ä¸ºç©ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return Object.keys(obj).length === 0</span><br></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨ JSON.stringify å’Œ ç©ºå¯¹è±¡å¯¹æ¯”ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return JSON.stringify(obj) === JSON.stringify(&#123;&#125;)</span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ€»ç»“äº†å‡ ç§åˆ¤æ–­ Object æ˜¯å¦ä¸ºç©ºçš„æ–¹æ³•&lt;br&gt;æ€»ç»“ once function (åªæ‰§è¡Œä¸€æ¬¡å‡½æ•°ä»£ç )&lt;br&gt;å®ç°ä¸¤ç§ç®€å•çš„å­—ç¬¦ä¸²æ¨¡æ¿æ›¿æ¢æ–¹æ³•&lt;br&gt;é‡æ–°å½’çº³æ€»ç»“äº†ä¸‹CDNå’ŒDNSçš„åè¯è§£é‡Š&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h
    
    </summary>
    
    
      <category term="Javascript" scheme="http://sevencai.github.io/tags/Javascript/"/>
    
  </entry>
  
</feed>
